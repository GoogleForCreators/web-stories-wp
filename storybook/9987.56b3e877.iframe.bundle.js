"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[9987],{"./packages/animation/src/components/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AMPAnimations:()=>components_AMPAnimations,AMPKeyframes:()=>components_AMPKeyframes,AMPWrapper:()=>components_AMPWrapper,AnimationProvider:()=>provider,WAAPIWrapper:()=>components_WAAPIWrapper,useStoryAnimationContext:()=>components_useStoryAnimationContext});__webpack_require__("./node_modules/react/index.js");var src=__webpack_require__("./packages/react/src/index.ts"),range=__webpack_require__("./packages/units/src/range.ts"),v4=__webpack_require__("./packages/animation/node_modules/uuid/dist/esm-browser/v4.js"),parts=__webpack_require__("./packages/animation/src/parts/index.tsx");const context=(0,src.kr)({state:{providerId:"",animationTargets:[]},actions:{getAnimationParts:()=>[],hoistWAAPIAnimation:()=>()=>{},WAAPIAnimationMethods:{play:()=>{},pause:()=>{},setCurrentTime:()=>{},reset:()=>{}}}});let AnimationMachineState=function(AnimationMachineState){return AnimationMachineState.Idle="idle",AnimationMachineState.Complete="complete",AnimationMachineState}({}),AnimationMachineTransition=function(AnimationMachineTransition){return AnimationMachineTransition.Complete="complete",AnimationMachineTransition.Reset="reset",AnimationMachineTransition}({});const AnimationMachine={[AnimationMachineState.Idle]:{[AnimationMachineTransition.Complete]:AnimationMachineState.Complete},[AnimationMachineState.Complete]:{[AnimationMachineTransition.Reset]:AnimationMachineState.Idle}},animationStateReducer=(state,action)=>AnimationMachine[state][action]||state;const animationMachine=function useAnimationMachine(){const[animationState,dispatchWAAPIAnimationState]=(0,src._Y)(animationStateReducer,AnimationMachineState.Idle);return{animationState,reset:(0,src.I4)((()=>dispatchWAAPIAnimationState(AnimationMachineTransition.Reset)),[]),complete:(0,src.I4)((()=>dispatchWAAPIAnimationState(AnimationMachineTransition.Complete)),[])}};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const STABLE=[];function mapHasReferentialEntry(map,_ref2){let[key,val]=_ref2;return map?.has(key)&&map.get(key)===val}function Provider(_ref3){let{animations=STABLE,elements=STABLE,children,onWAAPIFinish,selectedElementIds=[]}=_ref3;const elementsInstanceMapRef=(0,src.sO)(null),elementsInstanceMap=(0,src.Ye)((()=>new Map(elements.map((element=>[element.id,element])))),[elements]),animationsInstanceMapRef=(0,src.sO)(null),animationsInstanceMap=(0,src.Ye)((()=>new Map(animations.map((animation=>[animation.id,animation])))),[animations]),animationPartsMapRef=(0,src.sO)(null),animationPartsMap=(0,src.Ye)((()=>{const{current:oldAnimationsInstanceMap}=animationsInstanceMapRef,{current:oldElementsInstanceMap}=elementsInstanceMapRef,{current:oldAnimationPartsMap}=animationPartsMapRef,_animationPartsMap=new Map;for(const[animationId,animation]of animationsInstanceMap.entries()){const isAnimationRefentiallyStable=mapHasReferentialEntry(oldAnimationsInstanceMap,[animationId,animation]),areAnimationTargetElementsReferentiallyStable=animation.targets.every((elementId=>mapHasReferentialEntry(oldElementsInstanceMap,[elementId,elementsInstanceMap.get(elementId)])));if(isAnimationRefentiallyStable&&areAnimationTargetElementsReferentiallyStable&&null!==oldAnimationPartsMap)animation.targets.forEach((elementId=>{const element=elementsInstanceMap.get(elementId);element?.isHidden||_animationPartsMap.set(elementId,oldAnimationPartsMap.get(elementId)||[])}));else{const{targets}=animation;(targets||[]).forEach((elementId=>{const generatedParts=_animationPartsMap.get(elementId)||[],element=elementsInstanceMap.get(elementId);element&&(element.isHidden||_animationPartsMap.set(elementId,[...generatedParts,(0,parts.Af)(animation,element)]))}))}}return animationsInstanceMapRef.current=animationsInstanceMap,elementsInstanceMapRef.current=elementsInstanceMap,animationPartsMapRef.current=_animationPartsMap,_animationPartsMap}),[animationsInstanceMap,elementsInstanceMap]),providerId=(0,src.Ye)((()=>(0,v4.Z)()),[]),animationTargets=(0,src.Ye)((()=>Array.from(animationPartsMap.keys()||[])),[animationPartsMap]),getAnimationParts=(0,src.I4)((target=>animationPartsMap.get(target)||STABLE),[animationPartsMap]),onWAAPIFinishRef=(0,src.sO)(onWAAPIFinish),{animationState,reset,complete}=animationMachine(),WAAPIAnimationRef=(0,src.sO)(new Map),[WAAPIAnimations,setWAAPIAnimations]=(0,src.eJ)([]),filteredWAAPIAnimations=(0,src.Ye)((()=>((animations,selectedElementIds)=>selectedElementIds.length>0?animations.filter((_ref=>{let{elementId}=_ref;return selectedElementIds.includes(elementId)})):animations)(WAAPIAnimations,selectedElementIds)),[selectedElementIds,WAAPIAnimations]),hoistWAAPIAnimation=(0,src.I4)((_ref4=>{let{animation,elementId}=_ref4;const symbol=Symbol();return WAAPIAnimationRef.current.set(symbol,{animation,elementId}),setWAAPIAnimations(Array.from(WAAPIAnimationRef.current.values())),()=>{animation?.cancel(),WAAPIAnimationRef.current.delete(symbol),setWAAPIAnimations(Array.from(WAAPIAnimationRef.current.values()))}}),[]),WAAPIAnimationMethods=(0,src.Ye)((()=>{const pause=()=>filteredWAAPIAnimations.forEach((_ref6=>{let{animation}=_ref6;return animation?.pause()})),setCurrentTime=time=>filteredWAAPIAnimations.forEach((_ref7=>{let{animation}=_ref7;const{duration=0,delay=0}=animation.effect?.getTiming()??{},animationEndTime=delay+("string"==typeof duration?0:duration);animation.currentTime="end"===time?animationEndTime:(0,range.uZ)(time,{MIN:0,MAX:animationEndTime})}));return{play:()=>filteredWAAPIAnimations.forEach((_ref5=>{let{animation}=_ref5;animation?.cancel(),animation?.play()})),pause,setCurrentTime,reset:()=>{pause(),requestAnimationFrame((()=>{setCurrentTime("end")}))}}}),[filteredWAAPIAnimations]);(0,src.d4)((()=>{let cancel=()=>{};return AnimationMachineState.Idle===animationState&&filteredWAAPIAnimations.length&&new Promise(((resolve,reject)=>{cancel=reject,Promise.all(filteredWAAPIAnimations.map((_ref8=>{let{animation}=_ref8;return(animation=>new Promise((resolve=>{animation.onfinish=resolve})))(animation)}))).then((()=>{cancel=()=>{},resolve()}))})).then(complete).catch((()=>{})),cancel}),[filteredWAAPIAnimations,animationState,complete]),onWAAPIFinishRef.current=onWAAPIFinish,(0,src.d4)((()=>{AnimationMachineState.Complete===animationState&&(onWAAPIFinishRef.current?.(),reset())}),[animationState,reset]);const value=(0,src.Ye)((()=>({state:{providerId,animationTargets},actions:{getAnimationParts,hoistWAAPIAnimation,WAAPIAnimationMethods}})),[providerId,getAnimationParts,animationTargets,hoistWAAPIAnimation,WAAPIAnimationMethods]);return(0,jsx_runtime.jsx)(context.Provider,{value,children})}Provider.displayName="Provider";const provider=Provider;const utils_createKeyframeEffect=function createKeyframeEffect(target,keyframes,timings){const convertedTimings={...timings,iterations:"infinity"===timings.iterations?1/0:timings.iterations};return new KeyframeEffect(target,keyframes,convertedTimings)};var styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js");const fullSizeAbsolute=styled_components_browser_esm.ZP.div.withConfig({displayName:"fullSizeAbsolute",componentId:"sc-1wmzg8a-0"})(["position:absolute;top:0;right:0;bottom:0;left:0;transform-origin:50% 50%;",";"],(_ref=>{let{overflowHidden}=_ref;return overflowHidden&&(0,styled_components_browser_esm.iv)(["overflow:hidden;"])}));const components_useStoryAnimationContext=function useStoryAnimationContext(){let selector=arguments.length>0&&void 0!==arguments[0]?arguments[0]:src.yR;return(0,src.Sz)(context,selector)};function WAAPIAnimationWrapper(_ref){let{children,hoistAnimation,keyframes,timings,targetLeafElement=!1}=_ref;const target=(0,src.sO)(null);return(0,src.d4)((()=>{if(!keyframes)return()=>{};const targetEl=targetLeafElement?target.current?.querySelector('[data-leaf-element="true"]'):target.current;if(!targetEl)return()=>{};const effect=utils_createKeyframeEffect(targetEl,keyframes,timings);return hoistAnimation(new Animation(effect,document.timeline))}),[hoistAnimation,keyframes,targetLeafElement,timings]),(0,jsx_runtime.jsx)(fullSizeAbsolute,{ref:target,children})}function WAAPIWrapper(_ref2){let{children,target}=_ref2;const{hoistWAAPIAnimation,animationParts}=components_useStoryAnimationContext((_ref3=>{let{actions}=_ref3;return{hoistWAAPIAnimation:actions.hoistWAAPIAnimation,animationParts:actions.getAnimationParts(target)}})),WAAPIAnimationParts=animationParts?.map((anim=>anim.WAAPIAnimation)),hoistAnimation=(0,src.I4)((animation=>hoistWAAPIAnimation({animation,elementId:target})),[target,hoistWAAPIAnimation]);return(0,jsx_runtime.jsx)(WAAPIAnimationWrapper,{hoistAnimation,...WAAPIAnimationParts[0],children:(0,jsx_runtime.jsx)(WAAPIAnimationWrapper,{hoistAnimation,...WAAPIAnimationParts[1],children:(0,jsx_runtime.jsx)(WAAPIAnimationWrapper,{hoistAnimation,...WAAPIAnimationParts[2],children})})})}WAAPIAnimationWrapper.displayName="WAAPIAnimationWrapper",WAAPIWrapper.displayName="WAAPIWrapper";const components_WAAPIWrapper=WAAPIWrapper,fullSizeAbsoluteStyles={width:"100%",height:"100%",display:"block",position:"absolute",top:0,left:0};function ComposableWrapper(_ref){let{animationParts,children}=_ref;const root=props=>props.children,ComposedWrapper=(0,src.Ye)((()=>animationParts.reduce(((Composable,animationPart)=>{const{AMPTarget}=animationPart;return props=>(0,jsx_runtime.jsx)(Composable,{children:(0,jsx_runtime.jsx)(AMPTarget,{style:fullSizeAbsoluteStyles,children:props.children})})}),root)),[animationParts]);return(0,jsx_runtime.jsx)(ComposedWrapper,{children})}function AMPWrapper(_ref2){let{target,children}=_ref2;const{actions:{getAnimationParts}}=components_useStoryAnimationContext();return(0,jsx_runtime.jsx)(ComposableWrapper,{animationParts:getAnimationParts(target),children})}ComposableWrapper.displayName="ComposableWrapper",AMPWrapper.displayName="AMPWrapper";const components_AMPWrapper=AMPWrapper;var outputs=__webpack_require__("./packages/animation/src/outputs/index.ts");const components_generateKeyframesMap=function generateKeyframesMap(targets,getAnimationParts){const allKeyframeEntries=targets.map((target=>getAnimationParts(target).map((part=>Object.entries(part.generatedKeyframes))))).flat(2),keyframesAsMap=new Map(allKeyframeEntries);return Object.fromEntries(keyframesAsMap)};const components_AMPKeyframes=function AMPKeyframes(){const{state:{providerId,animationTargets},actions:{getAnimationParts}}=components_useStoryAnimationContext(),keyframesMap=(0,src.Ye)((()=>components_generateKeyframesMap(animationTargets,getAnimationParts)),[animationTargets,getAnimationParts]);return Object.keys(keyframesMap).map((animationName=>(0,jsx_runtime.jsx)(outputs.aA,{id:`${providerId}-${animationName}`,keyframes:keyframesMap[animationName]},animationName)))};const components_AMPAnimations=function AMPAnimations(){const{state:{providerId,animationTargets},actions:{getAnimationParts}}=components_useStoryAnimationContext();return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:animationTargets.map((target=>[getAnimationParts(target).map((_ref=>{let{id,AMPAnimation}=_ref;return(0,jsx_runtime.jsx)(AMPAnimation,{prefixId:providerId},id)}))])).flat(2)})}},"./packages/animation/src/constants.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Gx:()=>ANIMATION_EFFECTS,fo:()=>BG_MAX_SCALE,nF:()=>BG_MIN_SCALE,nK:()=>SCALE_DIRECTIONS,sx:()=>BEZIER,uf:()=>ANIMATION_PARTS,v8:()=>BACKGROUND_ANIMATION_EFFECTS});var _googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/i18n/src/i18n.ts"),_types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/animation/src/types/index.ts");const BEZIER={linear:"linear",in:"ease-in",out:"ease-out",inOut:"ease-in-out",inQuad:"cubic-bezier(0.55, 0.085, 0.68, 0.53)",outQuad:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",inOutQuad:"cubic-bezier(0.455, 0.03, 0.515, 0.955)",inCubic:"cubic-bezier(0.55, 0.055, 0.675, 0.19)",outCubic:"cubic-bezier(0.215, 0.61, 0.355, 1)",inOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1)",inQuart:"cubic-bezier(0.895, 0.03, 0.685, 0.22)",outQuart:"cubic-bezier(0.165, 0.84, 0.44, 1)",inOutQuart:"cubic-bezier(0.77, 0, 0.175, 1)",inQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",outQuint:"cubic-bezier(0.23, 1, 0.32, 1)",inOutQuint:"cubic-bezier(0.86, 0, 0.07, 1)",inSine:"cubic-bezier(0.47, 0, 0.745, 0.715)",outSine:"cubic-bezier(0.39, 0.575, 0.565, 1)",inOutSine:"cubic-bezier(0.445, 0.05, 0.55, 0.95)",inExpo:"cubic-bezier(0.95, 0.05, 0.795, 0.035)",outExpo:"cubic-bezier(0.19, 1, 0.22, 1)",inOutExpo:"cubic-bezier(1, 0, 0, 1)",inCirc:"cubic-bezier(0.6, 0.04, 0.98, 0.335)",outCirc:"cubic-bezier(0.075, 0.82, 0.165, 1)",inOutCirc:"cubic-bezier(0.785, 0.135, 0.15, 0.86)",default:"cubic-bezier(0.4, 0.4, 0.0, 1)"},ANIMATION_EFFECTS={DROP:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectDrop,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Drop","animation effect","web-stories")},FADE_IN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectFadeIn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Fade In","animation effect","web-stories")},FLY_IN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectFlyIn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Fly In","animation effect","web-stories")},PAN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectPan,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Pan","animation effect","web-stories")},PULSE:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectPulse,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Pulse","animation effect","web-stories")},TWIRL_IN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectTwirlIn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Twirl In","animation effect","web-stories")},WHOOSH_IN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectWhooshIn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Whoosh In","animation effect","web-stories")},ZOOM:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectZoom,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Scale","animation effect","web-stories")},ROTATE_IN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectRotateIn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Rotate In","animation effect","web-stories")}},BACKGROUND_ANIMATION_EFFECTS={ZOOM:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectBackgroundZoom,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Zoom","animation effect","web-stories")},PAN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectBackgroundPan,name:ANIMATION_EFFECTS.PAN.name},PAN_AND_ZOOM:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.EffectBackgroundPanAndZoom,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Pan and Zoom","animation effect","web-stories")}},ANIMATION_PARTS={BLINK_ON:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.BlinkOn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Blink On","animation effect","web-stories")},BOUNCE:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Bounce,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Bounce","animation effect","web-stories")},FADE:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Fade,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Fade","animation effect","web-stories")},FLIP:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Flip,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Flip","animation effect","web-stories")},FLOAT_ON:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.FloatOn,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Float On","animation effect","web-stories")},MOVE:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Move,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Move","animation effect","web-stories")},PULSE:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Pulse,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Pulse","animation effect","web-stories")},SPIN:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Spin,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Spin","animation effect","web-stories")},ZOOM:{value:_types__WEBPACK_IMPORTED_MODULE_0__.ru.Zoom,name:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_1__._x)("Zoom","animation effect","web-stories")}},SCALE_DIRECTIONS={IN:[_types__WEBPACK_IMPORTED_MODULE_0__.bQ.ScaleInTopLeft,_types__WEBPACK_IMPORTED_MODULE_0__.bQ.ScaleInBottomRight],OUT:[_types__WEBPACK_IMPORTED_MODULE_0__.bQ.ScaleOutTopRight,_types__WEBPACK_IMPORTED_MODULE_0__.bQ.ScaleOutBottomLeft]},BG_MIN_SCALE=100,BG_MAX_SCALE=400},"./packages/animation/src/outputs/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Yq:()=>animationOutput,aA:()=>keyframesOutput,Oz:()=>output});__webpack_require__("./node_modules/react/index.js");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function AnimationOutput(_ref){let{config}=_ref;const configs=Array.isArray(config)?config:[config];return(0,jsx_runtime.jsx)("amp-story-animation",{layout:"nodisplay",trigger:"visibility",children:(0,jsx_runtime.jsx)("script",{type:"application/json",dangerouslySetInnerHTML:{__html:JSON.stringify(configs.map((_ref2=>{let{selector,animation,keyframes,delay,direction,duration,easing,endDelay,fill,iterationStart,iterations}=_ref2;return{selector,animation,keyframes,delay,direction,duration,easing,endDelay,fill,iterationStart,iterations}})))}})})}AnimationOutput.displayName="AnimationOutput";const animationOutput=AnimationOutput;function KeyframesOutput(_ref){let{id,keyframes,...options}=_ref;return(0,jsx_runtime.jsx)("amp-animation",{id,layout:"nodisplay",children:(0,jsx_runtime.jsx)("script",{type:"application/json",dangerouslySetInnerHTML:{__html:JSON.stringify({keyframes,...options})}})})}KeyframesOutput.displayName="KeyframesOutput";const keyframesOutput=KeyframesOutput;const output=function WithAnimation(_ref){let{id,className,style,animationStyle,useClippingContainer,children}=_ref;return useClippingContainer?(0,jsx_runtime.jsx)("div",{style:{clipPath:"inset(0)",...style},children:(0,jsx_runtime.jsx)("div",{id,className,style:{width:"100%",height:"100%",...animationStyle},children})}):(0,jsx_runtime.jsx)("div",{id,className,style:{...style,...animationStyle},children})}},"./packages/animation/src/parts/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Af:()=>parts_createAnimationPart,D9:()=>getAnimationEffectDefaults,Fh:()=>getAnimationEffectFields});var constants=__webpack_require__("./packages/animation/src/constants.ts"),types=__webpack_require__("./packages/animation/src/types/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),v4=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./packages/animation/node_modules/uuid/dist/esm-browser/v4.js")),outputs=__webpack_require__("./packages/animation/src/outputs/index.ts");const ALLOWLIST=["opacity","transform"];const utils_getInitialStyleFromKeyframes=function getInitialStyleFromKeyframes(keyframes){const initialStyle={};let frame=null;return Array.isArray(keyframes)?frame=keyframes[0]:"object"==typeof keyframes&&(frame=keyframes),frame?(initialStyle["--initial-opacity"]=1,initialStyle["--initial-transform"]="none",Object.entries(frame).forEach((_ref=>{let[key,value]=_ref;ALLOWLIST.includes(key.toLowerCase())&&(Array.isArray(value)?initialStyle[`--initial-${key}`]=value[0]:initialStyle[`--initial-${key}`]=value)})),initialStyle):initialStyle};const utils_sanitizeTimings=function sanitizeTimings(_ref){let{easing,duration,delay,...rest}=_ref;return{easing:easing||"linear",duration:"number"==typeof duration?Math.max(duration,0):0,delay:"number"==typeof delay?Math.max(delay,0):0,...rest}};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const parts_createAnimation=function createAnimation(keyframes,timings){let useClippingContainer=arguments.length>2&&void 0!==arguments[2]&&arguments[2],targetLeafElement=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const id=`anim-${(0,v4.Z)()}`,WAAPIAnimation={timings:utils_sanitizeTimings(timings),keyframes,targetLeafElement,useClippingContainer},animationStyle=targetLeafElement?{}:utils_getInitialStyleFromKeyframes(keyframes),selector=targetLeafElement?`#${id} [data-leaf-element="true"]`:`#${id}`;return{id,keyframes,generatedKeyframes:{[id]:keyframes},WAAPIAnimation,AMPTarget:function(_ref){let{children,style={}}=_ref;return(0,jsx_runtime.jsx)(outputs.Oz,{id,className:"animation-wrapper",useClippingContainer,style,animationStyle,children})},AMPAnimation:function(){return(0,jsx_runtime.jsx)(outputs.Yq,{config:{selector,keyframes,...timings}})}}};var utils=__webpack_require__("./packages/animation/src/utils/index.ts");function getDropKeyframes(element){const minTop=function getMinTopOffset(element){return(0,utils.d)({...element,y:160}).offsetTop}(element),{offsetTop}=(0,utils.d)(element),global=(0,utils.Gp)(element),maxBounceHeight=-Math.max(Math.abs(minTop),Math.abs(offsetTop));return[{offset:0,transform:global`translate3d(0, ${maxBounceHeight}%, 0)`,easing:"cubic-bezier(.5, 0, 1, 1)"},{offset:.29,transform:global`translate3d(0, 0%, 0)`,easing:"cubic-bezier(0, 0, .5, 1)"},{offset:.45,transform:global`translate3d(0, ${.2812*maxBounceHeight}%, 0)`,easing:"cubic-bezier(.5, 0, 1, 1)"},{offset:.61,transform:global`translate3d(0, 0%, 0)`,easing:"cubic-bezier(0, 0, .5, 1)"},{offset:.71,transform:global`translate3d(0, ${.0956*maxBounceHeight}%, 0)`,easing:"cubic-bezier(.5, 0, 1, 1)"},{offset:.8,transform:global`translate3d(0, 0%, 0)`,easing:"cubic-bezier(0, 0, .5, 1)"},{offset:.85,transform:global`translate3d(0, ${.0359*maxBounceHeight}%, 0)`,easing:"cubic-bezier(.5, 0, 1, 1)"},{offset:.92,transform:global`translate3d(0, 0%, 0)`,easing:"cubic-bezier(0, 0, .5, 1)"},{offset:.96,transform:global`translate3d(0, ${.0156*maxBounceHeight}%, 0)`,easing:"cubic-bezier(.5, 0, 1, 1)"},{offset:1,transform:global`translate3d(0, 0%, 0)`,easing:"cubic-bezier(0, 0, .5, 1)"}]}const drop_fields={duration:{tooltip:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:600}},defaults={fill:"both",duration:1e3};function AnimationFade(_ref){let{fadeFrom=0,fadeTo=1,type,...args}=_ref;const timings={...defaults,...args};return parts_createAnimation({opacity:[fadeFrom,fadeTo]},timings)}types.fS.Float,types.fS.Float;const fadeIn_fields={duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:600}},move_defaults={fill:"both",duration:1e3};function AnimationMove(_ref,element){let{overflowHidden=!1,offsetX=0,offsetY=0,type,...args}=_ref;const global=(0,utils.Gp)(element),timings={...move_defaults,...args},keyframes={transform:[global`translate3d(${(0,utils.aA)(offsetX,"px")}, ${(0,utils.aA)(offsetY,"px")}, 0)`,global`translate3d(${(0,utils.aA)(0,"px")}, ${(0,utils.aA)(0,"px")}, 0)`]};return parts_createAnimation(keyframes,timings,overflowHidden)}types.fS.Checkbox,types.fS.Text,types.fS.Text;const flyIn_fields={flyInDir:{label:(0,i18n.__)("Direction","web-stories"),type:types.fS.DirectionPicker,values:[types.sc.TopToBottom,types.sc.BottomToTop,types.sc.LeftToRight,types.sc.RightToLeft],defaultValue:types.sc.BottomToTop},duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:600}};var src_constants=__webpack_require__("./packages/units/src/constants.ts"),dimensions=__webpack_require__("./packages/units/src/dimensions.ts");function EffectPan(_ref2,element){let{panDir=types.sc.RightToLeft,duration=1e3,delay,easing}=_ref2;const timings={fill:"both",duration,delay,easing},scale=function getTargetScale(_ref){let{width,height}=_ref;if(width<src_constants.JN||height<src_constants.gC){const scaleFactor=1.25,widthScale=width<src_constants.JN?src_constants.JN/width:1,heightScale=height<src_constants.gC?src_constants.gC/height:1;return Math.max(widthScale,heightScale)*scaleFactor}return 1}(element),scaledElement={x:element.x,y:element.y,width:element.width*scale,height:element.height*scale,rotationAngle:element.rotationAngle},{x,y,width,height}=(0,dimensions.iz)(scaledElement,100,100),dangerZoneOffset=(0,dimensions.Px)(src_constants.Z5,100),alignTop=-(dangerZoneOffset+y)/height*100,alignRight=(100-(x+width))/width*100,alignLeft=-x/width*100,alignBottom=(100-(y+height)+dangerZoneOffset)/height*100;let startX,startY,endX,endY;switch(panDir){case types.sc.TopToBottom:startX=(alignLeft+alignRight)/2,startY=alignTop,endX=(alignLeft+alignRight)/2,endY=alignBottom;break;case types.sc.BottomToTop:startX=(alignLeft+alignRight)/2,startY=alignBottom,endX=(alignLeft+alignRight)/2,endY=alignTop;break;case types.sc.LeftToRight:startX=alignLeft,startY=alignTop,endX=alignRight,endY=alignTop;break;case types.sc.RightToLeft:default:startX=alignRight,startY=alignTop,endX=alignLeft,endY=alignTop}return parts_createAnimation({transform:[`translate(${startX}%, ${startY}%) scale(${scale})`,`translate(${endX}%, ${endY}%) scale(${scale})`],"transform-origin":"left top"},timings,!1)}const pan_fields={panDir:{label:(0,i18n.__)("Direction","web-stories"),type:types.fS.DirectionPicker,values:[types.sc.TopToBottom,types.sc.BottomToTop,types.sc.LeftToRight,types.sc.RightToLeft],defaultValue:types.sc.BottomToTop}};const pulse_defaults={fill:"both",duration:400};function AnimationPulse(_ref){let{iterations=1,scale=.5,easing="cubic-bezier(0.3, 0.0, 0.0, 1)",type,...args}=_ref;const timings={...pulse_defaults,...args,iterations,easing},keyframes=function generatePulseKeyframes(scale){return{transform:["scale(1)",`scale(${1+scale})`,`scale(${1-scale/10})`,"scale(1)"],offset:[0,.33,.66,1]}}(scale);return parts_createAnimation(keyframes,timings)}const pulse_fields={scale:{label:(0,i18n.__)("Scale","web-stories"),tooltip:"Valid values are greater than or equal to 0",type:types.fS.Float,defaultValue:.5},iterations:{label:(0,i18n._x)("Pulses","number of pulses","web-stories"),type:types.fS.Float,defaultValue:1},duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:1450}},defaultTimings={delay:0,duration:1e3,fill:"both",iterations:1,easing:"cubic-bezier(0.4, 0.4, 0.0, 1)"};const zoom_defaults={fill:"forwards",duration:1e3};function AnimationZoom(_ref){let{zoomFrom=0,zoomTo=1,targetLeafElement=!1,transformOrigin,type,...args}=_ref;const timings={...zoom_defaults,...args},keyframes={transform:[`scale(${zoomFrom})`,`scale(${zoomTo})`]};if(transformOrigin){const originRelativeToCenter={x:50-transformOrigin.horizontal,y:50-transformOrigin.vertical},counterScaleTranslate={x:(zoomFrom-1)*originRelativeToCenter.x,y:(zoomFrom-1)*originRelativeToCenter.y};keyframes.transform=[`translate(${counterScaleTranslate.x}%, ${counterScaleTranslate.y}%) ${keyframes.transform[0]}`,`translate(0%, 0%) ${keyframes.transform[1]}`]}return parts_createAnimation(keyframes,timings,!1,targetLeafElement)}types.fS.Float,types.fS.Float;var getOffPageOffset=__webpack_require__("./packages/animation/src/utils/getOffPageOffset.ts");const whooshIn_fields={whooshInDir:{label:(0,i18n.__)("Direction","web-stories"),type:types.fS.DirectionPicker,values:[types.sc.LeftToRight,types.sc.RightToLeft],defaultValue:types.sc.LeftToRight},duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:600}};var sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts");const effects_zoom_fields={scaleDirection:{label:(0,i18n.__)("Direction","web-stories"),tooltip:(0,sprintf.Z)((0,i18n.__)("Valid values are %1$s or %2$s","web-stories"),"scaleIn","scaleOut"),type:types.fS.DirectionPicker,values:[types.bQ.ScaleIn,types.bQ.ScaleOut],defaultValue:types.bQ.ScaleIn},duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:2e3}},spin_defaults={fill:"forwards",duration:1e3};function AnimationSpin(_ref,element){let{rotation=0,stopAngle=0,type,...args}=_ref;const global=(0,utils.Gp)(element),timings={...spin_defaults,...args},keyframes={transform:[global`rotateZ(${(0,utils.aA)(rotation,"deg")})`,global`rotateZ(${(0,utils.aA)(stopAngle,"deg")})`]};return parts_createAnimation(keyframes,timings)}types.fS.Text,types.fS.Text;const numberOfRotations=1,stopAngle=0;const rotateIn_fields={rotateInDir:{label:(0,i18n.__)("Direction","web-stories"),type:types.fS.DirectionPicker,values:[types.sc.LeftToRight,types.sc.RightToLeft],defaultValue:types.sc.LeftToRight}};var src_range=__webpack_require__("./packages/units/src/range.ts");function EffectBackgroundZoom(_ref,element){let{zoomDirection=types.bQ.ScaleOut,transformOrigin,duration=2e3,delay=0,easing="cubic-bezier(.3,0,.55,1)"}=_ref;if(!(0,types.Sd)(element))throw new Error("Should not happen");const range={MIN:constants.nF/(element.scale||1),MAX:constants.fo/(element.scale||1)},normalizedDelta=(0,src_range.YD)(50,{MIN:0,MAX:constants.fo}),delta=(0,src_range.t7)(normalizedDelta,{MIN:0,MAX:range.MAX}),zoomFrom=1+(zoomDirection===types.bQ.ScaleOut?1:-1)*delta;return AnimationZoom({type:types.ru.Zoom,zoomFrom:(0,src_range.uZ)(zoomFrom,range),zoomTo:1,duration,delay,easing,targetLeafElement:!0,transformOrigin:transformOrigin||(0,utils.Gn)(element&&(0,utils.Qk)(element))})}const backgroundZoom_fields={zoomDirection:{label:(0,i18n.__)("Direction","web-stories"),tooltip:(0,sprintf.Z)((0,i18n.__)("Valid values are %1$s or %2$s","web-stories"),"scaleIn","scaleOut"),type:types.fS.DirectionPicker,values:[types.bQ.ScaleIn,types.bQ.ScaleOut],defaultValue:types.bQ.ScaleOut},duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:2e3}};function EffectBackgroundPan(_ref,element){let{panDir=types.sc.RightToLeft,duration=2e3,easing="cubic-bezier(.3,0,.55,1)",type,...args}=_ref;const timings={fill:"both",duration,easing,...args},offsets=element?(0,utils.Qk)(element):{top:0,right:0,bottom:0,left:0},translate={from:{[types.sc.RightToLeft]:`translate3d(${offsets.left}%, 0, 0)`,[types.sc.LeftToRight]:`translate3d(${offsets.right}%, 0, 0)`,[types.sc.BottomToTop]:`translate3d(0, ${offsets.top}%, 0)`,[types.sc.TopToBottom]:`translate3d(0, ${offsets.bottom}%, 0)`},to:{[types.sc.RightToLeft]:"translate3d(0%, 0, 0)",[types.sc.LeftToRight]:"translate3d(0%, 0, 0)",[types.sc.BottomToTop]:"translate3d(0, 0%, 0)",[types.sc.TopToBottom]:"translate3d(0, 0%, 0)"}},keyframes={transform:[translate.from[panDir],translate.to[panDir]]};return parts_createAnimation(keyframes,timings,!1,!0)}const backgroundPan_fields={panDir:{label:(0,i18n.__)("Direction","web-stories"),tooltip:(0,sprintf.Z)((0,i18n.__)("Valid values are %1$s or %2$s","web-stories"),"scaleIn","scaleOut"),type:types.fS.DirectionPicker,values:[types.sc.TopToBottom,types.sc.BottomToTop,types.sc.LeftToRight,types.sc.RightToLeft],defaultValue:types.sc.RightToLeft},duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:2e3}},backgroundPanAndZoom_defaults={fill:"forwards",duration:2e3,easing:"cubic-bezier(.14,.34,.47,.9)"};const keyframes=[{transform:"scale(0)",offset:0},{transform:"scale(1.27)",offset:.18},{transform:"scale(0.84)",offset:.28},{transform:"scale(0.84)",offset:.29},{transform:"scale(1.1)",offset:.4},{transform:"scale(1.1)",offset:.41},{transform:"scale(0.95)",offset:.52},{transform:"scale(0.95)",offset:.53},{transform:"scale(1.03)",offset:.6},{transform:"scale(1.03)",offset:.61},{transform:"scale(0.98)",offset:.7},{transform:"scale(0.98)",offset:.71},{transform:"scale(1.02)",offset:.8},{transform:"scale(1.02)",offset:.81},{transform:"scale(0.99)",offset:.9},{transform:"scale(0.99)",offset:.91},{transform:"scale(1)",offset:1}],bounce_defaults={fill:"both",duration:1500};const utils_generateLookupMap=function generateLookupMap(values){return values.reduce(((acc,currentValue)=>({...acc,[currentValue]:values.filter((opacity=>opacity!==currentValue))})),{})};const utils_padArray=function padArray(values,padCount){return values.map((val=>Array(padCount).fill(val))).flat()},DEFAULT_BLINKS=10,AVAILABLE_OPACITY=[0,.25,.75,1],blinkOn_defaults={fill:"forwards"};function generateOpacityFrames(){let blinkCount=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DEFAULT_BLINKS;const lookup=utils_generateLookupMap(AVAILABLE_OPACITY);let lastOpacity=null;const opacityFrames=function range(i){return Array(i).fill(0).map(((_v,k)=>k))}(blinkCount-2).map((()=>{const opacities=null!==lastOpacity?lookup[lastOpacity]:AVAILABLE_OPACITY,opacity=opacities[Math.floor(Math.random()*opacities.length)];return lastOpacity=opacity,opacity}));return utils_padArray(opacityFrames,3)}types.fS.Number;const flip_defaults={fill:"both",duration:1e3},keyframesLookup={[types.mi.Clockwise]:{[types.RD.X]:{transform:["rotateX(90deg)","rotateX(0deg)"]},[types.RD.Y]:{transform:["rotateY(90deg)","rotateY(0deg)"]}},[types.mi.CounterClockwise]:{[types.RD.X]:{transform:["rotateX(-90deg)","rotateX(0deg)"]},[types.RD.Y]:{transform:["rotateY(-90deg)","rotateY(0deg)"]}},[types.mi.PingPong]:{[types.RD.X]:{transform:[]},[types.RD.Y]:{transform:[]}}};types.fS.Dropdown,types.RD.X,types.RD.Y,types.RD.Y,types.fS.Dropdown,types.mi.Clockwise,types.mi.CounterClockwise,types.mi.Clockwise;const floatOn_defaults={fill:"both",duration:1e3},floatOn_keyframesLookup={[types.sc.TopToBottom]:{transform:["translateY(-100%)","translateY(0%)"]},[types.sc.BottomToTop]:{transform:["translateY(100%)","translateY(0%)"]},[types.sc.LeftToRight]:{transform:["translateX(-100%)","translateX(0%)"]},[types.sc.RightToLeft]:{transform:["translateX(100%)","translateX(0%)"]}};types.fS.Dropdown,types.sc.TopToBottom,types.sc.BottomToTop,types.sc.LeftToRight,types.sc.RightToLeft,types.sc.BottomToTop;function EmptyAMPTarget(_ref){let{children,...rest}=_ref;return(0,jsx_runtime.jsx)("div",{...rest,children})}EmptyAMPTarget.displayName="EmptyAMPTarget";const parts_emptyAnimationPart=function emptyAnimationPart(){return{id:"-1",keyframes:{},generatedKeyframes:{},WAAPIAnimation:{keyframes:{},timings:{}},AMPTarget:EmptyAMPTarget,AMPAnimation:()=>null}};const parts_createAnimationPart=function createAnimationPart(animationWithPreset,element){const animation=function convertEasingPreset(_ref){let{easingPreset,easing,...rest}=_ref;return{...rest,easing:easing||(easingPreset?constants.sx[easingPreset]:void 0)}}(animationWithPreset);switch(animation.type){case types.ru.BlinkOn:return function AnimationBlinkOn(_ref){let{blinkCount=DEFAULT_BLINKS,type,...args}=_ref;const timings={...blinkOn_defaults,...args},keyframes={opacity:[0,...generateOpacityFrames(blinkCount),1]};return parts_createAnimation(keyframes,timings)}(animation);case types.ru.Bounce:return function AnimationBounce(_ref){let{type,...args}=_ref;const timings={...bounce_defaults,...args};return parts_createAnimation(keyframes,timings)}(animation);case types.ru.Fade:return AnimationFade(animation);case types.ru.Flip:return function AnimationFlip(_ref){let{axis=types.RD.Y,rotation=types.mi.Clockwise,type,...args}=_ref;const timings={...flip_defaults,...args},keyframes=keyframesLookup[rotation][axis];return parts_createAnimation(keyframes,timings)}(animation);case types.ru.FloatOn:return function AnimationFloatOn(_ref){let{floatOnDir=types.sc.BottomToTop,type,...args}=_ref;const timings={...floatOn_defaults,...args},keyframes=floatOn_keyframesLookup[floatOnDir];return parts_createAnimation(keyframes,timings)}(animation);case types.ru.Move:return AnimationMove(animation,element);case types.ru.Pulse:return AnimationPulse(animation);case types.ru.Spin:return AnimationSpin(animation,element);case types.ru.Zoom:return AnimationZoom(animation);case types.ru.EffectDrop:return function EffectDrop(_ref,element){let{fill="both",duration=1600,delay=0}=_ref;const timings={fill,duration,delay},keyframes=getDropKeyframes(element);return parts_createAnimation(keyframes,timings)}(animation,element);case types.ru.EffectFadeIn:return function EffectFadeIn(_ref){let{duration=600,delay=0,easing="cubic-bezier(0.4, 0.4, 0.0, 1)"}=_ref;return AnimationFade({fadeFrom:0,fadeTo:1,duration,delay,easing,type:types.ru.Fade})}(animation);case types.ru.EffectFlyIn:return function EffectFlyIn(_ref,element){let{flyInDir=types.sc.TopToBottom,duration=600,delay=0,easing="cubic-bezier(0.2, 0.6, 0.0, 1)"}=_ref;const id=(0,v4.Z)(),{offsetTop,offsetLeft,offsetRight,offsetBottom}=(0,utils.d)(element),offsetLookup={[types.sc.TopToBottom]:{offsetY:`${offsetTop}%`},[types.sc.BottomToTop]:{offsetY:`${offsetBottom}%`},[types.sc.LeftToRight]:{offsetX:`${offsetLeft}%`},[types.sc.RightToLeft]:{offsetX:`${offsetRight}%`}},fade=AnimationFade({fadeFrom:0,fadeTo:1,duration,delay,easing,type:types.ru.Fade}),move=AnimationMove({...offsetLookup[flyInDir],duration,delay,easing,type:types.ru.Move},element),keyframes={...move.keyframes,...fade.keyframes};return{id,keyframes,WAAPIAnimation:{...move.WAAPIAnimation,keyframes},AMPTarget:function AMPTarget(_ref2){let{children,style}=_ref2;return(0,jsx_runtime.jsx)(fade.AMPTarget,{style,children:(0,jsx_runtime.jsx)(move.AMPTarget,{style,children})})},AMPAnimation:function AMPAnimation(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(fade.AMPAnimation,{}),(0,jsx_runtime.jsx)(move.AMPAnimation,{})]})},generatedKeyframes:{...fade.generatedKeyframes,...move.generatedKeyframes}}}(animation,element);case types.ru.EffectPan:return EffectPan(animation,element);case types.ru.EffectPulse:return function EffectPulse(_ref){let{iterations=1,scale=.5,duration=1450,delay,easing="ease-in-out"}=_ref;return AnimationPulse({scale,duration,delay,easing,iterations,type:types.ru.Pulse})}(animation);case types.ru.EffectRotateIn:return function EffectRotateIn(_ref,element){let{rotateInDir=types.sc.LeftToRight,duration=1e3,easing="cubic-bezier(.2, 0, .8, 1)",delay}=_ref;const id=(0,v4.Z)(),{offsetLeft,offsetRight}=(0,utils.d)(element),move=AnimationMove({offsetX:rotateInDir===types.sc.RightToLeft?`${offsetRight}%`:`${offsetLeft}%`,duration,delay,easing,type:types.ru.Move},element),spin=AnimationSpin({rotation:""+180*(rotateInDir===types.sc.LeftToRight?-1:1)*numberOfRotations,stopAngle,duration,delay,easing:"cubic-bezier(.2, 0, .5, 1)",type:types.ru.Spin},element),[moveTransformStart,moveTransformEnd]=move.keyframes.transform,[spinTransformStart,spinTransformEnd]=spin.keyframes.transform,keyframes={transform:[`${moveTransformStart} ${spinTransformStart}`,`${moveTransformEnd} ${spinTransformEnd}`]};return{id,keyframes,WAAPIAnimation:{...spin.WAAPIAnimation,keyframes},AMPTarget:function AMPTarget(_ref2){let{children,style}=_ref2;return(0,jsx_runtime.jsx)(move.AMPTarget,{style,children:(0,jsx_runtime.jsx)(spin.AMPTarget,{style,children})})},AMPAnimation:function AMPAnimation(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(move.AMPAnimation,{}),(0,jsx_runtime.jsx)(spin.AMPAnimation,{})]})},generatedKeyframes:{...move.generatedKeyframes,...spin.generatedKeyframes}}}(animation,element);case types.ru.EffectTwirlIn:return function EffectTwirlIn(_ref,element){let{type,...args}=_ref;const keyframes={transform:[(0,utils.Gp)(element)`rotate(-540deg) scale(0.1)`,"none"],opacity:[0,1]},timings={...defaultTimings,...args};return parts_createAnimation(keyframes,timings)}(animation,element);case types.ru.EffectWhooshIn:return function EffectWhooshIn(_ref,element){let{whooshInDir=types.sc.LeftToRight,duration=600,easing="cubic-bezier(0.4, 0.4, 0.0, 1)",delay}=_ref;const id=(0,v4.Z)(),{offsetLeft,offsetRight}=(0,getOffPageOffset.Z)(element),move=AnimationMove({offsetX:whooshInDir===types.sc.RightToLeft?`${offsetRight}%`:`${offsetLeft}%`,duration,delay,easing,type:types.ru.Move},element),fade=AnimationFade({fadeFrom:0,fadeTo:1,duration,delay,easing,type:types.ru.Fade}),zoom=AnimationZoom({zoomFrom:.15,zoomTo:1,duration,delay,easing,type:types.ru.Zoom}),[moveTransformStart,moveTransformEnd]=move.keyframes.transform,[zoomTransformStart,zoomTransformEnd]=zoom.keyframes.transform,keyframes={transform:[`${moveTransformStart} ${zoomTransformStart}`,`${moveTransformEnd} ${zoomTransformEnd}`],opacity:fade.keyframes.opacity};return{id,keyframes,WAAPIAnimation:{...zoom.WAAPIAnimation,keyframes},AMPTarget:function AMPTarget(_ref2){let{children,style}=_ref2;return(0,jsx_runtime.jsx)(move.AMPTarget,{style,children:(0,jsx_runtime.jsx)(fade.AMPTarget,{style,children:(0,jsx_runtime.jsx)(zoom.AMPTarget,{style,children})})})},AMPAnimation:function AMPAnimation(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(move.AMPAnimation,{}),(0,jsx_runtime.jsx)(fade.AMPAnimation,{}),(0,jsx_runtime.jsx)(zoom.AMPAnimation,{})]})},generatedKeyframes:{...move.generatedKeyframes,...fade.generatedKeyframes,...zoom.generatedKeyframes}}}(animation,element);case types.ru.EffectZoom:return function EffectZoom(_ref){let{scaleDirection=types.bQ.ScaleIn,duration=1e3,delay=0,easing="cubic-bezier(.3,0,.55,1)"}=_ref;const id=(0,v4.Z)(),zoom=AnimationZoom({zoomFrom:scaleDirection===types.bQ.ScaleOut?3:1/3,zoomTo:1,duration,delay,easing,type:types.ru.Zoom}),fade=AnimationFade({fadeFrom:scaleDirection===types.bQ.ScaleOut?1:0,fadeTo:1,duration,delay,easing,type:types.ru.Fade}),keyframes={transform:zoom.keyframes.transform,opacity:fade.keyframes.opacity};return{id,keyframes,WAAPIAnimation:{...zoom.WAAPIAnimation,keyframes},AMPTarget:function AMPTarget(_ref2){let{children,style}=_ref2;return(0,jsx_runtime.jsx)(fade.AMPTarget,{style,children:(0,jsx_runtime.jsx)(zoom.AMPTarget,{style,children})})},AMPAnimation:function AMPAnimation(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(fade.AMPAnimation,{}),(0,jsx_runtime.jsx)(zoom.AMPAnimation,{})]})},generatedKeyframes:{...fade.generatedKeyframes,...zoom.generatedKeyframes}}}(animation);case types.ru.EffectBackgroundPan:return EffectBackgroundPan(animation,element);case types.ru.EffectBackgroundPanAndZoom:return function EffectBackgroundPanAndZoom(_ref,element){let{zoomDirection=types.bQ.ScaleIn,panDir=types.sc.RightToLeft,type,...args}=_ref;const timings={...backgroundPanAndZoom_defaults,...args},origin=(0,utils.Gn)(element&&(0,utils.Qk)(element)),bgZoom=EffectBackgroundZoom({zoomDirection,transformOrigin:{[types.sc.RightToLeft]:{horizontal:0,vertical:origin.vertical},[types.sc.LeftToRight]:{horizontal:100,vertical:origin.vertical},[types.sc.BottomToTop]:{horizontal:origin.horizontal,vertical:0},[types.sc.TopToBottom]:{horizontal:origin.horizontal,vertical:100}}[panDir]||[],type:types.ru.EffectBackgroundZoom,...args},element),bgPan=EffectBackgroundPan({panDir,type:types.ru.EffectBackgroundPan,...args},element),startTransform=`${bgPan.keyframes.transform[0]} ${bgZoom.keyframes.transform[0]}`,zoomLastTransformIndex=(bgZoom.keyframes.transform.length||1)-1,panLastTransformIndex=(bgPan.keyframes.transform.length||1)-1,endTransform=`${bgPan.keyframes.transform[zoomLastTransformIndex]} ${bgZoom.keyframes.transform[panLastTransformIndex]}`;return parts_createAnimation({transform:[startTransform,endTransform]},timings,!1,!0)}(animation,element);case types.ru.EffectBackgroundZoom:return EffectBackgroundZoom(animation,element);default:return parts_emptyAnimationPart()}},utils_getDefaultFieldValue=fieldType=>{switch(fieldType){case types.fS.Checkbox:return!1;case types.fS.Number:case types.fS.Float:case types.fS.Range:return 0;default:return""}},basicAnimationFields={duration:{label:(0,i18n.__)("Duration","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:1e3},delay:{label:(0,i18n.__)("Delay","web-stories"),type:types.fS.Number,unit:(0,i18n._x)("ms","Time in milliseconds","web-stories"),defaultValue:0}};types.fS.Hidden,(0,i18n.__)("Animation Type","web-stories"),types.fS.Dropdown,types.z_,types.fS.Dropdown,(0,i18n.__)("Easing Presets","web-stories"),types.fS.Dropdown,Object.keys(constants.sx),Object.keys(constants.sx)[0],types.fS.Text,types.fS.Dropdown,(0,i18n.__)('Valid values are numerical or the word "infinity"',"web-stories"),types.fS.Text;function getAnimationEffectFields(type){const customFieldsByType={[types.ru.EffectFadeIn]:fadeIn_fields,[types.ru.EffectFlyIn]:flyIn_fields,[types.ru.EffectPan]:pan_fields,[types.ru.EffectPulse]:pulse_fields,[types.ru.EffectWhooshIn]:whooshIn_fields,[types.ru.EffectZoom]:effects_zoom_fields,[types.ru.EffectDrop]:drop_fields,[types.ru.EffectRotateIn]:rotateIn_fields,[types.ru.EffectBackgroundZoom]:backgroundZoom_fields,[types.ru.EffectBackgroundPan]:backgroundPan_fields,[types.ru.EffectBackgroundPanAndZoom]:backgroundPan_fields},customFields=type&&customFieldsByType[type]||{},allFields={...basicAnimationFields,...customFields},allFieldsOrder={...customFields,...basicAnimationFields};let fieldOrder=Object.keys(allFieldsOrder);type===types.ru.EffectBackgroundPanAndZoom&&fieldOrder.includes("zoomDirection")&&(fieldOrder=fieldOrder.filter((field=>"zoomDirection"!==field)).concat(["zoomDirection"]));return(0,utils.dW)(allFields,fieldOrder)}function getAnimationEffectDefaults(type){const fields=getAnimationEffectFields(type);return Object.fromEntries(Object.entries(fields).map((_ref=>{let[key,value]=_ref;return[key,value.defaultValue??utils_getDefaultFieldValue(value.type)]})))}},"./packages/animation/src/types/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{sc:()=>AnimationDirection,ic:()=>AnimationProps,ru:()=>AnimationType,RD:()=>Axis,fS:()=>FieldType,z_:()=>NonBackgroundAnimationType,mi:()=>Rotation,bQ:()=>ScaleDirection,pG:()=>StoryAnimationState,Sd:()=>isScaledElement});let AnimationType=function(AnimationType){return AnimationType.BlinkOn="blinkOn",AnimationType.Bounce="bounce",AnimationType.Fade="fade",AnimationType.Flip="flip",AnimationType.FloatOn="floatOn",AnimationType.Move="move",AnimationType.Pulse="pulse",AnimationType.Spin="spin",AnimationType.Zoom="zoom",AnimationType.EffectDrop="effect-drop",AnimationType.EffectFadeIn="effect-fade-in",AnimationType.EffectFlyIn="effect-fly-in",AnimationType.EffectPan="effect-pan",AnimationType.EffectPulse="effect-pulse",AnimationType.EffectRotateIn="effect-rotate-in",AnimationType.EffectTwirlIn="effect-twirl-in",AnimationType.EffectWhooshIn="effect-whoosh-in",AnimationType.EffectZoom="effect-zoom",AnimationType.EffectBackgroundPan="effect-background-pan",AnimationType.EffectBackgroundPanAndZoom="effect-background-pan-and-zoom",AnimationType.EffectBackgroundZoom="effect-background-zoom",AnimationType}({});const{EffectBackgroundPan,EffectBackgroundPanAndZoom,EffectBackgroundZoom,...NonBackgroundAnimationType}={...AnimationType};let AnimationDirection=function(AnimationDirection){return AnimationDirection.LeftToRight="leftToRight",AnimationDirection.TopToBottom="topToBottom",AnimationDirection.RightToLeft="rightToLeft",AnimationDirection.BottomToTop="bottomToTop",AnimationDirection}({}),StoryAnimationState=function(StoryAnimationState){return StoryAnimationState.Reset="reset",StoryAnimationState.Paused="paused",StoryAnimationState.Scrubbing="scrubbing",StoryAnimationState.Playing="playing",StoryAnimationState.PlayingSelected="playing-selected",StoryAnimationState}({}),ScaleDirection=function(ScaleDirection){return ScaleDirection.DynamicPropertyValue="dynamicPropertyValue",ScaleDirection.ScaleIn="scaleIn",ScaleDirection.ScaleOut="scaleOut",ScaleDirection.ScaleOutTopRight="scaleOutTopRight",ScaleDirection.ScaleOutBottomLeft="scaleOutBottomLeft",ScaleDirection.ScaleInTopLeft="scaleInTopLeft",ScaleDirection.ScaleInBottomRight="scaleInBottomRight",ScaleDirection}({}),Rotation=function(Rotation){return Rotation.Clockwise="clockwise",Rotation.CounterClockwise="counterClockwise",Rotation.PingPong="pingPong",Rotation}({}),Axis=function(Axis){return Axis.X="x",Axis.Y="y",Axis}({}),FieldType=function(FieldType){return FieldType.Dropdown="dropdown",FieldType.Hidden="hidden",FieldType.RotationPicker="rotation_picker",FieldType.DirectionPicker="direction_picker",FieldType.Number="number",FieldType.Float="float",FieldType.Text="text",FieldType.Checkbox="checkbox",FieldType.Range="range",FieldType}({});function isScaledElement(e){return"scale"in e}var prop_types=__webpack_require__("./node_modules/prop-types/index.js");prop_types.object;const GeneralAnimationPropTypes={delay:prop_types.number,direction:prop_types.oneOf(["normal","reverse","alternate","alternate-reverse"]),duration:prop_types.number,easing:prop_types.string,easingPreset:prop_types.string,endDelay:prop_types.number,fill:prop_types.oneOf(["backwards","forwards","both","none"]),iterationStart:prop_types.number,iterations:prop_types.oneOfType([prop_types.number,prop_types.oneOf(["infinity",""])])},AnimationProps={id:prop_types.string.isRequired,type:prop_types.oneOf([...Object.values(AnimationType)]),targets:prop_types.arrayOf(prop_types.string),...GeneralAnimationPropTypes}},"./packages/animation/src/utils/getOffPageOffset.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _googleforcreators_units__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/units/src/dimensions.ts"),_googleforcreators_units__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/units/src/constants.ts");function calcTopOffset(box,dangerZoneOffset){const{y,height}=box;return-Number((dangerZoneOffset+y)/height*100+100).toFixed(5)}function calcBottomOffset(box,dangerZoneOffset){const{y,height}=box;return Number((100-y+dangerZoneOffset)/height*100).toFixed(5)}function calcLeftOffset(box){const{x,width}=box;return-Number(x/width*100+100).toFixed(5)}function calcRightOffset(box){const{x,width}=box;return Number((100-x)/width*100).toFixed(5)}const __WEBPACK_DEFAULT_EXPORT__=function getOffPageOffset(element){const box=(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_0__.iz)(element,100,100),dangerZoneOffset=(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_0__.Px)(_googleforcreators_units__WEBPACK_IMPORTED_MODULE_1__.Z5,100);return{offsetTop:calcTopOffset(box,dangerZoneOffset),offsetBottom:calcBottomOffset(box,dangerZoneOffset),offsetLeft:calcLeftOffset(box),offsetRight:calcRightOffset(box)}}},"./packages/animation/src/utils/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ro:()=>DEFAULT_HAS_OFFSETS,aA:()=>defaultUnit,Qk:()=>getElementOffsets,Gn:()=>getElementOrigin,Gp:()=>getGlobalSpace,xY:()=>getHasElementOffsets,d:()=>getOffPageOffset.Z,Wk:()=>getTotalDuration,dW:()=>orderByKeys});const defaultUnit=(input,unit)=>/\d$/.test(String(input))?`${input}${unit}`:input;function literal(strings){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return strings.reduce(((accum,str,i)=>accum.concat([str,args[i]])),[]).join("")}function getGlobalSpace(){let element=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const angle=element?.rotationAngle||0;return 0!==angle?function global(strings){for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];return`rotate(${-1*angle}deg) ${literal(strings,...args)} rotate(${angle}deg)`}:literal}var getOffPageOffset=__webpack_require__("./packages/animation/src/utils/getOffPageOffset.ts");function getTotalDuration(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((total,_ref)=>{let{duration=0,delay=0}=_ref;return Math.max(total,duration+delay)}),0)}function orderByKeys(){let obj=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},keys=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const entries=Object.entries(obj),pos=s=>keys.includes(s)?keys.indexOf(s):Number.MAX_SAFE_INTEGER;return entries.sort(((_ref,_ref2)=>{let[a]=_ref,[b]=_ref2;return pos(a)-pos(b)})),Object.fromEntries(entries)}var getMediaSizePositionProps=__webpack_require__("./packages/media/src/getMediaSizePositionProps.ts"),dimensions=__webpack_require__("./packages/units/src/dimensions.ts"),constants=__webpack_require__("./packages/units/src/constants.ts");const PRECISION=1;function getElementOffsets(element){if(!function isMediaElement(e){return"resource"in e}(element))return{top:0,bottom:0,left:0,right:0};const box=(0,dimensions.iz)(element,constants.JN,constants.r_),media=(0,getMediaSizePositionProps.Z)(element.resource,box.width,box.height,element.scale??1,element.focalX??50,element.focalY??50);return{top:media.offsetY/media.height*100,right:(media.width-(media.offsetX+constants.JN))/media.width*-1*100,left:media.offsetX/media.width*100,bottom:(media.height-(media.offsetY+constants.gC))/media.height*-1*100}}const DEFAULT_HAS_OFFSETS={top:!1,bottom:!1,left:!1,right:!1};function getHasElementOffsets(element){const offsets=getElementOffsets(element);return Object.fromEntries(Object.entries(offsets).map((_ref=>{let[key,offset]=_ref;return[key,Math.abs(offset)>PRECISION]})))}function getElementOrigin(){let offsets=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{top:0,right:0,bottom:0,left:0};const progress={vertical:50,horizontal:50},absOffsets=Object.fromEntries(Object.entries(offsets).map((_ref2=>{let[key,val]=_ref2;return[key,Math.abs(val)]}))),isSignificant=val=>val>=.01;return[absOffsets.top,absOffsets.bottom].some(isSignificant)&&(progress.vertical=100*absOffsets.top/(absOffsets.top+absOffsets.bottom)),[absOffsets.left,absOffsets.right].some(isSignificant)&&(progress.horizontal=100*absOffsets.left/(absOffsets.left+absOffsets.right)),progress}},"./packages/media/src/getMediaSizePositionProps.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function getMediaSizePositionProps(resource,width,height){let scale=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,focalX=arguments.length>4?arguments[4]:void 0,focalY=arguments.length>5?arguments[5]:void 0;const ratio=width/height,oRatio=resource.width&&resource.height?resource.width/resource.height:1;scale=Math.max(scale||100,100),focalX="number"==typeof focalX?focalX:50,focalY="number"==typeof focalY?focalY:50;const mediaWidth=(oRatio<=ratio?width:height*oRatio)*scale*.01,mediaHeight=(oRatio<=ratio?width/oRatio:height)*scale*.01;return{width:mediaWidth,height:mediaHeight,offsetX:Math.max(0,Math.min(mediaWidth*focalX*.01-.5*width,mediaWidth-width)),offsetY:Math.max(0,Math.min(mediaHeight*focalY*.01-.5*height,mediaHeight-height)),scale,focalX,focalY}}},"./packages/units/src/calcRotatedResizeOffset.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function calcRotatedResizeOffset(degree,left,right,top,bottom){const rad=degree*Math.PI/180,cos=Math.cos(rad),sin=Math.sin(rad);return[((right-left)*cos+(top-bottom)*sin)/2-(right+left)/2,((bottom-top)*cos+(right-left)*sin)/2-(bottom+top)/2]}},"./packages/units/src/constants.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{JN:()=>PAGE_WIDTH,O1:()=>PAGE_RATIO,Sr:()=>FULLBLEED_RATIO,TG:()=>DEFAULT_EM,Z5:()=>DANGER_ZONE_HEIGHT,gC:()=>FULLBLEED_HEIGHT,r_:()=>PAGE_HEIGHT,wr:()=>DEFAULT_DPR});const PAGE_RATIO=2/3,PAGE_WIDTH=412,PAGE_HEIGHT=618,FULLBLEED_RATIO=9/16,FULLBLEED_HEIGHT=PAGE_WIDTH/FULLBLEED_RATIO,DANGER_ZONE_HEIGHT=(FULLBLEED_HEIGHT-PAGE_HEIGHT)/2,DEFAULT_EM=.02186*PAGE_HEIGHT,DEFAULT_DPR=.5},"./packages/units/src/dimensions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Gy:()=>getBoxWithBorder,Kf:()=>editorToDataX,Og:()=>editorToDataY,Px:()=>dataToEditorY,RM:()=>dataPixels,Sc:()=>dataToFontSizeY,Zq:()=>dataToEditorX,dA:()=>dataFontEm,iz:()=>getBox,v7:()=>editorPixels});var _calcRotatedResizeOffset__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/units/src/calcRotatedResizeOffset.ts"),_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/units/src/constants.ts");function dataPixels(v){return Number(v.toFixed(0))}function dataFontEm(v){return Number((v*_constants__WEBPACK_IMPORTED_MODULE_0__.TG).toFixed(1))}function editorPixels(v){return Number(v.toFixed(5))}function dataToEditorX(x,pageWidth){return editorPixels(x*pageWidth/_constants__WEBPACK_IMPORTED_MODULE_0__.JN)}function dataToEditorY(y,pageHeight){return editorPixels(y*pageHeight/_constants__WEBPACK_IMPORTED_MODULE_0__.r_)}function dataToFontSizeY(v,pageHeight){return(dataToEditorY(v,pageHeight)/10).toFixed(6)}function editorToDataX(x,pageWidth){let withRounding=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const v=x*_constants__WEBPACK_IMPORTED_MODULE_0__.JN/pageWidth;return withRounding?dataPixels(v):v}function editorToDataY(y,pageHeight){let withRounding=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const v=y*_constants__WEBPACK_IMPORTED_MODULE_0__.r_/pageHeight;return withRounding?dataPixels(v):v}function getBox(_ref,pageWidth,pageHeight){let{x,y,width,height,rotationAngle,isBackground}=_ref;return{x:dataToEditorX(isBackground?0:x,pageWidth),y:dataToEditorY(isBackground?-_constants__WEBPACK_IMPORTED_MODULE_0__.Z5:y,pageHeight),width:dataToEditorX(isBackground?_constants__WEBPACK_IMPORTED_MODULE_0__.JN:width,pageWidth),height:dataToEditorY(isBackground?_constants__WEBPACK_IMPORTED_MODULE_0__.gC:height,pageHeight),rotationAngle:isBackground?0:rotationAngle}}function getBoxWithBorder(element,pageWidth,pageHeight){const{rotationAngle,border}=element,box=getBox(element,pageWidth,pageHeight);if(!border)return box;const{left=0,right=0,top=0,bottom=0}=border,[diffX,diffY]=(0,_calcRotatedResizeOffset__WEBPACK_IMPORTED_MODULE_1__.Z)(rotationAngle,left,right,top,bottom);return{...box,x:box.x+diffX,y:box.y+diffY,width:box.width+left+right,height:box.height+top+bottom}}},"./packages/units/src/range.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{YD:()=>progress,t7:()=>lerp,uZ:()=>clamp});const lerp=(progress,range)=>(1-progress)*range.MIN+progress*range.MAX,progress=(v,range)=>{const delta=clamp(v,range)-range.MIN,difference=range.MAX-range.MIN;return Math.abs(delta/difference)},clamp=(value,_ref)=>{let{MIN,MAX}=_ref;return Math.min(Math.max(value,MIN),MAX)}}}]);