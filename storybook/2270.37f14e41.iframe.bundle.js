"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[2270],{"./packages/dashboard/src/app/views/myStories/header/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>header});var react=__webpack_require__("./node_modules/react/index.js"),dist=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js"),__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js")),src=__webpack_require__("./packages/react/src/index.ts"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),constants=__webpack_require__("./packages/dashboard/src/constants/index.ts"),propTypes=__webpack_require__("./packages/dashboard/src/propTypes.js"),useStoryView=__webpack_require__("./packages/dashboard/src/utils/useStoryView.js"),utils=__webpack_require__("./packages/dashboard/src/utils/index.js"),shared=__webpack_require__("./packages/dashboard/src/app/views/shared/index.js"),views_utils=__webpack_require__("./packages/dashboard/src/app/views/utils/index.js"),useStoryFilters=__webpack_require__("./packages/dashboard/src/app/views/myStories/filters/useStoryFilters.js"),pill=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/design-system/src/components/pill/pill.tsx")),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts");const StyledPill=(0,__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js").Ay)(pill.A).withConfig({displayName:"storyStatusToggle__StyledPill",componentId:"sc-141pqd7-0"})(["margin:0 2px;white-space:nowrap;& > span{padding-left:8px;color:",";}"],(({theme,isActive})=>isActive?theme.colors.gray[20]:theme.colors.fg.tertiary));function _temp(t0){const{actions:t1}=t0,{updateFilter,registerFilters}=t1;return{updateFilter,registerFilters}}const storyStatusToggle=function StoryStatusToggle(t0){const $=(0,dist.c)(20),{initialPageReady,totalStoriesByStatus,currentStatus}=t0,{updateFilter:updateFilter_0,registerFilters:registerFilters_0}=(0,useStoryFilters.A)(_temp);let t1,t2;$[0]!==updateFilter_0?(t1=value=>{updateFilter_0("status",{filterId:value})},t2=[updateFilter_0],$[0]=updateFilter_0,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const handleStatusChange=(0,src.hb)(t1,t2);let t3,t4,t5,t6;$[3]!==registerFilters_0?(t3=()=>{registerFilters_0([{key:"status",filterId:constants.q9.filters.status}])},t4=[registerFilters_0],$[3]=registerFilters_0,$[4]=t3,$[5]=t4):(t3=$[4],t4=$[5]),(0,src.vJ)(t3,t4),$[6]!==totalStoriesByStatus?(t5=()=>Object.keys(totalStoriesByStatus).reduce(((prev,cur)=>prev+totalStoriesByStatus[cur]),0),t6=[totalStoriesByStatus],$[6]=totalStoriesByStatus,$[7]=t5,$[8]=t6):(t5=$[7],t6=$[8]);const totalStories=(0,src.Kr)(t5,t6);let t7,t8;$[9]!==currentStatus||$[10]!==totalStoriesByStatus?(t7=()=>constants.h.filter((t9=>{const{status}=t9;return Boolean(status in totalStoriesByStatus)&&totalStoriesByStatus[status]>0||status===currentStatus})).map((t10=>{const{label,status:status_0,value:value_0}=t10,count=totalStoriesByStatus[status_0],disabled=Boolean(!count);return{ariaLabel:(0,sprintf.A)((0,i18n.__)("Filter stories by %s","web-stories"),label),disabled,isActive:currentStatus===value_0,value:value_0,label,count}})),t8=[totalStoriesByStatus,currentStatus],$[9]=currentStatus,$[10]=totalStoriesByStatus,$[11]=t7,$[12]=t8):(t7=$[11],t8=$[12]);const statuses=(0,src.Kr)(t7,t8);if(!initialPageReady||!totalStories||totalStoriesByStatus&&0===Object.keys(totalStoriesByStatus).length)return null;let t9,t10;if($[13]!==handleStatusChange||$[14]!==statuses){let t10;$[16]!==handleStatusChange?(t10=t11=>{const{ariaLabel:ariaLabel_0,disabled:disabled_0,isActive:isActive_0,value:value_1,label:label_0,count:count_0}=t11;return react.createElement(StyledPill,{key:value_1,onClick:()=>handleStatusChange(value_1),isActive:isActive_0,disabled:disabled_0,"aria-label":ariaLabel_0},label_0,react.createElement("span",null,count_0))},$[16]=handleStatusChange,$[17]=t10):t10=$[17],t9=statuses.map(t10),$[13]=handleStatusChange,$[14]=statuses,$[15]=t9}else t9=$[15];return $[18]!==t9?(t10=react.createElement(react.Fragment,null,t9),$[18]=t9,$[19]=t10):t10=$[19],t10};function Header(t0){const $=(0,dist.c)(45),{initialPageReady,stories,totalStoriesByStatus,view}=t0;let t1,t2;$[0]!==stories?(t1=()=>(0,views_utils.Ds)(stories),t2=[stories],$[0]=stories,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const searchOptions=(0,src.Kr)(t1,t2),{filters:filters_0,sortObject:sortObject_0,updateFilter:updateFilter_0,updateSort:updateSort_0,registerFilters:registerFilters_0}=(0,useStoryFilters.A)(header_temp);let t3,t4;$[3]!==filters_0?(t3=()=>{const status=filters_0.find(_temp2),search=filters_0.find(_temp3);return[filters_0.filter(_temp4),status?.filterId,search?.filterId]},t4=[filters_0],$[3]=filters_0,$[4]=t3,$[5]=t4):(t3=$[4],t4=$[5]);const[dropDownFilters,statusFilterValue,searchFilterValue]=(0,src.Kr)(t3,t4);let t5,t6;$[6]!==statusFilterValue||$[7]!==totalStoriesByStatus?(t5=()=>(statusFilterValue?.split(",")||[]).reduce(((total,filterKey)=>total+=totalStoriesByStatus[filterKey]||0),0),t6=[statusFilterValue,totalStoriesByStatus],$[6]=statusFilterValue,$[7]=totalStoriesByStatus,$[8]=t5,$[9]=t6):(t5=$[8],t6=$[9]);const totalResults=(0,src.Kr)(t5,t6),t7=Boolean(searchFilterValue);let t8;$[10]!==statusFilterValue||$[11]!==t7||$[12]!==totalResults?(t8={currentFilter:statusFilterValue,isActiveSearch:t7,totalResults,view:constants.eZ.DASHBOARD},$[10]=statusFilterValue,$[11]=t7,$[12]=totalResults,$[13]=t8):t8=$[13];const resultsLabel=(0,utils.qM)(t8);let t9;$[14]!==updateFilter_0?(t9=async value=>{await(0,tracking_src.sx)("search",{search_type:"dashboard",search_term:value}),updateFilter_0("search",{filterId:value})},$[14]=updateFilter_0,$[15]=t9):t9=$[15];const debouncedSearchChange=(0,src.YQ)(t9,constants.dQ);let t10,t11,t12,t13;$[16]!==registerFilters_0?(t10=()=>{registerFilters_0([{key:"search"}])},t11=[registerFilters_0],$[16]=registerFilters_0,$[17]=t10,$[18]=t11):(t10=$[17],t11=$[18]),(0,src.vJ)(t10,t11),$[19]!==updateFilter_0?(t12=()=>updateFilter_0("search",{filterId:null}),t13=[updateFilter_0],$[19]=updateFilter_0,$[20]=t12,$[21]=t13):(t12=$[20],t13=$[21]);const clearSearch=(0,src.hb)(t12,t13);let t14,t15,t16,t17,t18,t19;return $[22]===Symbol.for("react.memo_cache_sentinel")?(t14=(0,i18n.__)("Dashboard","web-stories"),t15=(0,i18n.__)("Search Stories","web-stories"),$[22]=t14,$[23]=t15):(t14=$[22],t15=$[23]),$[24]!==initialPageReady||$[25]!==statusFilterValue||$[26]!==totalStoriesByStatus?(t16=react.createElement(storyStatusToggle,{initialPageReady,totalStoriesByStatus,currentStatus:statusFilterValue}),$[24]=initialPageReady,$[25]=statusFilterValue,$[26]=totalStoriesByStatus,$[27]=t16):t16=$[27],$[28]!==clearSearch||$[29]!==debouncedSearchChange||$[30]!==initialPageReady||$[31]!==searchFilterValue||$[32]!==searchOptions||$[33]!==t16?(t17=react.createElement(shared.Av,{heading:t14,searchPlaceholder:t15,searchOptions,handleSearchChange:debouncedSearchChange,showSearch:initialPageReady,searchValue:searchFilterValue,onClear:clearSearch},t16),$[28]=clearSearch,$[29]=debouncedSearchChange,$[30]=initialPageReady,$[31]=searchFilterValue,$[32]=searchOptions,$[33]=t16,$[34]=t17):t17=$[34],$[35]!==dropDownFilters||$[36]!==resultsLabel||$[37]!==sortObject_0||$[38]!==updateSort_0||$[39]!==view.style||$[40]!==view.toggleStyle?(t18=react.createElement(shared.WJ,{showGridToggle:!0,filters:dropDownFilters,showSortDropdown:!0,resultsLabel,layoutStyle:view.style,handleLayoutSelect:view.toggleStyle,pageSortOptions:constants.yA,pageSortDefaultOption:constants._r.LAST_MODIFIED,handleSortChange:updateSort_0,currentSort:sortObject_0}),$[35]=dropDownFilters,$[36]=resultsLabel,$[37]=sortObject_0,$[38]=updateSort_0,$[39]=view.style,$[40]=view.toggleStyle,$[41]=t18):t18=$[41],$[42]!==t17||$[43]!==t18?(t19=react.createElement(react.Fragment,null,t17,t18),$[42]=t17,$[43]=t18,$[44]=t19):t19=$[44],t19}function _temp4(t0){const{key:key_1}=t0;return!["status","search"].includes(key_1)}function _temp3(t0){const{key:key_0}=t0;return"search"===key_0}function _temp2(t0){const{key}=t0;return"status"===key}function header_temp(t0){const{state:t1,actions:t2}=t0,{filters,sortObject}=t1,{updateFilter,updateSort,registerFilters}=t2;return{filters,updateFilter,sortObject,updateSort,registerFilters}}Header.propTypes={initialPageReady:prop_types_default().bool,stories:propTypes.Py,totalStoriesByStatus:propTypes.g3,view:useStoryView.Q8.isRequired};const header=(0,src.ph)(Header)},"./packages/dashboard/src/app/views/utils/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{hB:()=>utils_composeTemplateFilter,Ds:()=>utils_getSearchOptions,mK:()=>utils_getTemplateFilters});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");const utils_getSearchOptions=function getSearchOptions(options){return options.reduce(((acc,option)=>!option.title||option?.title.trim().length<=0?acc:[...acc,{label:option.title,value:option.title}]),[])};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var uniqueEntriesByKey=__webpack_require__("./packages/design-system/src/utils/uniqueEntriesByKey.ts");const TEMPLATE_META_DATA_TYPES_VERTICAL="VERTICAL",TEMPLATE_META_DATA_TYPES_COLOR="COLOR",TEMPLATE_META_DATA_TYPES_TAG="TAG",TEMPLATE_META_DATA_TYPES_TITLE="TITLE";const utils_getTemplateFilters=function getTemplateFilters(templates){const templatesArr=Object.values(templates),colors=templatesArr.flatMap((t=>t.colors)).map((c=>({label:c.family,value:c.family,type:TEMPLATE_META_DATA_TYPES_COLOR}))),tags=templatesArr.flatMap((t=>t.tags)).map((tag=>({label:tag,value:tag,type:TEMPLATE_META_DATA_TYPES_TAG}))),verticals=templatesArr.map((t=>t.vertical)).map((vertical=>({label:vertical,value:vertical,type:TEMPLATE_META_DATA_TYPES_VERTICAL}))),title=templatesArr.map((t=>({label:t.title,value:t.title,type:TEMPLATE_META_DATA_TYPES_TITLE})));return[...(0,uniqueEntriesByKey.A)(tags,"label"),...(0,uniqueEntriesByKey.A)(colors,"label"),...(0,uniqueEntriesByKey.A)(verticals,"label"),...(0,uniqueEntriesByKey.A)(title,"label")]};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");const utils_composeTemplateFilter=function composeTemplateFilter(filters){return template=>!filters||filters.some((filter=>{switch(filter?.type){case TEMPLATE_META_DATA_TYPES_TAG:return template.tags.map((tag=>tag.toLowerCase())).includes(filter.value.toLowerCase());case TEMPLATE_META_DATA_TYPES_COLOR:return template.colors.map((color=>color.label.toLowerCase())).includes(filter.value.toLowerCase());case TEMPLATE_META_DATA_TYPES_VERTICAL:return template.vertical.toLowerCase().includes(filter.value.toLowerCase());case TEMPLATE_META_DATA_TYPES_TITLE:return template.title.toLowerCase().includes(filter.value.toLowerCase());default:return!0}}))}}}]);