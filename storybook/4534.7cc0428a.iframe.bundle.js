"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[4534],{"./packages/dashboard/src/app/api/useApiAlerts.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/design-system/src/contexts/snackbar/useSnackbar.ts"),_useApi__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/dashboard/src/app/api/useApi.js");const __WEBPACK_DEFAULT_EXPORT__=function useApiAlerts(){const{storyError,templateError}=(0,_useApi__WEBPACK_IMPORTED_MODULE_1__.Z)((({state:{stories:{error:storyError},templates:{error:templateError}}})=>({storyError,templateError}))),{showSnackbar}=(0,_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__.D)(),debouncedShowSnackbar=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.y1)((message=>showSnackbar({message,dismissible:!0})),200);(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.d4)((()=>{storyError?.id&&debouncedShowSnackbar(storyError.message)}),[storyError,debouncedShowSnackbar]),(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.d4)((()=>{templateError?.id&&debouncedShowSnackbar(templateError.message)}),[templateError,debouncedShowSnackbar])}},"./packages/dashboard/src/app/views/exploreTemplates/content/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>content});__webpack_require__("./node_modules/react/index.js");var src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),loadingSpinner=__webpack_require__("./packages/design-system/src/components/loadingSpinner/loadingSpinner.tsx"),infiniteScroller=__webpack_require__("./packages/design-system/src/components/infiniteScroller/infiniteScroller.tsx"),headline=__webpack_require__("./packages/design-system/src/components/typography/headline/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),config=__webpack_require__("./packages/dashboard/src/app/config/index.ts"),components=__webpack_require__("./packages/dashboard/src/components/index.js"),shared=(__webpack_require__("./packages/dashboard/src/utils/useTemplateView.js"),__webpack_require__("./packages/dashboard/src/propTypes.js"),__webpack_require__("./packages/dashboard/src/app/views/shared/index.js")),useGridViewKeys=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/design-system/src/components/keyboard/gridview/useGridViewKeys.ts")),utils=__webpack_require__("./packages/dashboard/src/utils/index.js"),noop=__webpack_require__("./packages/design-system/src/utils/noop.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),src_constants=__webpack_require__("./packages/dashboard/src/constants/index.ts"),grid_components=__webpack_require__("./packages/dashboard/src/app/views/shared/grid/components.js");const CardWrapper=styled_components_browser_esm.ZP.div.withConfig({displayName:"content__CardWrapper",componentId:"sc-1ilp1n2-0"})(["position:absolute;height:100%;width:100%;transition:opacity ease-in-out 300ms;&:hover{",",","{opacity:1;}}",",","{opacity:",";}"],grid_components.ph,grid_components.ZM,grid_components.ph,grid_components.ZM,(({$isSelected})=>$isSelected?1:0)),TemplateDisplayContent=styled_components_browser_esm.ZP.div.withConfig({displayName:"content__TemplateDisplayContent",componentId:"sc-1ilp1n2-1"})(["display:flex;flex-direction:column;align-items:center;justify-content:space-between;height:100%;padding-bottom:16px;a,button{margin:auto auto 0;}"]),PicturePoster=(0,styled_components_browser_esm.ZP)(grid_components.Wf).attrs({as:"picture"}).withConfig({displayName:"content__PicturePoster",componentId:"sc-1ilp1n2-2"})(["display:block;& > img{height:100%;width:100%;object-fit:fill;border-radius:",";}"],(({theme})=>theme.borders.radius.medium));var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const SeeDetailsButton=(0,styled_components_browser_esm.ZP)(button_button.z).attrs({type:constants.L$.Tertiary,size:constants.qE.Small}).withConfig({displayName:"templateGridItem__SeeDetailsButton",componentId:"sc-fidkqe-0"})(["background-color:",";"],(({theme})=>theme.colors.standard.white)),TemplateGridItem=(0,src.Gp)((({onCreateStory,onFocus,height,id,isActive,posterSrc,slug,title,status,onSeeDetailsClick=noop.Z},ref)=>{const tabIndex=isActive?0:-1,posterAltText=(0,sprintf.Z)((0,i18n.__)("First page of %s template","web-stories"),title);return(0,jsx_runtime.jsx)(components.DT,{ref,id:`template-grid-item-${id}`,className:"templateGridItem","data-testid":`template-grid-item-${id}`,$posterHeight:height,onFocus,children:(0,jsx_runtime.jsx)(grid_components.W2,{children:(0,jsx_runtime.jsxs)(CardWrapper,{$isSelected:isActive,children:[(0,jsx_runtime.jsxs)(PicturePoster,{children:[(0,jsx_runtime.jsx)("source",{srcSet:posterSrc?.webp,type:"image/webp"}),(0,jsx_runtime.jsx)("source",{srcSet:posterSrc?.png,type:"image/png"}),(0,jsx_runtime.jsx)("img",{src:posterSrc?.png,alt:posterAltText,decoding:"async",width:src_constants.R8,height:src_constants.j$})]}),(0,jsx_runtime.jsx)(grid_components.ph,{}),(0,jsx_runtime.jsx)(grid_components.ZM,{"data-testid":"card-action-container","data-template-slug":slug,children:(0,jsx_runtime.jsxs)(TemplateDisplayContent,{children:[(0,jsx_runtime.jsx)(SeeDetailsButton,{ariaLabel:(0,sprintf.Z)((0,i18n.__)("Go to detail view of %s","web-stories"),title),onClick:()=>onSeeDetailsClick(id,title),className:"focus_template",tabIndex,children:src_constants.c1[status]}),onCreateStory&&(0,jsx_runtime.jsx)(button_button.z,{size:constants.qE.Small,type:constants.L$.Primary,onClick:onCreateStory,tabIndex,ariaLabel:(0,sprintf.Z)((0,i18n.__)("Create new story from %s","web-stories"),title),children:(0,i18n.__)("Use template","web-stories")})]})})]})})})}));TemplateGridItem.displayName="TemplateGridItem";const templateGridItem=TemplateGridItem;function TemplateGridView({pageSize,templates:filteredTemplates,templateActions}){const{isRTL,apiCallbacks}=(0,config.Z)(),containerRef=(0,src.sO)(),gridRef=(0,src.sO)(),itemRefs=(0,src.sO)({}),[activeGridItemId,setActiveGridItemId]=(0,src.eJ)(null),{handleDetailsToggle,createStoryFromTemplate}=templateActions||{},canCreateStory=Boolean(apiCallbacks?.createStoryFromTemplate);(0,useGridViewKeys.Z)({containerRef,gridRef,itemRefs,isRTL,currentItemId:activeGridItemId,items:filteredTemplates}),(0,src.d4)((()=>{activeGridItemId&&itemRefs.current?.[activeGridItemId]?.querySelector(".focus_template")?.focus()}),[activeGridItemId]),(0,src.FR)(containerRef,(()=>setActiveGridItemId(null)),[]);const memoizedTemplateItems=(0,src.Ye)((()=>filteredTemplates.map((({id,slug,status,title,postersByPage})=>{const isActive=activeGridItemId===id,posterSrc=postersByPage?.[0];return(0,jsx_runtime.jsx)(templateGridItem,{onCreateStory:canCreateStory?()=>createStoryFromTemplate(id):utils.ZT,onFocus:()=>{setActiveGridItemId(id)},onSeeDetailsClick:handleDetailsToggle,height:pageSize.height,id,isActive,posterSrc,ref:el=>{itemRefs.current[id]=el},slug,status,title},slug)}))),[filteredTemplates,activeGridItemId,canCreateStory,handleDetailsToggle,pageSize.height,createStoryFromTemplate]);return(0,jsx_runtime.jsx)("div",{ref:containerRef,children:(0,jsx_runtime.jsx)(components.gy,{pageSize,role:"list",ref:gridRef,ariaLabel:(0,i18n.__)("Viewing available templates","web-stories"),children:memoizedTemplateItems})})}TemplateGridView.displayName="TemplateGridView";const templateGridView=TemplateGridView;function Content({allPagesFetched,isLoading,page,templates,view,totalTemplates,search,templateActions}){const{newStoryURL}=(0,config.Z)(),pageContent=(0,src.Ye)((()=>isLoading?(0,jsx_runtime.jsx)(components.ly,{children:(0,jsx_runtime.jsx)(loadingSpinner.Z,{})}):totalTemplates>0?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(templateGridView,{templates,pageSize:view.pageSize,templateActions}),(0,jsx_runtime.jsx)(infiniteScroller.Z,{canLoadMore:!allPagesFetched,isLoading,allDataLoadedMessage:(0,i18n.__)("No more templates","web-stories"),allDataLoadedAriaMessage:(0,i18n.__)("All templates are loaded","web-stories"),loadingAriaMessage:(0,i18n.__)("Loading more templates","web-stories"),onLoadMore:page.requestNextPage})]}):(0,jsx_runtime.jsxs)(shared.Xr,{children:[(0,jsx_runtime.jsx)(headline.s,{size:types.TextSize.Small,as:"h3",children:search?(0,sprintf.Z)((0,i18n.__)('Sorry, we couldn\'t find any results matching "%s"',"web-stories"),search):(0,i18n.__)("No templates currently available.","web-stories")}),!search&&(0,jsx_runtime.jsx)(button_button.i,{type:constants.L$.Primary,size:constants.qE.Medium,href:newStoryURL,children:(0,i18n.__)("Create New Story","web-stories")})]})),[allPagesFetched,isLoading,newStoryURL,page.requestNextPage,templateActions,search,templates,totalTemplates,view.pageSize]);return(0,jsx_runtime.jsx)(components.Ar.Scrollable,{children:(0,jsx_runtime.jsx)(components.wD,{children:pageContent})})}Content.displayName="Content";const content=Content},"./packages/dashboard/src/app/views/exploreTemplates/filters/TemplateFiltersProvider/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>TemplateFiltersProvider,u:()=>filterContext});__webpack_require__("./node_modules/react/index.js");var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/react/src/index.ts"),_constants_templates__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/dashboard/src/constants/templates.ts"),_filters_reducer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/dashboard/src/app/views/filters/reducer.js"),_filters_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/dashboard/src/app/views/filters/types.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const filterContext=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.kr)({state:{},actions:{}}),{filters:defaultTemplateFilters,sort:defaultTemplateSort}=_constants_templates__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_TEMPLATE_FILTERS;function TemplateFiltersProvider({children}){const[state,dispatch]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__._Y)(_filters_reducer__WEBPACK_IMPORTED_MODULE_3__.Z,{filters:[],filtersObject:defaultTemplateFilters,sortObject:defaultTemplateSort}),updateFilter=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.I4)(((key,value)=>{dispatch({type:_filters_types__WEBPACK_IMPORTED_MODULE_5__._u,payload:{key,value}})}),[]),updateSort=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.I4)((values=>{dispatch({type:_filters_types__WEBPACK_IMPORTED_MODULE_5__.uM,payload:{type:"template",values}})}),[]),registerFilters=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.I4)((value=>{dispatch({type:_filters_types__WEBPACK_IMPORTED_MODULE_5__.zf,payload:{value}})}),[]),contextValue=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Ye)((()=>({state,actions:{updateSort,updateFilter,registerFilters}})),[state,updateSort,updateFilter,registerFilters]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(filterContext.Provider,{value:contextValue,children})}TemplateFiltersProvider.displayName="TemplateFiltersProvider"},"./packages/dashboard/src/app/views/exploreTemplates/filters/useTemplateFilters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>useTemplateFilters});var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/react/src/index.ts"),_TemplateFiltersProvider__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/filters/TemplateFiltersProvider/index.js");function useTemplateFilters(selector=_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.yR){return(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.Sz)(_TemplateFiltersProvider__WEBPACK_IMPORTED_MODULE_1__.u,selector)}},"./packages/dashboard/src/app/views/exploreTemplates/header/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js");var _googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/i18n/src/i18n.ts"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/react/src/index.ts"),flagged__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/dashboard/node_modules/flagged/dist/flagged.esm.js"),_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/dashboard/src/constants/index.ts"),_filters_useTemplateFilters__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__("./packages/dashboard/src/utils/useTemplateView.js"),__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/filters/useTemplateFilters.js")),_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/dashboard/src/utils/index.js"),_shared__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/dashboard/src/app/views/shared/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__=function Header({isLoading,totalTemplates,view,searchOptions=[]}){const enableInProgressTemplateActions=(0,flagged__WEBPACK_IMPORTED_MODULE_4__.SS)("enableInProgressTemplateActions"),{filters,sortObject,updateFilter,updateSort,registerFilters}=(0,_filters_useTemplateFilters__WEBPACK_IMPORTED_MODULE_7__.Z)((({state:{filters,sortObject},actions:{updateFilter,updateSort,registerFilters}})=>({filters,sortObject,updateFilter,updateSort,registerFilters}))),[statusFilterValue,searchFilterValue]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.Ye)((()=>{const status=filters.find((({key})=>"status"===key)),search=filters.find((({key})=>"search"===key));return[status?.filterId,search?.filterId]}),[filters]),debouncedSearchChange=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.y1)((value=>{updateFilter("search",{filterId:value})}),_constants__WEBPACK_IMPORTED_MODULE_5__.p$);(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.d4)((()=>{registerFilters([{key:"search"}]),registerFilters([{key:"status",filterId:_constants__WEBPACK_IMPORTED_MODULE_5__.z7.filters.status}])}),[registerFilters]);const clearSearch=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.I4)((()=>updateFilter("search",{filterId:null})),[updateFilter]),resultsLabel=(0,_utils__WEBPACK_IMPORTED_MODULE_8__.Uv)({totalResults:totalTemplates,currentFilter:statusFilterValue,view:_constants__WEBPACK_IMPORTED_MODULE_5__.g3.TEMPLATES_GALLERY});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_shared__WEBPACK_IMPORTED_MODULE_9__.CD,{heading:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_11__.__)("Explore Templates","web-stories"),searchPlaceholder:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_11__.__)("Search Templates","web-stories"),showSearch:!0,searchOptions,searchValue:searchFilterValue,handleSearchChange:debouncedSearchChange,onClear:clearSearch}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_shared__WEBPACK_IMPORTED_MODULE_9__.dA,{resultsLabel,layoutStyle:view.style,handleLayoutSelect:view.toggleStyle,isLoading,pageSortOptions:_constants__WEBPACK_IMPORTED_MODULE_5__.Fd,pageSortDefaultOption:_constants__WEBPACK_IMPORTED_MODULE_5__.Ce.POPULAR,currentSort:sortObject,handleSortChange:updateSort,showSortDropdown:enableInProgressTemplateActions,sortDropdownAriaLabel:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_11__.__)("Choose sort option for display","web-stories")})]})}},"./packages/dashboard/src/app/views/exploreTemplates/modal/templateDetails/content/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>content});__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),chip=__webpack_require__("./packages/design-system/src/components/chip/chip.tsx"),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),arrow_left_large=__webpack_require__("./packages/design-system/src/icons/arrow_left_large.svg"),arrow_right_large=__webpack_require__("./packages/design-system/src/icons/arrow_right_large.svg"),display=__webpack_require__("./packages/design-system/src/components/typography/display/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),components=__webpack_require__("./packages/dashboard/src/components/index.js");__webpack_require__("./packages/dashboard/src/propTypes.js");const Panel=styled_components_browser_esm.ZP.section.withConfig({displayName:"templateDetails__Panel",componentId:"sc-1cvs5jb-0"})(["padding:16vh 0 14vh 0;"]),Container=styled_components_browser_esm.ZP.div.withConfig({displayName:"templateDetails__Container",componentId:"sc-1cvs5jb-1"})(["position:relative;width:76%;max-width:","px;margin:0 auto;"],1459.2),Inner=styled_components_browser_esm.ZP.div.withConfig({displayName:"templateDetails__Inner",componentId:"sc-1cvs5jb-2"})(["display:flex;align-items:start;"]),DetailContainer=styled_components_browser_esm.ZP.section.attrs({"aria-label":(0,i18n.__)("Template Details","web-stories")}).withConfig({displayName:"templateDetails__DetailContainer",componentId:"sc-1cvs5jb-3"})(["padding:0 0 0 60px;margin-right:auto;"]),TemplateDetails=styled_components_browser_esm.ZP.div.withConfig({displayName:"templateDetails__TemplateDetails",componentId:"sc-1cvs5jb-4"})(["position:relative;display:flex;width:500px;"]);styled_components_browser_esm.ZP.section.attrs({"aria-label":(0,i18n.__)("Related Templates","web-stories")}).withConfig({displayName:"templateDetails__RowContainer",componentId:"sc-1cvs5jb-5"})(["display:flex;flex-wrap:wrap;padding-bottom:40px;margin:0 80px 0;& > h3{padding-bottom:32px;}& > div{width:100%;}"]);var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const StyledPanel=(0,styled_components_browser_esm.ZP)(Panel).withConfig({displayName:"content__StyledPanel",componentId:"sc-jxjpbh-0"})(["padding:0 0 48px 0;"]),ByLineText=(0,styled_components_browser_esm.ZP)(typography_text.x.Paragraph).withConfig({displayName:"content__ByLineText",componentId:"sc-jxjpbh-1"})(["color:",";margin:8px 0 24px;"],(({theme})=>theme.colors.fg.tertiary)),DescriptionText=(0,styled_components_browser_esm.ZP)(typography_text.x.Paragraph).withConfig({displayName:"content__DescriptionText",componentId:"sc-jxjpbh-2"})(["margin-bottom:24px;"]),PaginationContainer=styled_components_browser_esm.ZP.div.withConfig({displayName:"content__PaginationContainer",componentId:"sc-jxjpbh-3"})(["position:absolute;top:","px;",""],235,(({alignLeft})=>alignLeft?"\n          left: 0;\n          transform: translate(-187.5%, -50%);\n        ":"\n          right: 0;\n          transform: translate(187.5%, -50%);\n        ")),TemplateTag=(0,styled_components_browser_esm.ZP)(chip.Z).attrs({forwardedAs:"li"}).withConfig({displayName:"content__TemplateTag",componentId:"sc-jxjpbh-4"})(["margin-right:12px;margin-bottom:12px;> span{color:"," !important;}"],(({theme})=>theme.colors.fg.primary)),MetadataContainer=styled_components_browser_esm.ZP.div.withConfig({displayName:"content__MetadataContainer",componentId:"sc-jxjpbh-5"})(["margin-bottom:24px;display:flex;flex-wrap:wrap;align-items:center;"]);function DetailsContent({activeTemplateIndex,isRTL,filteredTemplatesLength,switchToTemplateByOffset,template}){const{postersByPage,title,description,tags,colors}=template||{},[galleryPosters,setGalleryPosters]=(0,src.eJ)([]);(0,src.d4)((()=>{postersByPage&&setGalleryPosters(Object.values(postersByPage).map(((poster,index)=>({id:index,...poster}))))}),[postersByPage]);const{NextButton,PrevButton}=(0,src.Ye)((()=>{const nextIndex=isRTL?activeTemplateIndex-1:activeTemplateIndex+1,previousIndex=isRTL?activeTemplateIndex+1:activeTemplateIndex-1,disablePrevious=isRTL?!filteredTemplatesLength||activeTemplateIndex===filteredTemplatesLength-1:!filteredTemplatesLength||0===activeTemplateIndex,disableNext=isRTL?!filteredTemplatesLength||0===activeTemplateIndex:!filteredTemplatesLength||activeTemplateIndex===filteredTemplatesLength-1,Previous=(0,jsx_runtime.jsx)(button_button.z,{type:constants.L$.Tertiary,size:constants.qE.Small,variant:constants.Wu.Square,"aria-label":(0,i18n.__)("View previous template","web-stories"),onClick:()=>{switchToTemplateByOffset(previousIndex),setGalleryPosters([])},disabled:disablePrevious,children:(0,jsx_runtime.jsx)(arrow_left_large.Z,{height:32,width:32})}),Next=(0,jsx_runtime.jsx)(button_button.z,{type:constants.L$.Tertiary,size:constants.qE.Small,variant:constants.Wu.Square,"aria-label":(0,i18n.__)("View next template","web-stories"),onClick:()=>{switchToTemplateByOffset(nextIndex),setGalleryPosters([])},disabled:disableNext,children:(0,jsx_runtime.jsx)(arrow_right_large.Z,{height:32,width:32})});return isRTL?{NextButton:Previous,PrevButton:Next}:{NextButton:Next,PrevButton:Previous}}),[filteredTemplatesLength,activeTemplateIndex,isRTL,switchToTemplateByOffset]),byLine=template?(0,sprintf.Z)((0,i18n.__)("By %s","web-stories"),template.createdBy):null;return(0,jsx_runtime.jsx)(StyledPanel,{children:(0,jsx_runtime.jsxs)(Container,{children:[(0,jsx_runtime.jsx)(PaginationContainer,{alignLeft:!0,children:PrevButton}),(0,jsx_runtime.jsxs)(Inner,{children:[(0,jsx_runtime.jsx)(components.ws,{galleryPosters,isRTL,galleryLabel:(0,i18n.__)("Template details by page","web-stories")}),(0,jsx_runtime.jsx)(TemplateDetails,{children:(0,jsx_runtime.jsxs)(DetailContainer,{children:[(0,jsx_runtime.jsx)(display.s,{size:types.TextSize.Small,as:"h3","data-testid":"template-details-title",children:title}),(0,jsx_runtime.jsx)(ByLineText,{size:types.TextSize.Medium,children:byLine}),(0,jsx_runtime.jsx)(DescriptionText,{size:types.TextSize.Medium,children:description}),(0,jsx_runtime.jsx)(MetadataContainer,{role:"list","aria-label":(0,i18n.__)("Template tags","web-stories"),children:tags.map((tag=>(0,jsx_runtime.jsx)(TemplateTag,{disabled:!0,children:tag},tag)))}),(0,jsx_runtime.jsx)(MetadataContainer,{children:(0,jsx_runtime.jsx)(components.Qn,{colors,size:32,"aria-label":(0,i18n.__)("Template colors","web-stories")})})]})})]}),(0,jsx_runtime.jsx)(PaginationContainer,{children:NextButton})]})})}DetailsContent.displayName="DetailsContent";const content=DetailsContent},"./packages/dashboard/src/app/views/exploreTemplates/modal/templateDetails/header/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/i18n/src/i18n.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/i18n/src/sprintf.ts"),styled_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/design-system/src/icons/cross_large.svg"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./packages/dashboard/src/propTypes.js"),__webpack_require__("./node_modules/react/jsx-runtime.js"));const Nav=styled_components__WEBPACK_IMPORTED_MODULE_3__.ZP.nav.withConfig({displayName:"header__Nav",componentId:"sc-1wko3r4-0"})(["justify-content:space-between;align-items:center;display:flex;margin:48px auto;width:calc(76% + 121px);"]),CTAButton=(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.ZP)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_4__.z).attrs({type:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__.L$.Primary,size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__.qE.Small}).withConfig({displayName:"header__CTAButton",componentId:"sc-1wko3r4-1"})(["padding:10px 16px;"]);function Header({templateTitle,templateId,templateActions,canCreateStory}){const{createStoryFromTemplate,handleDetailsToggle}=templateActions||{};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(Nav,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_4__.z,{type:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__.L$.Tertiary,variant:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__.Wu.Square,size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__.qE.Small,"aria-label":(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_6__.__)("Close","web-stories"),onClick:handleDetailsToggle,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__.Z,{})}),canCreateStory&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(CTAButton,{onClick:()=>createStoryFromTemplate(templateId),"aria-label":(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_8__.Z)((0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_6__.__)("Use %s template to create new story","web-stories"),templateTitle),children:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_6__.__)("Use template","web-stories")})]})}Header.displayName="Header";const __WEBPACK_DEFAULT_EXPORT__=Header},"./packages/dashboard/src/app/views/myStories/header/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>header});__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");var src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),constants=__webpack_require__("./packages/dashboard/src/constants/index.ts"),utils=(__webpack_require__("./packages/dashboard/src/propTypes.js"),__webpack_require__("./packages/dashboard/src/utils/useStoryView.js"),__webpack_require__("./packages/dashboard/src/utils/index.js")),shared=__webpack_require__("./packages/dashboard/src/app/views/shared/index.js"),views_utils=__webpack_require__("./packages/dashboard/src/app/views/utils/index.js"),useStoryFilters=__webpack_require__("./packages/dashboard/src/app/views/myStories/filters/useStoryFilters.js"),pill=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/design-system/src/components/pill/pill.tsx")),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const StyledPill=(0,styled_components_browser_esm.ZP)(pill.Z).withConfig({displayName:"storyStatusToggle__StyledPill",componentId:"sc-141pqd7-0"})(["margin:0 2px;white-space:nowrap;& > span{padding-left:8px;color:",";}"],(({theme,isActive})=>isActive?theme.colors.gray[20]:theme.colors.fg.tertiary));const storyStatusToggle=function StoryStatusToggle({initialPageReady,totalStoriesByStatus,currentStatus}){const{updateFilter,registerFilters}=(0,useStoryFilters.Z)((({actions:{updateFilter,registerFilters}})=>({updateFilter,registerFilters}))),handleStatusChange=(0,src.I4)((value=>{updateFilter("status",{filterId:value})}),[updateFilter]);(0,src.d4)((()=>{registerFilters([{key:"status",filterId:constants.MZ.filters.status}])}),[registerFilters]);const totalStories=(0,src.Ye)((()=>Object.keys(totalStoriesByStatus).reduce(((prev,cur)=>prev+totalStoriesByStatus[cur]),0)),[totalStoriesByStatus]),statuses=(0,src.Ye)((()=>constants.zI.filter((({status})=>Boolean(status in totalStoriesByStatus)&&totalStoriesByStatus[status]>0||status===currentStatus)).map((({label,status,value})=>{const count=totalStoriesByStatus[status],disabled=Boolean(!count);return{ariaLabel:(0,sprintf.Z)((0,i18n.__)("Filter stories by %s","web-stories"),label),disabled,isActive:currentStatus===value,value,label,count}}))),[totalStoriesByStatus,currentStatus]);return!initialPageReady||!totalStories||totalStoriesByStatus&&0===Object.keys(totalStoriesByStatus).length?null:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:statuses.map((({ariaLabel,disabled,isActive,value,label,count})=>(0,jsx_runtime.jsxs)(StyledPill,{onClick:()=>handleStatusChange(value),isActive,disabled,"aria-label":ariaLabel,children:[label,(0,jsx_runtime.jsx)("span",{children:count})]},value)))})};const header=(0,src.X$)((function Header({initialPageReady,stories,totalStoriesByStatus,view}){const searchOptions=(0,src.Ye)((()=>(0,views_utils.$o)(stories)),[stories]),{filters,sortObject,updateFilter,updateSort,registerFilters}=(0,useStoryFilters.Z)((({state:{filters,sortObject},actions:{updateFilter,updateSort,registerFilters}})=>({filters,updateFilter,sortObject,updateSort,registerFilters}))),[dropDownFilters,statusFilterValue,searchFilterValue]=(0,src.Ye)((()=>{const status=filters.find((({key})=>"status"===key)),search=filters.find((({key})=>"search"===key));return[filters.filter((({key})=>!["status","search"].includes(key))),status?.filterId,search?.filterId]}),[filters]),totalResults=(0,src.Ye)((()=>(statusFilterValue?.split(",")||[]).reduce(((total,filterKey)=>total+(totalStoriesByStatus[filterKey]||0)),0)),[statusFilterValue,totalStoriesByStatus]),resultsLabel=(0,utils.Uv)({currentFilter:statusFilterValue,isActiveSearch:Boolean(searchFilterValue),totalResults,view:constants.g3.DASHBOARD}),debouncedSearchChange=(0,src.y1)((async value=>{await(0,tracking_src.L9)("search",{search_type:"dashboard",search_term:value}),updateFilter("search",{filterId:value})}),constants.p$);(0,src.d4)((()=>{registerFilters([{key:"search"}])}),[registerFilters]);const clearSearch=(0,src.I4)((()=>updateFilter("search",{filterId:null})),[updateFilter]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(shared.CD,{heading:(0,i18n.__)("Dashboard","web-stories"),searchPlaceholder:(0,i18n.__)("Search Stories","web-stories"),searchOptions,handleSearchChange:debouncedSearchChange,showSearch:initialPageReady,searchValue:searchFilterValue,onClear:clearSearch,children:(0,jsx_runtime.jsx)(storyStatusToggle,{initialPageReady,totalStoriesByStatus,currentStatus:statusFilterValue})}),(0,jsx_runtime.jsx)(shared.dA,{showGridToggle:!0,filters:dropDownFilters,showSortDropdown:!0,resultsLabel,layoutStyle:view.style,handleLayoutSelect:view.toggleStyle,pageSortOptions:constants.h8,pageSortDefaultOption:constants.YN.LAST_MODIFIED,handleSortChange:updateSort,currentSort:sortObject})]})}))},"./packages/dashboard/src/app/views/utils/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A5:()=>utils_composeTemplateFilter,$o:()=>utils_getSearchOptions,Xw:()=>utils_getTemplateFilters});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");const utils_getSearchOptions=function getSearchOptions(options){return options.reduce(((acc,option)=>!option.title||option?.title.trim().length<=0?acc:[...acc,{label:option.title,value:option.title}]),[])};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var uniqueEntriesByKey=__webpack_require__("./packages/design-system/src/utils/uniqueEntriesByKey.ts");const TEMPLATE_META_DATA_TYPES_VERTICAL="VERTICAL",TEMPLATE_META_DATA_TYPES_COLOR="COLOR",TEMPLATE_META_DATA_TYPES_TAG="TAG",TEMPLATE_META_DATA_TYPES_TITLE="TITLE";const utils_getTemplateFilters=function getTemplateFilters(templates){const templatesArr=Object.values(templates),colors=templatesArr.flatMap((t=>t.colors)).map((c=>({label:c.family,value:c.family,type:TEMPLATE_META_DATA_TYPES_COLOR}))),tags=templatesArr.flatMap((t=>t.tags)).map((tag=>({label:tag,value:tag,type:TEMPLATE_META_DATA_TYPES_TAG}))),verticals=templatesArr.map((t=>t.vertical)).map((vertical=>({label:vertical,value:vertical,type:TEMPLATE_META_DATA_TYPES_VERTICAL}))),title=templatesArr.map((t=>({label:t.title,value:t.title,type:TEMPLATE_META_DATA_TYPES_TITLE})));return[...(0,uniqueEntriesByKey.Z)(tags,"label"),...(0,uniqueEntriesByKey.Z)(colors,"label"),...(0,uniqueEntriesByKey.Z)(verticals,"label"),...(0,uniqueEntriesByKey.Z)(title,"label")]};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");const utils_composeTemplateFilter=function composeTemplateFilter(filters){return template=>!filters||filters.some((filter=>{switch(filter?.type){case TEMPLATE_META_DATA_TYPES_TAG:return template.tags.map((tag=>tag.toLowerCase())).includes(filter.value.toLowerCase());case TEMPLATE_META_DATA_TYPES_COLOR:return template.colors.map((color=>color.label.toLowerCase())).includes(filter.value.toLowerCase());case TEMPLATE_META_DATA_TYPES_VERTICAL:return template.vertical.toLowerCase().includes(filter.value.toLowerCase());case TEMPLATE_META_DATA_TYPES_TITLE:return template.title.toLowerCase().includes(filter.value.toLowerCase());default:return!0}}))}},"./packages/dashboard/src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{iV:()=>app.iV,A:()=>dashboard,p0:()=>components.p0,v4:()=>interfaceSkeleton,wD:()=>components.wD,p$:()=>constants.p$,u:()=>components.u,ZR:()=>app.ZR});__webpack_require__("./node_modules/react/index.js");var deepMerge=__webpack_require__("./packages/design-system/src/utils/deepMerge.ts"),theme=__webpack_require__("./packages/design-system/src/theme/theme.ts"),colors=__webpack_require__("./packages/design-system/src/theme/colors.ts"),styles=__webpack_require__("./packages/design-system/src/theme/global/styles.ts"),modal_styles=__webpack_require__("./packages/design-system/src/components/modal/styles.ts"),snackbarProvider=__webpack_require__("./packages/design-system/src/contexts/snackbar/snackbarProvider.tsx"),popupProvider=__webpack_require__("./packages/design-system/src/contexts/popup/popupProvider.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),stylis_rtl=__webpack_require__("./node_modules/stylis-plugin-rtl/dist/stylis-rtl.js"),flagged_esm=__webpack_require__("./packages/dashboard/node_modules/flagged/dist/flagged.esm.js"),app_config=__webpack_require__("./packages/dashboard/src/app/config/index.ts"),apiProvider=__webpack_require__("./packages/dashboard/src/app/api/apiProvider.js"),components=__webpack_require__("./packages/dashboard/src/components/index.js"),router=__webpack_require__("./packages/dashboard/src/app/router/index.ts"),src_theme=__webpack_require__("./packages/dashboard/src/theme.js"),utils=__webpack_require__("./packages/dashboard/src/utils/index.js");const src_getDefaultConfig=()=>({isRTL:!1,userId:1,locale:{locale:"en-US",dateFormat:"F j, Y",timeFormat:"g:i a",gmtOffset:"0",timezone:"",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysInitials:["S","M","T","W","T","F","S"],weekStartsOn:1},newStoryURL:"",cdnURL:"https://wp.stories.google/static/main/",version:"",capabilities:{canManageSettings:!1,canUploadFiles:!1},canViewDefaultTemplates:!1,flags:{},apiCallbacks:{},leftRailSecondaryNavigation:[],styleConstants:{topOffset:0,leftOffset:0}});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function Dashboard({config,children}){const _config=(0,deepMerge.Z)(src_getDefaultConfig(),config),activeTheme={...theme.r,colors:colors.R},{isRTL,flags,styleConstants:{leftOffset,topOffset}={}}=_config;return(0,jsx_runtime.jsx)(flagged_esm.Q_,{features:flags,children:(0,jsx_runtime.jsx)(styled_components_browser_esm.LC,{stylisPlugins:isRTL?[stylis_rtl.ZP]:[],children:(0,jsx_runtime.jsxs)(styled_components_browser_esm.f6,{theme:activeTheme,children:[(0,jsx_runtime.jsx)(styles.z,{}),(0,jsx_runtime.jsx)(modal_styles.H,{}),(0,jsx_runtime.jsx)(app_config.i,{config:_config,children:(0,jsx_runtime.jsx)(apiProvider.Z,{children:(0,jsx_runtime.jsx)(components.N7,{children:(0,jsx_runtime.jsx)(router.pG,{children:(0,jsx_runtime.jsx)(snackbarProvider.Z,{children:(0,jsx_runtime.jsxs)(popupProvider.Z,{value:{isRTL,leftOffset,topOffset},children:[(0,jsx_runtime.jsx)(src_theme.Z,{}),(0,jsx_runtime.jsx)(utils.fD,{}),children]})})})})})})]})})})}Object.defineProperty(stylis_rtl.ZP,"name",{value:"stylisRTLPlugin"}),Dashboard.displayName="Dashboard";const dashboard=Dashboard;var app=__webpack_require__("./packages/dashboard/src/app/index.js"),constants=__webpack_require__("./packages/dashboard/src/constants/index.ts"),src=(__webpack_require__("./packages/dashboard/src/app/views/shared/index.js"),__webpack_require__("./packages/dashboard/src/utils/keyboardOnlyOutline.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/react/src/index.ts")),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),useSnackbar=__webpack_require__("./packages/design-system/src/contexts/snackbar/useSnackbar.ts"),snackbarContainer=__webpack_require__("./packages/design-system/src/components/snackbar/snackbarContainer.tsx"),useApi=__webpack_require__("./packages/dashboard/src/app/api/useApi.js"),useStoryFilters=__webpack_require__("./packages/dashboard/src/app/views/myStories/filters/useStoryFilters.js"),content=__webpack_require__("./packages/dashboard/src/app/views/myStories/content/index.js"),header=__webpack_require__("./packages/dashboard/src/app/views/myStories/header/index.js"),StoryFiltersProvider=__webpack_require__("./packages/dashboard/src/app/views/myStories/filters/StoryFiltersProvider/index.js");function MyStoriesView(){const{duplicateStory,fetchStories,trashStory,updateStory,allPagesFetched,isLoading,stories,storiesOrderById,totalPages,totalStoriesByStatus}=(0,useApi.Z)((({actions:{storyApi:{duplicateStory,fetchStories,trashStory,updateStory}},state:{stories:{allPagesFetched,isLoading,stories,storiesOrderById,totalPages,totalStoriesByStatus}}})=>({duplicateStory,fetchStories,trashStory,updateStory,allPagesFetched,isLoading,stories,storiesOrderById,totalPages,totalStoriesByStatus}))),{filtersObject,sortObject}=(0,useStoryFilters.Z)((({state:{filtersObject,sortObject}})=>({filtersObject,sortObject}))),{apiCallbacks,canViewDefaultTemplates}=(0,app_config.Z)(),isMounted=(0,src.sO)(!1);(0,src.d4)((()=>(isMounted.current=!0,()=>{isMounted.current=!1})),[]);const{page,view,showStoriesWhileLoading,initialPageReady}=(0,utils.KE)({filtersObject,sortObject,isLoading,totalPages});(0,src.d4)((()=>{fetchStories({page:page.value,filters:filtersObject,sort:sortObject})}),[fetchStories,filtersObject,sortObject,page.value,apiCallbacks]);const orderedStories=(0,src.Ye)((()=>storiesOrderById.map((storyId=>stories[storyId]))),[stories,storiesOrderById]);return(0,jsx_runtime.jsxs)(components.Ar.Provider,{children:[(0,jsx_runtime.jsx)(header.Z,{initialPageReady,stories:orderedStories,totalStoriesByStatus,view}),(0,jsx_runtime.jsx)(content.Z,{allPagesFetched,canViewDefaultTemplates,filtersObject,loading:{isLoading,showStoriesWhileLoading},page,stories:orderedStories,storyActions:{duplicateStory,trashStory,updateStory},view}),(0,jsx_runtime.jsx)(components.Ar.Fixed,{children:(0,jsx_runtime.jsx)(components.pU,{})})]})}function MyStories(){return(0,jsx_runtime.jsx)(StoryFiltersProvider.Z,{children:(0,jsx_runtime.jsx)(MyStoriesView,{})})}MyStoriesView.displayName="MyStoriesView",MyStories.displayName="MyStories";__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");var useLiveRegion=__webpack_require__("./packages/design-system/src/utils/useLiveRegion.ts"),uniqueEntriesByKey=__webpack_require__("./packages/design-system/src/utils/uniqueEntriesByKey.ts"),useRouteHistory=__webpack_require__("./packages/dashboard/src/app/router/useRouteHistory.ts"),views_utils=__webpack_require__("./packages/dashboard/src/app/views/utils/index.js"),useTemplateFilters=__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/filters/useTemplateFilters.js"),exploreTemplates_content=__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/content/index.js"),exploreTemplates_header=__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/header/index.js"),modal=__webpack_require__("./packages/design-system/src/components/modal/modal.tsx"),templateDetails_header=(__webpack_require__("./packages/dashboard/src/propTypes.js"),__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/modal/templateDetails/header/index.js")),templateDetails_content=__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/modal/templateDetails/content/index.js");function TemplateDetailsModal({activeTemplateIndex,activeTemplate,filteredTemplatesLength,isDetailsViewOpen,templateActions}){const{isRTL,apiCallbacks}=(0,app_config.Z)(),canCreateStory=Boolean(apiCallbacks?.createStoryFromTemplate),{handleDetailsToggle,switchToTemplateByOffset}=templateActions||{};return(0,jsx_runtime.jsxs)(modal.Z,{isOpen:isDetailsViewOpen,onClose:handleDetailsToggle,contentLabel:(0,sprintf.Z)((0,i18n.__)("Template Details for %s","web-stories"),activeTemplate?.title),overlayStyles:{backgroundColor:`${theme.r.colors.opacity.overlayDark}`},contentStyles:{display:"block",height:"90vh",width:"90vw",backgroundColor:`${theme.r.colors.standard.white}`},children:[(0,jsx_runtime.jsx)(templateDetails_header.Z,{templateTitle:activeTemplate?.title,templateId:activeTemplate?.id,templateActions,canCreateStory}),(0,jsx_runtime.jsx)(templateDetails_content.Z,{activeTemplateIndex,isRTL,filteredTemplatesLength,switchToTemplateByOffset,template:activeTemplate})]})}TemplateDetailsModal.displayName="TemplateDetailsModal";const exploreTemplates_modal=TemplateDetailsModal;var TemplateFiltersProvider=__webpack_require__("./packages/dashboard/src/app/views/exploreTemplates/filters/TemplateFiltersProvider/index.js");function ExploreTemplatesView(){const speak=(0,useLiveRegion.Z)(),[isDetailsViewOpen,setIsDetailsViewOpen]=(0,src.eJ)(!1),[activeTemplate,setActiveTemplate]=(0,src.eJ)(null),[activeTemplateIndex,setActiveTemplateIndex]=(0,src.eJ)(0),{templateIdParam,replace}=(0,useRouteHistory.Z)((({actions,state})=>({templateIdParam:state.queryParams.id,replace:actions.replace}))),idRef=(0,src.sO)(templateIdParam),{allPagesFetched,isLoading,templates,templatesOrderById,totalPages,totalTemplates,createStoryFromTemplate,fetchExternalTemplates}=(0,useApi.Z)((({state:{templates:{allPagesFetched,isLoading,templates,templatesOrderById,totalPages,totalTemplates}},actions:{storyApi:{createStoryFromTemplate},templateApi:{fetchExternalTemplates}}})=>({allPagesFetched,isLoading,templates,templatesOrderById,totalPages,totalTemplates,createStoryFromTemplate,fetchExternalTemplates}))),{filters,sortObject,filtersObject}=(0,useTemplateFilters.Z)((({state:{filters,sortObject,filtersObject}})=>({filters,sortObject,filtersObject}))),{page,view}=(0,utils.P6)({filtersObject,sortObject,totalPages}),[searchFilterValue]=(0,src.Ye)((()=>{const search=filters.find((({key})=>"search"===key));return[search?.filterId]}),[filters]),templateFilters=(0,src.Ye)((()=>(0,views_utils.Xw)(templates)),[templates]),selectFilters=(0,src.Ye)((()=>searchFilterValue?templateFilters.filter((opt=>opt.label.toLowerCase().includes(searchFilterValue.toLowerCase()))):templateFilters),[templateFilters,searchFilterValue]),orderedTemplates=(0,src.Ye)((()=>templatesOrderById.map((templateId=>templates[templateId])).filter((0,views_utils.A5)(selectFilters))),[templatesOrderById,templates,selectFilters]),totalVisibleTemplates=(0,src.Ye)((()=>totalTemplates!==orderedTemplates.length?orderedTemplates.length:totalTemplates),[orderedTemplates,totalTemplates]),searchOptions=(0,src.Ye)((()=>(0,uniqueEntriesByKey.Z)(selectFilters,"label")),[selectFilters]),handleCreateStoryFromTemplate=(0,src.I4)((templateId=>{const template=templates[templateId];(0,tracking_src.L9)("use_template",{name:template.title,template_id:template.id}),createStoryFromTemplate(template)}),[createStoryFromTemplate,templates]),updateTemplateView=(0,src.I4)((id=>{const currentTemplate=orderedTemplates.find((templateItem=>templateItem.id===id));setActiveTemplate(currentTemplate),setActiveTemplateIndex(orderedTemplates.findIndex((template=>template.id===id))),idRef.current&&(idRef.current=void 0),replace(`?id=${currentTemplate.id}&isLocal=${currentTemplate.isLocal}`)}),[replace,orderedTemplates]),handleDetailsToggle=(0,src.I4)(((id,title)=>{setIsDetailsViewOpen((prevIsOpen=>{const newIsOpen=!prevIsOpen;return title&&(0,tracking_src.o$)(title),newIsOpen&&id&&updateTemplateView(id),newIsOpen||(replace(""),speak((0,i18n.__)("Exit detail templates view","web-stories"))),newIsOpen}))}),[replace,speak,updateTemplateView]),switchToTemplateByOffset=(0,src.I4)((offset=>{const newTemplate=orderedTemplates[offset];setActiveTemplate(newTemplate),setActiveTemplateIndex(offset),replace(`?id=${newTemplate.id}&isLocal=${newTemplate.isLocal}`),speak((0,sprintf.Z)((0,i18n.__)("Viewing %s","web-stories"),newTemplate.title))}),[orderedTemplates,replace,speak]),templateActions=(0,src.Ye)((()=>({createStoryFromTemplate:handleCreateStoryFromTemplate,handleDetailsToggle,switchToTemplateByOffset})),[handleCreateStoryFromTemplate,handleDetailsToggle,switchToTemplateByOffset]);return(0,src.d4)((()=>{fetchExternalTemplates()}),[fetchExternalTemplates]),(0,src.d4)((()=>{if(idRef.current&&orderedTemplates.length){if(!orderedTemplates.some((template=>template.id===parseInt(idRef.current))))return void replace("");setIsDetailsViewOpen(!0),updateTemplateView(parseInt(idRef.current))}}),[orderedTemplates,replace,updateTemplateView]),(0,jsx_runtime.jsxs)(components.Ar.Provider,{children:[(0,jsx_runtime.jsx)(exploreTemplates_header.Z,{isLoading:isLoading&&!totalTemplates,totalTemplates:totalVisibleTemplates,searchOptions,view}),(0,jsx_runtime.jsx)(exploreTemplates_content.Z,{isLoading,allPagesFetched,page,templates:orderedTemplates,totalTemplates:totalVisibleTemplates,search:searchFilterValue,view,templateActions}),(0,jsx_runtime.jsx)(components.Ar.Fixed,{children:(0,jsx_runtime.jsx)(components.pU,{})}),(0,jsx_runtime.jsx)(exploreTemplates_modal,{activeTemplate,activeTemplateIndex,isDetailsViewOpen,templateActions,filteredTemplatesLength:orderedTemplates.length})]})}function ExploreTemplates(){return(0,jsx_runtime.jsx)(TemplateFiltersProvider.Z,{children:(0,jsx_runtime.jsx)(ExploreTemplatesView,{})})}ExploreTemplatesView.displayName="ExploreTemplatesView",ExploreTemplates.displayName="ExploreTemplates";var pageStructure=__webpack_require__("./packages/dashboard/src/components/pageStructure/index.js"),useApiAlerts=__webpack_require__("./packages/dashboard/src/app/api/useApiAlerts.js");const interfaceSkeleton=({additionalRoutes})=>{const{currentPath,templateId,availableRoutes}=(0,router.TU)((({state})=>({...state,templateId:state.queryParams.id}))),{push,setAvailableRoutes}=(0,router.TU)((({actions})=>actions)),{canViewDefaultTemplates,leftRailSecondaryNavigation=[],documentTitleSuffix=(0,i18n.__)("Web Stories","web-stories")}=(0,app_config.Z)(),{addInitialFetchListener}=(0,useApi.Z)((({actions:{storyApi:{addInitialFetchListener}},state:{templates:{templates}}})=>({currentTemplate:void 0!==templateId?templates[templateId]?.title:void 0,addInitialFetchListener}))),isFirstLoadOnMyStories=(0,src.sO)(currentPath===constants.QY.DASHBOARD),[isRedirectComplete,setIsRedirectComplete]=(0,src.eJ)(!isFirstLoadOnMyStories.current);(0,src.d4)((()=>addInitialFetchListener?.((storyStatuses=>{storyStatuses?.all<=0&&isFirstLoadOnMyStories.current&&canViewDefaultTemplates&&(push(constants.QY.TEMPLATES_GALLERY),isFirstLoadOnMyStories.current=!1),setIsRedirectComplete(!0)}))),[addInitialFetchListener,push,currentPath,canViewDefaultTemplates]),(0,src.d4)((()=>{if(availableRoutes.length>0)return;const additionalPaths=additionalRoutes?additionalRoutes.map((({path})=>path)):[];setAvailableRoutes([...Object.values(constants.QY),...additionalPaths])}),[additionalRoutes,availableRoutes.length,setAvailableRoutes]),(0,src.d4)((()=>{if(!isRedirectComplete)return;const additionalRouteTitle=leftRailSecondaryNavigation.find((config=>config.value===currentPath)),dynamicPageTitle=constants.L3[currentPath]||additionalRouteTitle?.label||constants.L3.DEFAULT;document.title=(0,sprintf.Z)((0,i18n.__)("%1$s ‹ %2$s","web-stories"),dynamicPageTitle,documentTitleSuffix),(0,tracking_src.o$)(dynamicPageTitle)}),[currentPath,isRedirectComplete,leftRailSecondaryNavigation,documentTitleSuffix]),(0,useApiAlerts.Z)();const{clearSnackbar,removeSnack,placement,currentSnacks}=(0,useSnackbar.D)(),prevPath=(0,src.D9)(currentPath);return(0,src.d4)((()=>{currentPath!==prevPath&&clearSnackbar()}),[clearSnackbar,currentPath,prevPath]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(pageStructure.qP,{children:[(0,jsx_runtime.jsx)(pageStructure.Vh,{}),(0,jsx_runtime.jsx)(pageStructure.JH,{children:availableRoutes.length>0&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(router.AW,{exact:!0,isDefault:!0,path:constants.QY.DASHBOARD,component:(0,jsx_runtime.jsx)(MyStories,{})}),canViewDefaultTemplates&&(0,jsx_runtime.jsx)(router.AW,{path:constants.QY.TEMPLATES_GALLERY,component:(0,jsx_runtime.jsx)(ExploreTemplates,{})}),additionalRoutes&&additionalRoutes.map((routeProps=>(0,jsx_runtime.jsx)(router.AW,{...routeProps},routeProps.path)))]})})]}),(0,jsx_runtime.jsx)(snackbarContainer.Z,{notifications:currentSnacks,onRemove:removeSnack,placement,max:1})]})}}}]);