"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[3961],{"./packages/design-system/src/components/keyboard/gridview/useGridViewKeys.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>gridview_useGridViewKeys});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),src=__webpack_require__("./packages/react/src/index.ts"),keyboard=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx");function focusOnPage(page){const button=page?.querySelector("button, a");button&&button.focus()}function getArrowDir(key,pos,neg,isRTL){const rtlDir=isRTL?-1:1;return key===pos?rtlDir:key===neg?-1*rtlDir:0}function getGridColumnAndRowCount(grid,pageCount){let prevX,columns=0;for(const el of grid.children){const{x}=el.getBoundingClientRect();if(void 0!==prevX&&x<prevX)break;prevX=x,columns++}return{rows:Math.ceil(pageCount/columns),columns}}function getRow(index,numColumns){return Math.ceil((index+1)/numColumns)}function getColumn(index,numColumns){return index%numColumns+1}function getIndex({row,column,numRows,numColumns,numItems}){if(row>numRows||row<=0||column>numColumns||column<=0)return-1;const index=numColumns*(row-1)+(column-1);return index>=numItems?numItems-1:index}function _temp(t0){const{id}=t0;return id}const gridview_useGridViewKeys=function useGridViewKeys(t0){const $=(0,dist.c)(38),{currentItemId,items,containerRef,gridRef,itemRefs,isRTL,arrangeItem}=t0,[focusedItemId,setFocusedItemId]=(0,src.J0)(null);let t1,t2;$[0]!==items?(t1=()=>items.map(_temp),t2=[items],$[0]=items,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const itemIds=(0,src.Kr)(t1,t2);let t3,t4,t5,t6,t7,t8,t9,t10;$[3]!==currentItemId||$[4]!==setFocusedItemId?(t3=()=>{setFocusedItemId(currentItemId)},$[3]=currentItemId,$[4]=setFocusedItemId,$[5]=t3):t3=$[5],$[6]!==currentItemId?(t4=[currentItemId],$[6]=currentItemId,$[7]=t4):t4=$[7],(0,src.vJ)(t3,t4),$[8]===Symbol.for("react.memo_cache_sentinel")?(t5={key:["up","down","left","right"]},$[8]=t5):t5=$[8],$[9]!==focusedItemId||$[10]!==gridRef||$[11]!==isRTL||$[12]!==itemIds||$[13]!==itemRefs?.current||$[14]!==setFocusedItemId?(t6=t7=>{const{key}=t7;bb7:switch(key){case"ArrowLeft":case"ArrowRight":{const dir_0=getArrowDir(key,"ArrowRight","ArrowLeft",isRTL);if(0===dir_0)return;const nextIndex_0=(null!==focusedItemId?itemIds.indexOf(focusedItemId):-1)+dir_0;if(nextIndex_0<0||nextIndex_0===itemIds.length)return;const itemId_0=itemIds[nextIndex_0];setFocusedItemId(itemId_0);const item_0=itemRefs?.current?.[itemId_0];focusOnPage(item_0);break bb7}case"ArrowUp":case"ArrowDown":{if(!gridRef.current)return;const{rows:numRows,columns:numColumns}=getGridColumnAndRowCount(gridRef.current,itemIds.length),currentIndex=null!==focusedItemId?itemIds.indexOf(focusedItemId):-1,dir="ArrowDown"===key?1:-1,nextIndex=getIndex({row:getRow(currentIndex,numColumns)+dir,column:getColumn(currentIndex,numColumns),numRows,numColumns,numItems:itemIds.length});if(nextIndex<0)return;const itemId=itemIds[nextIndex];setFocusedItemId(itemId);const item=itemRefs?.current?.[itemId];focusOnPage(item);break bb7}}},$[9]=focusedItemId,$[10]=gridRef,$[11]=isRTL,$[12]=itemIds,$[13]=itemRefs?.current,$[14]=setFocusedItemId,$[15]=t6):t6=$[15],$[16]!==currentItemId||$[17]!==focusedItemId||$[18]!==gridRef||$[19]!==isRTL||$[20]!==itemIds||$[21]!==itemRefs?(t7=[focusedItemId,isRTL,itemIds,itemRefs,gridRef,currentItemId],$[16]=currentItemId,$[17]=focusedItemId,$[18]=gridRef,$[19]=isRTL,$[20]=itemIds,$[21]=itemRefs,$[22]=t7):t7=$[22],(0,keyboard._h)(containerRef,t5,t6,t7),$[23]===Symbol.for("react.memo_cache_sentinel")?(t8={key:["mod+up","mod+down","mod+left","mod+right"],shift:!0},$[23]=t8):t8=$[23],$[24]!==arrangeItem||$[25]!==focusedItemId||$[26]!==gridRef||$[27]!==isRTL||$[28]!==itemIds?(t9=e=>{const{key:key_0,shiftKey}=e;let nextIndex_1,canArrange=!1;e.preventDefault();bb59:switch(key_0){case"ArrowLeft":case"ArrowRight":{const dir_2=getArrowDir(key_0,"ArrowRight","ArrowLeft",isRTL);if(0===dir_2)return;const currentIndex_1=null!==focusedItemId?itemIds.indexOf(focusedItemId):-1;nextIndex_1=currentIndex_1,shiftKey?nextIndex_1=dir_2<0?0:itemIds.length-1:nextIndex_1+=dir_2,canArrange=nextIndex_1!==currentIndex_1&&nextIndex_1>=0&&nextIndex_1<=itemIds.length-1;break bb59}case"ArrowUp":case"ArrowDown":{if(!gridRef.current)return;const{rows:numRows_0,columns:numColumns_0}=getGridColumnAndRowCount(gridRef.current,itemIds.length),currentIndex_0=null!==focusedItemId?itemIds.indexOf(focusedItemId):-1,dir_1="ArrowDown"===key_0?1:-1;if(nextIndex_1=getIndex({row:getRow(currentIndex_0,numColumns_0)+dir_1,column:getColumn(currentIndex_0,numColumns_0),numRows:numRows_0,numColumns:numColumns_0,numItems:itemIds.length}),nextIndex_1<0)return;break bb59}}canArrange&&void 0!==nextIndex_1&&arrangeItem&&focusedItemId&&arrangeItem(focusedItemId,nextIndex_1)},$[24]=arrangeItem,$[25]=focusedItemId,$[26]=gridRef,$[27]=isRTL,$[28]=itemIds,$[29]=t9):t9=$[29],$[30]!==arrangeItem||$[31]!==currentItemId||$[32]!==focusedItemId||$[33]!==gridRef||$[34]!==isRTL||$[35]!==itemIds||$[36]!==itemRefs?(t10=[currentItemId,itemIds,isRTL,gridRef,itemRefs,focusedItemId,arrangeItem],$[30]=arrangeItem,$[31]=currentItemId,$[32]=focusedItemId,$[33]=gridRef,$[34]=isRTL,$[35]=itemIds,$[36]=itemRefs,$[37]=t10):t10=$[37],(0,keyboard._h)(containerRef,t8,t9,t10)}},"./packages/design-system/src/components/loadingSpinner/loadingSpinner.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js")),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/react/src/index.ts"),styled_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),uuid__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/design-system/node_modules/uuid/dist/esm-browser/v4.js"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/i18n/src/i18n.ts"),_theme__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/design-system/src/theme/helpers/visuallyHidden.ts"),_theme__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/design-system/src/theme/constants/index.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const TAU=2*Math.PI,AriaOnlyAlert=styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay.span.withConfig({displayName:"loadingSpinner__AriaOnlyAlert",componentId:"sc-10eor9p-0"})(["",""],_theme__WEBPACK_IMPORTED_MODULE_5__.Q),Container=styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay.div.withConfig({displayName:"loadingSpinner__Container",componentId:"sc-10eor9p-1"})(["position:relative;height:","px;width:","px;color:",";"],(({animationSize})=>animationSize),(({animationSize})=>animationSize),(({theme})=>theme.colors.interactiveBg.brandNormal)),Circle=styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay.div.withConfig({displayName:"loadingSpinner__Circle",componentId:"sc-10eor9p-2"})(["position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) ",";height:","px;width:","px;background-color:",";border-radius:",";animation-name:",";animation-fill-mode:both;animation-duration:","s;animation-iteration-count:infinite;animation-timing-function:",";"],(({$position:{x,y}})=>`translate(${x}px, ${y}px)`),(({circleSize})=>circleSize),(({circleSize})=>circleSize),(({theme})=>theme.colors.interactiveBg.brandNormal),(({theme})=>theme.borders.radius.round),(({circleIndex,numCircles})=>(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.i7)(["0%{opacity:1}","{opacity:1}","{opacity:0.3}","{opacity:1}"],100*circleIndex/numCircles+"%",100*(circleIndex+1)/numCircles+"%",100*(circleIndex+1)/numCircles+1+"%")),.85,_theme__WEBPACK_IMPORTED_MODULE_6__.U.inOutQuad);function _temp(){return(0,uuid__WEBPACK_IMPORTED_MODULE_8__.A)()}const __WEBPACK_DEFAULT_EXPORT__=function LoadingSpinner(t0){const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(27);let props,t1,t2,t3,t4;$[0]!==t0?(({animationSize:t1,circleSize:t2,loadingMessage:t3,numCircles:t4,...props}=t0),$[0]=t0,$[1]=props,$[2]=t1,$[3]=t2,$[4]=t3,$[5]=t4):(props=$[1],t1=$[2],t2=$[3],t3=$[4],t4=$[5]);const animationSize=void 0===t1?95:t1,circleSize=void 0===t2?12:t2;let t5;$[6]!==t3?(t5=void 0===t3?(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_7__.__)("Loading","web-stories"):t3,$[6]=t3,$[7]=t5):t5=$[7];const loadingMessage=t5,numCircles=void 0===t4?11:t4;let t6,t7;$[8]!==numCircles?(t6=()=>Array.from({length:numCircles}).fill(1).map(_temp),t7=[numCircles],$[8]=numCircles,$[9]=t6,$[10]=t7):(t6=$[9],t7=$[10]);const ids=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.Kr)(t6,t7);let t8,t9,t10;if($[11]!==loadingMessage?(t8=loadingMessage&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(AriaOnlyAlert,{role:"status"},loadingMessage),$[11]=loadingMessage,$[12]=t8):t8=$[12],$[13]!==animationSize||$[14]!==circleSize||$[15]!==ids||$[16]!==numCircles){let t10;$[18]!==animationSize||$[19]!==circleSize||$[20]!==numCircles?(t10=(id,index)=>{const angle=((index,numCircles)=>TAU*index/numCircles)(index,numCircles),position=((angle,animationSize)=>{const radius=animationSize/2,x=Math.sin(angle)*radius,y=-Math.cos(angle)*radius;return{x:x.toFixed(1),y:y.toFixed(1)}})(angle,animationSize);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(Circle,{key:id,circleIndex:index,circleSize,numCircles,$position:position})},$[18]=animationSize,$[19]=circleSize,$[20]=numCircles,$[21]=t10):t10=$[21],t9=ids.map(t10),$[13]=animationSize,$[14]=circleSize,$[15]=ids,$[16]=numCircles,$[17]=t9}else t9=$[17];return $[22]!==animationSize||$[23]!==props||$[24]!==t8||$[25]!==t9?(t10=react__WEBPACK_IMPORTED_MODULE_0__.createElement(Container,_extends({animationSize},props),t8,t9),$[22]=animationSize,$[23]=props,$[24]=t8,$[25]=t9,$[26]=t10):t10=$[26],t10}},"./packages/media/src/formatMsToHMS.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _formatDuration__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/media/src/formatDuration.ts");const __WEBPACK_DEFAULT_EXPORT__=function formatMsToHMS(ms){if(!ms)return"00:00:00";let seconds=ms/1e3;const hours=Math.floor(seconds/3600);seconds%=3600;const minutes=Math.floor(seconds/60);return seconds%=60,`${(0,_formatDuration__WEBPACK_IMPORTED_MODULE_0__.A)(hours)}:${(0,_formatDuration__WEBPACK_IMPORTED_MODULE_0__.A)(minutes)}:${(0,_formatDuration__WEBPACK_IMPORTED_MODULE_0__.A)(seconds)}`}},"./packages/story-editor/src/app/highlights/styles.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var polished__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/polished/dist/polished.esm.js"),styled_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/design-system/src/theme/theme.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/design-system/src/theme/helpers/outline.ts");const flash=(0,styled_components__WEBPACK_IMPORTED_MODULE_0__.i7)(["50%{background-color:",";}"],(0,polished__WEBPACK_IMPORTED_MODULE_1__.B3)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__.w.colors.standard.white,.3)),FLASH=(0,styled_components__WEBPACK_IMPORTED_MODULE_0__.AH)(["background-color:",";animation:"," 0.3s ease-in-out 2;"],(0,polished__WEBPACK_IMPORTED_MODULE_1__.B3)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__.w.colors.standard.white,0),flash),__WEBPACK_DEFAULT_EXPORT__={OUTLINE:(0,styled_components__WEBPACK_IMPORTED_MODULE_0__.AH)(["",";"],_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_3__.g),FLASH}},"./packages/story-editor/src/app/story/utils/isEmptyStory.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/elements/src/index.ts");const __WEBPACK_DEFAULT_EXPORT__=pages=>{if(!(1===pages.length))return!1;if(!(1===pages[0].elements?.length))return!1;if(!pages[0].elements[0].isDefaultBackground)return!1;const hasPageAttachment=pages[0].pageAttachment?.url;if(hasPageAttachment)return!1;return!(!("color"in pages[0].backgroundColor)||!(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.bN)(_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_1__.jt.color,pages[0].backgroundColor.color))}},"./packages/story-editor/src/components/canvas/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>canvas_canvas,dr:()=>useInsertElement.A,On:()=>canvas_useInsertTextSet});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),app=__webpack_require__("./packages/story-editor/src/app/index.js"),constants=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/story-editor/src/constants/index.ts")),directionAware=__webpack_require__("./packages/story-editor/src/components/directionAware/index.js"),floatingMenu_constants=__webpack_require__("./packages/story-editor/src/components/floatingMenu/constants.js"),menu=__webpack_require__("./packages/story-editor/src/components/floatingMenu/menu.js");const floatingMenu_layer=function FloatingMenuLayer(){const{setMoveableMount,isEyedropperActive,floatingMenuPosition,displayFloatingMenu}=(0,app.yu)((({actions,state})=>({setMoveableMount:actions.setMoveableMount,isEyedropperActive:state.isEyedropperActive,floatingMenuPosition:state.floatingMenuPosition,displayFloatingMenu:state.displayFloatingMenu}))),{workspaceWidth:workspaceWidth_0,workspaceHeight:workspaceHeight_0}=(0,app.gK)((({state:{workspaceWidth,workspaceHeight}})=>({workspaceWidth,workspaceHeight}))),{selectedElementType,selectionIdentifier}=(0,app.P3)((({state:{selectedElements}})=>({selectedElementType:1!==selectedElements.length||selectedElements[0].isBackground?selectedElements.length>1?floatingMenu_constants.$7.MULTIPLE:floatingMenu_constants.$7.NONE:selectedElements[0]?.type,selectionIdentifier:selectedElements.map((({id})=>id)).join("")}))),isAnythingTransforming=(0,app.Gy)((({state:state_0})=>state_0.isAnythingTransforming)),[moveable,setMoveable]=(0,src.J0)(null),menuRef=(0,src.li)(),workspaceSizeRef=(0,src.li)(),[isDismissed,setDismissed]=(0,src.J0)(!1),handleDismiss=(0,src.hb)((()=>setDismissed(!0)),[]);(0,src.vJ)((()=>setDismissed(!1)),[selectionIdentifier]),(0,src.vJ)((()=>(setMoveableMount((()=>setMoveable)),()=>setMoveableMount(null))),[setMoveableMount]),(0,src.vJ)((()=>{setDismissed(!!isEyedropperActive)}),[isEyedropperActive]),(0,src.vJ)((()=>{workspaceSizeRef.current={width:workspaceWidth_0,height:workspaceHeight_0}}),[workspaceWidth_0,workspaceHeight_0]);const hasMenu=(0,floatingMenu_constants.iN)(selectedElementType)&&!isDismissed&&moveable&&!(!1===displayFloatingMenu);return(0,src.vJ)((()=>{const menu=menuRef.current;if(!menu||!moveable)return;const updatePosition=()=>{const frameRect=moveable.getRect(),{width,height}=workspaceSizeRef.current;if(floatingMenuPosition===floatingMenu_constants.Vd.TOP)menu.style.left=`clamp(0px, ${width/2}px - (var(--width) / 2), ${width}px - var(--width))`,menu.style.top=`clamp(0px, ${constants.uF}px, ${height}px - var(--height))`;else{const centerX=frameRect.left+frameRect.width/2;menu.style.left=`clamp(0px, ${centerX}px - (var(--width) / 2), ${width}px - var(--width))`;const bottomX=frameRect.top+frameRect.height+constants.Bt;menu.style.top=`clamp(0px, ${bottomX}px, ${height}px - var(--height))`}};updatePosition();const observer=new MutationObserver(updatePosition),node=document.querySelector(".moveable-control-box");return observer.observe(node,{attributes:!0,subtree:!0,attributeFilter:["style"]}),()=>observer.disconnect()}),[moveable,hasMenu,floatingMenuPosition]),!!hasMenu&&react.createElement(directionAware.A,null,react.createElement(menu.A,{ref:menuRef,handleDismiss,selectedElementType,selectionIdentifier,visuallyHidden:isAnythingTransforming}))};var mediaRecording=__webpack_require__("./packages/story-editor/src/components/mediaRecording/index.js"),keyboard=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx")),moveable_src=__webpack_require__("./packages/moveable/src/index.ts"),elements_src=__webpack_require__("./packages/elements/src/index.ts"),propTypes=__webpack_require__("./packages/story-editor/src/propTypes.js"),zIndex=__webpack_require__("./packages/story-editor/src/constants/zIndex.ts"),useVideoTrim=__webpack_require__("./packages/story-editor/src/components/videoTrim/useVideoTrim.js"),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),button_constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),getVideoLengthDisplay=__webpack_require__("./packages/media/src/getVideoLengthDisplay.ts"),useLayout=__webpack_require__("./packages/story-editor/src/app/layout/useLayout.ts"),useFocusTrapping=__webpack_require__("./packages/story-editor/src/utils/useFocusTrapping.js");var getMediaSizePositionProps=__webpack_require__("./packages/media/src/getMediaSizePositionProps.ts"),preloadVideo=__webpack_require__("./packages/media/src/preloadVideo.ts"),seekVideo=__webpack_require__("./packages/media/src/seekVideo.ts");const CACHE=new Map;const videoTrim_generateVideoStrip=async function generateVideoStrip(element,resource,stripWidth,stripHeight){const{width:frameWidth,height:frameHeight,scale,focalX,focalY,flip}=element,{src,length}=resource,cacheKey=JSON.stringify([src,stripWidth,stripHeight,scale,focalX,focalY,flip,frameWidth,frameHeight]);if(CACHE.has(cacheKey))return CACHE.get(cacheKey);const stripFrameHeight=stripHeight,stripFrameWidth=stripFrameHeight/frameHeight*frameWidth,frameCount=Math.ceil(stripWidth/stripFrameWidth),actualStripFrameWidth=stripWidth/frameCount,actualFrameWidth=actualStripFrameWidth/stripFrameWidth*frameWidth,{width:videoWidth,height:videoHeight,offsetX,offsetY}=(0,getMediaSizePositionProps.A)(resource,actualFrameWidth,frameHeight,scale,flip?.horizontal?100-focalX:focalX,flip?.vertical?100-focalY:focalY),frameDistance=length/(frameCount-1),video=await(0,preloadVideo.A)(src);video.width=videoWidth,video.height=videoHeight,await(0,seekVideo.A)(video,1e-6);const canvas=document.createElement("canvas");canvas.width=stripWidth,canvas.height=stripHeight;const ctx=canvas.getContext("2d");if(!ctx)return Promise.resolve(null);let timeOffset=0,frame=0;const grabFrame=async()=>{await(0,seekVideo.A)(video,timeOffset);const dx=frame*actualStripFrameWidth;return(flip.vertical||flip.horizontal)&&(ctx.translate(dx+actualStripFrameWidth/2,stripFrameHeight/2),ctx.scale(flip.horizontal?-1:1,flip.vertical?-1:1),ctx.translate(-(dx+actualStripFrameWidth/2),-stripFrameHeight/2)),ctx.drawImage(video,offsetX,offsetY,actualFrameWidth,frameHeight,dx,0,actualStripFrameWidth,stripFrameHeight),ctx.setTransform(1,0,0,1,0,0),frame+=1,frame===frameCount?Promise.resolve():(timeOffset+=frameDistance,grabFrame())};return grabFrame().then((()=>{const finalStrip=canvas.toDataURL();return CACHE.set(cacheKey,finalStrip),finalStrip}))};const videoTrim_useRailBackground=function useRailBackground(isReady,videoData,railWidth){const $=(0,dist.c)(9),[railBackgroundImage,setRailBackgroundImage]=(0,src.J0)(null);let t0,t1;return $[0]!==isReady||$[1]!==railWidth||$[2]!==setRailBackgroundImage||$[3]!==videoData?(t0=()=>{if(!isReady)return;const{element,resource}=videoData;videoTrim_generateVideoStrip(element,resource,railWidth,36).then(setRailBackgroundImage)},$[0]=isReady,$[1]=railWidth,$[2]=setRailBackgroundImage,$[3]=videoData,$[4]=t0):t0=$[4],$[5]!==isReady||$[6]!==railWidth||$[7]!==videoData?(t1=[isReady,videoData,railWidth],$[5]=isReady,$[6]=railWidth,$[7]=videoData,$[8]=t1):t1=$[8],(0,src.vJ)(t0,t1),railBackgroundImage};var noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const Thumb=styled_components_browser_esm.Ay.button.withConfig({displayName:"slider__Thumb",componentId:"sc-50zvue-0"})(["position:absolute;padding:0;"]);function getPageX(evt){return evt.pageX||evt.clientX}function Slider(t0){const $=(0,dist.c)(62);let max,min,railWidth,rest,step,t1,t2,t3,t4,t5,t6;$[0]!==t0?(({railWidth,min,max,step,minorStep:t1,value:t2,onChange:t3,getValueText:t4,onPointerDown:t5,onNudge:t6,...rest}=t0),$[0]=t0,$[1]=max,$[2]=min,$[3]=railWidth,$[4]=rest,$[5]=step,$[6]=t1,$[7]=t2,$[8]=t3,$[9]=t4,$[10]=t5,$[11]=t6):(max=$[1],min=$[2],railWidth=$[3],rest=$[4],step=$[5],t1=$[6],t2=$[7],t3=$[8],t4=$[9],t5=$[10],t6=$[11]);const minorStep=void 0===t1?null:t1,value=void 0===t2?0:t2,onChange=void 0===t3?noop.l:t3,getValueText=void 0===t4?null:t4,onPointerDown=void 0===t5?noop.l:t5,onNudge=void 0===t6?noop.l:t6,ref=(0,src.li)();let t7,t8;$[12]!==max||$[13]!==min||$[14]!==onChange||$[15]!==onPointerDown||$[16]!==railWidth||$[17]!==ref.current||$[18]!==value?(t7=downEvent=>{downEvent.preventDefault(),downEvent.stopPropagation(),ref.current.focus(),onPointerDown?.();const handlePointerMove=event=>{const deltaX=getPageX(event)-getPageX(downEvent);onChange(value+deltaX/railWidth*(max-min)),event.preventDefault(),event.stopPropagation()},handlePointerUp=()=>{document.removeEventListener("pointermove",handlePointerMove),document.removeEventListener("pointerup",handlePointerUp)};return document.addEventListener("pointermove",handlePointerMove),document.addEventListener("pointerup",handlePointerUp),handlePointerUp},$[12]=max,$[13]=min,$[14]=onChange,$[15]=onPointerDown,$[16]=railWidth,$[17]=ref.current,$[18]=value,$[19]=t7):t7=$[19],$[20]!==max||$[21]!==min||$[22]!==onChange||$[23]!==onPointerDown||$[24]!==railWidth||$[25]!==value?(t8=[value,max,min,onChange,railWidth,onPointerDown],$[20]=max,$[21]=min,$[22]=onChange,$[23]=onPointerDown,$[24]=railWidth,$[25]=value,$[26]=t8):t8=$[26];const handlePointerDown=(0,src.hb)(t7,t8);let t10,t9;$[27]!==onChange||$[28]!==onNudge||$[29]!==value?(t9=delta=>{onChange(value+delta),onNudge?.()},t10=[onChange,onNudge,value],$[27]=onChange,$[28]=onNudge,$[29]=value,$[30]=t10,$[31]=t9):(t10=$[30],t9=$[31]);const handleNudge=(0,src.hb)(t9,t10);let t11,t12,t13,t14,t15,t16,t17,t18;$[32]!==handleNudge||$[33]!==step?(t11=()=>handleNudge(-step),t12=[handleNudge,step],$[32]=handleNudge,$[33]=step,$[34]=t11,$[35]=t12):(t11=$[34],t12=$[35]),(0,keyboard._h)(ref,"left",t11,t12),$[36]!==handleNudge||$[37]!==minorStep?(t13=()=>handleNudge(-minorStep),t14=[handleNudge,minorStep],$[36]=handleNudge,$[37]=minorStep,$[38]=t13,$[39]=t14):(t13=$[38],t14=$[39]),(0,keyboard._h)(ref,"shift+left",t13,t14),$[40]!==handleNudge||$[41]!==step?(t15=()=>handleNudge(step),t16=[handleNudge,step],$[40]=handleNudge,$[41]=step,$[42]=t15,$[43]=t16):(t15=$[42],t16=$[43]),(0,keyboard._h)(ref,"right",t15,t16),$[44]!==handleNudge||$[45]!==minorStep?(t17=()=>handleNudge(minorStep),t18=[handleNudge,minorStep],$[44]=handleNudge,$[45]=minorStep,$[46]=t17,$[47]=t18):(t17=$[46],t18=$[47]),(0,keyboard._h)(ref,"shift+right",t17,t18);const cssValue=`${((value-min)/(max-min)*railWidth).toFixed(2)}px`;let t19;$[48]!==cssValue?(t19={left:cssValue},$[48]=cssValue,$[49]=t19):t19=$[49];const sliderStyle=t19;let t20,t21;return $[50]!==getValueText||$[51]!==value?(t20=getValueText?.(value),$[50]=getValueText,$[51]=value,$[52]=t20):t20=$[52],$[53]!==handlePointerDown||$[54]!==max||$[55]!==min||$[56]!==ref||$[57]!==rest||$[58]!==sliderStyle||$[59]!==t20||$[60]!==value?(t21=react.createElement(Thumb,_extends({ref,onPointerDown:handlePointerDown,style:sliderStyle,role:"slider","aria-valuemin":min,"aria-valuemax":max,"aria-valuenow":value,"aria-valuetext":t20},rest)),$[53]=handlePointerDown,$[54]=max,$[55]=min,$[56]=ref,$[57]=rest,$[58]=sliderStyle,$[59]=t20,$[60]=value,$[61]=t21):t21=$[61],t21}Slider.propTypes={railWidth:prop_types_default().number.isRequired,min:prop_types_default().number.isRequired,max:prop_types_default().number.isRequired,step:prop_types_default().number.isRequired,minorStep:prop_types_default().number.isRequired,value:prop_types_default().number,onChange:prop_types_default().func,getValueText:prop_types_default().func,onPointerDown:prop_types_default().func,onNudge:prop_types_default().func};const slider=Slider;function currentTime_extends(){return currentTime_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},currentTime_extends.apply(null,arguments)}const StyledSlider=(0,styled_components_browser_esm.Ay)(slider).withConfig({displayName:"currentTime__StyledSlider",componentId:"sc-tf91kz-0"})(["top:-3px;bottom:-3px;width:6px;margin-left:-3px;border-radius:6px;border-width:0;background-color:",";box-shadow:0px 1px 2px rgba(60,64,67,0.3),0px 1px 3px 1px rgba(60,64,67,0.15);"],(({theme})=>theme.colors.interactiveBg.primaryNormal));function _temp(t0){const{state:t1}=t0,{currentTime}=t1;return currentTime}const currentTime=function CurrentTime(props){const $=(0,dist.c)(4),currentTime_0=(0,useVideoTrim.A)(_temp);let t0,t1;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=(0,i18n.__)("Current time","web-stories"),$[0]=t0):t0=$[0],$[1]!==currentTime_0||$[2]!==props?(t1=react.createElement(StyledSlider,currentTime_extends({"aria-label":t0,value:currentTime_0,disabled:!0},props)),$[1]=currentTime_0,$[2]=props,$[3]=t1):t1=$[3],t1};var typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts");const Menu=styled_components_browser_esm.Ay.aside.withConfig({displayName:"trimmerComponents__Menu",componentId:"sc-1vmlktu-0"})(["display:flex;justify-content:center;align-items:flex-start;height:","px;gap:14px;"],40),RailWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"trimmerComponents__RailWrapper",componentId:"sc-1vmlktu-1"})(["display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-end;"]),Rail=styled_components_browser_esm.Ay.div.withConfig({displayName:"trimmerComponents__Rail",componentId:"sc-1vmlktu-2"})(["position:relative;width:","px;height:","px;border-radius:4px;border:1px solid ",";background-color:",";"],(({width})=>width),36,(({theme})=>theme.colors.standard.white),(({theme})=>theme.colors.standard.white));function Duration(t0){const $=(0,dist.c)(2),{children}=t0;let t1;return $[0]!==children?(t1=react.createElement(typography_text.E.Span,{size:types.$.XSmall},children),$[0]=children,$[1]=t1):t1=$[1],t1}Duration.propTypes={children:prop_types_default().node};const Handle=(0,styled_components_browser_esm.Ay)(slider).withConfig({displayName:"trimmerComponents__Handle",componentId:"sc-1vmlktu-3"})(["top:6px;bottom:6px;width:6px;margin-left:-3px;border-radius:6px;background-color:",";border:1px solid ",";box-shadow:0px 1px 2px rgba(60,64,67,0.3),0px 1px 3px 1px rgba(60,64,67,0.15);cursor:col-resize;&:focus{border-color:",";}&:focus-visible{outline:none !important;}"],(({theme})=>theme.colors.bg.primary),(({theme})=>theme.colors.border.defaultNormal),(({theme})=>theme.colors.border.focus)),SVG=styled_components_browser_esm.Ay.svg.withConfig({displayName:"trimmerComponents__SVG",componentId:"sc-1vmlktu-4"})(["position:absolute;top:-1px;"]),ButtonWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"trimmerComponents__ButtonWrapper",componentId:"sc-1vmlktu-5"})(["flex-grow:1;flex-basis:100px;display:flex;justify-content:",";"],(({isStart})=>isStart?"flex-end":"flex-start"));function Scrim(t0){const $=(0,dist.c)(11),{width,isLeftAligned:t1}=t0,isLeftAligned=void 0!==t1&&t1;let t2;$[0]!==isLeftAligned?(t2=isLeftAligned?{left:"-1px"}:{right:"-1px"},$[0]=isLeftAligned,$[1]=t2):t2=$[1];const floatStyle=t2,path=isLeftAligned?`M 4 0 h ${width} a 4 4 0 0 0 -4 4 v 28 a 4 4 0 0 0 4 4 h -${width} a 4 4 0 0 1 -4 -4 v -28 a 4 4 0 0 1 4 -4 Z`:`M 0 0 h ${width} a 4 4 0 0 1 4 4 v 28 a 4 4 0 0 1 -4 4 h -${width} a 4 4 0 0 0 4 -4 v -28 a 4 4 0 0 0 -4 -4 Z`,t3=`${width+4}px`;let t4;$[2]!==floatStyle||$[3]!==t3?(t4={width:t3,...floatStyle},$[2]=floatStyle,$[3]=t3,$[4]=t4):t4=$[4];const t5=`0 0 ${width+4} 36`;let t6,t7;return $[5]!==path?(t6=react.createElement("path",{stroke:"transparent",fill:"black",fillOpacity:"0.5",d:path}),$[5]=path,$[6]=t6):t6=$[6],$[7]!==t4||$[8]!==t5||$[9]!==t6?(t7=react.createElement(SVG,{style:t4,viewBox:t5},t6),$[7]=t4,$[8]=t5,$[9]=t6,$[10]=t7):t7=$[10],t7}function videoTrimmer_extends(){return videoTrimmer_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},videoTrimmer_extends.apply(null,arguments)}Scrim.propTypes={width:prop_types_default().number.isRequired,isLeftAligned:prop_types_default().bool};function _temp3(node){node&&node.focus()}function _temp2(t0){const{state:t1}=t0,{workspaceWidth,pageWidth}=t1;return{workspaceWidth,pageWidth}}function videoTrimmer_temp(t0){const{state:t1,actions:t2}=t0,{startOffset,endOffset,maxOffset,hasChanged,videoData}=t1,{setStartOffset,setEndOffset,performTrim,toggleTrimMode,setIsDraggingHandles}=t2;return{startOffset,endOffset,maxOffset,setStartOffset,setEndOffset,hasChanged,performTrim,setIsDraggingHandles,toggleTrimMode,videoData}}const videoTrimmer=function VideoTrimmer(){const $=(0,dist.c)(74),{startOffset:startOffset_0,endOffset:endOffset_0,maxOffset:maxOffset_0,setStartOffset:setStartOffset_0,setEndOffset:setEndOffset_0,hasChanged:hasChanged_0,performTrim:performTrim_0,setIsDraggingHandles:setIsDraggingHandles_0,toggleTrimMode:toggleTrimMode_0,videoData:videoData_0}=(0,useVideoTrim.A)(videoTrimmer_temp),{workspaceWidth:workspaceWidth_0,pageWidth:pageWidth_0}=(0,useLayout.A)(_temp2);let t0;$[0]!==setIsDraggingHandles_0?(t0=()=>setIsDraggingHandles_0(!1),$[0]=setIsDraggingHandles_0,$[1]=t0):t0=$[1];const debouncedNudge=(0,src.YQ)(t0,1e3),menu=(0,src.li)(null);let t1,t2;$[2]!==menu?(t1={ref:menu},$[2]=menu,$[3]=t1):t1=$[3],(0,useFocusTrapping.A)(t1),$[4]===Symbol.for("react.memo_cache_sentinel")?(t2=[],$[4]=t2):t2=$[4];const setCancelRef=(0,src.hb)(_temp3,t2),railWidth=Math.min(pageWidth_0,workspaceWidth_0-260),isReady=pageWidth_0&&maxOffset_0&&videoData_0,railBackgroundImage=videoTrim_useRailBackground(isReady,videoData_0,railWidth);let t3,t4;$[5]===Symbol.for("react.memo_cache_sentinel")?(t3=(0,i18n.__)("Video trimmer","web-stories"),$[5]=t3):t3=$[5],$[6]!==menu?(t4={ref:menu,"aria-label":t3},$[6]=menu,$[7]=t4):t4=$[7];const menuProps=t4;if(!isReady){let t5;return $[8]!==menuProps?(t5=react.createElement(Menu,menuProps),$[8]=menuProps,$[9]=t5):t5=$[9],t5}let t5,t6,t7,t8;$[10]!==setIsDraggingHandles_0?(t5=()=>setIsDraggingHandles_0(!0),t6=()=>setIsDraggingHandles_0(!1),$[10]=setIsDraggingHandles_0,$[11]=t5,$[12]=t6):(t5=$[11],t6=$[12]),$[13]!==debouncedNudge||$[14]!==setIsDraggingHandles_0?(t7=()=>{setIsDraggingHandles_0(!0),debouncedNudge()},$[13]=debouncedNudge,$[14]=setIsDraggingHandles_0,$[15]=t7):t7=$[15],$[16]!==maxOffset_0||$[17]!==t5||$[18]!==t6||$[19]!==t7?(t8={min:0,max:maxOffset_0,step:100,minorStep:10,onPointerDown:t5,onPointerUp:t6,onNudge:t7},$[16]=maxOffset_0,$[17]=t5,$[18]=t6,$[19]=t7,$[20]=t8):t8=$[20];const sliderProps=t8;let t9,t10;$[21]===Symbol.for("react.memo_cache_sentinel")?(t9=(0,i18n.__)("Cancel","web-stories"),$[21]=t9):t9=$[21],$[22]!==setCancelRef||$[23]!==toggleTrimMode_0?(t10=react.createElement(ButtonWrapper,{isStart:!0},react.createElement(button_button.$,{variant:button_constants.Ak.Rectangle,type:button_constants.VQ.Secondary,size:button_constants.Mp.Small,onClick:toggleTrimMode_0,ref:setCancelRef},t9)),$[22]=setCancelRef,$[23]=toggleTrimMode_0,$[24]=t10):t10=$[24];const t11=railBackgroundImage?`url(${railBackgroundImage})`:void 0;let t12;$[25]!==t11?(t12={backgroundImage:t11},$[25]=t11,$[26]=t12):t12=$[26];const t13=startOffset_0/maxOffset_0*railWidth;let t14;$[27]!==t13?(t14=react.createElement(Scrim,{isLeftAligned:!0,width:t13}),$[27]=t13,$[28]=t14):t14=$[28];const t15=(maxOffset_0-endOffset_0)/maxOffset_0*railWidth;let t16,t17,t18,t19,t20,t21,t22,t23,t24;$[29]!==t15?(t16=react.createElement(Scrim,{width:t15}),$[29]=t15,$[30]=t16):t16=$[30],$[31]!==railWidth||$[32]!==sliderProps?(t17=react.createElement(currentTime,videoTrimmer_extends({railWidth},sliderProps)),$[31]=railWidth,$[32]=sliderProps,$[33]=t17):t17=$[33],$[34]===Symbol.for("react.memo_cache_sentinel")?(t18=(0,i18n.__)("Start offset","web-stories"),$[34]=t18):t18=$[34],$[35]!==setStartOffset_0?(t19=val=>setStartOffset_0(val),$[35]=setStartOffset_0,$[36]=t19):t19=$[36],$[37]!==railWidth||$[38]!==sliderProps||$[39]!==startOffset_0||$[40]!==t19?(t20=react.createElement(Handle,videoTrimmer_extends({railWidth,value:startOffset_0,"aria-label":t18,onChange:t19},sliderProps)),$[37]=railWidth,$[38]=sliderProps,$[39]=startOffset_0,$[40]=t19,$[41]=t20):t20=$[41],$[42]===Symbol.for("react.memo_cache_sentinel")?(t21=(0,i18n.__)("End offset","web-stories"),$[42]=t21):t21=$[42],$[43]!==setEndOffset_0?(t22=val_0=>setEndOffset_0(val_0),$[43]=setEndOffset_0,$[44]=t22):t22=$[44],$[45]!==endOffset_0||$[46]!==railWidth||$[47]!==sliderProps||$[48]!==t22?(t23=react.createElement(Handle,videoTrimmer_extends({railWidth,value:endOffset_0,"aria-label":t21,onChange:t22},sliderProps)),$[45]=endOffset_0,$[46]=railWidth,$[47]=sliderProps,$[48]=t22,$[49]=t23):t23=$[49],$[50]!==railWidth||$[51]!==t12||$[52]!==t14||$[53]!==t16||$[54]!==t17||$[55]!==t20||$[56]!==t23?(t24=react.createElement(Rail,{width:railWidth,style:t12},t14,t16,t17,t20,t23),$[50]=railWidth,$[51]=t12,$[52]=t14,$[53]=t16,$[54]=t17,$[55]=t20,$[56]=t23,$[57]=t24):t24=$[57];const t25=Math.ceil((endOffset_0-startOffset_0)/1e3);let t26,t27,t28;$[58]!==t25?(t26=(0,getVideoLengthDisplay.A)(t25),$[58]=t25,$[59]=t26):t26=$[59],$[60]!==t26?(t27=react.createElement(Duration,null,t26),$[60]=t26,$[61]=t27):t27=$[61],$[62]!==t24||$[63]!==t27?(t28=react.createElement(RailWrapper,null,t24,t27),$[62]=t24,$[63]=t27,$[64]=t28):t28=$[64];const t29=!hasChanged_0;let t30,t31,t32;return $[65]===Symbol.for("react.memo_cache_sentinel")?(t30=(0,i18n.__)("Trim","web-stories"),$[65]=t30):t30=$[65],$[66]!==performTrim_0||$[67]!==t29?(t31=react.createElement(ButtonWrapper,null,react.createElement(button_button.$,{variant:button_constants.Ak.Rectangle,type:button_constants.VQ.Primary,size:button_constants.Mp.Small,onClick:performTrim_0,disabled:t29},t30)),$[66]=performTrim_0,$[67]=t29,$[68]=t31):t31=$[68],$[69]!==menuProps||$[70]!==t10||$[71]!==t28||$[72]!==t31?(t32=react.createElement(Menu,menuProps,t10,t28,t31),$[69]=menuProps,$[70]=t10,$[71]=t28,$[72]=t31,$[73]=t32):t32=$[73],t32};var useUnits=__webpack_require__("./packages/units/src/useUnits.ts"),animation_src=__webpack_require__("./packages/animation/src/index.ts"),element_library_src=__webpack_require__("./packages/element-library/src/index.ts"),useCORSProxy=__webpack_require__("./packages/story-editor/src/utils/useCORSProxy.ts");function editElement_extends(){return editElement_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},editElement_extends.apply(null,arguments)}const Z_INDEX_CANVAS={FLOAT_PANEL:11},Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"editElement__Wrapper",componentId:"sc-1w8k2uc-0"})([""," "," "," pointer-events:initial;"],element_library_src.AV,element_library_src.WZ,element_library_src.TH),EditElement=(0,src.ph)((0,src.Rf)((function EditElement(t0,ref){const $=(0,dist.c)(33),{element,editWrapper,onResize}=t0,{id,type}=element,{getBox,getBoxWithBorder}=(0,useUnits.A)(editElement_temp),{getProxiedUrl}=(0,useCORSProxy.A)(),{isRTL,styleConstants:t1}=(0,app.UK)();let t2;$[0]!==t1?(t2=void 0===t1?{}:t1,$[0]=t1,$[1]=t2):t2=$[1];const{topOffset}=t2,{actions:t3}=(0,app.Ln)(),{maybeEnqueueFontStyle}=t3,{updateElementById,deleteSelectedElements}=(0,app.P3)(editElement_temp2),{isTrimMode:isTrimMode_0,resource,setVideoNode:setVideoNode_0}=(0,useVideoTrim.A)(editElement_temp3),[localProperties,setLocalProperties]=(0,src.J0)(null);let t4;$[2]!==type?(t4=(0,elements_src.zh)(type),$[2]=type,$[3]=t4):t4=$[3];const{Edit}=t4;let t5;$[4]!==element||$[5]!==localProperties?(t5=localProperties?{...element,...localProperties}:element,$[4]=element,$[5]=localProperties,$[6]=t5):t5=$[6];const elementWithLocal=t5,isText="text"===type;let t6;$[7]!==elementWithLocal||$[8]!==getBox||$[9]!==getBoxWithBorder||$[10]!==isText?(t6=isText?getBoxWithBorder(elementWithLocal):getBox(elementWithLocal),$[7]=elementWithLocal,$[8]=getBox,$[9]=getBoxWithBorder,$[10]=isText,$[11]=t6):t6=$[11];const editBox=t6,t7=`layer-${id}`;let t8,t9;return $[12]!==Edit||$[13]!==deleteSelectedElements||$[14]!==editBox||$[15]!==editWrapper||$[16]!==elementWithLocal||$[17]!==getProxiedUrl||$[18]!==isRTL||$[19]!==isTrimMode_0||$[20]!==maybeEnqueueFontStyle||$[21]!==onResize||$[22]!==resource||$[23]!==setLocalProperties||$[24]!==setVideoNode_0||$[25]!==topOffset||$[26]!==updateElementById?(t8=react.createElement(Edit,{element:elementWithLocal,box:editBox,editWrapper,onResize,setLocalProperties,getProxiedUrl,isRTL,topOffset,isTrimMode:isTrimMode_0,resource,setVideoNode:setVideoNode_0,updateElementById,deleteSelectedElements,maybeEnqueueFontStyle,zIndexCanvas:Z_INDEX_CANVAS,scaleMin:animation_src.UD,scaleMax:animation_src.oQ}),$[12]=Edit,$[13]=deleteSelectedElements,$[14]=editBox,$[15]=editWrapper,$[16]=elementWithLocal,$[17]=getProxiedUrl,$[18]=isRTL,$[19]=isTrimMode_0,$[20]=maybeEnqueueFontStyle,$[21]=onResize,$[22]=resource,$[23]=setLocalProperties,$[24]=setVideoNode_0,$[25]=topOffset,$[26]=updateElementById,$[27]=t8):t8=$[27],$[28]!==editBox||$[29]!==ref||$[30]!==t7||$[31]!==t8?(t9=react.createElement(Wrapper,editElement_extends({"aria-labelledby":t7},editBox,{ref}),t8),$[28]=editBox,$[29]=ref,$[30]=t7,$[31]=t8,$[32]=t9):t9=$[32],t9})));EditElement.propTypes={element:prop_types_default().object.isRequired,editWrapper:prop_types_default().object,onResize:prop_types_default().func};const editElement=EditElement;function editElement_temp(state){return{getBox:state.actions.getBox,getBoxWithBorder:state.actions.getBoxWithBorder}}function editElement_temp2(state_0){return{updateElementById:state_0.actions.updateElementById,deleteSelectedElements:state_0.actions.deleteSelectedElements}}function editElement_temp3(t0){const{state:t1,actions:t2}=t0,{isTrimMode,videoData}=t1,{setVideoNode}=t2;return{isTrimMode,setVideoNode,resource:videoData?.resource}}var generatePatternStyles=__webpack_require__("./packages/patterns/src/generatePatternStyles.ts"),src_constants=__webpack_require__("./packages/units/src/constants.ts"),theme_constants=__webpack_require__("./packages/design-system/src/theme/constants/index.ts");const NAVIGATION_BUTTON_WIDTH=theme_constants.i.ICON_SIZE,NAVIGATION_BUTTON_GUTTER=NAVIGATION_BUTTON_WIDTH+8,KEYBOARD_SHORTCUTS_WIDTH=theme_constants.i.ICON_SIZE+6+2,MAX_MENU_WIDTH=2*(theme_constants.i.LARGE_BUTTON_SIZE+2)+2*KEYBOARD_SHORTCUTS_WIDTH+16+16;function useFooterHeight_temp(t0){const{state:t1}=t0,{carouselState}=t1;return{carouselState}}const footer_useFooterHeight=function useFooterHeight(){const{carouselState:carouselState_0}=(0,app.gK)(useFooterHeight_temp);return carouselState_0===constants.Wc.Closed?52:136};var layout=__webpack_require__("./packages/story-editor/src/app/layout/index.ts");function usePinchToZoom_temp2(value){return Math.min(3,Math.max(.25,value-value%.25))}function usePinchToZoom_temp(t0){const{state:t1,actions:t2}=t0,{zoomLevel}=t1,{setZoomLevel}=t2;return{zoomLevel,setZoomLevel}}const canvas_usePinchToZoom=function usePinchToZoom(t0){const $=(0,dist.c)(10),{containerRef}=t0,{zoomLevel:zoomLevel_0,setZoomLevel:setZoomLevel_0}=(0,layout.g)(usePinchToZoom_temp);let t1;$[0]!==setZoomLevel_0?(t1=level=>setZoomLevel_0(level),$[0]=setZoomLevel_0,$[1]=t1):t1=$[1];const handleZoom=(0,src.YQ)(t1,25);let t2,t3;$[2]!==containerRef.current||$[3]!==handleZoom||$[4]!==zoomLevel_0?(t2=()=>{if(!containerRef.current)return;const clampZoomLevel=usePinchToZoom_temp2,onWheel=e=>{const{ctrlKey,deltaY}=e,node=containerRef.current.childNodes[0];if(ctrlKey&&node.contains(e.target)&&deltaY){handleZoom(clampZoomLevel(deltaY>0?zoomLevel_0-.25:zoomLevel_0+.25)),e.preventDefault()}},preventDefault=e_0=>{containerRef.current.childNodes[0].contains(e_0.target)&&e_0.preventDefault()},handleGestureChange=e_1=>{const node_1=containerRef.current.childNodes[0],{scale}=e_1;if(node_1.contains(e_1.target)&&scale){handleZoom(clampZoomLevel(scale<1?zoomLevel_0-.25:zoomLevel_0+.25)),e_1.preventDefault()}};return document.addEventListener("wheel",onWheel,{passive:!1}),document.addEventListener("gesturestart",preventDefault),document.addEventListener("gestureend",preventDefault),document.addEventListener("gesturechange",handleGestureChange),()=>{document.removeEventListener("wheel",onWheel,{passive:!1}),document.removeEventListener("gesturestart",preventDefault),document.removeEventListener("gestureend",preventDefault),document.removeEventListener("gesturechange",handleGestureChange)}},$[2]=containerRef.current,$[3]=handleZoom,$[4]=zoomLevel_0,$[5]=t2):t2=$[5],$[6]!==containerRef||$[7]!==handleZoom||$[8]!==zoomLevel_0?(t3=[containerRef,handleZoom,zoomLevel_0],$[6]=containerRef,$[7]=handleZoom,$[8]=zoomLevel_0,$[9]=t3):t3=$[9],(0,src.Nf)(t2,t3)};function layout_extends(){return layout_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},layout_extends.apply(null,arguments)}const PAGE_NAV_WIDTH=theme_constants.i.LARGE_BUTTON_SIZE+8,LayerGrid=styled_components_browser_esm.Ay.section.withConfig({displayName:"layout__LayerGrid",componentId:"sc-1n0mp4m-0"})(["pointer-events:",";position:absolute;top:0;left:0;right:0;bottom:0;"," display:grid;grid:'h h h h h h h' ","px '. . . t . . .' minmax(","px,1fr) 'p b . c . f n' var(--viewport-height-px) '. . . . . . .' 1fr 'w w w w w w w' ","px '. . . . . . .' ","px / 1fr var(--page-nav-width) var(--page-nav-gap) var(--viewport-width-px) var(--page-nav-gap) var(--page-nav-width) 1fr;height:100%;"],(({pointerEvents})=>pointerEvents),(({zIndex})=>"number"==typeof zIndex?`z-index: ${zIndex};`:""),constants.uF,constants.h1,(({footerHeight})=>footerHeight),16),Area=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__Area",componentId:"sc-1n0mp4m-1"})(["pointer-events:",";grid-area:",";overflow:",";position:relative;width:100%;height:100%;",";"],(({pointerEvents})=>pointerEvents),(({area})=>area),(({showOverflow})=>showOverflow?"visible":"hidden"),(({zIndex})=>void 0!==zIndex?`z-index: ${zIndex}`:null)),PageAreaContainer=(0,styled_components_browser_esm.Ay)(Area).attrs({area:"c"}).withConfig({displayName:"layout__PageAreaContainer",componentId:"sc-1n0mp4m-2"})(["position:relative;display:flex;justify-content:",";align-items:",";overflow:",";",""],(({hasHorizontalOverflow})=>hasHorizontalOverflow?"flex-start":"center"),(({hasVerticalOverflow})=>hasVerticalOverflow?"flex-start":"center"),(({showOverflow})=>showOverflow?"visible":"var(--overflow-x) var(--overflow-y)"),(({isControlled,hasVerticalOverflow,hasHorizontalOverflow,showOverflow})=>isControlled&&`\n      overflow: ${showOverflow?"visible":"hidden"};\n      width: calc(\n        100% - ${hasVerticalOverflow?theme_constants.i.SCROLLBAR_WIDTH:0}px\n      );\n      height: calc(\n        100% - ${hasHorizontalOverflow?theme_constants.i.SCROLLBAR_WIDTH:0}px\n      );\n    `)),PageTitleContainer=(0,styled_components_browser_esm.Ay)(Area).attrs({area:"t"}).withConfig({displayName:"layout__PageTitleContainer",componentId:"sc-1n0mp4m-3"})(["position:relative;display:flex;justify-content:center;align-items:center;"]),Layer=(0,src.Rf)((function Layer(t0,ref){const $=(0,dist.c)(8);let children,rest;$[0]!==t0?(({children,...rest}=t0),$[0]=t0,$[1]=children,$[2]=rest):(children=$[1],rest=$[2]);const footerHeight=footer_useFooterHeight();let t1;return $[3]!==children||$[4]!==footerHeight||$[5]!==ref||$[6]!==rest?(t1=react.createElement(LayerGrid,layout_extends({ref,footerHeight},rest),children),$[3]=children,$[4]=footerHeight,$[5]=ref,$[6]=rest,$[7]=t1):t1=$[7],t1}));Layer.propTypes={children:prop_types_default().node};const PaddedPage=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__PaddedPage",componentId:"sc-1n0mp4m-4"})(["padding:calc(0.5 * var(--page-padding-px));"]),PageClip=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__PageClip",componentId:"sc-1n0mp4m-5"})(["",""],(({hasHorizontalOverflow,hasVerticalOverflow})=>(hasHorizontalOverflow||hasVerticalOverflow)&&`\n      overflow: hidden;\n      width: ${hasHorizontalOverflow?"calc(var(--page-width-px) + var(--page-padding-px))":`calc(var(--viewport-width-px) - ${theme_constants.i.SCROLLBAR_WIDTH}px)`};\n      flex-basis: ${hasHorizontalOverflow?"calc(var(--page-width-px) + var(--page-padding-px))":`calc(var(--viewport-width-px) - ${theme_constants.i.SCROLLBAR_WIDTH}px)`};\n      height: ${hasVerticalOverflow?"calc(var(--fullbleed-height-px) + var(--page-padding-px))":`calc(var(--viewport-height-px) - ${theme_constants.i.SCROLLBAR_WIDTH}px)`};\n      flex-shrink: 0;\n      flex-grow: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    `)),FullbleedContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__FullbleedContainer",componentId:"sc-1n0mp4m-6"})([""," overflow:visible;position:relative;width:var(--page-width-px);height:var(--fullbleed-height-px);display:flex;justify-content:center;align-items:center;border-radius:5px;",";",""],(({background})=>(0,generatePatternStyles.A)(background)),(({isControlled})=>isControlled&&"\n      left: var(--scroll-left-px);\n      top: var(--scroll-top-px);\n    "),(({isBackgroundSelected,theme})=>isBackgroundSelected&&`\n      &:before {\n        content: '';\n        position: absolute;\n        top: -4px;\n        left: -4px;\n        right: -4px;\n        bottom: -4px;\n        border: ${theme.colors.border.selection} 1px solid;\n        border-radius: ${theme.borders.radius.medium};\n      }\n    `)),PageAreaWithoutOverflow=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__PageAreaWithoutOverflow",componentId:"sc-1n0mp4m-7"})(["overflow:",";position:relative;width:var(--page-width-px);height:var(--fullbleed-height-px);display:flex;justify-content:center;align-items:center;"],(({showOverflow})=>showOverflow?"initial":"hidden")),PageAreaSafeZone=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__PageAreaSafeZone",componentId:"sc-1n0mp4m-8"})(["width:var(--page-width-px);height:var(--page-height-px);overflow:visible;position:relative;"]),HeadArea=(0,styled_components_browser_esm.Ay)(Area).attrs({area:"h"}).withConfig({displayName:"layout__HeadArea",componentId:"sc-1n0mp4m-9"})([""]),NavArea=((0,styled_components_browser_esm.Ay)(Area).attrs({area:"m"}).withConfig({displayName:"layout__MenuArea",componentId:"sc-1n0mp4m-10"})([""]),(0,styled_components_browser_esm.Ay)(Area).withConfig({displayName:"layout__NavArea",componentId:"sc-1n0mp4m-11"})(["display:flex;align-items:center;justify-content:center;"])),NavPrevArea=(0,styled_components_browser_esm.Ay)(NavArea).attrs({area:"b"}).withConfig({displayName:"layout__NavPrevArea",componentId:"sc-1n0mp4m-12"})([""]),NavNextArea=(0,styled_components_browser_esm.Ay)(NavArea).attrs({area:"f"}).withConfig({displayName:"layout__NavNextArea",componentId:"sc-1n0mp4m-13"})([""]),PageBeforeArea=(0,styled_components_browser_esm.Ay)(Area).attrs({area:"p"}).withConfig({displayName:"layout__PageBeforeArea",componentId:"sc-1n0mp4m-14"})([""]),PageAfterArea=(0,styled_components_browser_esm.Ay)(Area).attrs({area:"n"}).withConfig({displayName:"layout__PageAfterArea",componentId:"sc-1n0mp4m-15"})([""]),PageMenuArea=styled_components_browser_esm.Ay.div.withConfig({displayName:"layout__PageMenuArea",componentId:"sc-1n0mp4m-16"})(["grid-area:c;position:absolute;right:calc(-24px + var(--page-padding-px));top:calc(0.5 * var(--page-padding-px));min-height:calc(100% - var(--page-padding-px));"]),FooterArea=(0,styled_components_browser_esm.Ay)(Area).attrs({area:"w",showOverflow:!0}).withConfig({displayName:"layout__FooterArea",componentId:"sc-1n0mp4m-17"})([""]);function layout_temp(t0){const{actions:t1}=t0,{setWorkspaceSize}=t1;return{setWorkspaceSize}}function layout_temp2(t0){const{state:t1}=t0,{pageWidth,pageHeight,pagePadding,viewportWidth,viewportHeight,hasPageNavigation,hasVerticalOverflow,hasHorizontalOverflow,scrollLeft,scrollTop}=t1;return{pageWidth,pageHeight,pagePadding,viewportWidth,viewportHeight,hasPageNavigation,hasVerticalOverflow,hasHorizontalOverflow,scrollLeft,scrollTop}}const PageArea=(0,src.Rf)((function PageArea({children,fullbleedRef:_fullbleedRef=null,fullBleedContainerLabel=(0,i18n.__)("Fullbleed area","web-stories"),overlay=[],background,isControlled=!1,className="",showOverflow=!1,isBackgroundSelected=!1,pageAreaRef=(0,src._3)(),withSafezone=!0,...rest},ref){const internalFullblledRef=(0,src.li)(),fullbleedRef=_fullbleedRef||internalFullblledRef,{hasVerticalOverflow:hasVerticalOverflow_0,hasHorizontalOverflow:hasHorizontalOverflow_0,zoomSetting:zoomSetting_0,scrollLeft:scrollLeft_0,scrollTop:scrollTop_0}=(0,app.gK)((({state:{hasVerticalOverflow,hasHorizontalOverflow,zoomSetting,scrollLeft,scrollTop}})=>({hasVerticalOverflow,hasHorizontalOverflow,zoomSetting,scrollLeft,scrollTop}))),scrollRef=(0,src.li)();scrollRef.current={top:scrollTop_0,left:scrollLeft_0},(0,src.vJ)((()=>{isControlled||(fullbleedRef.current.scrollTop=scrollRef.current.top,fullbleedRef.current.scrollLeft=scrollRef.current.left)}),[isControlled,zoomSetting_0,fullbleedRef]);const paddedRef=(0,src.li)(null);return canvas_usePinchToZoom({containerRef:paddedRef}),react.createElement(PageAreaContainer,layout_extends({showOverflow,isControlled,hasHorizontalOverflow:hasHorizontalOverflow_0,hasVerticalOverflow:hasVerticalOverflow_0,className,"data-scroll-container":!0},rest),react.createElement(PageClip,{hasHorizontalOverflow:hasHorizontalOverflow_0,hasVerticalOverflow:hasVerticalOverflow_0},react.createElement(PaddedPage,{ref:paddedRef},react.createElement(FullbleedContainer,{"aria-label":fullBleedContainerLabel,role:"region",ref:fullbleedRef,"data-testid":"fullbleed",background,isControlled,isBackgroundSelected},react.createElement(PageAreaWithoutOverflow,{ref:pageAreaRef,showOverflow},withSafezone?react.createElement(PageAreaSafeZone,{ref,"data-testid":"safezone"},children):children,overlay)))))}));var useFocusCanvas=__webpack_require__("./packages/story-editor/src/components/canvas/useFocusCanvas.ts"),classnames=__webpack_require__("./packages/story-editor/node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),transform_src=__webpack_require__("./packages/transform/src/index.ts"),masks_src=__webpack_require__("./packages/masks/src/index.ts"),objectWithout=__webpack_require__("./packages/story-editor/src/utils/objectWithout.ts"),useSnapping=__webpack_require__("./packages/story-editor/src/components/canvas/utils/useSnapping.js");const utils_useUpdateSelectionRectangle=function useUpdateSelectionRectangle(moveableRef,dependencies=[]){(0,src.vJ)((()=>{let mounted=!0;const update=()=>{mounted&&moveableRef.current?.updateRect?.()};update();const timeout=setTimeout(update);return()=>{mounted=!1,clearTimeout(timeout)}}),dependencies)};const canvas_useWindowResizeHandler=function useWindowResizeHandler(ref){const $=(0,dist.c)(4);let t0,t1;$[0]!==ref.current?(t0=()=>{const handleUpdateMoveable=()=>ref.current?.updateRect();return window.addEventListener("resize",handleUpdateMoveable),()=>{window.removeEventListener("resize",handleUpdateMoveable)}},$[0]=ref.current,$[1]=t0):t0=$[1],$[2]!==ref?(t1=[ref],$[2]=ref,$[3]=t1):t1=$[3],(0,src.vJ)(t0,t1)};var dropTargets=__webpack_require__("./packages/story-editor/src/components/dropTargets/index.js"),isTargetOutOfContainer=__webpack_require__("./packages/story-editor/src/utils/isTargetOutOfContainer.ts");function useElementOutOfCanvas_temp3(t0){const{state:t1}=t0,{fullbleedContainer}=t1;return{fullbleedContainer}}function useElementOutOfCanvas_temp2(state_0){return{clearTransforms:state_0.actions.clearTransforms}}function useElementOutOfCanvas_temp(state){return{deleteSelectedElements:state.actions.deleteSelectedElements}}const utils_useElementOutOfCanvas=function useElementOutOfCanvas(){const $=(0,dist.c)(6),{deleteSelectedElements}=(0,app.P3)(useElementOutOfCanvas_temp),{clearTransforms}=(0,app.Gy)(useElementOutOfCanvas_temp2),{fullbleedContainer:fullbleedContainer_0}=(0,app.yu)(useElementOutOfCanvas_temp3);let t0;$[0]!==clearTransforms||$[1]!==deleteSelectedElements||$[2]!==fullbleedContainer_0?(t0=target=>!!(0,isTargetOutOfContainer.A)(target,fullbleedContainer_0)&&(deleteSelectedElements(),clearTransforms(),!0),$[0]=clearTransforms,$[1]=deleteSelectedElements,$[2]=fullbleedContainer_0,$[3]=t0):t0=$[3];const handleElementOutOfCanvas=t0;let t1;return $[4]!==handleElementOutOfCanvas?(t1={handleElementOutOfCanvas},$[4]=handleElementOutOfCanvas,$[5]=t1):t1=$[5],t1};var localStore=__webpack_require__("./packages/design-system/src/utils/localStore.ts"),useSnackbar=__webpack_require__("./packages/design-system/src/contexts/snackbar/useSnackbar.ts"),SAT=__webpack_require__("./node_modules/sat/SAT.js"),SAT_default=__webpack_require__.n(SAT),useElementPolygon=__webpack_require__("./packages/story-editor/src/utils/useElementPolygon.js");function useFullbleedMediaAsBackground_temp3(state_0){return{clearTransforms:state_0.actions.clearTransforms}}function useFullbleedMediaAsBackground_temp2(t0){const{state:t1}=t0,{fullbleedContainer}=t1;return{fullbleedContainer}}function useFullbleedMediaAsBackground_temp(state){return{setBackgroundElement:state.actions.setBackgroundElement,isDefaultBackground:state.state.currentPage?.elements[0]?.isDefaultBackground}}const utils_useFullbleedMediaAsBackground=function useFullbleedMediaAsBackground(){const $=(0,dist.c)(12);let t0;$[0]===Symbol.for("react.memo_cache_sentinel")?(t0=localStore.x.getItemByKey(localStore.$.BACKGROUND_IS_SET_DIALOG_DISMISSED),$[0]=t0):t0=$[0];const[isBackgroundSnackbarMessageDismissed,setIsBackgroundSnackbarMessageDismissed]=(0,src.J0)(t0),{setBackgroundElement,isDefaultBackground}=(0,app.P3)(useFullbleedMediaAsBackground_temp),{fullbleedContainer:fullbleedContainer_0}=(0,app.yu)(useFullbleedMediaAsBackground_temp2),{clearTransforms}=(0,app.Gy)(useFullbleedMediaAsBackground_temp3),{showSnackbar}=(0,useSnackbar.d)(),getElementPolygon=(0,useElementPolygon.A)();let t1;$[1]!==clearTransforms||$[2]!==fullbleedContainer_0||$[3]!==getElementPolygon||$[4]!==isBackgroundSnackbarMessageDismissed||$[5]!==isDefaultBackground||$[6]!==setBackgroundElement||$[7]!==setIsBackgroundSnackbarMessageDismissed||$[8]!==showSnackbar?(t1=selectedElement=>{if(isDefaultBackground&&elements_src.YO.includes(selectedElement.type)){const elPolygon=getElementPolygon(selectedElement),fullbleedBox=fullbleedContainer_0.getBoundingClientRect(),bgPolygon=new(SAT_default().Box)(new(SAT_default().Vector)(fullbleedBox.x+2,fullbleedBox.y+2),fullbleedBox.width-4,fullbleedBox.height-4).toPolygon(),response=new(SAT_default().Response);SAT_default().testPolygonPolygon(elPolygon,bgPolygon,response),response.bInA&&setBackgroundElement({elementId:selectedElement.id}),isBackgroundSnackbarMessageDismissed||(showSnackbar({message:(0,i18n.__)("Full bleed images and videos are automatically set as background. Double click to scale and position at any time.","web-stories"),dismissible:!0}),localStore.x.setItemByKey(localStore.$.BACKGROUND_IS_SET_DIALOG_DISMISSED,!0),setIsBackgroundSnackbarMessageDismissed(!0)),clearTransforms()}},$[1]=clearTransforms,$[2]=fullbleedContainer_0,$[3]=getElementPolygon,$[4]=isBackgroundSnackbarMessageDismissed,$[5]=isDefaultBackground,$[6]=setBackgroundElement,$[7]=setIsBackgroundSnackbarMessageDismissed,$[8]=showSnackbar,$[9]=t1):t1=$[9];const handleFullbleedMediaAsBackground=t1;let t2;return $[10]!==handleFullbleedMediaAsBackground?(t2={handleFullbleedMediaAsBackground},$[10]=handleFullbleedMediaAsBackground,$[11]=t2):t2=$[11],t2};const useDrag=function useSingleSelectionDrag({setIsDragging,resetMoveable,selectedElement,setTransformStyle,frame}){const{isDropSource:isDropSource_0,handleDrag:handleDrag_0,handleDrop:handleDrop_0,setDraggingResource:setDraggingResource_0}=(0,dropTargets.h)((({actions:{handleDrag,handleDrop,isDropSource,setDraggingResource}})=>({handleDrag,handleDrop,setDraggingResource,isDropSource}))),{handleElementOutOfCanvas}=utils_useElementOutOfCanvas(),{handleFullbleedMediaAsBackground}=utils_useFullbleedMediaAsBackground(),{updateSelectedElements}=(0,app.P3)((state=>({updateSelectedElements:state.actions.updateSelectedElements}))),{editorToDataX:editorToDataX_0,editorToDataY:editorToDataY_0}=(0,useUnits.A)((({actions:{editorToDataX,editorToDataY}})=>({editorToDataX,editorToDataY}))),resetDragging=(0,src.T0)((target=>{setIsDragging(!1),setDraggingResource_0(null),resetMoveable(target)}),[setIsDragging,setDraggingResource_0,resetMoveable]);return{onDrag:({target:target_0,beforeTranslate,clientX,clientY})=>{setIsDragging(!0),isDropSource_0(selectedElement.type)&&setDraggingResource_0(selectedElement.resource),frame.translate=beforeTranslate,setTransformStyle(target_0,frame),isDropSource_0(selectedElement.type)&&handleDrag_0(selectedElement.resource,clientX,clientY,selectedElement.id)},throttleDrag:0,onDragStart:({set})=>{set(frame.translate)},onDragEnd:({target:target_1,isDrag})=>{if(!isDrag)return!1;if(handleElementOutOfCanvas(target_1))return setIsDragging(!1),void setDraggingResource_0(null);const roundToZero=num=>Math.abs(num)<=1?0:num,[deltaX,deltaY]=frame.translate;let properties={};0===deltaX&&0===deltaY||(properties={x:roundToZero(selectedElement.x+editorToDataX_0(deltaX)),y:roundToZero(selectedElement.y+editorToDataY_0(deltaY))},updateSelectedElements({properties}),isDropSource_0(selectedElement.type)&&handleDrop_0(selectedElement.resource,selectedElement.id)),resetDragging(target_1),handleFullbleedMediaAsBackground({...selectedElement,...properties})}}},EMPTY_HANDLES=[],VERTICAL_HANDLES=["n","s"],HORIZONTAL_HANDLES=["e","w"],DIAGONAL_HANDLES=["nw","ne","sw","se"];function getRenderDirections({vertical,horizontal,diagonal}){return[...vertical?VERTICAL_HANDLES:EMPTY_HANDLES,...horizontal?HORIZONTAL_HANDLES:EMPTY_HANDLES,...diagonal?DIAGONAL_HANDLES:EMPTY_HANDLES]}const useResize=function useSingleSelectionResize({resetMoveable,selectedElement,setTransformStyle,frame,isEditMode,pushTransform,classNames,forceLockRatio}){const{updateSelectedElements}=(0,app.P3)((state=>({updateSelectedElements:state.actions.updateSelectedElements}))),{handleElementOutOfCanvas}=utils_useElementOutOfCanvas(),{handleFullbleedMediaAsBackground}=utils_useFullbleedMediaAsBackground(),{editorToDataX:editorToDataX_0,editorToDataY:editorToDataY_0,dataToEditorY:dataToEditorY_0,dataToEditorX:dataToEditorX_0}=(0,useUnits.A)((({actions:{editorToDataX,editorToDataY,dataToEditorY,dataToEditorX}})=>({editorToDataX,editorToDataY,dataToEditorY,dataToEditorX}))),{lockAspectRatio:elementLockRatio,type,border}=selectedElement,isText="text"===type,[isResizingFromCorner,setIsResizingFromCorner]=(0,src.J0)(!0),lockAspectRatio=!isText&&(forceLockRatio||elementLockRatio)||isText&&isResizingFromCorner,{resizeRules,updateForResizeEvent}=(0,elements_src.zh)(type),minWidth=dataToEditorX_0(resizeRules.minWidth),minHeight=dataToEditorY_0(resizeRules.minHeight),aspectRatio=selectedElement.width/selectedElement.height,{left=0,right=0,top=0,bottom=0}=border||{},visuallyHideHandles=selectedElement.width<=resizeRules.minWidth||selectedElement.height<=resizeRules.minHeight;return{onResize:({target,direction,width,height,drag})=>{let newWidth=width-(left+right),newHeight=height-(top+bottom),updates=null;lockAspectRatio?(newWidth<minWidth&&(newWidth=minWidth,newHeight=newWidth/aspectRatio),newHeight<minHeight&&(newHeight=minHeight,newWidth=minHeight*aspectRatio)):(newHeight=Math.max(newHeight,minHeight),newWidth=Math.max(newWidth,minWidth)),updateForResizeEvent&&(updates=updateForResizeEvent(selectedElement,direction,editorToDataX_0(newWidth,!1),editorToDataY_0(newHeight,!1))),updates&&updates.height&&(newHeight=dataToEditorY_0(updates.height)),updates&&updates.marginOffset&&(target.querySelector(".syncMargin").style.margin=-dataToEditorY_0(updates.marginOffset)/2+"px 0");const frameWidth=newWidth+left+right,frameHeight=newHeight+top+bottom;target.style.width=`${frameWidth}px`,target.style.height=`${frameHeight}px`,frame.direction=direction,frame.resize=[frameWidth,frameHeight],frame.translate=drag.beforeTranslate,frame.updates=updates,setTransformStyle(target,frame)},onResizeStart:({setOrigin,dragStart,direction:direction_0})=>{setOrigin(["%","%"]),dragStart&&dragStart.set(frame.translate);const newResizingMode=0!==direction_0[0]&&0!==direction_0[1];isResizingFromCorner!==newResizingMode&&isText&&setIsResizingFromCorner(newResizingMode),isEditMode&&pushTransform(selectedElement.id,frame)},onResizeEnd:({target:target_0})=>{if(handleElementOutOfCanvas(target_0))return;const[editorWidth,editorHeight]=frame.resize;let properties={};if(0!==editorWidth&&0!==editorHeight){const{direction:direction_1}=frame,[deltaX,deltaY]=frame.translate,newWidth_0=editorToDataX_0(editorWidth-(left+right)),newHeight_0=editorToDataY_0(editorHeight-(top+bottom));properties={width:newWidth_0,height:newHeight_0,x:selectedElement.x+editorToDataX_0(deltaX),y:selectedElement.y+editorToDataY_0(deltaY)},updateForResizeEvent&&Object.assign(properties,updateForResizeEvent(selectedElement,direction_1,newWidth_0,newHeight_0)),updateSelectedElements({properties})}setIsResizingFromCorner(!0),resetMoveable(target_0),handleFullbleedMediaAsBackground({...selectedElement,...properties})},keepRatio:lockAspectRatio,renderDirections:getRenderDirections(resizeRules),className:classnames_default()(classNames,{"visually-hide-handles":visuallyHideHandles})}};const utils_normalizeRotationDegrees=function normalizeRotationDegrees(degrees){return(degrees%360+360)%360};const useRotate=function useSingleSelectionRotate({selectedElement,isEditMode,pushTransform,frame,setTransformStyle,resetMoveable,throttleRotation}){const{updateSelectedElements}=(0,app.P3)((state=>({updateSelectedElements:state.actions.updateSelectedElements}))),{handleElementOutOfCanvas}=utils_useElementOutOfCanvas();return{throttleRotate:throttleRotation?30:0,onRotate:({target,beforeRotate})=>{frame.rotate=utils_normalizeRotationDegrees(beforeRotate),setTransformStyle(target,frame)},onRotateEnd:({target:target_0})=>{if(handleElementOutOfCanvas(target_0))return;const properties={rotationAngle:Math.round(frame.rotate)};updateSelectedElements({properties}),resetMoveable(target_0)},onRotateStart:({set})=>{isEditMode&&pushTransform(selectedElement.id,frame),set(frame.rotate)}}};function singleSelectionMoveable_extends(){return singleSelectionMoveable_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},singleSelectionMoveable_extends.apply(null,arguments)}const singleSelectionMoveable=(0,src.Rf)((function SingleSelectionMoveable({selectedElement,targetEl,pushEvent,isEditMode,...props},ref){const moveable=(0,src.li)(null),[isDragging,setIsDragging]=(0,src.J0)(!1),nodesById=(0,app.yu)((({state})=>state.nodesById)),getBox=(0,useUnits.A)((({actions})=>actions.getBox)),pushTransform=(0,transform_src.Gy)((({actions:actions_0})=>actions_0.pushTransform)),{zoomSetting,scrollLeft,scrollTop}=(0,app.gK)((({state:state_0})=>({zoomSetting:state_0.zoomSetting,scrollLeft:state_0.scrollLeft,scrollTop:state_0.scrollTop}))),{isBackground,isLocked,isHidden}=selectedElement,actionsEnabled=!isBackground&&!isLocked&&!isHidden,latestEvent=(0,src.li)(),backgroundElementId=(0,app.P3)((({state:state_1})=>state_1.currentPage?.elements[0]?.id)),isShiftPressed=(0,keyboard.A3)("shift");canvas_useWindowResizeHandler(moveable),(0,src.vJ)((()=>{latestEvent.current=pushEvent}),[pushEvent]),(0,src.vJ)((()=>{moveable.current&&moveable.current.updateRect()}),[scrollLeft,scrollTop]),utils_useUpdateSelectionRectangle(moveable,[zoomSetting]),(0,src.vJ)((()=>{moveable.current&&(latestEvent.current&&targetEl.contains(latestEvent.current.target)&&actionsEnabled&&moveable.current.moveable.dragStart(latestEvent.current),moveable.current.updateRect())}),[targetEl,moveable,actionsEnabled]),(0,src.vJ)((()=>{moveable.current&&moveable.current.updateRect()}));const box=getBox(selectedElement),frame=(0,src.Kr)((()=>({translate:[0,0],rotate:box.rotationAngle,resize:[0,0],updates:null})),[box.rotationAngle]),{border}=selectedElement,{left=0,right=0,top=0,bottom=0}=border||{},setTransformStyle=(target,newFrame=frame)=>{frame.translate=newFrame.translate,frame.direction=newFrame.direction,frame.resize=newFrame.resize,frame.updates=newFrame.updates,frame.rotate=newFrame.rotate,target.style.transform=`translate(${frame.translate[0]}px, ${frame.translate[1]}px) rotate(${frame.rotate}deg)`,frame.resize[0]&&(target.style.width=`${frame.resize[0]}px`),frame.resize[1]&&(target.style.height=`${frame.resize[1]}px`);let frameForEl={...frame};if((frame.resize[0]||frame.resize[1])&&(0,masks_src.Fn)(selectedElement)){const elWidth=frame.resize[0]-(left+right),elHeight=frame.resize[1]-(top+bottom);frameForEl={...frame,resize:[elWidth,elHeight]}}pushTransform(selectedElement.id,frameForEl)},resetMoveable=(0,src.T0)((target_0=>{moveable.current&&(frame.direction=[0,0],frame.translate=[0,0],frame.resize=[0,0],frame.updates=null,pushTransform(selectedElement.id,null),target_0.style.transform="",target_0.style.width="",target_0.style.height="",moveable.current.updateRect())}),[frame,pushTransform,selectedElement.id]),canSnap=!isEditMode,hideHandles=isDragging,classNames=classnames_default()("default-moveable",{"hide-handles":hideHandles,"type-text":"text"===selectedElement.type,immoveable:isLocked||isHidden}),_dragProps=useDrag({setIsDragging,resetMoveable,selectedElement,setTransformStyle,frame}),dragProps=isEditMode?{onDrag:()=>!1,onDragEnd:()=>!1,onDragStart:()=>!1}:_dragProps,resizeProps=useResize({resetMoveable,selectedElement,setTransformStyle,frame,isEditMode,pushTransform,classNames,forceLockRatio:isShiftPressed}),rotateProps=useRotate({selectedElement,isEditMode,pushTransform,frame,setTransformStyle,resetMoveable,throttleRotation:isShiftPressed}),otherNodes=Object.values((0,objectWithout.A)(nodesById,[selectedElement.id,backgroundElementId])),snapProps=(0,useSnapping.A)({otherNodes,canSnap:canSnap&&actionsEnabled,isDragging}),isResizable=actionsEnabled&&!hideHandles&&!0!==selectedElement.lockDimensions,isRotatable=actionsEnabled&&!hideHandles&&!1!==selectedElement.supportsRotation;return react.createElement(moveable_src.uW,singleSelectionMoveable_extends({},props,{className:classNames,zIndex:0,ref:(0,src.jn)(moveable,ref),target:targetEl,edge:!0,draggable:actionsEnabled,resizable:isResizable,rotatable:isRotatable},dragProps,resizeProps,rotateProps,snapProps,{origin:!1,pinchable:!0}))})),LayerWithGrayout=(0,moveable_src.rs)((0,styled_components_browser_esm.Ay)(Layer).withConfig({displayName:"editLayer__LayerWithGrayout",componentId:"sc-1j9iuj3-0"})(["background-color:",";"],(({grayout,theme})=>grayout?theme.colors.opacity.overlayDark:"transparent"))),EditPageArea=(0,moveable_src.rs)(PageArea);function editLayer_temp2(t0){const{state:t1}=t0,{editingElement,editingElementState:t2}=t1,{showOverflow}=void 0===t2?{}:t2;return{editingElement,showOverflow}}function editLayer_temp(state){return{currentPage:state.state.currentPage}}function EditLayerForElement({element,showOverflow}){const ref=(0,src.li)(null),pageAreaRef=(0,src.li)(null),{editModeGrayout}=(0,elements_src.zh)(element.type),{isTrimMode:isTrimMode_0}=(0,useVideoTrim.A)((({state:{isTrimMode}})=>({isTrimMode}))),{clearEditing,onMoveableMount}=(0,app.yu)((state=>({clearEditing:state.actions.clearEditing,onMoveableMount:state.state.onMoveableMount}))),focusCanvas=(0,useFocusCanvas.A)(),[editWrapper,setEditWrapper]=(0,src.J0)(null);(0,keyboard._h)(ref,{key:"esc",editable:!0},(()=>clearEditing()),[clearEditing]),(0,src.vJ)((()=>()=>focusCanvas(!1)),[focusCanvas]);const moveableRef=(0,src.li)(null),setRef=(0,src.hb)((newMoveable=>{moveableRef.current=newMoveable,onMoveableMount?.(newMoveable)}),[onMoveableMount]),onResize=(0,src.hb)((()=>{moveableRef.current&&moveableRef.current.updateRect()}),[]),{hasEditModeMoveable}=(0,elements_src.zh)(element.type);return react.createElement(LayerWithGrayout,{ref,"aria-label":(0,i18n._x)("Edit layer","compound noun","web-stories"),"data-testid":"editLayer",grayout:editModeGrayout,zIndex:zIndex.Vg,onPointerDown:evt=>{evt.target!==ref.current&&evt.target!==pageAreaRef.current||clearEditing()}},react.createElement(EditPageArea,{ref:pageAreaRef,fullBleedContainerLabel:(0,i18n.__)("Fullbleed area (Edit layer)","web-stories"),isControlled:!0,showOverflow,overflow:showOverflow?"visible":"hidden"},react.createElement(editElement,{editWrapper:hasEditModeMoveable&&editWrapper,onResize,element,ref:setEditWrapper})),hasEditModeMoveable&&editWrapper&&react.createElement(singleSelectionMoveable,{selectedElement:element,targetEl:editWrapper,isEditMode:!0,ref:setRef}),isTrimMode_0&&react.createElement(FooterArea,{showOverflow:!0},react.createElement(videoTrimmer,null)))}const editLayer=(0,src.ph)((function EditLayer(){const $=(0,dist.c)(6),{currentPage}=(0,app.P3)(editLayer_temp),{editingElement:editingElementId,showOverflow:t0}=(0,app.yu)(editLayer_temp2),showOverflow_0=void 0===t0||t0;let t1;$[0]!==currentPage||$[1]!==editingElementId?(t1=editingElementId&&currentPage&&currentPage.elements.find((element=>element.id===editingElementId)),$[0]=currentPage,$[1]=editingElementId,$[2]=t1):t1=$[2];const editingElement_0=t1;if(!editingElement_0)return null;let t2;return $[3]!==editingElement_0||$[4]!==showOverflow_0?(t2=react.createElement(EditLayerForElement,{element:editingElement_0,showOverflow:showOverflow_0}),$[3]=editingElement_0,$[4]=showOverflow_0,$[5]=t2):t2=$[5],t2}));__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js");var _path,_path2,displayElement=__webpack_require__("./packages/story-editor/src/components/canvas/displayElement.js"),popup=__webpack_require__("./packages/design-system/src/components/popup/popup.tsx"),popup_constants=__webpack_require__("./packages/design-system/src/components/popup/constants.ts"),useElementsWithLinks=__webpack_require__("./packages/story-editor/src/utils/useElementsWithLinks.ts");function defaultIcon_extends(){return defaultIcon_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},defaultIcon_extends.apply(null,arguments)}const SvgDefaultIcon=({title,titleId,...props})=>react.createElement("svg",defaultIcon_extends({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-labelledby":titleId},props),title?react.createElement("title",{id:titleId},title):null,_path||(_path=react.createElement("path",{fillOpacity:.1,d:"M12 0c6.6 0 12 5.4 12 12s-5.4 12-12 12S0 18.6 0 12 5.4 0 12 0"})),_path2||(_path2=react.createElement("path",{d:"M13.8 14.6c.1.1.2.3.2.5s-.1.3-.2.5L12.3 17c-.7.7-1.7 1.1-2.7 1.1s-1.9-.4-2.7-1.1c-.7-.7-1.1-1.7-1.1-2.7s.4-1.9 1.1-2.7l1.5-1.5c.2 0 .3-.1.5-.1s.3.1.5.2c.1.1.2.3.2.5s-.1.4-.2.5l-1.5 1.5c-.5.5-.7 1.1-.7 1.7s.3 1.3.7 1.7c.5.5 1.1.7 1.7.7s1.3-.3 1.7-.7l1.5-1.5c.3-.3.7-.3 1 0M17 7c-.7-.7-1.7-1.1-2.7-1.1s-1.9.4-2.7 1.1l-1.5 1.5c0 .1-.1.3-.1.4 0 .2.1.3.2.5.1.1.3.2.5.2s.3-.1.5-.2l1.5-1.5c.5-.5 1.1-.7 1.7-.7s1.3.3 1.7.7c.5.5.7 1.1.7 1.7s-.3 1.3-.7 1.7l-1.5 1.5c-.1.1-.2.3-.2.5s.1.3.2.5c.1.1.3.2.5.2s.3-.1.5-.2l1.5-1.5c.7-.7 1.1-1.7 1.1-2.7-.1-1-.5-1.9-1.2-2.6m-7.9 7.2c0 .2.1.3.2.5.1.1.3.2.5.2s.4-.1.5-.2l4.5-4.5c.1-.1.2-.3.2-.5s-.1-.4-.2-.5c-.3-.2-.8-.2-1 .1l-4.5 4.5c-.1.1-.2.3-.2.4"}))),defaultIcon=(0,react.memo)(SvgDefaultIcon);var arrowBar_path;function arrowBar_extends(){return arrowBar_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},arrowBar_extends.apply(null,arguments)}const SvgArrowBar=({title,titleId,...props})=>react.createElement("svg",arrowBar_extends({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 8","aria-labelledby":titleId},props),title?react.createElement("title",{id:titleId},title):null,arrowBar_path||(arrowBar_path=react.createElement("path",{d:"M18 7.7c-.2 0-.5-.1-.7-.2l-7.3-4-7.3 4c-.7.4-1.6.2-2-.6-.4-.7-.1-1.6.6-2l8-4.4q.75-.3 1.5 0l8 4.4c.7.4 1 1.3.6 2-.4.5-.9.8-1.4.8"}))),arrowBar=(0,react.memo)(SvgArrowBar),pageAttachment_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"pageAttachment__Wrapper",componentId:"sc-1bseqmx-0"})(["position:absolute;display:flex;align-items:center;justify-content:flex-end;flex-direction:column;bottom:0;height:20%;width:100%;color:",";z-index:3;"],(({theme})=>theme.colors.standard.white)),Guideline=styled_components_browser_esm.Ay.div.withConfig({displayName:"pageAttachment__Guideline",componentId:"sc-1bseqmx-1"})(["mix-blend-mode:difference;position:absolute;height:1px;bottom:20%;width:100%;background-image:",";background-position:top;background-size:16px 0.5px;background-repeat:repeat-x;z-index:3;"],(({theme})=>`linear-gradient(to right, ${theme.colors.standard.black} 50%, ${theme.colors.standard.white} 0%)`)),ArrowBar=(0,styled_components_browser_esm.Ay)(arrowBar).withConfig({displayName:"pageAttachment__ArrowBar",componentId:"sc-1bseqmx-2"})(["display:block;cursor:pointer;margin-bottom:10px;filter:drop-shadow(0px 2px 6px rgba(0,0,0,0.3));width:20px;height:8px;"]),OutlinkChip=styled_components_browser_esm.Ay.div.withConfig({displayName:"pageAttachment__OutlinkChip",componentId:"sc-1bseqmx-3"})(["height:","px;display:flex;position:relative;padding:","px ","px;margin:0 0 20px;max-width:calc(100% - 64px);border-radius:30px;place-items:center;box-shadow:0px 4px 10px rgba(0,0,0,0.15);background:",";"],(({$factor})=>$factor(36)),(({$factor})=>$factor(10)),(({$factor})=>$factor(6)),(({bgColor})=>bgColor)),TextWrapper=styled_components_browser_esm.Ay.span.withConfig({displayName:"pageAttachment__TextWrapper",componentId:"sc-1bseqmx-4"})(["font-family:Roboto,sans-serif;font-size:","px;line-height:18px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;position:relative;padding-inline-start:6px;padding-inline-end:8px;height:16px;letter-spacing:0.3px;font-weight:700;max-width:210px;color:",";"],(({$factor})=>$factor(16)),(({fgColor})=>fgColor)),Tooltip=styled_components_browser_esm.Ay.div.withConfig({displayName:"pageAttachment__Tooltip",componentId:"sc-1bseqmx-5"})(["background-color:",";color:",";width:200px;padding:8px;font-size:14px;border-radius:4px;text-align:center;"],(({theme})=>theme.colors.standard.black),(({theme})=>theme.colors.standard.white)),LinkImage=styled_components_browser_esm.Ay.img.withConfig({displayName:"pageAttachment__LinkImage",componentId:"sc-1bseqmx-6"})(["height:24px;width:24px;vertical-align:middle;border-radius:50%;border:0 none;object-fit:contain;"]),spacing={x:8};function PageAttachment(t0){const $=(0,dist.c)(20),{pageAttachment:t1}=t0;let t2;$[0]!==t1?(t2=void 0===t1?{}:t1,$[0]=t1,$[1]=t2):t2=$[1];const pageAttachment=t2,{displayLinkGuidelines,pageAttachmentContainer,setPageAttachmentContainer}=(0,app.yu)(pageAttachment_temp),{dataToEditorY:dataToEditorY_0}=(0,useUnits.A)(pageAttachment_temp2),{hasInvalidLinkSelected}=(0,useElementsWithLinks.A)(),{ctaText,url,icon,theme}=pageAttachment,bgColor=theme===constants.RS.DARK?"#000000":"#FFFFFF",fgColor=theme===constants.RS.DARK?"#FFFFFF":"#000000";let t3,t4,t5,t6;return $[2]!==displayLinkGuidelines||$[3]!==hasInvalidLinkSelected?(t3=(displayLinkGuidelines||hasInvalidLinkSelected)&&react.createElement(Guideline,null),$[2]=displayLinkGuidelines,$[3]=hasInvalidLinkSelected,$[4]=t3):t3=$[4],$[5]!==bgColor||$[6]!==ctaText||$[7]!==dataToEditorY_0||$[8]!==fgColor||$[9]!==hasInvalidLinkSelected||$[10]!==icon||$[11]!==pageAttachmentContainer||$[12]!==url?.length?(t4=url?.length>0&&react.createElement(react.Fragment,null,react.createElement(ArrowBar,{fill:bgColor}),react.createElement(OutlinkChip,{bgColor,$factor:dataToEditorY_0},icon?react.createElement(LinkImage,{src:icon,alt:(0,i18n.__)("Site Icon","web-stories"),decoding:"async",crossOrigin:"anonymous"}):react.createElement(defaultIcon,{fill:fgColor,width:dataToEditorY_0(24),height:dataToEditorY_0(24)}),react.createElement(TextWrapper,{fgColor,$factor:dataToEditorY_0},ctaText||(0,i18n.__)("Learn more","web-stories"))),pageAttachmentContainer&&hasInvalidLinkSelected&&react.createElement(popup.A,{anchor:{current:pageAttachmentContainer},isOpen:!0,placement:popup_constants.W.Left,spacing},react.createElement(Tooltip,null,(0,i18n.__)("Links can not reside below the dashed line when a page attachment is present. Your viewers will not be able to click on the link.","web-stories")))),$[5]=bgColor,$[6]=ctaText,$[7]=dataToEditorY_0,$[8]=fgColor,$[9]=hasInvalidLinkSelected,$[10]=icon,$[11]=pageAttachmentContainer,$[12]=url?.length,$[13]=t4):t4=$[13],$[14]!==setPageAttachmentContainer||$[15]!==t4?(t5=react.createElement(pageAttachment_Wrapper,{role:"presentation",ref:setPageAttachmentContainer},t4),$[14]=setPageAttachmentContainer,$[15]=t4,$[16]=t5):t5=$[16],$[17]!==t3||$[18]!==t5?(t6=react.createElement(react.Fragment,null,t3,t5),$[17]=t3,$[18]=t5,$[19]=t6):t6=$[19],t6}function pageAttachment_temp2(t0){const{actions:t1}=t0,{dataToEditorY}=t1;return{dataToEditorY}}function pageAttachment_temp(state){return{displayLinkGuidelines:state.state.displayLinkGuidelines,pageAttachmentContainer:state.state.pageAttachmentContainer,setPageAttachmentContainer:state.actions.setPageAttachmentContainer}}PageAttachment.propTypes={pageAttachment:prop_types_default().shape({url:prop_types_default().string,ctaText:prop_types_default().string,icon:prop_types_default().string,theme:prop_types_default().string,rel:prop_types_default().arrayOf(prop_types_default().string)})};const canvas_pageAttachment=PageAttachment;var icons_arrowBar_path;function icons_arrowBar_extends(){return icons_arrowBar_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},icons_arrowBar_extends.apply(null,arguments)}const arrowBar_SvgArrowBar=({title,titleId,...props})=>react.createElement("svg",icons_arrowBar_extends({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 8","aria-labelledby":titleId},props),title?react.createElement("title",{id:titleId},title):null,icons_arrowBar_path||(icons_arrowBar_path=react.createElement("path",{d:"M18 7.7c-.2 0-.5-.1-.7-.2l-7.3-4-7.3 4c-.7.4-1.6.2-2-.6-.4-.7-.1-1.6.6-2l8-4.4q.75-.3 1.5 0l8 4.4c.7.4 1 1.3.6 2-.4.5-.9.8-1.4.8"}))),icons_arrowBar=(0,react.memo)(arrowBar_SvgArrowBar),shoppingPageAttachment_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"shoppingPageAttachment__Wrapper",componentId:"sc-7unzl7-0"})(["position:absolute;display:flex;align-items:center;justify-content:flex-end;flex-direction:column;bottom:0;height:20%;width:100%;color:",";z-index:3;"],(({theme})=>theme.colors.standard.white)),InnerWrap=styled_components_browser_esm.Ay.div.withConfig({displayName:"shoppingPageAttachment__InnerWrap",componentId:"sc-7unzl7-1"})(["position:relative;width:100%;height:100%;"]),Inner=styled_components_browser_esm.Ay.div.withConfig({displayName:"shoppingPageAttachment__Inner",componentId:"sc-7unzl7-2"})(["position:absolute;bottom:0;width:100%;",";display:flex;flex-direction:column;align-items:center;"],(({$hasGradient})=>$hasGradient&&"background: linear-gradient(0, rgba(0, 0, 0, 0.15), transparent) !important")),ArrowWrap=styled_components_browser_esm.Ay.div.withConfig({displayName:"shoppingPageAttachment__ArrowWrap",componentId:"sc-7unzl7-3"})(["width:","px;min-height:","px;border-radius:50%;background:",";display:flex;align-items:center;justify-content:center;"],(({$factor})=>$factor(32)),(({$factor})=>$factor(32)),(({bgColor})=>bgColor)),shoppingPageAttachment_ArrowBar=(0,styled_components_browser_esm.Ay)(icons_arrowBar).withConfig({displayName:"shoppingPageAttachment__ArrowBar",componentId:"sc-7unzl7-4"})(["display:block;cursor:pointer;filter:drop-shadow(0px 2px 6px rgba(0,0,0,0.3));width:","px;height:","px;"],(({$factor})=>$factor(20)),(({$factor})=>$factor(8))),shoppingPageAttachment_OutlinkChip=styled_components_browser_esm.Ay.div.withConfig({displayName:"shoppingPageAttachment__OutlinkChip",componentId:"sc-7unzl7-5"})(["height:","px;display:flex;position:relative;padding:","px ","px;margin:0 0 ","px;max-width:calc(100% - 64px);border-radius:30px;place-items:center;background:",";"],(({$factor})=>$factor(36)),(({$factor})=>$factor(10)),(({$factor})=>$factor(6)),(({$factor})=>$factor(20)),(({bgColor})=>bgColor)),shoppingPageAttachment_TextWrapper=styled_components_browser_esm.Ay.span.withConfig({displayName:"shoppingPageAttachment__TextWrapper",componentId:"sc-7unzl7-6"})(["font-family:Roboto,sans-serif;font-size:","px;line-height:18px;text-overflow:ellipsis;white-space:nowrap;position:relative;padding-inline-start:6px;padding-inline-end:8px;height:","px;letter-spacing:0.3px;font-weight:700;max-width:210px;color:",";"],(({$factor})=>$factor(16)),(({$factor})=>$factor(16)),(({fgColor})=>fgColor));function shoppingPageAttachment_PageAttachment(t0){const $=(0,dist.c)(20),{ctaText,theme}=t0,arrowColor=theme===constants.RS.DARK?"#FFFFFF":"#000000",fgColor=theme===constants.RS.DARK?"#000000":"#FFFFFF",{dataToEditorY:dataToEditorY_0}=(0,useUnits.A)(shoppingPageAttachment_temp),t1=theme!==constants.RS.DARK;let t2,t3,t4,t5,t6,t7;return $[0]!==arrowColor||$[1]!==dataToEditorY_0?(t2=react.createElement(shoppingPageAttachment_ArrowBar,{fill:arrowColor,$factor:dataToEditorY_0}),$[0]=arrowColor,$[1]=dataToEditorY_0,$[2]=t2):t2=$[2],$[3]!==dataToEditorY_0||$[4]!==fgColor||$[5]!==t2?(t3=react.createElement(ArrowWrap,{bgColor:fgColor,$factor:dataToEditorY_0},t2),$[3]=dataToEditorY_0,$[4]=fgColor,$[5]=t2,$[6]=t3):t3=$[6],$[7]!==ctaText?(t4=ctaText||(0,i18n.__)("Shop Now","web-stories"),$[7]=ctaText,$[8]=t4):t4=$[8],$[9]!==dataToEditorY_0||$[10]!==fgColor||$[11]!==t4?(t5=react.createElement(shoppingPageAttachment_TextWrapper,{fgColor,$factor:dataToEditorY_0},t4),$[9]=dataToEditorY_0,$[10]=fgColor,$[11]=t4,$[12]=t5):t5=$[12],$[13]!==dataToEditorY_0||$[14]!==t5?(t6=react.createElement(shoppingPageAttachment_OutlinkChip,{$factor:dataToEditorY_0},t5),$[13]=dataToEditorY_0,$[14]=t5,$[15]=t6):t6=$[15],$[16]!==t1||$[17]!==t3||$[18]!==t6?(t7=react.createElement(shoppingPageAttachment_Wrapper,{role:"presentation",tabIndex:-1},react.createElement(InnerWrap,null,react.createElement(Inner,{$hasGradient:t1},t3,t6))),$[16]=t1,$[17]=t3,$[18]=t6,$[19]=t7):t7=$[19],t7}function shoppingPageAttachment_temp(t0){const{actions:t1}=t0,{dataToEditorY}=t1;return{dataToEditorY}}shoppingPageAttachment_PageAttachment.propTypes={ctaText:prop_types_default().string,theme:prop_types_default().string};const shoppingPageAttachment=shoppingPageAttachment_PageAttachment;const mediaCaptions_parseTimestamp=function parseTimestamp(timestamp){const match=/^(?:(\d{2,}):)?(\d{2}):(\d{2})\.(\d{3})$/.exec(timestamp);return match?3600*(match[1]?Number.parseInt(match[1]):0)+60*Number.parseInt(match[2])+Number.parseInt(match[3])+Number.parseInt(match[4])/1e3:null},CueWrapper=styled_components_browser_esm.Ay.span.withConfig({displayName:"cue__CueWrapper",componentId:"sc-h5j1x4-0"})(["text-align:center;height:",";"],(({$height})=>`${$height}px`)),CueEl=styled_components_browser_esm.Ay.span.withConfig({displayName:"cue__CueEl",componentId:"sc-h5j1x4-1"})(["color:",";"],(({$isFutureCue,theme})=>$isFutureCue?theme.colors.fg.black:theme.colors.fg.white)),Section=styled_components_browser_esm.Ay.span.withConfig({displayName:"cue__Section",componentId:"sc-h5j1x4-2"})(["margin:0 10px 10px;padding:6px 12px;vertical-align:middle;border-radius:15px;background:rgba(11,11,11,0.6);color:rgba(255,255,255,1);display:inline-block;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen-Sans,Ubuntu,Cantarell,'Helvetica Neue',sans-serif;line-height:1.4;word-break:break-word;word-wrap:break-word;overflow-wrap:break-word;"]);const mediaCaptions_cue=function Cue(t0){const $=(0,dist.c)(16),{cue,videoTime,height}=t0;let T0,T1,t1,t2,t3,t4;if($[0]!==cue||$[1]!==height||$[2]!==videoTime){const html=cue.getCueAsHTML();let t3;T1=CueWrapper,t2=height,T0=Section,$[7]!==videoTime?(t3=node=>{if("timestamp"===node.target)return null;{let timestamp=null;"timestamp"===node.previousSibling?.target&&(timestamp=mediaCaptions_parseTimestamp(node.previousSibling.data));const isFutureCue=timestamp>videoTime;return node.nodeType===Node.TEXT_NODE?null!==timestamp?react.createElement("span",null,react.createElement(CueEl,{$isFutureCue:isFutureCue},node.textContent)):react.createElement(CueEl,null,node.textContent):null!==timestamp?react.createElement("span",null,react.createElement(CueEl,{$isFutureCue:isFutureCue,dangerouslySetInnerHTML:{__html:node.innerHTML}})):react.createElement(CueEl,{dangerouslySetInnerHTML:{__html:node.innerHTML}})}},$[7]=videoTime,$[8]=t3):t3=$[8],t1=html.childNodes.map(t3),$[0]=cue,$[1]=height,$[2]=videoTime,$[3]=T0,$[4]=T1,$[5]=t1,$[6]=t2}else T0=$[3],T1=$[4],t1=$[5],t2=$[6];return $[9]!==T0||$[10]!==t1?(t3=react.createElement(T0,null,t1),$[9]=T0,$[10]=t1,$[11]=t3):t3=$[11],$[12]!==T1||$[13]!==t2||$[14]!==t3?(t4=react.createElement(T1,{$height:t2},t3),$[12]=T1,$[13]=t2,$[14]=t3,$[15]=t4):t4=$[15],t4},Track=styled_components_browser_esm.Ay.div.withConfig({displayName:"trackRenderer__Track",componentId:"sc-7rx40r-0"})(["width:100%;height:100%;display:grid;align-content:end;font-size:",";"],(({$fontSize})=>`${$fontSize}px`));function TrackRenderer(t0){const $=(0,dist.c)(28),{elementId,trackIndex}=t0,{pageWidth:pageWidth_0,pageHeight:pageHeight_0}=(0,app.gK)(trackRenderer_temp),fontSize=.04*pageWidth_0,height=.3*pageHeight_0,[track,setTrack]=(0,src.J0)(null),[videoTime,setVideoTime]=(0,src.J0)(0);let t1;$[0]===Symbol.for("react.memo_cache_sentinel")?(t1=[],$[0]=t1):t1=$[0];const[cues,setCues]=(0,src.J0)(t1);let t2,t3;$[1]!==setCues||$[2]!==track?(t2=()=>{const activeCues=track?.activeCues?[...track.activeCues]:[];setCues(activeCues)},$[1]=setCues,$[2]=track,$[3]=t2):t2=$[3],$[4]!==track?(t3=[track],$[4]=track,$[5]=t3):t3=$[5];const updateCues=(0,src.hb)(t2,t3);let t4,t5,t6,t7;if($[6]!==elementId||$[7]!==setTrack||$[8]!==setVideoTime||$[9]!==trackIndex||$[10]!==updateCues?(t4=()=>{updateCues(),setVideoTime(0);const mediaEl=document.getElementById(elementId);if(!mediaEl)return;const mediaTrack=mediaEl.textTracks?.[trackIndex];return mediaTrack?(mediaTrack.mode="hidden",updateCues(),setTrack(mediaTrack),mediaEl.addEventListener("timeupdate",(()=>{setVideoTime(mediaEl.currentTime)})),mediaTrack.addEventListener("cuechange",updateCues),()=>{mediaTrack.removeEventListener("cuechange",updateCues)}):void 0},$[6]=elementId,$[7]=setTrack,$[8]=setVideoTime,$[9]=trackIndex,$[10]=updateCues,$[11]=t4):t4=$[11],$[12]!==elementId||$[13]!==pageHeight_0||$[14]!==pageWidth_0||$[15]!==trackIndex||$[16]!==updateCues?(t5=[trackIndex,updateCues,elementId,pageWidth_0,pageHeight_0],$[12]=elementId,$[13]=pageHeight_0,$[14]=pageWidth_0,$[15]=trackIndex,$[16]=updateCues,$[17]=t5):t5=$[17],(0,src.vJ)(t4,t5),!cues||!track)return null;if($[18]!==cues||$[19]!==height||$[20]!==videoTime){let t7;$[22]!==height||$[23]!==videoTime?(t7=(cue,index)=>react.createElement(mediaCaptions_cue,{key:index,cue,videoTime,height}),$[22]=height,$[23]=videoTime,$[24]=t7):t7=$[24],t6=cues.map(t7),$[18]=cues,$[19]=height,$[20]=videoTime,$[21]=t6}else t6=$[21];return $[25]!==fontSize||$[26]!==t6?(t7=react.createElement(Track,{$fontSize:fontSize},t6),$[25]=fontSize,$[26]=t6,$[27]=t7):t7=$[27],t7}function trackRenderer_temp(t0){const{state:t1}=t0,{pageWidth,pageHeight}=t1;return{pageWidth,pageHeight}}TrackRenderer.propTypes={elementId:prop_types_default().string.isRequired,trackIndex:prop_types_default().number.isRequired};const trackRenderer=TrackRenderer,CaptionsLayer=(0,styled_components_browser_esm.Ay)(Layer).withConfig({displayName:"mediaCaptionsLayer__CaptionsLayer",componentId:"sc-11mx67a-0"})([""]),CaptionsPageArea=(0,styled_components_browser_esm.Ay)(PageArea).withConfig({displayName:"mediaCaptionsLayer__CaptionsPageArea",componentId:"sc-11mx67a-1"})(["position:absolute;pointer-events:none;"]),CaptionsCanvas=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaCaptionsLayer__CaptionsCanvas",componentId:"sc-11mx67a-2"})(["background:transparent;border-radius:5px;position:absolute;z-index:2;transform:translateZ(0);top:0;left:0;bottom:0;right:0;cursor:default;"]);function mediaCaptionsLayer_temp2(t0){const{state}=t0,{selectedElements,currentPage}=state;let backgroundAudio=null,videoElement=null;if(1===selectedElements.length&&currentPage){const selectedElement=selectedElements[0],{isBackground,type,tracks}=selectedElement,{backgroundAudio:currentPageBackgroundAudio}=currentPage;isBackground&&currentPageBackgroundAudio&&currentPageBackgroundAudio?.tracks?.length>0&&(backgroundAudio=currentPageBackgroundAudio),"video"===type&&tracks?.length>0&&(videoElement=selectedElement)}return{currentPageId:currentPage?.id,backgroundAudio,videoElement}}function mediaCaptionsLayer_temp(t0){const{state:t1}=t0,{isEditing}=t1;return{isEditing}}const mediaCaptionsLayer=function MediaCaptionsLayer(){const $=(0,dist.c)(19),{isEditing:isEditing_0}=(0,app.yu)(mediaCaptionsLayer_temp),{currentPageId,backgroundAudio:backgroundAudio_0,videoElement:videoElement_0}=(0,app.P3)(mediaCaptionsLayer_temp2),[mediaTrackCount,setMediaTrackCount]=(0,src.J0)(0),[mediaElementId,setMediaElementId]=(0,src.J0)("");let t0,t1,t2,t3;if($[0]!==backgroundAudio_0||$[1]!==currentPageId||$[2]!==isEditing_0||$[3]!==setMediaElementId||$[4]!==setMediaTrackCount||$[5]!==videoElement_0?(t0=()=>{if(setMediaTrackCount(0),setMediaElementId(""),backgroundAudio_0)return setMediaElementId(`page-${currentPageId}-background-audio`),void setMediaTrackCount(backgroundAudio_0?.tracks?.length);!isEditing_0&&videoElement_0&&(setMediaElementId(`video-${videoElement_0.id}`),setMediaTrackCount(videoElement_0.tracks.length))},$[0]=backgroundAudio_0,$[1]=currentPageId,$[2]=isEditing_0,$[3]=setMediaElementId,$[4]=setMediaTrackCount,$[5]=videoElement_0,$[6]=t0):t0=$[6],$[7]!==backgroundAudio_0||$[8]!==currentPageId||$[9]!==isEditing_0||$[10]!==videoElement_0?(t1=[videoElement_0,backgroundAudio_0,currentPageId,isEditing_0],$[7]=backgroundAudio_0,$[8]=currentPageId,$[9]=isEditing_0,$[10]=videoElement_0,$[11]=t1):t1=$[11],(0,src.vJ)(t0,t1),!mediaTrackCount)return null;if($[12]!==mediaElementId||$[13]!==mediaTrackCount){let t3;$[15]!==mediaElementId?(t3=(_,index)=>react.createElement(trackRenderer,{key:index,elementId:mediaElementId,trackIndex:index}),$[15]=mediaElementId,$[16]=t3):t3=$[16],t2=Array.from({length:mediaTrackCount}).map(t3),$[12]=mediaElementId,$[13]=mediaTrackCount,$[14]=t2}else t2=$[14];return $[17]!==t2?(t3=react.createElement(CaptionsLayer,null,react.createElement(CaptionsPageArea,{withSafezone:!1,showOverflow:!0},react.createElement(CaptionsCanvas,null,t2))),$[17]=t2,$[18]=t3):t3=$[18],t3},DisplayPageArea=(0,styled_components_browser_esm.Ay)(PageArea).withConfig({displayName:"displayLayer__DisplayPageArea",componentId:"sc-13e1aq-0"})(["position:absolute;"]);function DisplayPage({pageElements,editingElement}){return pageElements?pageElements.map((element=>{if(editingElement===element.id)return null;if(element.isHidden)return null;const siblingCount=pageElements.filter((({type})=>type===element.type)).length-1;return react.createElement(displayElement.A,{key:element.id,element,isAnimatable:!0,siblingCount})})):null}function DisplayPageAnimationController(t0){const $=(0,dist.c)(9),{resetAnimationState}=t0,{animationState,pageId}=(0,app.P3)(displayLayer_temp),WAAPIAnimationMethods=(0,animation_src.oB)(displayLayer_temp2);let t1,t2,t3,t4;return $[0]!==WAAPIAnimationMethods||$[1]!==animationState?(t1=()=>{switch(animationState){case animation_src.TR.PlayingSelected:case animation_src.TR.Playing:return void WAAPIAnimationMethods.play();case animation_src.TR.Reset:return void WAAPIAnimationMethods.reset();case animation_src.TR.Scrubbing:case animation_src.TR.Paused:return void WAAPIAnimationMethods.pause();default:return}},t2=[animationState,WAAPIAnimationMethods],$[0]=WAAPIAnimationMethods,$[1]=animationState,$[2]=t1,$[3]=t2):(t1=$[2],t2=$[3]),(0,src.vJ)(t1,t2),$[4]!==resetAnimationState?(t3=()=>resetAnimationState,$[4]=resetAnimationState,$[5]=t3):t3=$[5],$[6]!==pageId||$[7]!==resetAnimationState?(t4=[resetAnimationState,pageId],$[6]=pageId,$[7]=resetAnimationState,$[8]=t4):t4=$[8],(0,src.vJ)(t3,t4),null}function displayLayer_temp2(t0){const{actions}=t0;return actions.WAAPIAnimationMethods}function displayLayer_temp(t0){const{state}=t0;return{animationState:state.animationState,pageId:state.currentPage?.id}}function StoryAnimations(t0){const $=(0,dist.c)(15),{children}=t0,{isAnimationPlaying,currentPageAnimations,currentPageElements,selectedElements,updateAnimationState}=(0,app.P3)(displayLayer_temp3);let t1,t2;$[0]!==updateAnimationState?(t1=()=>{updateAnimationState({animationState:animation_src.TR.Reset})},t2=[updateAnimationState],$[0]=updateAnimationState,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const resetAnimationState=(0,src.hb)(t1,t2);let t3,t4;$[3]!==selectedElements?(t3=()=>selectedElements.map(_temp4),t4=[selectedElements],$[3]=selectedElements,$[4]=t3,$[5]=t4):(t3=$[4],t4=$[5]);const animatedElements=(0,src.Kr)(t3,t4),t5=isAnimationPlaying?animatedElements:constants.qW;let t6,t7;return $[6]!==resetAnimationState?(t6=react.createElement(DisplayPageAnimationController,{resetAnimationState}),$[6]=resetAnimationState,$[7]=t6):t6=$[7],$[8]!==children||$[9]!==currentPageAnimations||$[10]!==currentPageElements||$[11]!==resetAnimationState||$[12]!==t5||$[13]!==t6?(t7=react.createElement(animation_src.S,{animations:currentPageAnimations,elements:currentPageElements,onWAAPIFinish:resetAnimationState,selectedElementIds:t5},t6,children),$[8]=children,$[9]=currentPageAnimations,$[10]=currentPageElements,$[11]=resetAnimationState,$[12]=t5,$[13]=t6,$[14]=t7):t7=$[14],t7}function _temp4(el){return el.id}function displayLayer_temp3(t0){const{state,actions}=t0;return{isAnimationPlaying:state.animationState===animation_src.TR.PlayingSelected,currentPageAnimations:state.currentPage?.animations||constants.qW,currentPageElements:state.currentPage?.elements||constants.qW,selectedElements:state.selectedElements,updateAnimationState:actions.updateAnimationState}}function _temp8(t0){const{state:t1,actions:t2}=t0,{editingElement}=t1,{setPageContainer,setFullbleedContainer}=t2;return{editingElement,setPageContainer,setFullbleedContainer}}function _temp7(t0){const{state:state_0}=t0;return state_0.currentPage?.elements||constants.qW}function _temp6(t0){const{state}=t0;return{hasCurrentPage:Boolean(state.currentPage),backgroundColor:state.currentPage?.backgroundColor,isBackgroundSelected:state.selectedElements?.[0]?.isBackground,pageAttachment:state.currentPage?.pageAttachment||{},shoppingAttachment:state.currentPage?.shoppingAttachment||{},hasProducts:state.currentPage?.elements?.some(_temp5)}}function _temp5(t0){const{type,product}=t0;return type===elements_src.bV.PRODUCT&&product?.productId}DisplayPageAnimationController.propTypes={resetAnimationState:prop_types_default().func},StoryAnimations.propTypes={children:prop_types_default().node};const displayLayer=(0,src.ph)((function DisplayLayer(){const $=(0,dist.c)(20),{backgroundColor,isBackgroundSelected,pageAttachment,shoppingAttachment,hasProducts}=(0,app.P3)(_temp6),currentPageElements=(0,app.P3)(_temp7),boundingBoxTrackingRef=(0,app.yR)(app.DN.PAGE_CONTAINER),{editingElement:editingElement_0,setPageContainer:setPageContainer_0,setFullbleedContainer:setFullbleedContainer_0}=(0,app.yu)(_temp8);let t0,t1;$[0]!==hasProducts||$[1]!==pageAttachment||$[2]!==shoppingAttachment?(t0=()=>hasProducts?react.createElement(shoppingPageAttachment,shoppingAttachment):react.createElement(canvas_pageAttachment,{pageAttachment}),t1=[hasProducts,pageAttachment,shoppingAttachment],$[0]=hasProducts,$[1]=pageAttachment,$[2]=shoppingAttachment,$[3]=t0,$[4]=t1):(t0=$[3],t1=$[4]);const Overlay=(0,src.Kr)(t0,t1);let t2;$[5]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n._x)("Display layer","compound noun","web-stories"),$[5]=t2):t2=$[5];const t3=(0,src.jn)(setPageContainer_0,boundingBoxTrackingRef);let t4,t5,t6,t7,t8;return $[6]===Symbol.for("react.memo_cache_sentinel")?(t4=(0,i18n.__)("Fullbleed area (Display layer)","web-stories"),$[6]=t4):t4=$[6],$[7]!==currentPageElements||$[8]!==editingElement_0?(t5=react.createElement(DisplayPage,{pageElements:currentPageElements,editingElement:editingElement_0}),$[7]=currentPageElements,$[8]=editingElement_0,$[9]=t5):t5=$[9],$[10]!==Overlay||$[11]!==backgroundColor||$[12]!==isBackgroundSelected||$[13]!==setFullbleedContainer_0||$[14]!==t3||$[15]!==t5?(t6=react.createElement(DisplayPageArea,{ref:t3,fullbleedRef:setFullbleedContainer_0,background:backgroundColor,isBackgroundSelected,fullBleedContainerLabel:t4,overlay:Overlay,isControlled:!0},t5),$[10]=Overlay,$[11]=backgroundColor,$[12]=isBackgroundSelected,$[13]=setFullbleedContainer_0,$[14]=t3,$[15]=t5,$[16]=t6):t6=$[16],$[17]===Symbol.for("react.memo_cache_sentinel")?(t7=react.createElement(mediaCaptionsLayer,null),$[17]=t7):t7=$[17],$[18]!==t6?(t8=react.createElement(StoryAnimations,null,react.createElement(Layer,{"data-testid":"DisplayLayer",pointerEvents:"none","aria-label":t2},t6,t7)),$[18]=t6,$[19]=t8):t8=$[19],t8}));var outline=__webpack_require__("./packages/design-system/src/theme/helpers/outline.ts"),useLiveRegion=__webpack_require__("./packages/design-system/src/utils/useLiveRegion.ts"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),getKeyboardMovement=__webpack_require__("./packages/design-system/src/utils/getKeyboardMovement.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),highlights=__webpack_require__("./packages/story-editor/src/app/highlights/index.ts"),useHighlights=__webpack_require__("./packages/story-editor/src/app/highlights/useHighlights.ts"),story=__webpack_require__("./packages/story-editor/src/app/story/index.ts");const utils_getLayerArrangementProps=function getLayerArrangementProps(key,shift,selectedElements,elements){if(!selectedElements||selectedElements.length>1)return{};let position=null;if("ArrowUp"===key&&(position=shift?constants.lH.Front:constants.lH.Forward),"ArrowDown"===key&&(position=shift?constants.lH.Back:constants.lH.Backward),!position)return{};const{id,groupId}=selectedElements[0],currentPosition=elements.findIndex((({id:elId})=>elId===id));if(groupId){const isLastInGroup=elements[currentPosition-1]?.groupId!==groupId,isFirstInGroup=elements[currentPosition+1]?.groupId!==groupId;if(isLastInGroup&&position===constants.lH.Backward||isFirstInGroup&&position===constants.lH.Forward)return{position:currentPosition,groupId:null}}else{if(elements[currentPosition-1]?.groupId&&position===constants.lH.Backward)return{position:currentPosition,groupId:elements[currentPosition-1].groupId};if(elements[currentPosition+1]?.groupId&&position===constants.lH.Forward)return{position:currentPosition,groupId:elements[currentPosition+1].groupId}}return{position}};var canvas=__webpack_require__("./packages/story-editor/src/app/canvas/index.ts");const canvas_useCanvasKeys=function useCanvasKeys(ref){const{selectedElementIds:selectedElementIds_0,selectedElements:selectedElements_0,arrangeSelection:arrangeSelection_0,deleteSelectedElements:deleteSelectedElements_0,duplicateElementsById:duplicateElementsById_0,updateSelectedElements:updateSelectedElements_0,setSelectedElementsById:setSelectedElementsById_0,currentPage:currentPage_0,currentPageNumber:currentPageNumber_0,animationState:animationState_0,updateAnimationState:updateAnimationState_0,currentPageProductIds,pageElements}=(0,story.P3)((({state:{selectedElementIds,selectedElements,currentPage,currentPageNumber,animationState},actions:{arrangeSelection,deleteSelectedElements,duplicateElementsById,updateSelectedElements,setSelectedElementsById,updateAnimationState}})=>({currentPage,currentPageNumber,selectedElementIds,selectedElements,arrangeSelection,deleteSelectedElements,duplicateElementsById,updateSelectedElements,setSelectedElementsById,animationState,updateAnimationState,currentPageProductIds:currentPage?.elements?.filter(elements_src.V7.product).map((({product})=>product?.productId)),pageElements:currentPage?.elements}))),showSnackbar_0=(0,useSnackbar.d)((({showSnackbar})=>showSnackbar)),{setHighlights:setHighlights_0}=(0,useHighlights.A)((({setHighlights})=>({setHighlights}))),{isEditing:isEditing_0,getNodeForElement:getNodeForElement_0,setEditingElement:setEditingElement_0}=(0,canvas.yu)((({state:{isEditing},actions:{getNodeForElement,setEditingElement}})=>({isEditing,getNodeForElement,setEditingElement}))),selectedElementIdsRef=(0,src.li)(null);selectedElementIdsRef.current=selectedElementIds_0,(0,src.vJ)((()=>{const container=ref.current;if(!container)return;const doc=container.ownerDocument;if(!doc)return;const handler=()=>{setTimeout((()=>{if(doc.activeElement===doc.body){const currentSelectedIds=selectedElementIdsRef.current,selectedFrame=1===currentSelectedIds?.length?getNodeForElement_0(currentSelectedIds[0]):null,sel=window.getSelection();if(""!==sel?.toString())return;selectedFrame?selectedFrame.focus({preventScroll:!0}):container.focus({preventScroll:!0})}}),300)};return doc.addEventListener("focusout",handler,!0),()=>{doc.removeEventListener("focusout",handler,!0)}}),[ref,getNodeForElement_0]),(0,keyboard.pP)("delete",(()=>deleteSelectedElements_0()),[deleteSelectedElements_0]),(0,keyboard.pP)({key:["mod+a"]},(()=>{if(!currentPage_0)return;const elementIds=currentPage_0.elements.map((({id})=>id));setSelectedElementsById_0({elementIds})}),[currentPage_0,setSelectedElementsById_0]),(0,keyboard.pP)({key:["up","down","left","right"],shift:!0},(({key,shiftKey})=>{if(isEditing_0||!selectedElements_0?.length)return;const{isLocked}=selectedElements_0[0];if(elements_src.V7.backgroundable(selectedElements_0[0])&&selectedElements_0[0].isBackground||isLocked)return;const{dx,dy}=(0,getKeyboardMovement.A)(key,shiftKey);updateSelectedElements_0({properties:({x,y})=>({x:x+dx,y:y+dy})})}),[updateSelectedElements_0,isEditing_0,selectedElements_0]),(0,keyboard.pP)({key:["mod+up","mod+down","mod+left","mod+right"],shift:!0},(evt=>{const{key:key_0,shiftKey:shiftKey_0}=evt;if(evt.preventDefault(),1===selectedElements_0?.length&&pageElements){const{position,groupId}=utils_getLayerArrangementProps(key_0,shiftKey_0,selectedElements_0,pageElements);(position||groupId)&&arrangeSelection_0({position,groupId})}}),[arrangeSelection_0,selectedElements_0,pageElements]),(0,keyboard.pP)({key:"enter",clickable:!1},(()=>{if(1!==selectedElements_0.length)return;const{type,id:id_0,isLocked:isLocked_0}=selectedElements_0[0],{hasEditMode,hasEditModeIfLocked}=(0,elements_src.zh)(type);!hasEditMode||!hasEditModeIfLocked&&isLocked_0||setEditingElement_0(id_0)}),[selectedElements_0,setEditingElement_0]);const cloneHandler=(0,src.hb)((()=>{if(0!==selectedElements_0.length){for(const el of selectedElements_0)if(elements_src.V7.product(el)){const{product:product_0}=el,{productId,productTitle,productImages}=product_0;productId&&currentPageProductIds?.includes(productId)&&showSnackbar_0({message:(0,sprintf.A)((0,i18n.__)('Product "%s" already exists on the page.',"web-stories"),productTitle),thumbnail:productImages?.[0]?.url?{src:productImages[0].url,alt:productImages[0].alt}:void 0})}duplicateElementsById_0({elementIds:selectedElements_0.map((element=>element.id))})}}),[duplicateElementsById_0,selectedElements_0,currentPageProductIds,showSnackbar_0]);(0,keyboard.pP)("clone",(()=>cloneHandler()),[cloneHandler]);const isPlaying=[animation_src.TR.Playing,animation_src.TR.PlayingSelected].includes(animationState_0);(0,keyboard.pP)({key:["mod+enter"]},(evt_0=>{evt_0.preventDefault(),1!==currentPageNumber_0&&(updateAnimationState_0({animationState:isPlaying?animation_src.TR.Reset:animation_src.TR.Playing}),(0,tracking_src.sx)("canvas_play_animations",{status:isPlaying?"stop":"play"}))}),[isPlaying,updateAnimationState_0,currentPageNumber_0]),(0,keyboard.pP)({key:["mod+k"]},(evt_1=>{evt_1.preventDefault(),!selectedElements_0.length||elements_src.V7.backgroundable(selectedElements_0[0])&&selectedElements_0[0].isBackground||setHighlights_0({elements:selectedElements_0,highlight:highlights.xP.Link})}),[setHighlights_0,selectedElements_0])};var pagepreview=__webpack_require__("./packages/story-editor/src/components/footer/pagepreview/index.js");const ExtraPageWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"extraPages__ExtraPageWrapper",componentId:"sc-12b8j4d-0"})(["display:flex;overflow:hidden;justify-content:",";align-items:center;height:100%;"],(({isPrevious})=>isPrevious?"flex-end":"flex-start")),ExtraPageList=styled_components_browser_esm.Ay.ol.withConfig({displayName:"extraPages__ExtraPageList",componentId:"sc-12b8j4d-1"})(["display:flex;flex-direction:",";width:","px;margin:0;padding:0 ","px;gap:","px;"],(({isPrevious})=>isPrevious?"row-reverse":"row"),(({listWidth})=>listWidth),32,32),ExtraPage=styled_components_browser_esm.Ay.li.withConfig({displayName:"extraPages__ExtraPage",componentId:"sc-12b8j4d-2"})(["display:block;width:","px;height:100%;border-radius:4px;background-color:white;opacity:",";transition:opacity 0.2s ease;&:hover{opacity:1;}",""],(({extraPageWidth})=>extraPageWidth-32),(({$distance})=>.6-.15*$distance),(({$inert})=>$inert&&"pointer-events: none;")),ExtraPagePreview=(0,styled_components_browser_esm.Ay)(pagepreview.A).withConfig({displayName:"extraPages__ExtraPagePreview",componentId:"sc-12b8j4d-3"})(["cursor:pointer;"]);function range(from,to){return from<to?Array.from(Array(to-from)).map(((k,v)=>v+from)):[]}function ExtraPages(t0){const $=(0,dist.c)(34),{isPrevious:t1}=t0,isPrevious=void 0!==t1&&t1,{currentPageIndex:currentPageIndex_0,pages:pages_0,setCurrentPage:setCurrentPage_0}=(0,app.P3)(extraPages_temp),{hasExtraPages:hasExtraPages_0,extraPageWidth:extraPageWidth_0,extraPageCount:extraPageCount_0}=(0,app.gK)(extraPages_temp2),isAnythingTransforming_0=(0,transform_src.Gy)(extraPages_temp3),pageCount=pages_0?.length;if(!pageCount)return null;let T0,T1,t2,t3,t4,t5,t6,t7,t8,t9;if($[0]!==currentPageIndex_0||$[1]!==extraPageCount_0||$[2]!==extraPageWidth_0||$[3]!==hasExtraPages_0||$[4]!==isAnythingTransforming_0||$[5]!==isPrevious||$[6]!==pageCount||$[7]!==pages_0||$[8]!==setCurrentPage_0){t7=Symbol.for("react.early_return_sentinel");bb0:{const pagesToShow=function getPagesToShow({isPrevious,hasExtraPages,currentPageIndex,extraPageCount,pageCount}){if(!hasExtraPages)return[];if(isPrevious)return range(Math.max(0,currentPageIndex-extraPageCount),currentPageIndex).reverse();return range(currentPageIndex+1,Math.min(pageCount,currentPageIndex+extraPageCount+2))}({isPrevious,hasExtraPages:hasExtraPages_0,currentPageIndex:currentPageIndex_0,extraPageCount:extraPageCount_0,pageCount});if(0===pagesToShow.length){t7=null;break bb0}const listWidth=pagesToShow.length*extraPageWidth_0,extraPageHeight=(extraPageWidth_0-32)/src_constants.iZ;let t8;$[17]!==setCurrentPage_0?(t8=pageId=>()=>setCurrentPage_0({pageId}),$[17]=setCurrentPage_0,$[18]=t8):t8=$[18];const clickPage=t8;let t9;T1=ExtraPageWrapper,t6=isPrevious,T0=ExtraPageList,t2=isPrevious,t3=listWidth,t4=extraPageHeight,$[19]!==clickPage||$[20]!==extraPageWidth_0||$[21]!==isAnythingTransforming_0||$[22]!==pages_0?(t9=(pageNum,index)=>react.createElement(ExtraPage,{key:pageNum,extraPageWidth:extraPageWidth_0,$inert:isAnythingTransforming_0,$distance:index},react.createElement(ExtraPagePreview,{page:pages_0[pageNum],onClick:clickPage(pages_0[pageNum].id),"aria-label":(0,sprintf.A)((0,i18n.__)("Go to page %s","web-stories"),pageNum+1),width:extraPageWidth_0-32})),$[19]=clickPage,$[20]=extraPageWidth_0,$[21]=isAnythingTransforming_0,$[22]=pages_0,$[23]=t9):t9=$[23],t5=pagesToShow.map(t9)}$[0]=currentPageIndex_0,$[1]=extraPageCount_0,$[2]=extraPageWidth_0,$[3]=hasExtraPages_0,$[4]=isAnythingTransforming_0,$[5]=isPrevious,$[6]=pageCount,$[7]=pages_0,$[8]=setCurrentPage_0,$[9]=T0,$[10]=T1,$[11]=t2,$[12]=t3,$[13]=t4,$[14]=t5,$[15]=t6,$[16]=t7}else T0=$[9],T1=$[10],t2=$[11],t3=$[12],t4=$[13],t5=$[14],t6=$[15],t7=$[16];return t7!==Symbol.for("react.early_return_sentinel")?t7:($[24]!==T0||$[25]!==t2||$[26]!==t3||$[27]!==t4||$[28]!==t5?(t8=react.createElement(T0,{isPrevious:t2,listWidth:t3,extraPageHeight:t4},t5),$[24]=T0,$[25]=t2,$[26]=t3,$[27]=t4,$[28]=t5,$[29]=t8):t8=$[29],$[30]!==T1||$[31]!==t6||$[32]!==t8?(t9=react.createElement(T1,{isPrevious:t6},t8),$[30]=T1,$[31]=t6,$[32]=t8,$[33]=t9):t9=$[33],t9)}function extraPages_temp3(t0){const{state:t1}=t0,{isAnythingTransforming}=t1;return isAnythingTransforming}function extraPages_temp2(t0){const{state:t1}=t0,{hasExtraPages,extraPageWidth,extraPageCount}=t1;return{hasExtraPages,extraPageWidth,extraPageCount}}function extraPages_temp(t0){const{state:t1,actions:t2}=t0,{pages,currentPageIndex}=t1,{setCurrentPage}=t2;return{currentPageIndex,pages,setCurrentPage}}ExtraPages.propTypes={isPrevious:prop_types_default().bool};const extraPages=(0,src.ph)(ExtraPages);var utils=__webpack_require__("./packages/design-system/src/components/keyboard/utils.ts"),polished_esm=__webpack_require__("./node_modules/polished/dist/polished.esm.js"),url=__webpack_require__("./packages/url/src/url.ts"),external_link=__webpack_require__("./packages/design-system/src/icons/external_link.svg"),tooltip=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js"),elementLink=__webpack_require__("./packages/story-editor/src/components/elementLink/index.js");const StyledTooltip=(0,styled_components_browser_esm.Ay)(tooltip.A).withConfig({displayName:"frame__StyledTooltip",componentId:"sc-1fjzoyw-0"})(["box-shadow:0px 6px 10px ",";align-items:center;p{display:flex;max-width:100%;}"],(({theme})=>(0,polished_esm.B3)(theme.colors.standard.black,.1))),IconWrapper=styled_components_browser_esm.Ay.span.withConfig({displayName:"frame__IconWrapper",componentId:"sc-1fjzoyw-1"})(["background-color:",";width:24px;height:24px;border-radius:50%;overflow:hidden;margin-right:8px;display:inline-block;"],(({theme})=>theme.colors.fg.secondary)),BrandIcon=styled_components_browser_esm.Ay.img.withConfig({displayName:"frame__BrandIcon",componentId:"sc-1fjzoyw-2"})(["width:100%;height:100%;border:none;"]),LinkDesc=styled_components_browser_esm.Ay.span.withConfig({displayName:"frame__LinkDesc",componentId:"sc-1fjzoyw-3"})(["padding-top:2px;flex:1;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"]),ExternalLink=(0,styled_components_browser_esm.Ay)(external_link.A).withConfig({displayName:"frame__ExternalLink",componentId:"sc-1fjzoyw-4"})(["width:24px;"]);function WithLink(t0){const $=(0,dist.c)(7),{element,active,children,anchorRef}=t0;let t1;if($[0]!==active||$[1]!==element){const link=(0,elementLink.f)(element);t1=link?.url&&active?react.createElement(react.Fragment,null,link?.icon&&react.createElement(IconWrapper,null,react.createElement(BrandIcon,{src:link.icon,alt:(0,i18n.__)("Site Icon","web-stories"),decoding:"async",crossOrigin:"anonymous"})),react.createElement(LinkDesc,null,link.desc||(0,url.rM)(link.url)),react.createElement(ExternalLink,null)):null,$[0]=active,$[1]=element,$[2]=t1}else t1=$[2];const tooltipContent=t1;let t2;return $[3]!==anchorRef||$[4]!==children||$[5]!==tooltipContent?(t2=react.createElement(StyledTooltip,{forceAnchorRef:anchorRef,placement:popup_constants.W.Top,title:tooltipContent},children),$[3]=anchorRef,$[4]=children,$[5]=tooltipContent,$[6]=t2):t2=$[6],t2}WithLink.propTypes={element:propTypes.Ed.element.isRequired,anchorRef:prop_types_default().object,active:prop_types_default().bool.isRequired,children:prop_types_default().node.isRequired};const elementLink_frame=WithLink;var pill_path;function pill_extends(){return pill_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pill_extends.apply(null,arguments)}const SvgPill=({title,titleId,...props})=>react.createElement("svg",pill_extends({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 12 12","aria-labelledby":titleId},props),title?react.createElement("title",{id:titleId},title):null,pill_path||(pill_path=react.createElement("path",{fill:"currentColor",d:"M11.49 5.755 6.24.505a1.16 1.16 0 0 0-.823-.338H1.334A1.17 1.17 0 0 0 .167 1.333v4.084c0 .32.128.612.344.828l5.25 5.25c.21.21.502.338.823.338s.612-.128.822-.344l4.083-4.083a1.14 1.14 0 0 0 .345-.823c0-.32-.134-.618-.345-.828ZM2.208 3.083a.874.874 0 1 1 0-1.75.874.874 0 1 1 0 1.75"}))),pill=(0,react.memo)(SvgPill),frame_StyledTooltip=(0,styled_components_browser_esm.Ay)(tooltip.A).withConfig({displayName:"frame__StyledTooltip",componentId:"sc-uvs0u9-0"})(["align-items:center;p{display:flex;max-width:100%;color:#fff;font-family:'Poppins',sans-serif;font-weight:700;font-size:14px;line-height:24px;padding:0;}background-color:rgba(125,125,125,0.75);border-radius:18px;padding-inline-start:6px;padding-inline-end:12px;cursor:pointer;height:36px;"]),PillImage=styled_components_browser_esm.Ay.span.withConfig({displayName:"frame__PillImage",componentId:"sc-uvs0u9-1"})(["width:24px;height:24px;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,0.6);border-radius:100%;flex-shrink:0;margin-inline-end:4px;"]);function TooltipTitle(t0){const $=(0,dist.c)(3),{productTagText}=t0;let t1,t2;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t1=react.createElement(PillImage,null,react.createElement(pill,{width:14,height:14,"aria-hidden":!0})),$[0]=t1):t1=$[0],$[1]!==productTagText?(t2=react.createElement(react.Fragment,null,t1,productTagText),$[1]=productTagText,$[2]=t2):t2=$[2],t2}function WithProductPill(t0){const $=(0,dist.c)(16),{element,active,children,anchorRef}=t0,{actions:t1}=(0,app.Ln)(),{maybeEnqueueFontStyle}=t1,{locale:t2}=(0,app.UK)(),{locale}=t2,elementType=element.type;let t3,t4;if($[0]!==elementType||$[1]!==maybeEnqueueFontStyle?(t3=()=>{elementType===elements_src.bV.PRODUCT&&maybeEnqueueFontStyle([{font:{family:"Poppins",service:"fonts.google.com",weights:[700],styles:["regular"],variants:[[0,700]]},fontWeight:700}])},t4=[elementType,maybeEnqueueFontStyle],$[0]=elementType,$[1]=maybeEnqueueFontStyle,$[2]=t3,$[3]=t4):(t3=$[2],t4=$[3]),(0,src.vJ)(t3,t4),elementType!==elements_src.bV.PRODUCT)return children;const{productPrice,productPriceCurrency,productTitle}=element.product;let t5;$[4]!==locale||$[5]!==productPrice||$[6]!==productPriceCurrency||$[7]!==productTitle?(t5=productPrice&&productPriceCurrency&&locale?new Intl.NumberFormat(locale,{style:"currency",currency:productPriceCurrency}).format(productPrice):productTitle,$[4]=locale,$[5]=productPrice,$[6]=productPriceCurrency,$[7]=productTitle,$[8]=t5):t5=$[8];const productTagText=t5;let t6,t7;return $[9]!==active||$[10]!==productTagText?(t6=active?react.createElement(TooltipTitle,{productTagText}):null,$[9]=active,$[10]=productTagText,$[11]=t6):t6=$[11],$[12]!==anchorRef||$[13]!==children||$[14]!==t6?(t7=react.createElement(frame_StyledTooltip,{forceAnchorRef:anchorRef,placement:popup_constants.W.Right,hasTail:!1,title:t6},children),$[12]=anchorRef,$[13]=children,$[14]=t6,$[15]=t7):t7=$[15],t7}TooltipTitle.propTypes={productTagText:prop_types_default().string.isRequired},WithProductPill.propTypes={element:propTypes.Ed.element.isRequired,anchorRef:prop_types_default().object,active:prop_types_default().bool.isRequired,children:prop_types_default().node.isRequired};const shopping_frame=WithProductPill,utils_useDoubleClick=(onSingleClick,onDoubleClick,t0)=>{const $=(0,dist.c)(21),ms=void 0===t0?200:t0,[target,setTarget]=(0,src.J0)(null),[lastEvent,setLastEvent]=(0,src.J0)(null);let t1,t2;$[0]!==onDoubleClick||$[1]!==onSingleClick||$[2]!==setLastEvent||$[3]!==setTarget||$[4]!==target?(t1=newTarget=>evt=>{if(evt.stopPropagation(),target!==newTarget)return target&&onSingleClick(evt,target),setTarget(newTarget),void setLastEvent(evt);onDoubleClick(evt,target),setTarget(null)},$[0]=onDoubleClick,$[1]=onSingleClick,$[2]=setLastEvent,$[3]=setTarget,$[4]=target,$[5]=t1):t1=$[5],$[6]!==onDoubleClick||$[7]!==onSingleClick||$[8]!==target?(t2=[onSingleClick,onDoubleClick,target],$[6]=onDoubleClick,$[7]=onSingleClick,$[8]=target,$[9]=t2):t2=$[9];const getHandler=(0,src.hb)(t1,t2);let t3,t4;return $[10]!==lastEvent||$[11]!==ms||$[12]!==onSingleClick||$[13]!==setTarget||$[14]!==target?(t3=()=>{if(!target)return;const int=setTimeout((()=>{setTarget(null),lastEvent&&target&&onSingleClick(lastEvent,target)}),ms);return()=>{clearTimeout(int)}},$[10]=lastEvent,$[11]=ms,$[12]=onSingleClick,$[13]=setTarget,$[14]=target,$[15]=t3):t3=$[15],$[16]!==lastEvent||$[17]!==ms||$[18]!==onSingleClick||$[19]!==target?(t4=[target,lastEvent,onSingleClick,ms],$[16]=lastEvent,$[17]=ms,$[18]=onSingleClick,$[19]=target,$[20]=t4):t4=$[20],(0,src.vJ)(t3,t4),getHandler};var usePerformanceTracking=__webpack_require__("./packages/story-editor/src/utils/usePerformanceTracking.ts"),editLayerFocusManager=__webpack_require__("./packages/story-editor/src/components/canvas/editLayerFocusManager/index.js");function frameElement_extends(){return frameElement_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},frameElement_extends.apply(null,arguments)}const frameElement_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"frameElement__Wrapper",componentId:"sc-80q0sm-0"})([""," "," "," outline:1px solid transparent;transition:outline-color 0.5s;&:focus,&:active{outline-color:",";}"," ",""],element_library_src.AV,element_library_src.WZ,element_library_src.TH,(({theme,hasMask})=>hasMask?"transparent":theme.colors.border.selection),(({isLocked,hasMask,theme})=>!isLocked&&!hasMask&&`\n    &:hover {\n      outline-color: ${theme.colors.border.selection};\n    }\n  `),(({isClickable})=>!isClickable&&"pointer-events: none;")),EmptyFrame=styled_components_browser_esm.Ay.div.withConfig({displayName:"frameElement__EmptyFrame",componentId:"sc-80q0sm-1"})(["position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;"]),FRAME_ELEMENT_MESSAGE=(0,sprintf.A)((0,i18n.__)("To exit the canvas area, press Escape. Press Tab to move to the next group or element. To enter floating menu, press %s.","web-stories"),(0,utils.KV)("ctrl+alt+p"));const frameElement=(0,src.ph)((function FrameElement({id}){const speak=(0,useLiveRegion.A)(),{enterFocusGroup:enterFocusGroup_0,setFocusGroupCleanup:setFocusGroupCleanup_0}=(0,editLayerFocusManager.in)((({enterFocusGroup,setFocusGroupCleanup})=>({enterFocusGroup,setFocusGroupCleanup}))),[isTransforming,setIsTransforming]=(0,src.J0)(!1),focusGroupRef=(0,editLayerFocusManager.ec)(editLayerFocusManager.wn.ELEMENT_SELECTION),{setNodeForElement,handleSelectElement,isEditing,setEditingElement,setEditingElementWithState}=(0,app.yu)((({state,actions})=>({setNodeForElement:actions.setNodeForElement,handleSelectElement:actions.handleSelectElement,isEditing:state.isEditing,setEditingElement:actions.setEditingElement,setEditingElementWithState:actions.setEditingElementWithState}))),{isSelected:isSelected_0,isOnlySelectedElement:isOnlySelectedElement_0,isActive:isActive_0,isBackground,element}=(0,app.P3)((({state:state_0})=>{const isSelected=state_0.selectedElementIds.includes(id),isOnlySelectedElement=isSelected&&1===state_0.selectedElementIds.length,isActive=isOnlySelectedElement&&!isTransforming&&!isEditing;return{isSelected,isBackground:state_0.currentPage?.elements[0].id===id,element:state_0.currentPage?.elements.find((el=>el.id===id)),isOnlySelectedElement,isActive}})),{type,flip,isLocked,isHidden}=element,isClickable=(!isLocked||isSelected_0)&&!isHidden,{Frame,isMaskable,Controls}=(0,elements_src.zh)(type),elementRef=(0,src.li)(),combinedFocusGroupRef=(0,src.jn)(elementRef,focusGroupRef),[hovering,setHovering]=(0,src.J0)(!1),{isRTL,styleConstants:{topOffset}={}}=(0,app.UK)(),{draggingResource:draggingResource_0,activeDropTargetId:activeDropTargetId_0,isDropSource:isDropSource_0,registerDropTarget:registerDropTarget_0,unregisterDropTarget:unregisterDropTarget_0}=(0,app.hS)((({state:{draggingResource,activeDropTargetId},actions:{isDropSource,registerDropTarget,unregisterDropTarget}})=>({draggingResource,activeDropTargetId,isDropSource,registerDropTarget,unregisterDropTarget}))),isLinkActive=(0,app.Gy)((({state:state_1})=>!isSelected_0&&hovering&&!state_1.isAnythingTransforming))&&!isLocked,getBoxWithBorder=(0,useUnits.A)((({actions:actions_0})=>actions_0.getBoxWithBorder));(0,src.Nf)((()=>{setNodeForElement(id,elementRef.current)}),[id,setNodeForElement]);const boxWithBorder=getBoxWithBorder(element);(0,transform_src.Ap)(id,(transform=>{const target=elementRef.current;void 0!==transform?.dropTargets?.hover&&(target.style.opacity=transform.dropTargets.hover?0:1),setIsTransforming(null!==transform)}));const{isMedia}=(0,elements_src.zh)(type),handleMediaDoubleClick=(0,src.hb)((evt=>{isSelected_0||handleSelectElement(id,evt),setEditingElement(id)}),[id,setEditingElement,handleSelectElement,isSelected_0]),handleMediaClick=utils_useDoubleClick(noop.l,handleMediaDoubleClick),handleFocus=(0,src.hb)((evt_0=>{isSelected_0||handleSelectElement(id,evt_0),isBackground||speak(FRAME_ELEMENT_MESSAGE)}),[handleSelectElement,id,isBackground,isSelected_0,speak]),{clearTransforms}=(0,app.Gy)((state_2=>({clearTransforms:state_2.actions.clearTransforms}))),handleMouseDown=(0,src.hb)((evt_1=>{isSelected_0||(handleSelectElement(id,evt_1),clearTransforms()),elementRef.current.focus({preventScroll:!0}),isBackground||evt_1.stopPropagation()}),[handleSelectElement,id,isBackground,isSelected_0,clearTransforms]);(0,usePerformanceTracking.A)({node:elementRef.current,eventData:{...constants.Zy.SELECT_ELEMENT,label:element.type},eventType:"pointerdown"}),(0,keyboard._h)(elementRef,{key:["ctrl+alt+p"]},(()=>{enterFocusGroup_0({groupId:editLayerFocusManager.wn.EDIT_ELEMENT})}),[enterFocusGroup_0]),(0,src.vJ)((()=>{isSelected_0&&setFocusGroupCleanup_0({groupId:editLayerFocusManager.wn.EDIT_ELEMENT,cleanup:()=>elementRef.current?.focus()})}),[setFocusGroupCleanup_0,isSelected_0]);const layerName=(0,elements_src.Hi)(element),elementLabel=element.isLocked?(0,sprintf.A)((0,i18n.__)("Locked element: %s","web-stories"),layerName):(0,sprintf.A)((0,i18n.__)("Element: %s","web-stories"),layerName);return react.createElement(shopping_frame,{element,active:isLinkActive,anchorRef:elementRef},react.createElement(elementLink_frame,{element,active:isLinkActive,anchorRef:elementRef},Controls&&react.createElement(Controls,{isTransforming,box:boxWithBorder,elementRef,element,isRTL,topOffset,isActive:isActive_0}),react.createElement(frameElement_Wrapper,frameElement_extends({ref:combinedFocusGroupRef,"data-element-id":id},boxWithBorder,{tabIndex:-1,role:"button","aria-label":elementLabel,hasMask:isMaskable,isClickable,"data-testid":"frameElement",onMouseDown:handleMouseDown,onFocus:handleFocus,onPointerEnter:()=>setHovering(!0),onPointerLeave:()=>setHovering(!1),onClick:isMedia?handleMediaClick(id):null}),react.createElement(masks_src.we,{element,fill:!0,flip,draggingResource:draggingResource_0,activeDropTargetId:activeDropTargetId_0,isDropSource:isDropSource_0,registerDropTarget:registerDropTarget_0,unregisterDropTarget:unregisterDropTarget_0,isSelected:isSelected_0},Frame?react.createElement(Frame,{wrapperRef:elementRef,element,box:boxWithBorder,isOnlySelectedElement:isOnlySelectedElement_0,setEditingElementWithState}):react.createElement(EmptyFrame,null)))))}));__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");const multiSelectionMoveable_useDrag=function useMultiSelectionDrag({targetList,frames,setTransformStyle,onGroupEventStart,onGroupEventEnd,isDragging,setIsDragging}){const{draggingResource:draggingResource_0}=(0,dropTargets.h)((({state:{draggingResource}})=>({draggingResource}))),{nodesById:nodesById_0,handleSelectElement:handleSelectElement_0}=(0,app.yu)((({state:{nodesById},actions:{handleSelectElement}})=>({nodesById,handleSelectElement}))),eventTracker=(0,src.li)({}),hideHandles=isDragging||Boolean(draggingResource_0);return{onDragGroup:({events})=>{events.forEach((({target,beforeTranslate},i)=>{const sFrame=frames[i],{element}=targetList[i];sFrame.translate=beforeTranslate,setTransformStyle(element,target,sFrame)}))},onDragGroupEnd:({targets,inputEvent:inputEvent_1})=>{setIsDragging(!1),(inputEvent=>{if((0,moveable_src.hW)(eventTracker.current,inputEvent))return!1;const clickedElement=Object.keys(nodesById_0).find((id=>nodesById_0[id].contains(inputEvent.target)));return clickedElement&&setTimeout((()=>{handleSelectElement_0(clickedElement,inputEvent)}),0),!0})(inputEvent_1)||onGroupEventEnd({targets})},onDragGroupStart:({events:events_0,inputEvent:inputEvent_0})=>{(evt=>{const{timeStamp,clientX,clientY}=evt;eventTracker.current={timeStamp,clientX,clientY}})(inputEvent_0),isDragging||setIsDragging(!0),onGroupEventStart({events:events_0,isDrag:!0})},className:"default-moveable "+(hideHandles?"hide-handles":""),resizable:!hideHandles,rotatable:!hideHandles}};const multiSelectionMoveable_useResize=function useResize_useResize({onGroupEventEnd,targetList,setTransformStyle,frames}){const{editorToDataX,editorToDataY,dataToEditorY,dataToEditorX}=(0,useUnits.A)((state=>({editorToDataX:state.actions.editorToDataX,editorToDataY:state.actions.editorToDataY,dataToEditorY:state.actions.dataToEditorY,dataToEditorX:state.actions.dataToEditorX})));return{onResizeGroup:({events:events_0})=>{events_0.forEach((({target,direction,width,height,drag},i_0)=>{const sFrame=frames[i_0],{element,updateForResizeEvent}=targetList[i_0],{border,type}=element,{resizeRules}=(0,elements_src.zh)(type),minWidth=dataToEditorX(resizeRules.minWidth),minHeight=dataToEditorY(resizeRules.minHeight),{left=0,right=0,top=0,bottom=0}=border||{};let newWidth=width-(left+right),newHeight=height-(top+bottom);const aspectRatio=element.width/element.height;newWidth<minWidth&&(newWidth=minWidth,newHeight=newWidth/aspectRatio),newHeight<minHeight&&(newHeight=minHeight,newWidth=minHeight*aspectRatio);let updates=null;updateForResizeEvent&&(updates=updateForResizeEvent(element,direction,editorToDataX(newWidth),editorToDataY(newHeight))),updates&&updates.height&&(newHeight=dataToEditorY(updates.height));const frameWidth=newWidth+left+right,frameHeight=newHeight+top+bottom;target.style.width=`${frameWidth}px`,target.style.height=`${frameHeight}px`,sFrame.direction=direction,sFrame.resize=[frameWidth,frameHeight],sFrame.translate=drag.beforeTranslate,sFrame.updates=updates,setTransformStyle(element,target,sFrame)}))},onResizeGroupStart:({events})=>{events.forEach(((ev,i)=>{const frame=frames[i];ev.setOrigin(["%","%"]),ev.dragStart&&ev.dragStart.set(frame.translate)}))},onResizeGroupEnd:({targets})=>{onGroupEventEnd({targets,isResize:!0})}}};const multiSelectionMoveable_useRotate=function useRotate_useRotate({onGroupEventStart,setTransformStyle,onGroupEventEnd,targetList,frames}){return{onRotateGroup:({events:events_0})=>{events_0.forEach((({target,beforeRotate,drag},i)=>{const sFrame=frames[i],{element}=targetList[i];sFrame.rotate=utils_normalizeRotationDegrees(beforeRotate),sFrame.translate=drag.beforeTranslate,setTransformStyle(element,target,sFrame)}))},onRotateGroupEnd:({targets})=>{onGroupEventEnd({targets,isRotate:!0})},onRotateGroupStart:({events})=>{onGroupEventStart({events,isRotate:!0})},throttleRotate:(0,keyboard.A3)("shift")?30:0}};function multiSelectionMoveable_extends(){return multiSelectionMoveable_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},multiSelectionMoveable_extends.apply(null,arguments)}const CORNER_HANDLES=["nw","ne","sw","se"],MultiSelectionMoveable=(0,src.Rf)((function MultiSelectionMoveable(t0,ref){const $=(0,dist.c)(34);let props,selectedElements;$[0]!==t0?(({selectedElements,...props}=t0),$[0]=t0,$[1]=props,$[2]=selectedElements):(props=$[1],selectedElements=$[2]);const moveable=(0,src.li)(),[isDragging,setIsDragging]=(0,src.J0)(!1),isAnyLayerLocked=selectedElements.some(multiSelectionMoveable_temp),actionsEnabled=!isAnyLayerLocked,{updateElementsById,deleteElementsById,backgroundElement}=(0,app.P3)(multiSelectionMoveable_temp2),{nodesById:nodesById_0,fullbleedContainer:fullbleedContainer_0}=(0,app.yu)(multiSelectionMoveable_temp3),{editorToDataX,editorToDataY}=(0,useUnits.A)(multiSelectionMoveable_temp4),{zoomSetting:zoomSetting_0,scrollLeft:scrollLeft_0,scrollTop:scrollTop_0}=(0,app.gK)(multiSelectionMoveable_temp5),{actions:t1}=(0,transform_src.Gy)(),{pushTransform}=t1;let t2,t3,t4,t5;canvas_useWindowResizeHandler(moveable),$[3]!==moveable.current?(t2=()=>{moveable.current&&moveable.current.updateRect()},$[3]=moveable.current,$[4]=t2):t2=$[4],$[5]!==moveable||$[6]!==nodesById_0||$[7]!==scrollLeft_0||$[8]!==scrollTop_0||$[9]!==selectedElements?(t3=[selectedElements,moveable,nodesById_0,scrollLeft_0,scrollTop_0],$[5]=moveable,$[6]=nodesById_0,$[7]=scrollLeft_0,$[8]=scrollTop_0,$[9]=selectedElements,$[10]=t3):t3=$[10],(0,src.vJ)(t2,t3),$[11]!==zoomSetting_0?(t4=[zoomSetting_0],$[11]=zoomSetting_0,$[12]=t4):t4=$[12],utils_useUpdateSelectionRectangle(moveable,t4),$[13]!==nodesById_0?(t5=element=>({element,node:nodesById_0[element.id],updateForResizeEvent:(0,elements_src.zh)(element.type).updateForResizeEvent}),$[13]=nodesById_0,$[14]=t5):t5=$[14];const targetList=selectedElements.map(t5);let t6;$[15]!==pushTransform?(t6=(element_0,target,frame)=>{const{id,border}=element_0;target.style.transform=`translate(${frame.translate[0]}px, ${frame.translate[1]}px) rotate(${frame.rotate}deg)`;const{left:t7,right:t8,top:t9,bottom:t10}=border||{},left=void 0===t7?0:t7,right=void 0===t8?0:t8,top=void 0===t9?0:t9,bottom=void 0===t10?0:t10;let frameForEl={...frame};if((frame.resize[0]||frame.resize[1])&&(0,masks_src.Fn)(element_0)){const elWidth=frame.resize[0]-(left+right),elHeight=frame.resize[1]-(top+bottom);frameForEl={...frame,resize:[elWidth,elHeight]}}pushTransform(id,frameForEl)},$[15]=pushTransform,$[16]=t6):t6=$[16];const setTransformStyle=t6,frames=targetList?targetList.map(multiSelectionMoveable_temp6):[],onGroupEventStart=t8=>{const{events,isDrag,isRotate}=t8;events.forEach(((ev,i_0)=>{const sFrame=frames[i_0];isDrag?ev.set(sFrame.translate):isRotate&&ev.set(sFrame.rotate)}))},onGroupEventEnd=t9=>{const{targets,isRotate:isRotate_0,isResize}=t9,updates={},toRemove=[];targets.forEach(((target_0,i_1)=>{const{element:element_3,updateForResizeEvent}=targetList[i_1];if((0,isTargetOutOfContainer.A)(target_0,fullbleedContainer_0))return void toRemove.push(element_3.id);const frame_0=frames[i_1],{direction}=frame_0,roundToZero=multiSelectionMoveable_temp7,properties={x:roundToZero(element_3.x+editorToDataX(frame_0.translate[0])),y:roundToZero(element_3.y+editorToDataY(frame_0.translate[1]))};isRotate_0&&(properties.rotationAngle=frame_0.rotate);const[editorWidth,editorHeight]=frame_0.resize;if(isResize&&(0!==editorWidth&&0!==editorHeight)){const{border:border_0}=element_3,{left:t10,right:t11,top:t12,bottom:t13}=border_0||{},top_0=void 0===t12?0:t12,bottom_0=void 0===t13?0:t13,newWidth=editorToDataX(editorWidth-((void 0===t10?0:t10)+(void 0===t11?0:t11))),newHeight=editorToDataY(editorHeight-(top_0+bottom_0));properties.width=newWidth,properties.height=newHeight,updateForResizeEvent&&Object.assign(properties,updateForResizeEvent(element_3,direction,newWidth,newHeight))}updates[element_3.id]=properties})),updateElementsById({elementIds:Object.keys(updates),properties:currentProperties=>updates[currentProperties.id]}),toRemove.length>0&&deleteElementsById({elementIds:toRemove}),targetList.forEach(((t7,i)=>{const{element:element_2,node}=t7;frames[i].direction=[0,0],frames[i].translate=[0,0],frames[i].resize=[0,0],frames[i].updates=null,node.style.transform="",node.style.width="",node.style.height="",pushTransform(element_2.id,null)})),moveable.current&&moveable.current.updateRect()};let t14;$[17]!==backgroundElement.id||$[18]!==nodesById_0||$[19]!==selectedElements?(t14=Object.values((0,objectWithout.A)(nodesById_0,[...selectedElements.map(multiSelectionMoveable_temp8),backgroundElement.id])),$[17]=backgroundElement.id,$[18]=nodesById_0,$[19]=selectedElements,$[20]=t14):t14=$[20];const otherNodes=t14;let t15;$[21]!==otherNodes?(t15={canSnap:!0,otherNodes},$[21]=otherNodes,$[22]=t15):t15=$[22];const snapProps=(0,useSnapping.A)(t15),dragProps=multiSelectionMoveable_useDrag({targetList,frames,setTransformStyle,onGroupEventStart,onGroupEventEnd,isDragging,setIsDragging}),resizeProps=multiSelectionMoveable_useResize({onGroupEventEnd,targetList,setTransformStyle,frames}),rotateProps=multiSelectionMoveable_useRotate({onGroupEventStart,setTransformStyle,onGroupEventEnd,targetList,frames}),combinedRef=(0,src.jn)(moveable,ref);if(targetList.some(_temp9))return null;const classNames=classnames_default()("default-moveable",{"hide-handles":isDragging,immoveable:isAnyLayerLocked}),T0=moveable_src.uW,t17=targetList.map(_temp10);let t18;return $[23]!==T0||$[24]!==actionsEnabled||$[25]!==classNames||$[26]!==combinedRef||$[27]!==dragProps||$[28]!==props||$[29]!==resizeProps||$[30]!==rotateProps||$[31]!==snapProps||$[32]!==t17?(t18=react.createElement(T0,multiSelectionMoveable_extends({},props,{className:classNames,ref:combinedRef,zIndex:0,target:t17,renderDirections:CORNER_HANDLES},dragProps,{draggable:actionsEnabled,resizable:actionsEnabled,rotatable:actionsEnabled},rotateProps,resizeProps,snapProps)),$[23]=T0,$[24]=actionsEnabled,$[25]=classNames,$[26]=combinedRef,$[27]=dragProps,$[28]=props,$[29]=resizeProps,$[30]=rotateProps,$[31]=snapProps,$[32]=t17,$[33]=t18):t18=$[33],t18}));MultiSelectionMoveable.propTypes={selectedElements:prop_types_default().arrayOf(prop_types_default().object).isRequired};const multiSelectionMoveable=MultiSelectionMoveable;function multiSelectionMoveable_temp(el){return el.isLocked}function multiSelectionMoveable_temp2(state){return{updateElementsById:state.actions.updateElementsById,deleteElementsById:state.actions.deleteElementsById,backgroundElement:state.state.currentPage.elements[0]??{}}}function multiSelectionMoveable_temp3(t0){const{state:t1}=t0,{nodesById,fullbleedContainer}=t1;return{fullbleedContainer,nodesById}}function multiSelectionMoveable_temp4(state_0){return{editorToDataX:state_0.actions.editorToDataX,editorToDataY:state_0.actions.editorToDataY}}function multiSelectionMoveable_temp5(t0){const{state:t1}=t0,{zoomSetting,scrollLeft,scrollTop}=t1;return{zoomSetting,scrollLeft,scrollTop}}function multiSelectionMoveable_temp6(t0){const{element:element_1}=t0;return{translate:[0,0],rotate:element_1.rotationAngle,direction:[0,0],resize:[0,0],updates:null}}function multiSelectionMoveable_temp7(num){return Math.abs(num)<=1?0:num}function multiSelectionMoveable_temp8(element_4){return element_4.id}function _temp9(t0){const{node:node_0}=t0;return void 0===node_0}function _temp10(t0){const{node:node_1}=t0;return node_1}function selection_extends(){return selection_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},selection_extends.apply(null,arguments)}function selection_temp3(t0){const{state:t1}=t0,{editingElement,lastSelectionEvent,nodesById,onMoveableMount}=t1;return{editingElement,lastSelectionEvent,nodesById,onMoveableMount}}function selection_temp2(state_0){return{selectedElements:state_0.state.selectedElements,isAnimating:[animation_src.TR.Playing,animation_src.TR.PlayingSelected,animation_src.TR.Scrubbing].includes(state_0.state.animationState)}}function selection_temp(t0){const{state}=t0;return state.selectedElements[0]?.id===state.currentPage?.elements?.[0]?.id}const selection=function Selection(props){const $=(0,dist.c)(14),isBackground=(0,app.P3)(selection_temp),{selectedElements,isAnimating}=(0,app.P3)(selection_temp2),{editingElement:editingElement_0,lastSelectionEvent:lastSelectionEvent_0,nodesById:nodesById_0,onMoveableMount:onMoveableMount_0}=(0,app.yu)(selection_temp3);if(0===selectedElements.length)return null;if(isBackground)return null;const isVideoPlaceholder=selectedElements[0]?.resource?.isPlaceholder;if(isVideoPlaceholder)return null;if(editingElement_0||isAnimating)return null;if(1===selectedElements.length){const selectedElement=selectedElements[0],target=nodesById_0[selectedElement.id];if(!target)return null;let t0,t1;return $[0]!==onMoveableMount_0?(t0=onMoveableMount_0&&{ref:onMoveableMount_0},$[0]=onMoveableMount_0,$[1]=t0):t0=$[1],$[2]!==lastSelectionEvent_0||$[3]!==props||$[4]!==selectedElement||$[5]!==t0||$[6]!==target?(t1=react.createElement(singleSelectionMoveable,selection_extends({selectedElement,targetEl:target,pushEvent:lastSelectionEvent_0},props,t0)),$[2]=lastSelectionEvent_0,$[3]=props,$[4]=selectedElement,$[5]=t0,$[6]=target,$[7]=t1):t1=$[7],t1}let t0,t1;return $[8]!==onMoveableMount_0?(t0=onMoveableMount_0&&{ref:onMoveableMount_0},$[8]=onMoveableMount_0,$[9]=t0):t0=$[9],$[10]!==props||$[11]!==selectedElements||$[12]!==t0?(t1=react.createElement(multiSelectionMoveable,selection_extends({selectedElements},props,t0)),$[10]=props,$[11]=selectedElements,$[12]=t0,$[13]=t1):t1=$[13],t1};var arrow_left_large=__webpack_require__("./packages/design-system/src/icons/arrow_left_large.svg");const pagenav_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"pagenav__Wrapper",componentId:"sc-j8q0gt-0"})(["display:flex;align-items:center;color:",";& > *{pointer-events:initial;}"],(({theme})=>theme.colors.fg.white)),FlippableArrow=(0,styled_components_browser_esm.Ay)(arrow_left_large.A).withConfig({displayName:"pagenav__FlippableArrow",componentId:"sc-j8q0gt-1"})(["transform:rotate(","turn);"],(({$isLeft})=>$isLeft?0:.5));function PageNav(t0){const $=(0,dist.c)(20),{isNext:t1}=t0,isNext=void 0===t1||t1,{pages:pages_0,currentPageIndex:currentPageIndex_0,setCurrentPage:setCurrentPage_0}=(0,app.P3)(pagenav_temp),{isRTL}=(0,app.UK)(),buttonRef=(0,src.li)(null);let t2;$[0]===Symbol.for("react.memo_cache_sentinel")?(t2=[],$[0]=t2):t2=$[0];const cancelMouseDown=(0,src.hb)(pagenav_temp2,t2);let t3,t4;$[1]!==currentPageIndex_0||$[2]!==isNext||$[3]!==pages_0||$[4]!==setCurrentPage_0?(t3=()=>{const newPage=isNext?pages_0[currentPageIndex_0+1]:pages_0[currentPageIndex_0-1];newPage&&setCurrentPage_0({pageId:newPage.id})},t4=[setCurrentPage_0,currentPageIndex_0,isNext,pages_0],$[1]=currentPageIndex_0,$[2]=isNext,$[3]=pages_0,$[4]=setCurrentPage_0,$[5]=t3,$[6]=t4):(t3=$[5],t4=$[6]);const handleClick=(0,src.hb)(t3,t4),{hasPageNavigation:hasPageNavigation_0}=(0,app.gK)(pagenav_temp3);let t5;if($[7]!==buttonRef.current?(t5={node:buttonRef.current,eventData:constants.Zy.PAGE_NAVIGATION},$[7]=buttonRef.current,$[8]=t5):t5=$[8],(0,usePerformanceTracking.A)(t5),!hasPageNavigation_0)return!1;const displayNav=isNext&&currentPageIndex_0<pages_0.length-1||!isNext&&currentPageIndex_0>0,isLeft=isRTL===isNext,t6=!displayNav;let t7,t8,t9;return $[9]!==isNext?(t7=isNext?(0,i18n.__)("Next Page","web-stories"):(0,i18n.__)("Previous Page","web-stories"),$[9]=isNext,$[10]=t7):t7=$[10],$[11]!==isLeft?(t8=react.createElement(FlippableArrow,{$isLeft:isLeft}),$[11]=isLeft,$[12]=t8):t8=$[12],$[13]!==buttonRef||$[14]!==cancelMouseDown||$[15]!==handleClick||$[16]!==t6||$[17]!==t7||$[18]!==t8?(t9=react.createElement(pagenav_Wrapper,null,react.createElement(button_button.$,{ref:buttonRef,variant:button_constants.Ak.Square,type:button_constants.VQ.Tertiary,size:button_constants.Mp.Medium,"aria-disabled":t6,"aria-label":t7,onClick:handleClick,onMouseDown:cancelMouseDown},t8)),$[13]=buttonRef,$[14]=cancelMouseDown,$[15]=handleClick,$[16]=t6,$[17]=t7,$[18]=t8,$[19]=t9):t9=$[19],t9}function pagenav_temp3(t0){const{state:t1}=t0,{hasPageNavigation}=t1;return{hasPageNavigation}}function pagenav_temp2(evt){return evt.stopPropagation()}function pagenav_temp(t0){const{state:t1,actions:t2}=t0,{pages,currentPageIndex}=t1,{setCurrentPage}=t2;return{pages,currentPageIndex,setCurrentPage}}PageNav.propTypes={isNext:prop_types_default().bool};const pagenav=PageNav,FramesPageArea=(0,styled_components_browser_esm.Ay)(PageArea).withConfig({displayName:"framesLayer__FramesPageArea",componentId:"sc-5ltl4w-0"})(["pointer-events:initial;"]),marginRatio=constants.Jg/src_constants.bj*100,FocusContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"framesLayer__FocusContainer",componentId:"sc-5ltl4w-1"})(["grid-row:2 / -1;grid-column:1 / -1;margin:5px;",";"],outline.Q),FOCUS_CONTAINER_MESSAGE=(0,i18n.__)("Canvas Area. To navigate into the page, press Enter.","web-stories"),framesLayer_FRAME_ELEMENT_MESSAGE=(0,i18n.__)("To exit the canvas area, press Escape. Press Tab to move to the next group or element.","web-stories"),DesignSpaceGuidelineBorder=styled_components_browser_esm.Ay.div.withConfig({displayName:"framesLayer__DesignSpaceGuidelineBorder",componentId:"sc-5ltl4w-2"})(["border:1px solid ",";left:","%;right:","%;top:0;bottom:0;position:absolute;pointer-events:none;z-index:1;visibility:",";"],(({theme})=>theme.colors.border.negativePress),marginRatio,marginRatio,(({isVisible})=>isVisible?"visible":"hidden"));function DesignSpaceGuideline(){const $=(0,dist.c)(3),setDesignSpaceGuideline=(0,app.yu)(framesLayer_temp),{isAnythingTransforming}=(0,app.Gy)(framesLayer_temp2);let t0;return $[0]!==isAnythingTransforming||$[1]!==setDesignSpaceGuideline?(t0=react.createElement(DesignSpaceGuidelineBorder,{ref:setDesignSpaceGuideline,isVisible:isAnythingTransforming}),$[0]=isAnythingTransforming,$[1]=setDesignSpaceGuideline,$[2]=t0):t0=$[2],t0}function framesLayer_temp2(t0){const{state}=t0;return{isAnythingTransforming:state.isAnythingTransforming}}function framesLayer_temp(t0){const{actions}=t0;return actions.setDesignSpaceGuideline}function FramesNavAndSelection(t0){const $=(0,dist.c)(13),{children}=t0,framesLayerRef=(0,src.li)(null),onOpenMenu=(0,app.lS)(framesLayer_temp3);let t1,t2,t3,t4,t5,t6,t7,t8;return $[0]!==onOpenMenu?(t1=evt=>{document.dispatchEvent(new KeyboardEvent("keydown",{key:"tab"})),onOpenMenu(evt)},$[0]=onOpenMenu,$[1]=t1):t1=$[1],(0,keyboard._h)(framesLayerRef,"mod+alt+shift+m",t1),$[2]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n.__)("Frames layer","web-stories"),$[2]=t2):t2=$[2],$[3]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(PageBeforeArea,null,react.createElement(extraPages,{isPrevious:!0})),$[3]=t3):t3=$[3],$[4]===Symbol.for("react.memo_cache_sentinel")?(t4=react.createElement(PageAfterArea,null,react.createElement(extraPages,null)),$[4]=t4):t4=$[4],$[5]===Symbol.for("react.memo_cache_sentinel")?(t5=react.createElement(NavPrevArea,null,react.createElement(pagenav,{isNext:!1})),$[5]=t5):t5=$[5],$[6]===Symbol.for("react.memo_cache_sentinel")?(t6=react.createElement(NavNextArea,null,react.createElement(pagenav,null)),$[6]=t6):t6=$[6],$[7]!==onOpenMenu?(t7=react.createElement(selection,{onContextMenu:onOpenMenu}),$[7]=onOpenMenu,$[8]=t7):t7=$[8],$[9]!==children||$[10]!==framesLayerRef||$[11]!==t7?(t8=react.createElement(Layer,{ref:framesLayerRef,"data-testid":"FramesLayer",pointerEvents:"initial",tabIndex:"-1","aria-label":t2},children,t3,t4,t5,t6,t7),$[9]=children,$[10]=framesLayerRef,$[11]=t7,$[12]=t8):t8=$[12],t8}function framesLayer_temp3(state){return state.onOpenMenu}function FrameElements(){const $=(0,dist.c)(8),elementIds=(0,app.P3)(framesLayer_temp5),isAnimating=(0,app.P3)(framesLayer_temp6),onOpenMenu=(0,app.lS)(framesLayer_temp7),{setScrollOffset:setScrollOffset_0}=(0,app.gK)(framesLayer_temp8);let t0,t1;$[0]!==setScrollOffset_0?(t0=evt=>setScrollOffset_0({left:evt.target.scrollLeft,top:evt.target.scrollTop}),t1=[setScrollOffset_0],$[0]=setScrollOffset_0,$[1]=t0,$[2]=t1):(t0=$[1],t1=$[2]);const onScroll=(0,src.hb)(t0,t1);let t2;return $[3]!==elementIds||$[4]!==isAnimating||$[5]!==onOpenMenu||$[6]!==onScroll?(t2=!isAnimating&&react.createElement(FramesPageArea,{fullBleedContainerLabel:(0,i18n.__)("Fullbleed area (Frames layer)","web-stories"),onContextMenu:onOpenMenu,onScroll},elementIds.map(framesLayer_temp9),react.createElement(DesignSpaceGuideline,null)),$[3]=elementIds,$[4]=isAnimating,$[5]=onOpenMenu,$[6]=onScroll,$[7]=t2):t2=$[7],t2}function framesLayer_temp9(id){return react.createElement(frameElement,{key:id,id})}function framesLayer_temp8(t0){const{actions:t1}=t0,{setScrollOffset}=t1;return{setScrollOffset}}function framesLayer_temp7(state_1){return state_1.onOpenMenu}function framesLayer_temp6(t0){const{state:state_0}=t0;return[animation_src.TR.Playing,animation_src.TR.Scrubbing].includes(state_0.animationState)}function framesLayer_temp5(t0){const{state}=t0;return state.currentPage?.elements?.map(framesLayer_temp4)||constants.qW}function framesLayer_temp4(el){return el.id}function framesLayer_temp10(t0){const{enterFocusGroup,setFocusGroupCleanup}=t0;return{enterFocusGroup,setFocusGroupCleanup}}FramesNavAndSelection.propTypes={children:prop_types_default().node};const framesLayer=(0,src.ph)((function FramesLayer(){const $=(0,dist.c)(19),canvasRef=(0,src.li)(),speak=(0,useLiveRegion.A)(),{enterFocusGroup:enterFocusGroup_0,setFocusGroupCleanup:setFocusGroupCleanup_0}=(0,editLayerFocusManager.in)(framesLayer_temp10);let t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0={key:"mod+option+2",editable:!0},$[0]=t0):t0=$[0],$[1]!==enterFocusGroup_0?(t1=()=>{enterFocusGroup_0({groupId:editLayerFocusManager.wn.ELEMENT_SELECTION})},t2=[enterFocusGroup_0],$[1]=enterFocusGroup_0,$[2]=t1,$[3]=t2):(t1=$[2],t2=$[3]),(0,keyboard.pP)(t0,t1,t2),canvas_useCanvasKeys(canvasRef),$[4]===Symbol.for("react.memo_cache_sentinel")?(t3={key:["enter"]},$[4]=t3):t3=$[4],$[5]!==enterFocusGroup_0||$[6]!==speak?(t4=()=>{enterFocusGroup_0({groupId:editLayerFocusManager.wn.ELEMENT_SELECTION}),speak(framesLayer_FRAME_ELEMENT_MESSAGE)},t5=[enterFocusGroup_0,speak],$[5]=enterFocusGroup_0,$[6]=speak,$[7]=t4,$[8]=t5):(t4=$[7],t5=$[8]),(0,keyboard._h)(canvasRef,t3,t4,t5),$[9]!==canvasRef.current||$[10]!==setFocusGroupCleanup_0?(t6=()=>{setFocusGroupCleanup_0({groupId:editLayerFocusManager.wn.ELEMENT_SELECTION,cleanup:()=>canvasRef.current?.focus()})},$[9]=canvasRef.current,$[10]=setFocusGroupCleanup_0,$[11]=t6):t6=$[11],$[12]!==setFocusGroupCleanup_0?(t7=[setFocusGroupCleanup_0],$[12]=setFocusGroupCleanup_0,$[13]=t7):t7=$[13],(0,react.useEffect)(t6,t7),$[14]!==canvasRef?(t8=react.createElement(FocusContainer,{role:"region","data-testid":"canvas-focus-container",ref:canvasRef,"aria-label":FOCUS_CONTAINER_MESSAGE,tabIndex:0}),$[14]=canvasRef,$[15]=t8):t8=$[15],$[16]===Symbol.for("react.memo_cache_sentinel")?(t9=react.createElement(FrameElements,null),$[16]=t9):t9=$[16],$[17]!==t8?(t10=react.createElement(FramesNavAndSelection,null,t8,t9),$[17]=t8,$[18]=t10):t10=$[18],t10}));var checklist=__webpack_require__("./packages/story-editor/src/components/checklist/index.js"),keyboardShortcutsMenuContext=__webpack_require__("./packages/story-editor/src/components/keyboardShortcutsMenu/keyboardShortcutsMenuContext/index.ts"),CSSTransition=__webpack_require__("./node_modules/react-transition-group/esm/CSSTransition.js"),arrow_left=__webpack_require__("./packages/design-system/src/icons/arrow_left.svg");const context=(0,src.q6)({state:{pageThumbWidth:0,pageThumbHeight:0,pageThumbMargin:0,carouselWidth:0,hasOverflow:!1,pages:[],pageIds:[],numPages:0,currentPageId:null,canScrollBack:!1,canScrollForward:!1,showSkeleton:!1},actions:{scrollBack:noop.l,scrollForward:noop.l,clickPage:noop.l,rearrangePages:noop.l,setListRef:noop.l,setPageRef:noop.l}});const carouselContext_useCarousel=function useCarousel(t0){const selector=void 0===t0?src.D_:t0;return(0,src.i7)(context,selector)};var idleCallback=__webpack_require__("./packages/story-editor/src/utils/idleCallback.ts");const carouselContext_useCarouselSizing=function useCarouselSizing(t0){const $=(0,dist.c)(4),{availableSpace,numPages}=t0;let t1,t2;return $[0]!==availableSpace||$[1]!==numPages?(t1=()=>{const isWideCarousel=availableSpace>=400,spaceForCarousel=availableSpace-2*NAVIGATION_BUTTON_GUTTER,pageThumbWidth=isWideCarousel?45:36,pageThumbHeight=isWideCarousel?80:64,pageAndMargin=pageThumbWidth+16,showablePages=Math.floor((spaceForCarousel-16)/pageAndMargin),hasOverflow=showablePages<numPages;return{pageThumbWidth,pageThumbHeight,pageThumbMargin:16,carouselWidth:Math.min(showablePages,numPages)*(pageThumbWidth+16)+16,showablePages,hasOverflow}},t2=[availableSpace,numPages],$[0]=availableSpace,$[1]=numPages,$[2]=t1,$[3]=t2):(t1=$[2],t2=$[3]),(0,src.Kr)(t1,t2)};var config=__webpack_require__("./packages/story-editor/src/app/config/index.ts");const carouselContext_useCarouselScroll=function useCarouselScroll({listElement,carouselWidth,hasOverflow,showablePages,pageThumbWidth,pageThumbMargin}){const[ratio,setRatio]=(0,src.J0)(0),{isRTL}=(0,config.UK)(),{carouselState:carouselState_0}=(0,layout.g)((({state:{carouselState}})=>({carouselState}))),{currentPageIndex}=(0,story.P3)((({state:{currentPageId,pages}})=>({currentPageIndex:pages.findIndex((({id})=>id===currentPageId))}))),scroll=(0,src.hb)((offset=>{listElement&&(isRTL&&(offset*=-1),listElement.scrollBy({left:offset,behavior:"smooth"}))}),[listElement,isRTL]),scrollByPx=carouselWidth,canScrollBack=hasOverflow&&!(0===ratio),canScrollForward=hasOverflow&&!(isRTL?-1===ratio:1===ratio),scrollForward=(0,src.hb)((()=>scroll(scrollByPx)),[scroll,scrollByPx]),scrollBack=(0,src.hb)((()=>scroll(-scrollByPx)),[scroll,scrollByPx]);(0,src.Nf)((()=>{if(!hasOverflow||!listElement)return;const handleScroll=()=>{const{offsetWidth,scrollLeft,scrollWidth}=listElement;setRatio(scrollLeft/(scrollWidth-offsetWidth))};return listElement.addEventListener("scroll",handleScroll,{passive:!0}),()=>listElement.removeEventListener("scroll",handleScroll)}),[listElement,hasOverflow]);const getOffsetFromIndex=(0,src.hb)((index=>(pageThumbWidth+pageThumbMargin)*index),[pageThumbWidth,pageThumbMargin]),firstScrollRef=(0,src.li)(!0);return(0,src.vJ)((()=>{carouselState_0===constants.Wc.Closed&&(firstScrollRef.current=!0)}),[carouselState_0]),(0,src.Nf)((()=>{if(!hasOverflow||!listElement)return;const{scrollLeft:scrollLeft_0}=listElement,minVisiblePageIndex=Math.max(0,currentPageIndex-showablePages+1),maxVisiblePageIndex=currentPageIndex,minOffset=getOffsetFromIndex(minVisiblePageIndex),maxOffset=getOffsetFromIndex(maxVisiblePageIndex);if(scrollLeft_0>=minOffset&&scrollLeft_0<=maxOffset)return;const targetLeft=scrollLeft_0<minOffset?minOffset:maxOffset,retry=setInterval((()=>{if(listElement.scrollWidth-listElement.offsetWidth<targetLeft)return;const scrollBehavior=firstScrollRef.current?"auto":"smooth";firstScrollRef.current=!1,listElement.scrollTo({left:targetLeft,top:0,behavior:scrollBehavior}),clearInterval(retry)}),100);return()=>clearInterval(retry)}),[listElement,hasOverflow,currentPageIndex,showablePages,getOffsetFromIndex]),{canScrollBack,canScrollForward,scrollForward,scrollBack}};function useCarouselKeys_temp2(t0){const{id}=t0;return id}function useCarouselKeys_temp(t0){const{state:t1,actions:t2}=t0,{pages,currentPage,currentPageId}=t1,{addPageAt,arrangePage,deletePage,setCurrentPage}=t2;return{addPageAt,arrangePage,currentPage,currentPageId,deletePage,pages,setCurrentPage}}function getArrowDir(key,pos,neg,isRTL){const rtlDir=isRTL?-1:1;return key===pos?rtlDir:key===neg?-rtlDir:0}const carouselContext_useCarouselKeys=function useCarouselKeys(t0){const $=(0,dist.c)(41),{listElement,pageRefs}=t0,{isRTL}=(0,config.UK)(),{addPageAt:addPageAt_0,arrangePage:arrangePage_0,currentPage:currentPage_0,currentPageId:currentPageId_0,deletePage:deletePage_0,pages:pages_0,setCurrentPage:setCurrentPage_0}=(0,story.P3)(useCarouselKeys_temp);let t1,t2;$[0]!==pages_0?(t1=()=>pages_0.map(useCarouselKeys_temp2),t2=[pages_0],$[0]=pages_0,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const pageIds=(0,src.Kr)(t1,t2);let t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13;$[3]!==listElement?(t3=[listElement],$[3]=listElement,$[4]=t3):t3=$[4],(0,keyboard.A0)(listElement,t3),$[5]===Symbol.for("react.memo_cache_sentinel")?(t4={key:["up","down","left","right"]},$[5]=t4):t4=$[5],$[6]!==currentPageId_0||$[7]!==isRTL||$[8]!==pageIds||$[9]!==pageRefs||$[10]!==setCurrentPage_0?(t5=t6=>{const{key}=t6,dir=getArrowDir(key,"ArrowRight","ArrowLeft",isRTL);if(0===dir)return;if(!currentPageId_0)return;const nextIndex=pageIds.indexOf(currentPageId_0)+dir;if(nextIndex>=0&&nextIndex<pageIds.length){const pageId=pageIds[nextIndex];setCurrentPage_0({pageId});const thumbnail=pageRefs.current&&pageRefs.current[pageId],button=thumbnail?.querySelector("button");button&&button.focus()}},$[6]=currentPageId_0,$[7]=isRTL,$[8]=pageIds,$[9]=pageRefs,$[10]=setCurrentPage_0,$[11]=t5):t5=$[11],$[12]!==currentPageId_0||$[13]!==isRTL||$[14]!==listElement||$[15]!==pageIds||$[16]!==pageRefs||$[17]!==setCurrentPage_0?(t6=[currentPageId_0,isRTL,pageIds,setCurrentPage_0,pageRefs,listElement],$[12]=currentPageId_0,$[13]=isRTL,$[14]=listElement,$[15]=pageIds,$[16]=pageRefs,$[17]=setCurrentPage_0,$[18]=t6):t6=$[18],(0,keyboard._h)(listElement,t4,t5,t6),$[19]===Symbol.for("react.memo_cache_sentinel")?(t7={key:["mod+up","mod+down","mod+left","mod+right"],shift:!0},$[19]=t7):t7=$[19],$[20]!==arrangePage_0||$[21]!==currentPageId_0||$[22]!==isRTL||$[23]!==pageIds?(t8=evt=>{const{key:key_0,shiftKey}=evt;evt.preventDefault();const dir_0=getArrowDir(key_0,"ArrowRight","ArrowLeft",isRTL);if(0===dir_0)return;if(!currentPageId_0)return;const index_0=pageIds.indexOf(currentPageId_0);let newPos=index_0+dir_0;shiftKey&&(newPos=dir_0<0?0:pageIds.length-1),newPos!==index_0&&newPos>=0&&newPos<pageIds.length&&arrangePage_0({pageId:currentPageId_0,position:newPos})},$[20]=arrangePage_0,$[21]=currentPageId_0,$[22]=isRTL,$[23]=pageIds,$[24]=t8):t8=$[24],$[25]!==arrangePage_0||$[26]!==currentPageId_0||$[27]!==isRTL||$[28]!==pageIds||$[29]!==setCurrentPage_0?(t9=[arrangePage_0,currentPageId_0,isRTL,pageIds,setCurrentPage_0],$[25]=arrangePage_0,$[26]=currentPageId_0,$[27]=isRTL,$[28]=pageIds,$[29]=setCurrentPage_0,$[30]=t9):t9=$[30],(0,keyboard._h)(listElement,t7,t8,t9),$[31]!==currentPageId_0||$[32]!==deletePage_0||$[33]!==listElement?(t10=()=>{deletePage_0({pageId:currentPageId_0});const currentElement=document.activeElement,setFocusWhenActiveElementChanges=()=>{if(document.activeElement!==currentElement&&listElement){const focusableOption=listElement.querySelector('[role="option"][tabindex="0"]');if(focusableOption)return void focusableOption.focus()}setTimeout(setFocusWhenActiveElementChanges,100)};setFocusWhenActiveElementChanges()},t11=[currentPageId_0,deletePage_0,listElement],$[31]=currentPageId_0,$[32]=deletePage_0,$[33]=listElement,$[34]=t10,$[35]=t11):(t10=$[34],t11=$[35]),(0,keyboard._h)(listElement,"delete",t10,t11),$[36]!==addPageAt_0||$[37]!==currentPage_0||$[38]!==pageIds?(t12=()=>{if(!currentPage_0)return;const index_1=pageIds.indexOf(currentPage_0.id);addPageAt_0({page:(0,elements_src.hi)(currentPage_0),position:index_1+1})},t13=[addPageAt_0,currentPage_0,pageIds],$[36]=addPageAt_0,$[37]=currentPage_0,$[38]=pageIds,$[39]=t12,$[40]=t13):(t12=$[39],t13=$[40]),(0,keyboard._h)(listElement,"clone",t12,t13)};const carouselProvider=function CarouselProvider({availableSpace,children}){const{pages:pages_0,currentPageId:currentPageId_0,setCurrentPage:setCurrentPage_0,arrangePage:arrangePage_0}=(0,story.P3)((({state:{pages,currentPageId},actions:{setCurrentPage,arrangePage}})=>({pages,currentPageId,setCurrentPage,arrangePage}))),[listElement,setListElement]=(0,src.J0)(null),pagesRef=(0,src.li)({}),numPages=pages_0.length,pageIds=(0,src.Kr)((()=>pages_0.map((({id})=>id))),[pages_0]),[showSkeleton,setShowSkeleton]=(0,src.J0)(!0);(0,src.vJ)((()=>{const id_0=(0,idleCallback.B)((()=>setShowSkeleton(!1)),{timeout:5e3});return()=>(0,idleCallback.G)(id_0)}),[]);const{pageThumbWidth,pageThumbHeight,pageThumbMargin,carouselWidth,hasOverflow,showablePages}=carouselContext_useCarouselSizing({availableSpace,numPages}),{canScrollBack,canScrollForward,scrollBack,scrollForward}=carouselContext_useCarouselScroll({listElement,carouselWidth,hasOverflow,showablePages,pageThumbWidth,pageThumbMargin});carouselContext_useCarouselKeys({listElement,pageRefs:pagesRef});const setPageRef=(0,src.hb)(((page,el)=>{pagesRef.current[page.id]=el}),[]),clickPage=(0,src.hb)((page_0=>setCurrentPage_0({pageId:page_0.id})),[setCurrentPage_0]),rearrangePages=(0,src.hb)((({position:oldPos},{position:newPos})=>{const pageId=pageIds[oldPos];arrangePage_0({pageId,position:newPos}),setCurrentPage_0({pageId})}),[pageIds,arrangePage_0,setCurrentPage_0]),value={state:{pageThumbWidth,pageThumbHeight,pageThumbMargin,carouselWidth,hasOverflow,pages:pages_0,pageIds,numPages,currentPageId:currentPageId_0,canScrollBack,canScrollForward,showSkeleton},actions:{scrollBack,scrollForward,clickPage,rearrangePages,setListRef:setListElement,setPageRef}};return react.createElement(context.Provider,{value},children)},carouselScroll_FlippableArrow=(0,styled_components_browser_esm.Ay)(arrow_left.A).withConfig({displayName:"carouselScroll__FlippableArrow",componentId:"sc-1npfzcu-0"})(["transform:rotate(","turn);"],(({$isLeft})=>$isLeft?0:.5));function CarouselScrollButton(t0){const $=(0,dist.c)(9),{isNext:t1}=t0,isNext=void 0!==t1&&t1,{hasOverflow:hasOverflow_0,canScrollBack:canScrollBack_0,canScrollForward:canScrollForward_0,scrollBack:scrollBack_0,scrollForward:scrollForward_0}=carouselContext_useCarousel(carouselScroll_temp),{isRTL}=(0,app.UK)();if(!hasOverflow_0)return null;const canScroll=isNext?canScrollForward_0:canScrollBack_0,onClick=isNext?scrollForward_0:scrollBack_0;let t2;$[0]!==isNext?(t2=isNext?(0,i18n.__)("Scroll Forward","web-stories"):(0,i18n.__)("Scroll Back","web-stories"),$[0]=isNext,$[1]=t2):t2=$[1];const label=t2,isLeft=isRTL===isNext,t3=!canScroll;let t4,t5;return $[2]!==isLeft?(t4=react.createElement(carouselScroll_FlippableArrow,{$isLeft:isLeft}),$[2]=isLeft,$[3]=t4):t4=$[3],$[4]!==label||$[5]!==onClick||$[6]!==t3||$[7]!==t4?(t5=react.createElement(button_button.$,{variant:button_constants.Ak.Square,type:button_constants.VQ.Plain,size:button_constants.Mp.Small,disabled:t3,onClick,"aria-label":label},t4),$[4]=label,$[5]=onClick,$[6]=t3,$[7]=t4,$[8]=t5):t5=$[8],t5}function carouselScroll_temp(t0){const{state:t1,actions:t2}=t0,{hasOverflow,canScrollBack,canScrollForward}=t1,{scrollBack,scrollForward}=t2;return{hasOverflow,canScrollBack,canScrollForward,scrollBack,scrollForward}}function CarouselScrollForward(){const $=(0,dist.c)(1);let t0;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(CarouselScrollButton,{isNext:!0}),$[0]=t0):t0=$[0],t0}function CarouselScrollBack(){const $=(0,dist.c)(1);let t0;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(CarouselScrollButton,null),$[0]=t0):t0=$[0],t0}CarouselScrollButton.propTypes={isNext:prop_types_default().bool};const reorderable_context=(0,src.q6)({state:{},actions:{}});const reorderable_useReordering=function useReordering(onPositionChange,numChildren){const[isReordering,setIsReordering]=(0,src.J0)(!1),[currentSeparator,setCurrentSeparator]=(0,src.J0)(null),[currentPosition,setCurrentPosition]=(0,src.J0)(null),[dragTarget,setDragTarget]=(0,src.J0)(null),speak=(0,useLiveRegion.A)("assertive"),handleStartReordering=(0,src.hb)((({position:currentPos,data={},onStartReordering=noop.l})=>evt=>{const isModified=evt.shiftKey||evt.metaKey||evt.ctrlKey||evt.altKey,isLeftButton=0===evt.button;!isModified&&isLeftButton&&(onStartReordering(),setCurrentPosition({position:currentPos,data}),setDragTarget(evt.target))}),[]),separatorRef=(0,src.li)(null);return(0,src.vJ)((()=>{separatorRef.current=currentSeparator}),[currentSeparator]),(0,src.vJ)((()=>{if(!dragTarget)return;const onRelease=evt_0=>{if(evt_0.preventDefault(),null!==separatorRef.current){const newPosition=separatorRef.current,position=newPosition.position>currentPosition.position?newPosition.position-1:newPosition.position;onPositionChange(currentPosition,{...separatorRef.current,position},evt_0)}setDragTarget(null)},onMove=()=>setIsReordering(!0),onAbort=evt_1=>{"Escape"===evt_1.key&&(setDragTarget(null),evt_1.stopPropagation())};return dragTarget.ownerDocument.addEventListener("pointerup",onRelease),dragTarget.ownerDocument.addEventListener("keydown",onAbort,!0),dragTarget.addEventListener("pointermove",onMove),()=>{setCurrentSeparator(null),setIsReordering(!1),dragTarget.removeEventListener("pointermove",onMove),dragTarget.ownerDocument.removeEventListener("pointerup",onRelease),dragTarget.ownerDocument.removeEventListener("keydown",onAbort,!0)}}),[dragTarget,currentPosition,setCurrentSeparator,setIsReordering,onPositionChange]),(0,src.vJ)((()=>{if(isReordering&&currentSeparator){const position_0=numChildren-currentSeparator.position,message=(0,sprintf.A)((0,i18n.__)("Reordering. Press Escape to abort. Release mouse to drop in position %d.","web-stories"),String(position_0));speak(message)}}),[isReordering,currentSeparator,numChildren,speak]),{isReordering,currentSeparator,setCurrentSeparator,handleStartReordering,currentPosition}},Scroller=styled_components_browser_esm.Ay.div.withConfig({displayName:"reorderableScroller__Scroller",componentId:"sc-lvxibs-0"})(["z-index:3;opacity:0;position:sticky;"]),HorizontalScroller=(0,styled_components_browser_esm.Ay)(Scroller).withConfig({displayName:"reorderableScroller__HorizontalScroller",componentId:"sc-lvxibs-1"})(["padding-left:","px;height:100%;",""],(({size})=>size),(({direction,size})=>-1===direction?`\n        left: 0px;\n        margin-right: -${size}px;\n        `:`\n        right: 0px;\n        margin-left: -${size}px;\n        `)),VerticalScroller=(0,styled_components_browser_esm.Ay)(Scroller).withConfig({displayName:"reorderableScroller__VerticalScroller",componentId:"sc-lvxibs-2"})(["padding-top:","px;width:100%;",""],(({size})=>size),(({direction,size})=>-1===direction?`\n        top: 0px;\n        margin-bottom: -${size}px;\n        `:`\n        bottom: 0px;\n        margin-top: -${size}px;\n        `));function ReorderableScroller(t0){const $=(0,dist.c)(23),{direction,size}=t0,{state:t1,actions:t2}=(0,src.NT)(reorderable_context),{canScrollEnd,canScrollStart,mode}=t1,{startScroll}=t2,[isHovering,setIsHovering]=(0,src.J0)(!1);let t3,t4;$[0]!==setIsHovering?(t3=()=>setIsHovering(!0),$[0]=setIsHovering,$[1]=t3):t3=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t4=[],$[2]=t4):t4=$[2];const handlePointerEnter=(0,src.hb)(t3,t4);let t5,t6;$[3]!==setIsHovering?(t5=()=>setIsHovering(!1),$[3]=setIsHovering,$[4]=t5):t5=$[4],$[5]===Symbol.for("react.memo_cache_sentinel")?(t6=[],$[5]=t6):t6=$[5];const handlePointerLeave=(0,src.hb)(t5,t6);let t7,t8;$[6]!==direction||$[7]!==isHovering||$[8]!==startScroll?(t7=()=>{if(isHovering)return startScroll(direction)},t8=[direction,startScroll,isHovering],$[6]=direction,$[7]=isHovering,$[8]=startScroll,$[9]=t7,$[10]=t8):(t7=$[9],t8=$[10]),(0,src.vJ)(t7,t8);const isVisible=-1===direction&&canScrollStart||1===direction&&canScrollEnd;let t9,t10;if($[11]!==isVisible||$[12]!==setIsHovering?(t9=()=>{isVisible||setIsHovering(!1)},$[11]=isVisible,$[12]=setIsHovering,$[13]=t9):t9=$[13],$[14]!==isVisible?(t10=[isVisible],$[14]=isVisible,$[15]=t10):t10=$[15],(0,src.vJ)(t9,t10),!isVisible)return null;const ScrollerElement="horizontal"===mode?HorizontalScroller:VerticalScroller;let t11;return $[16]!==ScrollerElement||$[17]!==direction||$[18]!==handlePointerEnter||$[19]!==handlePointerLeave||$[20]!==mode||$[21]!==size?(t11=react.createElement(ScrollerElement,{size,direction,onPointerEnter:handlePointerEnter,onPointerLeave:handlePointerLeave,mode}),$[16]=ScrollerElement,$[17]=direction,$[18]=handlePointerEnter,$[19]=handlePointerLeave,$[20]=mode,$[21]=size,$[22]=t11):t11=$[22],t11}ReorderableScroller.propTypes={direction:prop_types_default().number.isRequired,size:prop_types_default().number.isRequired};const reorderableScroller=(0,src.ph)(ReorderableScroller);const reorderable_useScroll=function useScroll(mode="horizontal",isReordering,scrollTargetRef,size){const[hasScrollAbove,setHasScrollAbove]=(0,src.J0)(!1),[hasScrollBelow,setHasScrollBelow]=(0,src.J0)(!1),[scrollDirection,setScrollDirection]=(0,src.J0)(0),updateScrollMarkers=(0,src.T0)((()=>{const node=scrollTargetRef.current;if(node)if("horizontal"===mode){const possibleScroll=node.scrollWidth-node.clientWidth;possibleScroll<=0?(setHasScrollAbove(!1),setHasScrollBelow(!1)):(setHasScrollAbove(node.scrollLeft>0),setHasScrollBelow(node.scrollLeft<possibleScroll))}else{const possibleScroll_0=node.scrollHeight-node.clientHeight;possibleScroll_0<=0?(setHasScrollAbove(!1),setHasScrollBelow(!1)):(setHasScrollAbove(node.scrollTop>0),setHasScrollBelow(node.scrollTop<possibleScroll_0))}}),[mode,scrollTargetRef]),startScroll=(0,src.hb)((dir=>(setScrollDirection(dir),()=>setScrollDirection(0))),[setScrollDirection]),canScrollStart=isReordering&&hasScrollAbove,canScrollEnd=isReordering&&hasScrollBelow;return(0,src.vJ)((()=>{if(0===scrollDirection||!(canScrollStart&&scrollDirection<0||canScrollEnd&&scrollDirection>0))return;let mounted=!0;const update=()=>{const scrollStep=Math.max(Math.min(.2*size,10),0);"horizontal"===mode?scrollTargetRef.current.scrollLeft+=scrollDirection*scrollStep:scrollTargetRef.current.scrollTop+=scrollDirection*scrollStep,updateScrollMarkers(),mounted&&window.requestAnimationFrame(update)};return update(),()=>{mounted=!1}}),[scrollDirection,updateScrollMarkers,canScrollStart,canScrollEnd,size,mode,scrollTargetRef]),(0,src.vJ)((()=>updateScrollMarkers()),[isReordering,updateScrollMarkers]),{startScroll,canScrollEnd,canScrollStart}};function reorderable_extends(){return reorderable_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},reorderable_extends.apply(null,arguments)}const ReorderableContainer=styled_components_browser_esm.Ay.div.attrs({role:"listbox"}).withConfig({displayName:"reorderable__ReorderableContainer",componentId:"sc-plmujd-0"})(["display:flex;"]),Reorderable=(0,src.Rf)((function Reorderable(t0,forwardedRef){const $=(0,dist.c)(40);let children,getItemSize,onPositionChange,props,t1,t2;$[0]!==t0?(({children,onPositionChange,getItemSize,scrollSize:t1,mode:t2,...props}=t0),$[0]=t0,$[1]=children,$[2]=getItemSize,$[3]=onPositionChange,$[4]=props,$[5]=t1,$[6]=t2):(children=$[1],getItemSize=$[2],onPositionChange=$[3],props=$[4],t1=$[5],t2=$[6]);const scrollSize=void 0===t1?null:t1,mode=void 0===t2?"horizontal":t2,ref=(0,src.li)(null),containerRef=forwardedRef||ref,{isReordering,currentSeparator,setCurrentSeparator,handleStartReordering,currentPosition}=reorderable_useReordering(onPositionChange,children.length);let t3;$[7]!==getItemSize?(t3=getItemSize(),$[7]=getItemSize,$[8]=t3):t3=$[8];const{startScroll,canScrollEnd,canScrollStart}=reorderable_useScroll(mode,isReordering,containerRef,t3);let t4,t5,t6;$[9]!==canScrollEnd||$[10]!==canScrollStart||$[11]!==containerRef||$[12]!==currentPosition||$[13]!==currentSeparator||$[14]!==isReordering||$[15]!==mode?(t4={isReordering,currentSeparator,containerRef,mode,canScrollEnd,canScrollStart,currentPosition},$[9]=canScrollEnd,$[10]=canScrollStart,$[11]=containerRef,$[12]=currentPosition,$[13]=currentSeparator,$[14]=isReordering,$[15]=mode,$[16]=t4):t4=$[16],$[17]!==handleStartReordering||$[18]!==setCurrentSeparator||$[19]!==startScroll?(t5={setCurrentSeparator,handleStartReordering,startScroll},$[17]=handleStartReordering,$[18]=setCurrentSeparator,$[19]=startScroll,$[20]=t5):t5=$[20],$[21]!==t4||$[22]!==t5?(t6={state:t4,actions:t5},$[21]=t4,$[22]=t5,$[23]=t6):t6=$[23];const state=t6;let t7;$[24]!==getItemSize||$[25]!==scrollSize?(t7=scrollSize||getItemSize(),$[24]=getItemSize,$[25]=scrollSize,$[26]=t7):t7=$[26];const scrollerSize=t7;let t8,t9,t10,t11;return $[27]!==scrollerSize?(t8=react.createElement(reorderableScroller,{direction:-1,size:scrollerSize}),$[27]=scrollerSize,$[28]=t8):t8=$[28],$[29]!==scrollerSize?(t9=react.createElement(reorderableScroller,{direction:1,size:scrollerSize}),$[29]=scrollerSize,$[30]=t9):t9=$[30],$[31]!==children||$[32]!==containerRef||$[33]!==props||$[34]!==t8||$[35]!==t9?(t10=react.createElement(ReorderableContainer,reorderable_extends({ref:containerRef},props),t8,children,t9),$[31]=children,$[32]=containerRef,$[33]=props,$[34]=t8,$[35]=t9,$[36]=t10):t10=$[36],$[37]!==state||$[38]!==t10?(t11=react.createElement(reorderable_context.Provider,{value:state},t10),$[37]=state,$[38]=t10,$[39]=t11):t11=$[39],t11}));Reorderable.propTypes={children:prop_types_default().node,onPositionChange:prop_types_default().func.isRequired,getItemSize:prop_types_default().func.isRequired,scrollSize:prop_types_default().number,mode:prop_types_default().string};const reorderable=Reorderable;const reorderable_useReorderable=function useReorderable(selector){return(0,src.i7)(reorderable_context,selector??src.D_)};function reorderableItem_extends(){return reorderableItem_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},reorderableItem_extends.apply(null,arguments)}const Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"reorderableItem__Container",componentId:"sc-5aswet-0"})(["z-index:1;"]);function ReorderableItem(t0){const $=(0,dist.c)(17);let children,data,disabled,onStartReordering,position,props;$[0]!==t0?(({children,position,onStartReordering,disabled,data,...props}=t0),$[0]=t0,$[1]=children,$[2]=data,$[3]=disabled,$[4]=onStartReordering,$[5]=position,$[6]=props):(children=$[1],data=$[2],disabled=$[3],onStartReordering=$[4],position=$[5],props=$[6]);const handleStartReordering=reorderable_useReorderable(reorderableItem_temp);let t1,t2;return $[7]!==data||$[8]!==disabled||$[9]!==handleStartReordering||$[10]!==onStartReordering||$[11]!==position?(t1=disabled?null:{onPointerDown:handleStartReordering({position,onStartReordering,data})},$[7]=data,$[8]=disabled,$[9]=handleStartReordering,$[10]=onStartReordering,$[11]=position,$[12]=t1):t1=$[12],$[13]!==children||$[14]!==props||$[15]!==t1?(t2=react.createElement(Container,reorderableItem_extends({},t1,props),children),$[13]=children,$[14]=props,$[15]=t1,$[16]=t2):t2=$[16],t2}function reorderableItem_temp(t0){const{actions}=t0;return actions.handleStartReordering}ReorderableItem.propTypes={children:prop_types_default().node,position:prop_types_default().number.isRequired,onStartReordering:prop_types_default().func,disabled:prop_types_default().bool,data:prop_types_default().object};const reorderableItem=ReorderableItem,nestedOffsetCalcFunc=evt=>evt.offsetY<35/1.7;function reorderableSeparator_extends(){return reorderableSeparator_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},reorderableSeparator_extends.apply(null,arguments)}const reorderableSeparator_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"reorderableSeparator__Wrapper",componentId:"sc-1tnz6qo-0"})(["opacity:0;position:relative;z-index:",";&:hover{opacity:",";}"],(({isReordering,isNested})=>isReordering?isNested?3:2:-1),(({isReordering})=>isReordering?1:0)),Line=styled_components_browser_esm.Ay.div.withConfig({displayName:"reorderableSeparator__Line",componentId:"sc-1tnz6qo-1"})(["height:4px;margin:0 0 -4px;background:",";width:100%;"," width:",""],(({theme})=>theme.colors.accent.secondary),(({isNested})=>isNested&&"margin-left: 30px;"),(({isNested})=>isNested?"calc(100% - 30px)":"100%"));function ReorderableSeparator(t0){const $=(0,dist.c)(30);let position,props,t1,t2,t3,t4,t5;$[0]!==t0?(({position,groupId:t1,isNested:t2,nestedOffset:t3,nestedOffsetCalcFunc:t4,children:t5,...props}=t0),$[0]=t0,$[1]=position,$[2]=props,$[3]=t1,$[4]=t2,$[5]=t3,$[6]=t4,$[7]=t5):(position=$[1],props=$[2],t1=$[3],t2=$[4],t3=$[5],t4=$[6],t5=$[7]);const groupId=void 0===t1?null:t1,isNested=void 0!==t2&&t2,nestedOffset=void 0!==t3&&t3,nestedOffsetCalcFunc=void 0===t4?noop.l:t4;let children=void 0===t5?null:t5;const separatorRef=(0,src.li)(null),[isTempNested,setIsTempNested]=(0,src.J0)(!1);let t6;$[8]!==position?(t6=t7=>{const{state,actions}=t7,currentPosition=state.currentPosition?.position,isNextToCurrentItem=currentPosition===position||currentPosition===position-1;return{isReordering:state.isReordering&&!isNextToCurrentItem,isNextToCurrentItem,setCurrentSeparator:actions.setCurrentSeparator}},$[8]=position,$[9]=t6):t6=$[9];const{isReordering,setCurrentSeparator}=reorderable_useReorderable(t6);let t7,t8;$[10]!==groupId||$[11]!==isReordering||$[12]!==position||$[13]!==setCurrentSeparator?(t7=()=>{isReordering&&setCurrentSeparator({position,data:{groupId}})},t8=[setCurrentSeparator,isReordering,position,groupId],$[10]=groupId,$[11]=isReordering,$[12]=position,$[13]=setCurrentSeparator,$[14]=t7,$[15]=t8):(t7=$[14],t8=$[15]);const handlePointerEnter=(0,src.hb)(t7,t8);let t9;$[16]!==nestedOffset||$[17]!==nestedOffsetCalcFunc||$[18]!==setIsTempNested?(t9=evt=>{nestedOffset&&setIsTempNested(nestedOffsetCalcFunc(evt.nativeEvent))},$[16]=nestedOffset,$[17]=nestedOffsetCalcFunc,$[18]=setIsTempNested,$[19]=t9):t9=$[19];const handlePointerMove=t9;if(null===children){const t10=isNested||isTempNested;let t11;$[20]!==t10?(t11=react.createElement(Line,{isNested:t10}),$[20]=t10,$[21]=t11):t11=$[21],children=t11}const t10=isNested||isTempNested;let t11;return $[22]!==children||$[23]!==handlePointerEnter||$[24]!==handlePointerMove||$[25]!==isReordering||$[26]!==props||$[27]!==separatorRef||$[28]!==t10?(t11=react.createElement(reorderableSeparator_Wrapper,reorderableSeparator_extends({onPointerOver:handlePointerEnter,onPointerMove:handlePointerMove,ref:separatorRef,isReordering,isNested:t10},props),children),$[22]=children,$[23]=handlePointerEnter,$[24]=handlePointerMove,$[25]=isReordering,$[26]=props,$[27]=separatorRef,$[28]=t10,$[29]=t11):t11=$[29],t11}ReorderableSeparator.propTypes={position:prop_types_default().number.isRequired,groupId:prop_types_default().string,isNested:prop_types_default().string,nestedOffset:prop_types_default().bool,nestedOffsetCalcFunc:prop_types_default().func,children:prop_types_default().oneOfType([prop_types_default().arrayOf(prop_types_default().node),prop_types_default().node])};const reorderableSeparator=ReorderableSeparator,carouselPage_Line=styled_components_browser_esm.Ay.div.withConfig({displayName:"carouselPage__Line",componentId:"sc-mvqls9-0"})(["background:",";height:","px;width:","px;margin:0px;"],(({theme})=>theme.colors.border.selection),(({$height})=>$height),4),ItemContainer=styled_components_browser_esm.Ay.li.attrs({role:"presentation"}).withConfig({displayName:"carouselPage__ItemContainer",componentId:"sc-mvqls9-1"})(["display:flex;position:relative;margin:0;padding:0;"]),PageSeparator=(0,styled_components_browser_esm.Ay)(reorderableSeparator).withConfig({displayName:"carouselPage__PageSeparator",componentId:"sc-mvqls9-2"})(["position:absolute;bottom:0;left:","px;width:","px;height:","px;display:flex;justify-content:center;",":first-of-type &:first-of-type,",":last-of-type &:last-of-type{width:","px;}",":first-of-type &:first-of-type{left:","px;justify-content:flex-start;}",":first-of-type &:last-of-type{left:","px;}",":last-of-type &:last-of-type{justify-content:flex-end;}"],(({$width})=>$width/2),(({$width,margin})=>$width+margin),(({$height})=>$height),ItemContainer,ItemContainer,(({$width,margin})=>($width+margin+4)/2),ItemContainer,(({margin})=>(margin-4)/2),ItemContainer,(({$width,margin})=>margin+$width/2),ItemContainer),ReorderablePage=(0,styled_components_browser_esm.Ay)(reorderableItem).withConfig({displayName:"carouselPage__ReorderablePage",componentId:"sc-mvqls9-3"})(["display:flex;z-index:1;margin-right:","px;margin-left:","px;"],(({margin})=>margin),(({margin,position})=>0===position?margin:0));function CarouselPage(t0){const $=(0,dist.c)(43),{pageId,index}=t0;let t1;$[0]!==pageId?(t1=t2=>{const{state:t3,actions:t4}=t2,{pageThumbWidth,pageThumbHeight,pageThumbMargin,numPages,pages,currentPageId}=t3,{clickPage,setPageRef}=t4;return{pageThumbWidth,pageThumbHeight,pageThumbMargin,clickPage,setPageRef,page:pages.find((t5=>{const{id}=t5;return id===pageId})),isCurrentPage:pageId===currentPageId,hasMultiplePages:numPages>1}},$[0]=pageId,$[1]=t1):t1=$[1];const{pageThumbWidth:pageThumbWidth_0,pageThumbHeight:pageThumbHeight_0,pageThumbMargin:pageThumbMargin_0,clickPage:clickPage_0,setPageRef:setPageRef_0,page,isCurrentPage,hasMultiplePages}=carouselContext_useCarousel(t1);if(!page||!page.id)return null;let t2;$[2]!==page||$[3]!==setPageRef_0?(t2=el=>setPageRef_0(page,el),$[2]=page,$[3]=setPageRef_0,$[4]=t2):t2=$[4];const t3=`carousel-page-preview-${pageId}`;let t4;$[5]!==index||$[6]!==pageThumbHeight_0||$[7]!==pageThumbMargin_0||$[8]!==pageThumbWidth_0?(t4=0===index&&react.createElement(PageSeparator,{position:0,$width:pageThumbWidth_0,$height:pageThumbHeight_0,margin:pageThumbMargin_0},react.createElement(carouselPage_Line,{$height:pageThumbHeight_0})),$[5]=index,$[6]=pageThumbHeight_0,$[7]=pageThumbMargin_0,$[8]=pageThumbWidth_0,$[9]=t4):t4=$[9];const t5=isCurrentPage&&hasMultiplePages?0:-1;let t6,t7,t8,t9;$[10]!==clickPage_0||$[11]!==page?(t6=()=>clickPage_0(page),$[10]=clickPage_0,$[11]=page,$[12]=t6):t6=$[12],$[13]!==index||$[14]!==isCurrentPage?(t7=isCurrentPage?(0,sprintf.A)((0,i18n.__)("Page %s (current page)","web-stories"),index+1):(0,sprintf.A)((0,i18n.__)("Go to page %s","web-stories"),index+1),$[13]=index,$[14]=isCurrentPage,$[15]=t7):t7=$[15],$[16]!==hasMultiplePages||$[17]!==isCurrentPage||$[18]!==page||$[19]!==pageThumbHeight_0||$[20]!==pageThumbWidth_0||$[21]!==t5||$[22]!==t6||$[23]!==t7?(t8=react.createElement(pagepreview.A,{tabIndex:t5,onClick:t6,role:"option","data-page-id":page.id,label:t7,isActive:isCurrentPage,page,width:pageThumbWidth_0,height:pageThumbHeight_0,isInteractive:hasMultiplePages}),$[16]=hasMultiplePages,$[17]=isCurrentPage,$[18]=page,$[19]=pageThumbHeight_0,$[20]=pageThumbWidth_0,$[21]=t5,$[22]=t6,$[23]=t7,$[24]=t8):t8=$[24],$[25]!==index||$[26]!==pageThumbMargin_0||$[27]!==t8?(t9=react.createElement(ReorderablePage,{position:index,margin:pageThumbMargin_0},t8),$[25]=index,$[26]=pageThumbMargin_0,$[27]=t8,$[28]=t9):t9=$[28];const t10=index+1;let t11,t12,t13;return $[29]!==pageThumbHeight_0?(t11=react.createElement(carouselPage_Line,{$height:pageThumbHeight_0}),$[29]=pageThumbHeight_0,$[30]=t11):t11=$[30],$[31]!==pageThumbHeight_0||$[32]!==pageThumbMargin_0||$[33]!==pageThumbWidth_0||$[34]!==t10||$[35]!==t11?(t12=react.createElement(PageSeparator,{position:t10,$width:pageThumbWidth_0,$height:pageThumbHeight_0,margin:pageThumbMargin_0},t11),$[31]=pageThumbHeight_0,$[32]=pageThumbMargin_0,$[33]=pageThumbWidth_0,$[34]=t10,$[35]=t11,$[36]=t12):t12=$[36],$[37]!==t12||$[38]!==t2||$[39]!==t3||$[40]!==t4||$[41]!==t9?(t13=react.createElement(ItemContainer,{ref:t2,"data-testid":t3},t4,t9,t12),$[37]=t12,$[38]=t2,$[39]=t3,$[40]=t4,$[41]=t9,$[42]=t13):t13=$[42],t13}CarouselPage.propTypes={pageId:prop_types_default().string.isRequired,index:prop_types_default().number.isRequired};const carouselPage=CarouselPage;var isHexColorString=__webpack_require__("./packages/patterns/src/isHexColorString.ts"),getSolidFromHex=__webpack_require__("./packages/patterns/src/getSolidFromHex.ts");const EmptyPage=styled_components_browser_esm.Ay.li.attrs({role:"presentation"}).withConfig({displayName:"skeletonPage__EmptyPage",componentId:"sc-3wwzc9-0"})(["display:block;position:relative;flex:0 0;margin:0;padding:0;border-radius:4px;"]);const skeletonPage=function SkeletonPage(t0){const $=(0,dist.c)(13),{pageId,index}=t0;let t1;$[0]!==pageId?(t1=t2=>{const{state:t3}=t2,{pageThumbWidth,pageThumbHeight,pageThumbMargin,pages}=t3;let bgColor=null;const page=pages.find((t4=>{const{id}=t4;return id===pageId}));if(page){bgColor=page.backgroundColor;const bgElement=page.elements[0];bgElement&&elements_src.V7.media(bgElement)&&bgElement.resource.baseColor&&(0,isHexColorString.A)(bgElement.resource.baseColor)&&(bgColor=(0,getSolidFromHex.A)(bgElement.resource.baseColor.replace("#","")))}return{pageThumbWidth,pageThumbHeight,pageThumbMargin,hasPage:Boolean(page&&page.id),bgColor}},$[0]=pageId,$[1]=t1):t1=$[1];const{pageThumbWidth:pageThumbWidth_0,pageThumbHeight:pageThumbHeight_0,pageThumbMargin:pageThumbMargin_0,hasPage,bgColor:bgColor_0}=carouselContext_useCarousel(t1);if(!hasPage)return null;const t2=`${pageThumbWidth_0}px`,t3=`${pageThumbHeight_0}px`,t4=`${0===index?pageThumbMargin_0:0}px`,t5=`${pageThumbMargin_0}px`;let t6,t7;$[2]!==bgColor_0?(t6=(0,generatePatternStyles.A)(bgColor_0),$[2]=bgColor_0,$[3]=t6):t6=$[3],$[4]!==t2||$[5]!==t3||$[6]!==t4||$[7]!==t5||$[8]!==t6?(t7={flexBasis:t2,height:t3,marginLeft:t4,marginRight:t5,...t6},$[4]=t2,$[5]=t3,$[6]=t4,$[7]=t5,$[8]=t6,$[9]=t7):t7=$[9];const t8=`carousel-page-preview-skeleton-${pageId}`;let t9;return $[10]!==t7||$[11]!==t8?(t9=react.createElement(EmptyPage,{style:t7,"data-testid":t8}),$[10]=t7,$[11]=t8,$[12]=t9):t9=$[12],t9},PageList=(0,styled_components_browser_esm.Ay)(reorderable).attrs({role:"listbox","aria-orientation":"horizontal",mode:"horizontal"}).withConfig({displayName:"carouselList__PageList",componentId:"sc-1oa14z5-0"})(["grid-area:carousel;flex-direction:row;align-items:center;justify-content:center;overflow-x:hidden;overflow-y:hidden;width:","px;list-style:none;padding:4px 0;margin:-4px 0;",";::-webkit-scrollbar-thumb{border:6px solid transparent !important;}"],(({$width})=>$width),(({hasOverflow})=>hasOverflow&&(0,styled_components_browser_esm.AH)(["overflow-x:visible;overflow-x:overlay;justify-content:flex-start;"])));function carouselList_temp(t0){const{state:t1,actions:t2}=t0,{pageThumbWidth,carouselWidth,hasOverflow,pageIds,showSkeleton}=t1,{rearrangePages,setListRef}=t2;return{pageThumbWidth,carouselWidth,hasOverflow,pageIds,rearrangePages,setListRef,showSkeleton}}const carouselList=function CarouselList(){const $=(0,dist.c)(15),{pageThumbWidth:pageThumbWidth_0,carouselWidth:carouselWidth_0,hasOverflow:hasOverflow_0,pageIds:pageIds_0,rearrangePages:rearrangePages_0,setListRef:setListRef_0,showSkeleton:showSkeleton_0}=carouselContext_useCarousel(carouselList_temp),Page=showSkeleton_0?skeletonPage:carouselPage;let t0,t1,t2,t3;if($[0]===Symbol.for("react.memo_cache_sentinel")?(t0=(0,i18n.__)("Pages List","web-stories"),$[0]=t0):t0=$[0],$[1]!==pageThumbWidth_0?(t1=()=>pageThumbWidth_0,$[1]=pageThumbWidth_0,$[2]=t1):t1=$[2],$[3]!==Page||$[4]!==pageIds_0){let t3;$[6]!==Page?(t3=(pageId,index)=>react.createElement(Page,{key:pageId,pageId,index}),$[6]=Page,$[7]=t3):t3=$[7],t2=pageIds_0.map(t3),$[3]=Page,$[4]=pageIds_0,$[5]=t2}else t2=$[5];return $[8]!==carouselWidth_0||$[9]!==hasOverflow_0||$[10]!==rearrangePages_0||$[11]!==setListRef_0||$[12]!==t1||$[13]!==t2?(t3=react.createElement(PageList,{mode:"horizontal",$width:carouselWidth_0,ref:setListRef_0,hasOverflow:hasOverflow_0,"aria-label":t0,onPositionChange:rearrangePages_0,getItemSize:t1},t2),$[8]=carouselWidth_0,$[9]=hasOverflow_0,$[10]=rearrangePages_0,$[11]=setListRef_0,$[12]=t1,$[13]=t2,$[14]=t3):t3=$[14],t3};var chevron_down_small=__webpack_require__("./packages/design-system/src/icons/chevron_down_small.svg"),chevron_up_small=__webpack_require__("./packages/design-system/src/icons/chevron_up_small.svg");const iconCss=(0,styled_components_browser_esm.AH)(["width:32px;margin:-8px;"]),IconDown=(0,styled_components_browser_esm.Ay)(chevron_down_small.A).withConfig({displayName:"carouselDrawerIcon__IconDown",componentId:"sc-b03fdn-0"})(["",""],iconCss),IconUp=(0,styled_components_browser_esm.Ay)(chevron_up_small.A).withConfig({displayName:"carouselDrawerIcon__IconUp",componentId:"sc-b03fdn-1"})(["",""],iconCss);function CarouselDrawerIcon(t0){const $=(0,dist.c)(2),{state}=t0;if([constants.Wc.Open,constants.Wc.Closing].includes(state)){let t1;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t1=react.createElement(IconDown,null),$[0]=t1):t1=$[0],t1}let t1;return $[1]===Symbol.for("react.memo_cache_sentinel")?(t1=react.createElement(IconUp,null),$[1]=t1):t1=$[1],t1}CarouselDrawerIcon.propTypes={state:prop_types_default().string.isRequired};const carouselDrawerIcon=CarouselDrawerIcon,carouselDrawer_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"carouselDrawer__Wrapper",componentId:"sc-1dxh28m-0"})(["display:flex;justify-content:center;"]),StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"carouselDrawer__StyledButton",componentId:"sc-1dxh28m-1"})(["white-space:nowrap;gap:8px;"]);function carouselDrawer_temp2(t0){const{state:t1}=t0,{currentPageNumber,pages}=t1;return{currentPageNumber,pageCount:pages.length}}function carouselDrawer_temp(t0){const{state:t1,actions:t2}=t0,{carouselState}=t1,{openCarousel,closeCarousel}=t2;return{carouselState,openCarousel,closeCarousel}}const carouselDrawer=function CarouselDrawer(){const $=(0,dist.c)(15),{carouselState:carouselState_0,openCarousel:openCarousel_0,closeCarousel:closeCarousel_0}=(0,app.gK)(carouselDrawer_temp),{currentPageNumber:currentPageNumber_0,pageCount}=(0,app.P3)(carouselDrawer_temp2);let t0,t1;$[0]!==carouselState_0||$[1]!==closeCarousel_0||$[2]!==openCarousel_0?(t0=()=>{carouselState_0===constants.Wc.Open?closeCarousel_0():carouselState_0===constants.Wc.Closed&&openCarousel_0()},t1=[carouselState_0,openCarousel_0,closeCarousel_0],$[0]=carouselState_0,$[1]=closeCarousel_0,$[2]=openCarousel_0,$[3]=t0,$[4]=t1):(t0=$[3],t1=$[4]);const onClick=(0,src.hb)(t0,t1);let t2,t3,t4,t5;return $[5]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n.__)("Toggle page carousel","web-stories"),$[5]=t2):t2=$[5],$[6]!==currentPageNumber_0||$[7]!==pageCount?(t3=(0,sprintf.A)((0,i18n._n)("%1$d of %2$d page","%1$d of %2$d pages",pageCount,"web-stories"),currentPageNumber_0,pageCount),$[6]=currentPageNumber_0,$[7]=pageCount,$[8]=t3):t3=$[8],$[9]!==carouselState_0?(t4=react.createElement(carouselDrawerIcon,{state:carouselState_0}),$[9]=carouselState_0,$[10]=t4):t4=$[10],$[11]!==onClick||$[12]!==t3||$[13]!==t4?(t5=react.createElement(carouselDrawer_Wrapper,null,react.createElement(StyledButton,{"aria-label":t2,onClick,variant:button_constants.Ak.Rectangle,size:button_constants.Mp.Small,type:button_constants.VQ.Tertiary},t3,t4)),$[11]=onClick,$[12]=t3,$[13]=t4,$[14]=t5):t5=$[14],t5},carouselLayout_Wrapper=styled_components_browser_esm.Ay.section.withConfig({displayName:"carouselLayout__Wrapper",componentId:"sc-iaovfa-0"})(["position:relative;display:grid;grid:'. d d d d d .' 32px '. . . . . . .' ","px '. p . c . n .' auto / 1fr ","px ","px auto ","px ","px 1fr;width:100%;height:auto;z-index:",";&.carousel-enter{top:","px;&.carousel-enter-active{top:0;transition:","ms ease-out;transition-property:top;}}&.carousel-exit{top:0;&.carousel-exit-active{top:","px;transition:","ms ease-out;transition-property:top;}}"],(({isCollapsed})=>isCollapsed?2:8),NAVIGATION_BUTTON_WIDTH,8,8,NAVIGATION_BUTTON_WIDTH,zIndex.GM,(({thumbHeight})=>thumbHeight+6),constants.CE,(({thumbHeight})=>thumbHeight+6),constants.CE),carouselLayout_Area=styled_components_browser_esm.Ay.div.withConfig({displayName:"carouselLayout__Area",componentId:"sc-iaovfa-1"})(["grid-area:",";display:flex;align-items:center;justify-content:center;flex-direction:column;"],(({area})=>area));function carouselLayout_temp2(t0){const{state:t1}=t0,{numPages,pageThumbHeight}=t1;return{numPages,pageThumbHeight}}function carouselLayout_temp(t0){const{state:t1}=t0,{carouselState}=t1;return{carouselState}}const carouselLayout=function CarouselLayout(){const $=(0,dist.c)(14),{carouselState:carouselState_0}=(0,app.gK)(carouselLayout_temp),{numPages:numPages_0,pageThumbHeight:pageThumbHeight_0}=carouselContext_useCarousel(carouselLayout_temp2),nodeRef=(0,src.li)();if(numPages_0<=0)return null;const isCollapsed=carouselState_0===constants.Wc.Closed;let t0;$[0]===Symbol.for("react.memo_cache_sentinel")?(t0=[constants.Wc.Open,constants.Wc.Opening],$[0]=t0):t0=$[0];const isOpenOrOpening=t0.includes(carouselState_0);let t1,t2,t3,t4,t5;return $[1]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Page Carousel","web-stories"),$[1]=t1):t1=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(carouselLayout_Area,{area:"d"},react.createElement(carouselDrawer,null)),$[2]=t2):t2=$[2],$[3]!==isCollapsed?(t3=!isCollapsed&&react.createElement(react.Fragment,null,react.createElement(carouselLayout_Area,{area:"p"},react.createElement(CarouselScrollBack,null)),react.createElement(carouselLayout_Area,{area:"c"},react.createElement(carouselList,null)),react.createElement(carouselLayout_Area,{area:"n"},react.createElement(CarouselScrollForward,null))),$[3]=isCollapsed,$[4]=t3):t3=$[4],$[5]!==isCollapsed||$[6]!==nodeRef||$[7]!==pageThumbHeight_0||$[8]!==t3?(t4=react.createElement(carouselLayout_Wrapper,{ref:nodeRef,"aria-label":t1,isCollapsed,thumbHeight:pageThumbHeight_0},t2,t3),$[5]=isCollapsed,$[6]=nodeRef,$[7]=pageThumbHeight_0,$[8]=t3,$[9]=t4):t4=$[9],$[10]!==isOpenOrOpening||$[11]!==nodeRef||$[12]!==t4?(t5=react.createElement(CSSTransition.A,{in:isOpenOrOpening,classNames:"carousel",containerRef:!0,nodeRef,timeout:constants.CE},t4),$[10]=isOpenOrOpening,$[11]=nodeRef,$[12]=t4,$[13]=t5):t5=$[13],t5},carouselContainer_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"carouselContainer__Wrapper",componentId:"sc-1dsu28u-0"})(["height:auto;width:100%;align-self:flex-end;"]);const carouselContainer=(0,src.ph)((function CarouselContainer(){const $=(0,dist.c)(9),ref=(0,src.li)(),[carouselWidth,setCarouselWidth]=(0,src.J0)(0);let t0,t1,t2,t3,t4;return $[0]!==setCarouselWidth?(t0=t1=>{const{width}=t1;return setCarouselWidth(width)},$[0]=setCarouselWidth,$[1]=t0):t0=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t1=[],$[2]=t1):t1=$[2],(0,src.pO)(ref,t0,t1),$[3]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(carouselLayout,null),$[3]=t2):t2=$[3],$[4]!==ref?(t3=react.createElement(carouselContainer_Wrapper,{ref},t2),$[4]=ref,$[5]=t3):t3=$[5],$[6]!==carouselWidth||$[7]!==t3?(t4=react.createElement(carouselProvider,{availableSpace:carouselWidth},t3),$[6]=carouselWidth,$[7]=t3,$[8]=t4):t4=$[8],t4}));var dropdown=__webpack_require__("./packages/design-system/src/components/dropDown/dropdown.tsx");const selectButtonCSS=(0,styled_components_browser_esm.AH)(["width:80px;height:36px;padding:0 10px;border-width:1px;border-style:solid;border-color:",";background-color:",";transition:background-color ",";&:hover,&:focus,&:active{border-color:",";background-color:",";}span{height:100%;padding:0;display:flex;align-items:center;}svg{margin:0 -10px;}"],(({theme})=>theme.colors.border.defaultNormal),(({theme})=>theme.colors.bg.primary),button_constants.QB,(({theme})=>theme.colors.bg.secondary),(({theme})=>theme.colors.bg.tertiary)),ZOOM_OPTIONS=[{label:(0,i18n._x)("100%","zoom level","web-stories"),value:1},{label:(0,i18n._x)("200%","zoom level","web-stories"),value:2},{label:(0,i18n._x)("Fill","zoom level","web-stories"),value:constants.gw.Fill},{label:(0,i18n._x)("Fit","zoom level","web-stories"),value:constants.gw.Fit}];function zoomSelector_temp(t0){const{state:t1,actions:t2}=t0,{zoomSetting,zoomLevel}=t1,{setZoomSetting,setZoomLevel}=t2;return{zoomSetting,zoomLevel,setZoomSetting,setZoomLevel}}const zoomSelector=function ZoomSelector(){const $=(0,dist.c)(13),{zoomSetting:zoomSetting_0,zoomLevel:zoomLevel_0,setZoomSetting:setZoomSetting_0,setZoomLevel:setZoomLevel_0}=(0,layout.g)(zoomSelector_temp);let t0,t1;$[0]!==zoomLevel_0||$[1]!==zoomSetting_0?(t0=()=>{const option=ZOOM_OPTIONS.find((t2=>{const{value}=t2;return zoomSetting_0===constants.gw.Fixed?value===zoomLevel_0:value===zoomSetting_0}));return option?option.label:(0,sprintf.A)((0,i18n._x)("%d%%","zoom level","web-stories"),Math.round(100*zoomLevel_0))},t1=[zoomSetting_0,zoomLevel_0],$[0]=zoomLevel_0,$[1]=zoomSetting_0,$[2]=t0,$[3]=t1):(t0=$[2],t1=$[3]);const placeholder=(0,src.Kr)(t0,t1);let t2,t3;$[4]!==setZoomLevel_0||$[5]!==setZoomSetting_0?(t2=(_event,value_0)=>{Object.values(constants.gw).includes(value_0)?setZoomSetting_0(value_0):setZoomLevel_0(value_0)},t3=[setZoomSetting_0,setZoomLevel_0],$[4]=setZoomLevel_0,$[5]=setZoomSetting_0,$[6]=t2,$[7]=t3):(t2=$[6],t3=$[7]);const handleSetZoom=(0,src.hb)(t2,t3);let t4,t5;return $[8]===Symbol.for("react.memo_cache_sentinel")?(t4=(0,i18n.__)("Zoom Level","web-stories"),$[8]=t4):t4=$[8],$[9]!==handleSetZoom||$[10]!==placeholder||$[11]!==zoomSetting_0?(t5=react.createElement(dropdown.A,{ariaLabel:t4,placeholder,options:ZOOM_OPTIONS,placement:popup_constants.W.TopStart,onMenuItemClick:handleSetZoom,selectedValue:zoomSetting_0,popupFillWidth:!1,selectButtonStylesOverride:selectButtonCSS,className:"zoom-selector-dropdown"}),$[9]=handleSetZoom,$[10]=placeholder,$[11]=zoomSetting_0,$[12]=t5):t5=$[12],t5};var box4=__webpack_require__("./packages/design-system/src/icons/box4.svg"),modal=__webpack_require__("./packages/design-system/src/components/modal/modal.tsx"),toggleButton=__webpack_require__("./packages/story-editor/src/components/toggleButton/index.js"),slider_slider=__webpack_require__("./packages/design-system/src/components/slider/slider.tsx"),useGridViewKeys=__webpack_require__("./packages/design-system/src/components/keyboard/gridview/useGridViewKeys.ts"),cross=__webpack_require__("./packages/design-system/src/icons/cross.svg");const gridView_Container=styled_components_browser_esm.Ay.section.withConfig({displayName:"gridView__Container",componentId:"sc-ytsaos-0"})(["display:flex;flex-direction:column;height:100%;width:100%;padding:32px;"]),TopRow=styled_components_browser_esm.Ay.header.withConfig({displayName:"gridView__TopRow",componentId:"sc-ytsaos-1"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:36px;@media ","{margin-bottom:72px;}@media ","{margin-bottom:112px;}"],(({theme})=>theme.breakpoint.desktop),(({theme})=>theme.breakpoint.wide)),gridView_Wrapper=(0,styled_components_browser_esm.Ay)(reorderable).withConfig({displayName:"gridView__Wrapper",componentId:"sc-ytsaos-2"})(["position:relative;overflow-y:auto;overflow-y:overlay;overflow-x:hidden;flex-grow:1;display:flex;flex-direction:column;pointer-events:all;padding:4px;"]),Grid=styled_components_browser_esm.Ay.div.withConfig({displayName:"gridView__Grid",componentId:"sc-ytsaos-3"})(["position:relative;display:grid;grid-template-columns:",";grid-template-rows:repeat(auto-fill,","px);grid-gap:","px;justify-content:center;align-items:flex-start;flex-grow:1;"],(({pageWidth})=>`repeat(auto-fit, minmax(${pageWidth}px, max-content))`),(({pageHeight})=>pageHeight),(({gapWidth})=>gapWidth)),NoButton=styled_components_browser_esm.Ay.div.withConfig({displayName:"gridView__NoButton",componentId:"sc-ytsaos-4"})(["flex:0 0 56px;"]),ClickableButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"gridView__ClickableButton",componentId:"sc-ytsaos-5"})(["pointer-events:all;"]),ClickableSlider=(0,styled_components_browser_esm.Ay)(slider_slider.A).withConfig({displayName:"gridView__ClickableSlider",componentId:"sc-ytsaos-6"})(["pointer-events:all;width:366px;"]),gridView_PageSeparator=(0,styled_components_browser_esm.Ay)(reorderableSeparator).withConfig({displayName:"gridView__PageSeparator",componentId:"sc-ytsaos-7"})(["position:absolute;bottom:0;left:","px;width:","px;height:","px;display:flex;justify-content:center;align-items:center;",""],(({width})=>width/2),(({width,margin})=>width+margin),(({height})=>height),(({before,width,margin})=>before&&`\n      left: -${(width+2*margin)/2}px;\n    `)),gridView_Line=styled_components_browser_esm.Ay.div.withConfig({displayName:"gridView__Line",componentId:"sc-ytsaos-8"})(["background:",";height:","px;width:2px;margin:0px;"],(({theme})=>theme.colors.border.selection),(({height})=>height)),gridView_ItemContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"gridView__ItemContainer",componentId:"sc-ytsaos-9"})(["display:flex;flex-direction:row;position:relative;"]);const gridView=function GridView({onClose}){const{pages:pages_0,currentPageId:currentPageId_0,currentPageIndex:currentPageIndex_0,setCurrentPage:setCurrentPage_0,arrangePage:arrangePage_0}=(0,app.P3)((({state:{pages,currentPageIndex,currentPageId},actions:{setCurrentPage,arrangePage}})=>({pages,currentPageIndex,currentPageId,setCurrentPage,arrangePage}))),{isRTL}=(0,app.UK)(),[pagesPerRow,setPagesPerRow]=(0,src.J0)(4),[availableWidth,setAvailableWidth]=(0,src.J0)(null),wrapperRef=(0,src.li)();(0,src.pO)(wrapperRef,(({width})=>setAvailableWidth(width)),[]);const rawPageWidth=(availableWidth-20*(pagesPerRow-1))/pagesPerRow,pageWidth=12*Math.floor(rawPageWidth/12),actualPageWidths=pageWidth*pagesPerRow,pageGridGap=Math.floor((availableWidth-actualPageWidths)/(pagesPerRow-1)),pageHeight=pageWidth/src_constants.yK,gridRef=(0,src.li)(),pagesRef=(0,src.li)({}),arrangeItem=(0,src.hb)(((focusedPageId,nextIndex)=>{arrangePage_0({pageId:focusedPageId,position:nextIndex})}),[arrangePage_0]);(0,useGridViewKeys.A)({containerRef:wrapperRef,gridRef,itemRefs:pagesRef,isRTL,currentItemId:currentPageId_0,items:pages_0,arrangeItem});const dividerLineHeight=Math.min(pageHeight-24,64);return react.createElement(gridView_Container,{"aria-label":(0,i18n.__)("Grid View","web-stories")},react.createElement(TopRow,null,react.createElement(ClickableButton,{variant:button_constants.Ak.Square,type:button_constants.VQ.Tertiary,size:button_constants.Mp.Medium,onClick:onClose,"aria-label":(0,i18n.__)("Close","web-stories")},react.createElement(cross.A,null)),react.createElement(ClickableSlider,{min:4,max:12,majorStep:1,minorStep:1,value:pagesPerRow,handleChange:newValue=>setPagesPerRow(newValue),"aria-label":(0,i18n.__)("Pages per row","web-stories"),popupZIndexOverride:zIndex.PK}),react.createElement(NoButton,null)),react.createElement(gridView_Wrapper,{"aria-label":(0,i18n.__)("Grid View Pages List","web-stories"),ref:wrapperRef,onPositionChange:({position:oldPos},{position:newPos})=>{const pageId=pages_0[oldPos].id;arrangePage_0({pageId,position:newPos}),setCurrentPage_0({pageId})},mode:"grid",getItemSize:()=>pageHeight,scrollSize:64},react.createElement(Grid,{pageWidth,pageHeight,gapWidth:pageGridGap,ref:gridRef},pages_0.map(((page_0,index)=>{const isCurrentPage=index===currentPageIndex_0,isInteractive=pages_0.length>1;return react.createElement(gridView_ItemContainer,{key:page_0.id,ref:el=>{pagesRef.current[page_0.id]=el}},react.createElement(gridView_PageSeparator,{position:index,width:pageWidth,height:pageHeight,margin:pageGridGap,before:!0},react.createElement(gridView_Line,{height:dividerLineHeight})),react.createElement(reorderableItem,{position:index},react.createElement(pagepreview.A,{label:isCurrentPage?(0,sprintf.A)((0,i18n.__)("Page %s (current page)","web-stories"),index+1):(0,sprintf.A)((0,i18n.__)("Page %s","web-stories"),index+1),tabIndex:isCurrentPage&&isInteractive?0:-1,isActive:isCurrentPage&&isInteractive,page:page_0,width:pageWidth,height:pageHeight,onClick:(page=page_0,()=>setCurrentPage_0({pageId:page.id})),isInteractive,gridRef,role:"option"})),react.createElement(gridView_PageSeparator,{position:index+1,width:pageWidth,height:pageHeight,margin:pageGridGap},react.createElement(gridView_Line,{height:dividerLineHeight})));var page})))))},Box=styled_components_browser_esm.Ay.div.withConfig({displayName:"gridViewButton__Box",componentId:"sc-1gc0r0y-0"})(["display:flex;justify-content:center;align-items:center;"]);function gridViewButton_temp(prevIsOpen){const newIsOpen=!prevIsOpen;return(0,tracking_src.sx)("grid_view_toggled",{status:newIsOpen?"open":"closed"}),newIsOpen}const gridViewButton=function GridViewButton(){const $=(0,dist.c)(21),[isGridViewOpen,setIsGridViewOpen]=(0,src.J0)(!1);let t0,t1;$[0]!==setIsGridViewOpen?(t0=()=>{setIsGridViewOpen(gridViewButton_temp)},t1=[setIsGridViewOpen],$[0]=setIsGridViewOpen,$[1]=t0,$[2]=t1):(t0=$[1],t1=$[2]);const toggleModal=(0,src.hb)(t0,t1);let t2,t3,t4,t5,t6,t7,t8,t9,t10,t11;return $[3]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n.__)("Grid View","web-stories"),$[3]=t2):t2=$[3],$[4]===Symbol.for("react.memo_cache_sentinel")?(t3=(0,i18n.__)("Grid View","web-stories"),t4=(0,i18n.__)("Grid View","web-stories"),$[4]=t3,$[5]=t4):(t3=$[4],t4=$[5]),$[6]!==isGridViewOpen||$[7]!==toggleModal?(t5=react.createElement(Box,null,react.createElement(tooltip.A,{title:t2,placement:popup_constants.W.Top,hasTail:!0},react.createElement(toggleButton.f,{isOpen:isGridViewOpen,onClick:toggleModal,"aria-owns":"gridview_modal",MainIcon:box4.A,"aria-label":t3,label:t4}))),$[6]=isGridViewOpen,$[7]=toggleModal,$[8]=t5):t5=$[8],$[9]===Symbol.for("react.memo_cache_sentinel")?(t6=(0,i18n.__)("Grid View","web-stories"),$[9]=t6):t6=$[9],$[10]===Symbol.for("react.memo_cache_sentinel")?(t7={alignItems:"stretch",backgroundColor:"#131516"},t8={pointerEvents:"none",flex:1},$[10]=t7,$[11]=t8):(t7=$[10],t8=$[11]),$[12]!==toggleModal?(t9=react.createElement(gridView,{onClose:toggleModal}),$[12]=toggleModal,$[13]=t9):t9=$[13],$[14]!==isGridViewOpen||$[15]!==t9||$[16]!==toggleModal?(t10=react.createElement(modal.A,{isOpen:isGridViewOpen,onClose:toggleModal,contentLabel:t6,popupId:"gridview_modal",overlayStyles:t7,contentStyles:t8},t9),$[14]=isGridViewOpen,$[15]=t9,$[16]=toggleModal,$[17]=t10):t10=$[17],$[18]!==t10||$[19]!==t5?(t11=react.createElement(react.Fragment,null,t5,t10),$[18]=t10,$[19]=t5,$[20]=t11):t11=$[20],t11};var panel=__webpack_require__("./packages/story-editor/src/components/panels/panel/index.js"),useSidebar=__webpack_require__("./packages/story-editor/src/components/sidebar/useSidebar.js"),chevron_down=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.every.js"),__webpack_require__("./packages/design-system/src/icons/chevron_down.svg")),group=__webpack_require__("./packages/design-system/src/icons/group.svg"),visibility_off=__webpack_require__("./packages/design-system/src/icons/visibility_off.svg"),lock_closed=__webpack_require__("./packages/design-system/src/icons/lock_closed.svg");function useGroupSelection_temp(t0){const{actions:actions_0}=t0;return actions_0.setRenamableLayer}const layer_useGroupSelection=function useGroupSelection(groupId){const $=(0,dist.c)(16);let t0;$[0]!==groupId?(t0=t1=>{const{state,actions}=t1;return{groupLayers:state.currentPage.elements.filter((el=>el.groupId===groupId)),selectedElementIds:state.selectedElementIds,toggleLayer:actions.toggleLayer}},$[0]=groupId,$[1]=t0):t0=$[1];const{toggleLayer,groupLayers,selectedElementIds}=(0,app.P3)(t0),setRenamableLayer=(0,app.yu)(useGroupSelection_temp);let t1;if($[2]!==groupLayers||$[3]!==selectedElementIds){let t2;$[5]!==selectedElementIds?(t2=gl=>selectedElementIds.includes(gl.id),$[5]=selectedElementIds,$[6]=t2):t2=$[6],t1=groupLayers.every(t2),$[2]=groupLayers,$[3]=selectedElementIds,$[4]=t1}else t1=$[4];const isSelected=t1;let t2,t3;$[7]!==groupId||$[8]!==groupLayers||$[9]!==setRenamableLayer||$[10]!==toggleLayer?(t2=evt=>{evt.preventDefault(),evt.stopPropagation(),toggleLayer({elementId:groupLayers[0].id,metaKey:evt.metaKey,shiftKey:evt.shiftKey,withLinked:!0});2===evt.detail&&setRenamableLayer({elementId:groupId})},t3=[toggleLayer,groupLayers,setRenamableLayer,groupId],$[7]=groupId,$[8]=groupLayers,$[9]=setRenamableLayer,$[10]=toggleLayer,$[11]=t2,$[12]=t3):(t2=$[11],t3=$[12]);const handleClick=(0,src.hb)(t2,t3);let t4;return $[13]!==handleClick||$[14]!==isSelected?(t4={isSelected,handleClick},$[13]=handleClick,$[14]=isSelected,$[15]=t4):t4=$[15],t4};var visibility=__webpack_require__("./packages/design-system/src/icons/visibility.svg"),trash=__webpack_require__("./packages/design-system/src/icons/trash.svg"),page_plus=__webpack_require__("./packages/design-system/src/icons/page_plus.svg"),lock_open=__webpack_require__("./packages/design-system/src/icons/lock_open.svg"),v4=__webpack_require__("./packages/story-editor/node_modules/uuid/dist/esm-browser/v4.js"),generateGroupName=__webpack_require__("./packages/story-editor/src/utils/generateGroupName.ts");const layerIdContext=(0,src.q6)(""),ActionButton=(0,styled_components_browser_esm.Ay)(button_button.$).attrs({type:button_constants.VQ.Plain,tabIndex:-1}).withConfig({displayName:"layerAction__ActionButton",componentId:"sc-xw5sxy-0"})(["position:relative;aspect-ratio:1;width:20px;padding:0;svg{position:absolute;width:32px;height:auto;top:50%;left:50%;transform:translate(-50%,-50%);}&&{transition:revert;background:var(--background-color);}:disabled{color:",";}:hover{color:var( --selected-hover-color,"," );}& + &{margin-left:4px;}*{pointer-events:none;}:focus{","}"],(({theme})=>theme.colors.fg.secondary),(({theme})=>theme.colors.fg.secondary),(({theme})=>outline.g(theme.colors.border.focus,"var(--background-color)")));function preventReorder(e){e.stopPropagation(),e.preventDefault()}function LayerAction(t0){const $=(0,dist.c)(13),{label,handleClick,children,disabled:t1,isActive:t2,trackingData:t3}=t0,disabled=void 0!==t1&&t1,isActive=void 0===t2||t2,trackingData=void 0===t3?null:t3,buttonRef=(0,src.li)(null),t4=trackingData?buttonRef.current:null;let t5;$[0]!==t4||$[1]!==trackingData?(t5={node:t4,eventData:trackingData},$[0]=t4,$[1]=trackingData,$[2]=t5):t5=$[2],(0,usePerformanceTracking.A)(t5);const layerId=(0,src.NT)(layerIdContext);if(!isActive)return null;let t6,t7;return $[3]!==buttonRef||$[4]!==children||$[5]!==disabled||$[6]!==handleClick||$[7]!==label||$[8]!==layerId?(t6=react.createElement(ActionButton,{"aria-label":label,"aria-describedby":layerId,onPointerDown:preventReorder,disabled,onClick:handleClick,ref:buttonRef},children),$[3]=buttonRef,$[4]=children,$[5]=disabled,$[6]=handleClick,$[7]=label,$[8]=layerId,$[9]=t6):t6=$[9],$[10]!==label||$[11]!==t6?(t7=react.createElement(tooltip.A,{title:label,hasTail:!0,isDelayed:!0},t6),$[10]=label,$[11]=t6,$[12]=t7):t7=$[12],t7}LayerAction.propTypes={label:prop_types_default().string.isRequired,handleClick:prop_types_default().func.isRequired,children:prop_types_default().node.isRequired,disabled:prop_types_default().bool,isActive:prop_types_default().bool,trackingData:prop_types_default().object};const layerAction=(0,src.ph)(LayerAction);function GroupLayerActions(t0){const $=(0,dist.c)(60),{groupId}=t0;let t1;$[0]!==groupId?(t1=t2=>{const{actions,state}=t2;return{groups:state.currentPage.groups,updateGroupById:actions.updateGroupById,deleteGroupAndElementsById:actions.deleteGroupAndElementsById,updateElementsById:actions.updateElementsById,duplicateGroupById:actions.duplicateGroupById,groupLayers:state.currentPage.elements.filter((el=>el.groupId===groupId))}},$[0]=groupId,$[1]=t1):t1=$[1];const{groups,updateGroupById,deleteGroupAndElementsById,updateElementsById,duplicateGroupById,groupLayers}=(0,app.P3)(t1);let t2;$[2]!==groupId||$[3]!==groups?(t2=groups?.[groupId]||{name:"",isLocked:!1,isCollapsed:!1},$[2]=groupId,$[3]=groups,$[4]=t2):t2=$[4];const group=t2;let t3;$[5]!==groupLayers?(t3=groupLayers.every(groupLayerActions_temp),$[5]=groupLayers,$[6]=t3):t3=$[6];const allLayersHidden=t3;let t4;$[7]!==allLayersHidden?(t4=allLayersHidden?(0,i18n.__)("Show Group","web-stories"):(0,i18n.__)("Hide Group","web-stories"),$[7]=allLayersHidden,$[8]=t4):t4=$[8];const visibilityTitle=t4;let t5;$[9]!==group.isLocked?(t5=group.isLocked?(0,i18n.__)("Unlock Group","web-stories"):(0,i18n.__)("Lock Group","web-stories"),$[9]=group.isLocked,$[10]=t5):t5=$[10];const lockTitle=t5,{name,isLocked,isCollapsed}=group;let t6,t7;$[11]!==allLayersHidden||$[12]!==groupLayers||$[13]!==updateElementsById?(t6=()=>{updateElementsById({elementIds:groupLayers.map(groupLayerActions_temp2),properties:{isHidden:!allLayersHidden}})},t7=[allLayersHidden,groupLayers,updateElementsById],$[11]=allLayersHidden,$[12]=groupLayers,$[13]=updateElementsById,$[14]=t6,$[15]=t7):(t6=$[14],t7=$[15]);const handleHideGroup=(0,src.hb)(t6,t7);let t8,t9;$[16]!==groupId||$[17]!==groupLayers||$[18]!==isLocked||$[19]!==updateElementsById||$[20]!==updateGroupById?(t8=()=>{updateGroupById({groupId,properties:{isLocked:!isLocked}}),updateElementsById({elementIds:groupLayers.map(groupLayerActions_temp3),properties:{isLocked:!isLocked}})},t9=[groupId,groupLayers,isLocked,updateElementsById,updateGroupById],$[16]=groupId,$[17]=groupLayers,$[18]=isLocked,$[19]=updateElementsById,$[20]=updateGroupById,$[21]=t8,$[22]=t9):(t8=$[21],t9=$[22]);const handleLockGroup=(0,src.hb)(t8,t9);let t10,t11;$[23]!==duplicateGroupById||$[24]!==groupId||$[25]!==groups||$[26]!==isCollapsed||$[27]!==isLocked||$[28]!==name?(t10=()=>{const newGroupId=(0,v4.A)(),newGroupName=(0,generateGroupName.A)(groups,name);duplicateGroupById({oldGroupId:groupId,groupId:newGroupId,name:newGroupName,isLocked,isCollapsed})},t11=[duplicateGroupById,name,isLocked,isCollapsed,groupId,groups],$[23]=duplicateGroupById,$[24]=groupId,$[25]=groups,$[26]=isCollapsed,$[27]=isLocked,$[28]=name,$[29]=t10,$[30]=t11):(t10=$[29],t11=$[30]);const handleDuplicateGroup=(0,src.hb)(t10,t11);let t12,t13;$[31]!==deleteGroupAndElementsById||$[32]!==groupId?(t12=()=>deleteGroupAndElementsById({groupId}),t13=[groupId,deleteGroupAndElementsById],$[31]=deleteGroupAndElementsById,$[32]=groupId,$[33]=t12,$[34]=t13):(t12=$[33],t13=$[34]);const handleDeleteGroup=(0,src.hb)(t12,t13),VisibilityIcon=allLayersHidden?visibility_off.A:visibility.A;let t14,t15,t16,t17,t18,t19,t20,t21,t22,t23,t24;return $[35]===Symbol.for("react.memo_cache_sentinel")?(t14=(0,i18n.__)("Delete Group","web-stories"),$[35]=t14):t14=$[35],$[36]===Symbol.for("react.memo_cache_sentinel")?(t15=react.createElement(trash.A,null),$[36]=t15):t15=$[36],$[37]!==handleDeleteGroup?(t16=react.createElement(layerAction,{label:t14,handleClick:handleDeleteGroup},t15),$[37]=handleDeleteGroup,$[38]=t16):t16=$[38],$[39]===Symbol.for("react.memo_cache_sentinel")?(t17=(0,i18n.__)("Duplicate Group","web-stories"),$[39]=t17):t17=$[39],$[40]===Symbol.for("react.memo_cache_sentinel")?(t18=react.createElement(page_plus.A,null),$[40]=t18):t18=$[40],$[41]!==handleDuplicateGroup?(t19=react.createElement(layerAction,{label:t17,handleClick:handleDuplicateGroup},t18),$[41]=handleDuplicateGroup,$[42]=t19):t19=$[42],$[43]!==VisibilityIcon?(t20=react.createElement(VisibilityIcon,null),$[43]=VisibilityIcon,$[44]=t20):t20=$[44],$[45]!==handleHideGroup||$[46]!==t20||$[47]!==visibilityTitle?(t21=react.createElement(layerAction,{label:visibilityTitle,handleClick:handleHideGroup},t20),$[45]=handleHideGroup,$[46]=t20,$[47]=visibilityTitle,$[48]=t21):t21=$[48],$[49]!==isLocked?(t22=isLocked?react.createElement(lock_closed.A,null):react.createElement(lock_open.A,null),$[49]=isLocked,$[50]=t22):t22=$[50],$[51]!==handleLockGroup||$[52]!==lockTitle||$[53]!==t22?(t23=react.createElement(layerAction,{label:lockTitle,handleClick:handleLockGroup},t22),$[51]=handleLockGroup,$[52]=lockTitle,$[53]=t22,$[54]=t23):t23=$[54],$[55]!==t16||$[56]!==t19||$[57]!==t21||$[58]!==t23?(t24=react.createElement(react.Fragment,null,t16,t19,t21,t23),$[55]=t16,$[56]=t19,$[57]=t21,$[58]=t23,$[59]=t24):t24=$[59],t24}function groupLayerActions_temp3(layer_1){return layer_1.id}function groupLayerActions_temp2(layer_0){return layer_0.id}function groupLayerActions_temp(layer){return layer.isHidden}GroupLayerActions.propTypes={groupId:prop_types_default().string.isRequired};const groupLayerActions=(0,src.ph)(GroupLayerActions);var input=__webpack_require__("./packages/design-system/src/components/input/input.tsx");const fadeOutCss=(0,styled_components_browser_esm.AH)(["background-color:var(--background-color);::before{position:absolute;content:'';width:32px;height:100%;top:0;left:0;transform:translateX(-100%);background:linear-gradient( to right,var(--background-color-opaque),var(--background-color) );pointer-events:none;}"]),ActionsContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__ActionsContainer",componentId:"sc-sxidj-0"})(["position:absolute;display:none;align-items:center;height:100%;top:0;right:0;padding-right:6px;column-gap:6px;",""],fadeOutCss),LayerContainer=styled_components_browser_esm.Ay.div.attrs({"data-testid":"layer-option"}).withConfig({displayName:"layerComponents__LayerContainer",componentId:"sc-sxidj-1"})(["position:relative;height:","px;width:100%;overflow:hidden;--background-color:",";--background-color-opaque:",";:is(:hover,:focus-within) ","{display:inline-flex;}"],35,(({theme})=>theme.colors.bg.secondary),(({theme})=>(0,polished_esm.B3)(theme.colors.bg.secondary,0)),ActionsContainer),LayerButton=(0,styled_components_browser_esm.Ay)(button_button.$).attrs({type:button_constants.VQ.Plain,tabIndex:-1,role:"option"}).withConfig({displayName:"layerComponents__LayerButton",componentId:"sc-sxidj-2"})(["position:relative;display:grid;grid-template-columns:auto 1fr;gap:12px;border:0;padding:0;background:transparent;height:100%;width:100%;overflow:hidden;align-items:center;user-select:none;border-radius:0;padding-left:","px;transition:revert;"," :hover{background:",";}:hover,:hover + *{--background-color:",";--background-color-opaque:",";}:active{background:",";}:active,:active + *{--background-color:",";--background-color-opaque:",";}"],(({isNested})=>isNested?30:12),(({isSelected,theme})=>isSelected&&(0,styled_components_browser_esm.AH)(["background:",";&,& + *{--background-color:",";--background-color-opaque:",";--selected-hover-color:",";}"],theme.colors.interactiveBg.tertiaryPress,theme.colors.interactiveBg.tertiaryPress,(0,polished_esm.B3)(theme.colors.interactiveBg.tertiaryPress,0),theme.colors.interactiveBg.tertiaryHover)),(({theme})=>theme.colors.interactiveBg.tertiaryHover),(({theme})=>theme.colors.interactiveBg.tertiaryHover),(({theme})=>(0,polished_esm.B3)(theme.colors.interactiveBg.tertiaryHover,0)),(({theme})=>theme.colors.interactiveBg.tertiaryPress),(({theme})=>theme.colors.interactiveBg.tertiaryPress),(({theme})=>(0,polished_esm.B3)(theme.colors.interactiveBg.tertiaryPress,0))),LayerInputWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__LayerInputWrapper",componentId:"sc-sxidj-3"})(["display:grid;grid-template-columns:23px 1fr;gap:12px;height:100%;width:100%;padding-left:","px;padding-right:10px;:hover{background:",";}:hover,:hover + *{--background-color:",";--background-color-opaque:",";}"],(({isNested})=>isNested?30:12),(({theme})=>theme.colors.interactiveBg.tertiaryHover),(({theme})=>theme.colors.interactiveBg.tertiaryHover),(({theme})=>(0,polished_esm.B3)(theme.colors.interactiveBg.tertiaryHover,0))),LayerDescription=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__LayerDescription",componentId:"sc-sxidj-4"})(["position:relative;width:100%;overflow:hidden;display:flex;align-items:center;margin-left:0;text-align:left;color:",";"],(({theme})=>theme.colors.fg.primary)),LayerText=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).attrs({size:types.$.Small}).withConfig({displayName:"layerComponents__LayerText",componentId:"sc-sxidj-5"})(["color:inherit;white-space:nowrap;text-overflow:' ';overflow:hidden;max-width:100%;",";"],(({isHidden})=>isHidden&&(0,styled_components_browser_esm.AH)(["opacity:0.3;"]))),LayerIconWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__LayerIconWrapper",componentId:"sc-sxidj-6"})(["",";"],(({isHidden})=>isHidden&&(0,styled_components_browser_esm.AH)(["opacity:0.3;"]))),FadeOutWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__FadeOutWrapper",componentId:"sc-sxidj-7"})(["display:flex;align-items:center;justify-content:flex-start;position:absolute;right:0;aspect-ratio:1;",""],fadeOutCss),layerComponents_IconWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__IconWrapper",componentId:"sc-sxidj-8"})(["display:flex;align-items:center;justify-content:flex-start;width:32px;aspect-ratio:1;svg{position:relative;display:block;width:100%;color:",";}"],(({theme})=>theme.colors.fg.secondary)),HiddenIconWrapper=(0,styled_components_browser_esm.Ay)(layerComponents_IconWrapper).withConfig({displayName:"layerComponents__HiddenIconWrapper",componentId:"sc-sxidj-9"})(["margin-right:-6px;"]),LayerContentContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerComponents__LayerContentContainer",componentId:"sc-sxidj-10"})(["margin-right:8px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"]),LayerInput=(0,styled_components_browser_esm.Ay)(input.A).withConfig({displayName:"layerComponents__LayerInput",componentId:"sc-sxidj-11"})(["overflow:visible;div{height:100%;}"]),LayerInputForm=(0,styled_components_browser_esm.Ay)(LayerDescription).attrs({as:"form"}).withConfig({displayName:"layerComponents__LayerInputForm",componentId:"sc-sxidj-12"})(["overflow:visible;"]),stopPropagation=evt=>evt.stopPropagation();function LayerForm(t0){const $=(0,dist.c)(27),{layerName,handleNewLayerName}=t0,[newLayerName,setNewLayerName]=(0,src.J0)(layerName),setRenamableLayer=(0,app.yu)(layerForm_temp);let t1,t2,t3;$[0]!==layerName||$[1]!==setNewLayerName?(t1=()=>{setNewLayerName(layerName)},$[0]=layerName,$[1]=setNewLayerName,$[2]=t1):t1=$[2],$[3]!==layerName?(t2=[layerName],$[3]=layerName,$[4]=t2):t2=$[4],(0,src.vJ)(t1,t2),$[5]!==setNewLayerName?(t3=evt=>{setNewLayerName(evt.target.value)},$[5]=setNewLayerName,$[6]=t3):t3=$[6];const handleChange=t3;let t4;$[7]!==layerName||$[8]!==setNewLayerName||$[9]!==setRenamableLayer?(t4=evt_0=>{"Escape"===evt_0.key&&(setNewLayerName(layerName),setRenamableLayer(null))},$[7]=layerName,$[8]=setNewLayerName,$[9]=setRenamableLayer,$[10]=t4):t4=$[10];const handleKeyDown=t4;let t5;$[11]!==handleNewLayerName||$[12]!==newLayerName||$[13]!==setRenamableLayer?(t5=()=>{setRenamableLayer(null);const trimmedLayerName=newLayerName.trim();trimmedLayerName&&handleNewLayerName(trimmedLayerName)},$[11]=handleNewLayerName,$[12]=newLayerName,$[13]=setRenamableLayer,$[14]=t5):t5=$[14];const updateLayerName=t5;let t6;$[15]!==updateLayerName?(t6=evt_1=>{evt_1.preventDefault(),updateLayerName()},$[15]=updateLayerName,$[16]=t6):t6=$[16];const handleSubmit=t6;let t7,t8,t9,t10;return $[17]===Symbol.for("react.memo_cache_sentinel")?(t7=(0,i18n.__)("Layer Name","web-stories"),$[17]=t7):t7=$[17],$[18]!==handleChange||$[19]!==handleKeyDown||$[20]!==newLayerName||$[21]!==updateLayerName?(t8=react.createElement(LayerInput,{tabIndex:-1,"aria-label":t7,value:newLayerName,onChange:handleChange,onKeyDown:handleKeyDown,onBlur:updateLayerName,onPointerDown:stopPropagation,hasFocus:!0}),$[18]=handleChange,$[19]=handleKeyDown,$[20]=newLayerName,$[21]=updateLayerName,$[22]=t8):t8=$[22],$[23]===Symbol.for("react.memo_cache_sentinel")?(t9=react.createElement("button",{hidden:!0}),$[23]=t9):t9=$[23],$[24]!==handleSubmit||$[25]!==t8?(t10=react.createElement(LayerInputForm,{onSubmit:handleSubmit},t8,t9),$[24]=handleSubmit,$[25]=t8,$[26]=t10):t10=$[26],t10}function layerForm_temp(t0){const{actions}=t0;return actions.setRenamableLayer}LayerForm.propTypes={layerName:prop_types_default().string.isRequired,handleNewLayerName:prop_types_default().func.isRequired};const layerForm=(0,src.ph)(LayerForm);function layer_Layer(t0){const $=(0,dist.c)(19),{id,handleNewLayerName,layerName,handleClick,isSelected,LayerIcon,hasLayerLockIcon,hasLayerHiddenIcon,LayerLockIcon,LayerVisibilityIcon,actions,hasActions:t1,isNested:t2,skipLayer:t3,trackingData:t4}=t0,hasActions=void 0===t1||t1,isNested=void 0!==t2&&t2,skipLayer=void 0!==t3&&t3,trackingData=void 0===t4?null:t4,renamableLayer=(0,app.yu)(layer_temp),layerRef=(0,src.li)(null),t5=trackingData?layerRef.current:null;let t6;if($[0]!==t5||$[1]!==trackingData?(t6={node:t5,eventData:trackingData},$[0]=t5,$[1]=trackingData,$[2]=t6):t6=$[2],(0,usePerformanceTracking.A)(t6),skipLayer)return null;const layerId=`layer-${id}`,isRenameable=renamableLayer?.elementId===id;let t7;return $[3]!==LayerIcon||$[4]!==LayerLockIcon||$[5]!==LayerVisibilityIcon||$[6]!==actions||$[7]!==handleClick||$[8]!==handleNewLayerName||$[9]!==hasActions||$[10]!==hasLayerHiddenIcon||$[11]!==hasLayerLockIcon||$[12]!==isNested||$[13]!==isRenameable||$[14]!==isSelected||$[15]!==layerId||$[16]!==layerName||$[17]!==layerRef?(t7=react.createElement(LayerContainer,null,isRenameable?react.createElement(LayerInputWrapper,{isNested},react.createElement(LayerIcon,null),react.createElement(layerForm,{handleNewLayerName,layerName})):react.createElement(layerIdContext.Provider,{value:layerId},react.createElement(LayerButton,{ref:layerRef,id:layerId,onClick:handleClick,isSelected,isNested},react.createElement(LayerIconWrapper,{isHidden:hasLayerHiddenIcon},react.createElement(LayerIcon,null)),react.createElement(LayerDescription,null,react.createElement(LayerContentContainer,null,react.createElement(LayerText,{isHidden:hasLayerHiddenIcon},layerName)),(hasLayerHiddenIcon||hasLayerLockIcon)&&react.createElement(FadeOutWrapper,null,hasLayerHiddenIcon&&react.createElement(HiddenIconWrapper,null,hasLayerHiddenIcon&&react.createElement(LayerVisibilityIcon,null)),(hasLayerHiddenIcon||hasLayerLockIcon)&&react.createElement(layerComponents_IconWrapper,null,hasLayerLockIcon&&react.createElement(LayerLockIcon,null))))),hasActions&&react.createElement(ActionsContainer,null,actions))),$[3]=LayerIcon,$[4]=LayerLockIcon,$[5]=LayerVisibilityIcon,$[6]=actions,$[7]=handleClick,$[8]=handleNewLayerName,$[9]=hasActions,$[10]=hasLayerHiddenIcon,$[11]=hasLayerLockIcon,$[12]=isNested,$[13]=isRenameable,$[14]=isSelected,$[15]=layerId,$[16]=layerName,$[17]=layerRef,$[18]=t7):t7=$[18],t7}function layer_temp(t0){const{state}=t0;return state.renamableLayer}layer_Layer.propTypes={id:prop_types_default().string.isRequired,handleNewLayerName:prop_types_default().func.isRequired,layerName:prop_types_default().string.isRequired,handleClick:prop_types_default().func.isRequired,isSelected:prop_types_default().bool.isRequired,LayerIcon:prop_types_default().elementType.isRequired,LayerVisibilityIcon:prop_types_default().elementType.isRequired,hasLayerLockIcon:prop_types_default().bool,hasLayerHiddenIcon:prop_types_default().bool,LayerLockIcon:prop_types_default().elementType.isRequired,actions:prop_types_default().object.isRequired,hasActions:prop_types_default().bool,isNested:prop_types_default().bool,skipLayer:prop_types_default().bool,trackingData:prop_types_default().object};const layer_layer=(0,src.ph)(layer_Layer),GroupIconsWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"groupLayer__GroupIconsWrapper",componentId:"sc-gchq7p-0"})(["display:flex;align-items:center;justify-content:flex-start;width:48px;svg{position:relative;display:block;width:100%;color:",";}transform:translateX(-12px);margin-right:-12px;"],(({theme})=>theme.colors.fg.secondary)),ChevronDown=(0,styled_components_browser_esm.Ay)(chevron_down.A).withConfig({displayName:"groupLayer__ChevronDown",componentId:"sc-gchq7p-1"})(["min-width:32px;min-height:32px;"]),ChevronRight=(0,styled_components_browser_esm.Ay)(chevron_down.A).withConfig({displayName:"groupLayer__ChevronRight",componentId:"sc-gchq7p-2"})(["min-width:32px;min-height:32px;transform:rotate(-90deg);"]);function GroupLayer(t0){const $=(0,dist.c)(34),{groupId}=t0;let t1;$[0]!==groupId?(t1=t2=>{const{actions,state}=t2;return{groups:state.currentPage.groups,updateGroupById:actions.updateGroupById,groupLayers:state.currentPage.elements.filter((el=>el.groupId===groupId))}},$[0]=groupId,$[1]=t1):t1=$[1];const{groups,updateGroupById,groupLayers}=(0,app.P3)(t1);let t2;$[2]!==groupId||$[3]!==groups?(t2=groups?.[groupId]||{},$[2]=groupId,$[3]=groups,$[4]=t2):t2=$[4];const{name:t3,isLocked:t4,isCollapsed:t5}=t2,name=void 0===t3?"":t3,isLocked=void 0!==t4&&t4,isCollapsed=void 0!==t5&&t5,{isSelected,handleClick}=layer_useGroupSelection(groupId);let t6,t7;$[5]!==groupId||$[6]!==isCollapsed||$[7]!==updateGroupById?(t6=()=>{updateGroupById({groupId,properties:{isCollapsed:!isCollapsed}})},t7=[isCollapsed,groupId,updateGroupById],$[5]=groupId,$[6]=isCollapsed,$[7]=updateGroupById,$[8]=t6,$[9]=t7):(t6=$[8],t7=$[9]);const handleGroupArrowClick=(0,src.hb)(t6,t7);let t8,t9;$[10]!==handleGroupArrowClick||$[11]!==isCollapsed?(t8=()=>react.createElement(GroupIconsWrapper,null,isCollapsed?react.createElement(ChevronRight,{onClick:handleGroupArrowClick}):react.createElement(ChevronDown,{onClick:handleGroupArrowClick}),react.createElement(group.A,null)),t9=[handleGroupArrowClick,isCollapsed],$[10]=handleGroupArrowClick,$[11]=isCollapsed,$[12]=t8,$[13]=t9):(t8=$[12],t9=$[13]);const GroupLayerIcon=(0,src.hb)(t8,t9);let t10;$[14]!==groupLayers?(t10=groupLayers.every(groupLayer_temp),$[14]=groupLayers,$[15]=t10):t10=$[15];const allLayersHidden=t10;let t11;$[16]!==allLayersHidden?(t11=()=>allLayersHidden&&react.createElement(visibility_off.A,null),$[16]=allLayersHidden,$[17]=t11):t11=$[17];const LayerVisibilityIcon=t11;let t12,t13,t14;return $[18]!==groupId||$[19]!==updateGroupById?(t12=newLayerName=>updateGroupById({groupId,properties:{name:newLayerName}}),$[18]=groupId,$[19]=updateGroupById,$[20]=t12):t12=$[20],$[21]!==groupId?(t13=react.createElement(groupLayerActions,{groupId}),$[21]=groupId,$[22]=t13):t13=$[22],$[23]!==GroupLayerIcon||$[24]!==LayerVisibilityIcon||$[25]!==allLayersHidden||$[26]!==groupId||$[27]!==handleClick||$[28]!==isLocked||$[29]!==isSelected||$[30]!==name||$[31]!==t12||$[32]!==t13?(t14=react.createElement(layer_layer,{id:groupId,handleNewLayerName:t12,layerName:name,handleClick,hasLayerHiddenIcon:allLayersHidden,isSelected,LayerIcon:GroupLayerIcon,LayerVisibilityIcon,hasLayerLockIcon:isLocked,LayerLockIcon:lock_closed.A,actions:t13}),$[23]=GroupLayerIcon,$[24]=LayerVisibilityIcon,$[25]=allLayersHidden,$[26]=groupId,$[27]=handleClick,$[28]=isLocked,$[29]=isSelected,$[30]=name,$[31]=t12,$[32]=t13,$[33]=t14):t14=$[33],t14}function groupLayer_temp(layer){return layer.isHidden}GroupLayer.propTypes={groupId:prop_types_default().string.isRequired};const groupLayer=(0,src.ph)(GroupLayer),LayerSeparator=(0,styled_components_browser_esm.Ay)(reorderableSeparator).withConfig({displayName:"reorderableGroupLayer__LayerSeparator",componentId:"sc-zozo8e-0"})(["height:","px;margin:-","px 0;padding:","px 0;"],35,17.5,17.5),ReorderableGroup=(0,src.ph)((function ReorderableGroup(t0){const $=(0,dist.c)(17),{id,position,handleStartReordering}=t0,t1=position+1;let t2,t3,t4,t5,t6,t7;return $[0]!==t1?(t2=react.createElement(LayerSeparator,{groupId:null,position:t1}),$[0]=t1,$[1]=t2):t2=$[1],$[2]!==id?(t3={group:id},$[2]=id,$[3]=t3):t3=$[3],$[4]!==handleStartReordering||$[5]!==id?(t4=handleStartReordering({id}),$[4]=handleStartReordering,$[5]=id,$[6]=t4):t4=$[6],$[7]!==id?(t5=react.createElement(groupLayer,{groupId:id}),$[7]=id,$[8]=t5):t5=$[8],$[9]!==position||$[10]!==t3||$[11]!==t4||$[12]!==t5?(t6=react.createElement(reorderableItem,{position,data:t3,onStartReordering:t4},t5),$[9]=position,$[10]=t3,$[11]=t4,$[12]=t5,$[13]=t6):t6=$[13],$[14]!==t2||$[15]!==t6?(t7=react.createElement(react.Fragment,null,t2,t6),$[14]=t2,$[15]=t6,$[16]=t7):t7=$[16],t7}));ReorderableGroup.propTypes={id:prop_types_default().string.isRequired,name:prop_types_default().string.isRequired,position:prop_types_default().number.isRequired,handleStartReordering:prop_types_default().func.isRequired};const reorderableGroupLayer=ReorderableGroup;var lock_filled_closed=__webpack_require__("./packages/design-system/src/icons/lock_filled_closed.svg");function useLayerSelection_temp(t0){const{actions:actions_0}=t0;return actions_0.setRenamableLayer}const layer_useLayerSelection=function useLayerSelection(layer){const $=(0,dist.c)(10),{id:elementId}=layer;let t0;$[0]!==elementId?(t0=t1=>{const{state,actions}=t1;return{isSelected:state.selectedElementIds.includes(elementId),toggleLayer:actions.toggleLayer}},$[0]=elementId,$[1]=t0):t0=$[1];const{isSelected,toggleLayer}=(0,app.P3)(t0),setRenamableLayer=(0,app.yu)(useLayerSelection_temp);let t1,t2;$[2]!==elementId||$[3]!==setRenamableLayer||$[4]!==toggleLayer?(t1=evt=>{evt.preventDefault(),evt.stopPropagation(),toggleLayer({elementId,metaKey:evt.metaKey,shiftKey:evt.shiftKey,withLinked:!1});2===evt.detail&&setRenamableLayer({elementId})},t2=[toggleLayer,elementId,setRenamableLayer],$[2]=elementId,$[3]=setRenamableLayer,$[4]=toggleLayer,$[5]=t1,$[6]=t2):(t1=$[5],t2=$[6]);const handleClick=(0,src.hb)(t1,t2);let t3;return $[7]!==handleClick||$[8]!==isSelected?(t3={isSelected,handleClick},$[7]=handleClick,$[8]=isSelected,$[9]=t3):t3=$[9],t3};var useShapeMask=__webpack_require__("./packages/story-editor/src/utils/useShapeMask.js");const MaskedIconWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"shapeMaskWrapper__MaskedIconWrapper",componentId:"sc-1blxy5z-0"})(["position:relative;clip-path:url(#",");"],(({maskId})=>maskId));function ShapeMaskWrapper(t0){const $=(0,dist.c)(5),{element,children}=t0,{hasShapeMask}=(0,useShapeMask.A)(element);if(!hasShapeMask)return children;let t1,t2;return $[0]!==element?(t1=(0,masks_src.t7)(element,"frame"),$[0]=element,$[1]=t1):t1=$[1],$[2]!==children||$[3]!==t1?(t2=react.createElement(MaskedIconWrapper,{maskId:t1},children),$[2]=children,$[3]=t1,$[4]=t2):t2=$[4],t2}const shapeMaskWrapper=ShapeMaskWrapper;ShapeMaskWrapper.propTypes={element:propTypes.Ed.element.isRequired,children:prop_types_default().node.isRequired};var remove_mask=__webpack_require__("./packages/design-system/src/icons/remove_mask.svg");function ElementLayerActions(t0){const $=(0,dist.c)(63),{element}=t0;let t1;$[0]!==element.type?(t1=(0,elements_src.zh)(element.type),$[0]=element.type,$[1]=t1):t1=$[1];const{hasDuplicateMenu}=t1,{duplicateElementsById,updateElementById,deleteElementById}=(0,app.P3)(elementLayerActions_temp),{hasShapeMask,removeShapeMask}=(0,useShapeMask.A)(element);let t2;$[2]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n.__)("Unmask","web-stories"),$[2]=t2):t2=$[2];const removeMaskTitle=t2,isNested=Boolean(element.groupId),{isLocked,isHidden}=element;let t3,t4;$[3]!==isLocked||$[4]!==isNested?(t3=()=>isNested?isLocked?(0,i18n.__)("Group is Locked","web-stories"):(0,i18n.__)("Group is Unlocked","web-stories"):isLocked?(0,i18n.__)("Unlock Layer","web-stories"):(0,i18n.__)("Lock Layer","web-stories"),t4=[isLocked,isNested],$[3]=isLocked,$[4]=isNested,$[5]=t3,$[6]=t4):(t3=$[5],t4=$[6]);const lockTitle=(0,src.Kr)(t3,t4);let t5;$[7]!==isHidden?(t5=isHidden?(0,i18n.__)("Show Layer","web-stories"):(0,i18n.__)("Hide Layer","web-stories"),$[7]=isHidden,$[8]=t5):t5=$[8];const visibilityTitle=t5;let t6,t7;$[9]!==deleteElementById||$[10]!==element.id?(t6=()=>deleteElementById({elementId:element.id}),t7=[deleteElementById,element.id],$[9]=deleteElementById,$[10]=element.id,$[11]=t6,$[12]=t7):(t6=$[11],t7=$[12]);const handleDeleteElement=(0,src.hb)(t6,t7);let t8,t9;$[13]!==duplicateElementsById||$[14]!==element.id?(t8=()=>duplicateElementsById({elementIds:[element.id]}),t9=[duplicateElementsById,element.id],$[13]=duplicateElementsById,$[14]=element.id,$[15]=t8,$[16]=t9):(t8=$[15],t9=$[16]);const handleDuplicateElement=(0,src.hb)(t8,t9);let t10,t11;$[17]!==element.id||$[18]!==isLocked||$[19]!==updateElementById?(t10=()=>updateElementById({elementId:element.id,properties:{isLocked:!isLocked}}),t11=[element.id,isLocked,updateElementById],$[17]=element.id,$[18]=isLocked,$[19]=updateElementById,$[20]=t10,$[21]=t11):(t10=$[20],t11=$[21]);const handleLockElement=(0,src.hb)(t10,t11);let t12,t13;$[22]!==element.id||$[23]!==isHidden||$[24]!==updateElementById?(t12=()=>updateElementById({elementId:element.id,properties:{isHidden:!isHidden}}),t13=[element.id,isHidden,updateElementById],$[22]=element.id,$[23]=isHidden,$[24]=updateElementById,$[25]=t12,$[26]=t13):(t12=$[25],t13=$[26]);const handleHideElement=(0,src.hb)(t12,t13),LockIcon=isLocked?lock_closed.A:lock_open.A,VisibilityIcon=isHidden?visibility_off.A:visibility.A;let t14,t15,t16,t17,t18,t19,t20,t21,t22,t23,t24,t25,t26,t27;return $[27]===Symbol.for("react.memo_cache_sentinel")?(t14=react.createElement(remove_mask.A,null),$[27]=t14):t14=$[27],$[28]!==hasShapeMask||$[29]!==removeShapeMask?(t15=react.createElement(layerAction,{isActive:hasShapeMask,label:removeMaskTitle,handleClick:removeShapeMask},t14),$[28]=hasShapeMask,$[29]=removeShapeMask,$[30]=t15):t15=$[30],$[31]===Symbol.for("react.memo_cache_sentinel")?(t16=(0,i18n.__)("Delete Layer","web-stories"),$[31]=t16):t16=$[31],$[32]!==element.type?(t17={...constants.Zy.DELETE_ELEMENT,label:element.type},$[32]=element.type,$[33]=t17):t17=$[33],$[34]===Symbol.for("react.memo_cache_sentinel")?(t18=react.createElement(trash.A,null),$[34]=t18):t18=$[34],$[35]!==handleDeleteElement||$[36]!==t17?(t19=react.createElement(layerAction,{label:t16,handleClick:handleDeleteElement,trackingData:t17},t18),$[35]=handleDeleteElement,$[36]=t17,$[37]=t19):t19=$[37],$[38]===Symbol.for("react.memo_cache_sentinel")?(t20=(0,i18n.__)("Duplicate Layer","web-stories"),$[38]=t20):t20=$[38],$[39]===Symbol.for("react.memo_cache_sentinel")?(t21=react.createElement(page_plus.A,null),$[39]=t21):t21=$[39],$[40]!==handleDuplicateElement||$[41]!==hasDuplicateMenu?(t22=react.createElement(layerAction,{isActive:hasDuplicateMenu,label:t20,handleClick:handleDuplicateElement},t21),$[40]=handleDuplicateElement,$[41]=hasDuplicateMenu,$[42]=t22):t22=$[42],$[43]!==VisibilityIcon?(t23=react.createElement(VisibilityIcon,null),$[43]=VisibilityIcon,$[44]=t23):t23=$[44],$[45]!==handleHideElement||$[46]!==t23||$[47]!==visibilityTitle?(t24=react.createElement(layerAction,{label:visibilityTitle,handleClick:handleHideElement},t23),$[45]=handleHideElement,$[46]=t23,$[47]=visibilityTitle,$[48]=t24):t24=$[48],$[49]!==LockIcon||$[50]!==isNested?(t25=isNested?react.createElement(lock_filled_closed.A,null):react.createElement(LockIcon,null),$[49]=LockIcon,$[50]=isNested,$[51]=t25):t25=$[51],$[52]!==handleLockElement||$[53]!==isNested||$[54]!==lockTitle||$[55]!==t25?(t26=react.createElement(layerAction,{label:lockTitle,disabled:isNested,handleClick:handleLockElement},t25),$[52]=handleLockElement,$[53]=isNested,$[54]=lockTitle,$[55]=t25,$[56]=t26):t26=$[56],$[57]!==t15||$[58]!==t19||$[59]!==t22||$[60]!==t24||$[61]!==t26?(t27=react.createElement(react.Fragment,null,t15,t19,t22,t24,t26),$[57]=t15,$[58]=t19,$[59]=t22,$[60]=t24,$[61]=t26,$[62]=t27):t27=$[62],t27}function elementLayerActions_temp(t0){const{actions}=t0;return{duplicateElementsById:actions.duplicateElementsById,deleteElementById:actions.deleteElementById,updateElementById:actions.updateElementById}}ElementLayerActions.propTypes={element:propTypes.Ed.element.isRequired};const elementLayerActions=(0,src.ph)(ElementLayerActions),elementLayer_LayerIconWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"elementLayer__LayerIconWrapper",componentId:"sc-ndwsm1-0"})(["display:flex;align-items:center;justify-content:flex-start;color:",";:hover{background:",";}:hover,:hover + *{--background-color:",";--background-color-opaque:",";}"],(({theme})=>theme.colors.fg.primary),(({theme})=>theme.colors.interactiveBg.tertiaryHover),(({theme})=>theme.colors.interactiveBg.tertiaryHover),(({theme})=>(0,polished_esm.B3)(theme.colors.interactiveBg.tertiaryHover,0)));function ElementLayer(t0){const $=(0,dist.c)(44),{element}=t0;let t1;$[0]!==element?(t1=(0,elements_src.Hi)(element),$[0]=element,$[1]=t1):t1=$[1];const layerName=t1;let t2;$[2]!==element.type?(t2=(0,elements_src.zh)(element.type),$[2]=element.type,$[3]=t2):t2=$[3];const{LayerIcon}=t2,{isSelected,handleClick}=layer_useLayerSelection(element),{id,isDefaultBackground,isBackground,type}=element;let t3;$[4]!==isDefaultBackground?(t3=t4=>{const{actions,state}=t4;return{updateElementById:actions.updateElementById,groups:state.currentPage?.groups||{},currentPageBackgroundColor:!isDefaultBackground||state.currentPage?.backgroundColor}},$[4]=isDefaultBackground,$[5]=t3):t3=$[5];const{updateElementById,currentPageBackgroundColor,groups}=(0,app.P3)(t3),{getProxiedUrl}=(0,useCORSProxy.A)(),isNested=Boolean(element.groupId),group=groups[element.groupId];let t4,t5;$[6]!==LayerIcon||$[7]!==currentPageBackgroundColor||$[8]!==element||$[9]!==getProxiedUrl?(t4=()=>react.createElement(elementLayer_LayerIconWrapper,null,react.createElement(shapeMaskWrapper,{element},react.createElement(LayerIcon,{element,getProxiedUrl,currentPageBackgroundColor}))),$[6]=LayerIcon,$[7]=currentPageBackgroundColor,$[8]=element,$[9]=getProxiedUrl,$[10]=t4):t4=$[10],$[11]!==currentPageBackgroundColor||$[12]!==element||$[13]!==getProxiedUrl?(t5=[currentPageBackgroundColor,element,getProxiedUrl],$[11]=currentPageBackgroundColor,$[12]=element,$[13]=getProxiedUrl,$[14]=t5):t5=$[14];const CompoundLayerIcon=(0,src.hb)(t4,t5),hasLayerHiddenIcon=element.isHidden,hasLayerLockIcon=Boolean(isBackground||element.isLocked);let t6,t7;$[15]!==isBackground||$[16]!==isNested?(t6=()=>isBackground||isNested?react.createElement(lock_filled_closed.A,null):react.createElement(lock_closed.A,null),t7=[isBackground,isNested],$[15]=isBackground,$[16]=isNested,$[17]=t6,$[18]=t7):(t6=$[17],t7=$[18]);const LayerLockIcon=(0,src.hb)(t6,t7);let t8;$[19]!==element.isHidden?(t8=()=>element.isHidden&&react.createElement(visibility_off.A,null),$[19]=element.isHidden,$[20]=t8):t8=$[20];const LayerVisibilityIcon=t8;let t9;$[21]!==element.id||$[22]!==updateElementById?(t9=newLayerName=>updateElementById({elementId:element.id,properties:{layerName:newLayerName}}),$[21]=element.id,$[22]=updateElementById,$[23]=t9):t9=$[23];const t10=!isBackground;let t11;$[24]!==element?(t11=react.createElement(elementLayerActions,{element}),$[24]=element,$[25]=t11):t11=$[25];const t12=group?.isCollapsed;let t13,t14;return $[26]!==type?(t13={...constants.Zy.SELECT_ELEMENT,label:type},$[26]=type,$[27]=t13):t13=$[27],$[28]!==CompoundLayerIcon||$[29]!==LayerLockIcon||$[30]!==LayerVisibilityIcon||$[31]!==handleClick||$[32]!==hasLayerHiddenIcon||$[33]!==hasLayerLockIcon||$[34]!==id||$[35]!==isNested||$[36]!==isSelected||$[37]!==layerName||$[38]!==t10||$[39]!==t11||$[40]!==t12||$[41]!==t13||$[42]!==t9?(t14=react.createElement(layer_layer,{id,handleNewLayerName:t9,layerName,handleClick,isSelected,LayerIcon:CompoundLayerIcon,hasLayerLockIcon,hasLayerHiddenIcon,LayerLockIcon,LayerVisibilityIcon,hasActions:t10,actions:t11,isNested,skipLayer:t12,trackingData:t13}),$[28]=CompoundLayerIcon,$[29]=LayerLockIcon,$[30]=LayerVisibilityIcon,$[31]=handleClick,$[32]=hasLayerHiddenIcon,$[33]=hasLayerLockIcon,$[34]=id,$[35]=isNested,$[36]=isSelected,$[37]=layerName,$[38]=t10,$[39]=t11,$[40]=t12,$[41]=t13,$[42]=t9,$[43]=t14):t14=$[43],t14}ElementLayer.propTypes={element:propTypes.Ed.element.isRequired};const elementLayer=(0,src.ph)(ElementLayer),reorderableElementLayer_LayerSeparator=(0,styled_components_browser_esm.Ay)(reorderableSeparator).withConfig({displayName:"reorderableElementLayer__LayerSeparator",componentId:"sc-1ed8ff9-0"})(["height:","px;margin:-","px 0;padding:","px 0;"],35,17.5,17.5),ReorderableLayer=(0,src.ph)((function ReorderableLayer(t0){const $=(0,dist.c)(9),{id,position,nestedOffset,nestedOffsetCalcFunc,handleStartReordering}=t0;let t1;$[0]!==id?(t1=t2=>{const{state}=t2;return state.currentPage?.elements.find((el=>el.id===id))},$[0]=id,$[1]=t1):t1=$[1];const element=(0,app.P3)(t1);let t2;return $[2]!==element||$[3]!==handleStartReordering||$[4]!==id||$[5]!==nestedOffset||$[6]!==nestedOffsetCalcFunc||$[7]!==position?(t2=element?react.createElement(src.FK,{key:id},react.createElement(reorderableElementLayer_LayerSeparator,{groupId:element.groupId,nestedOffset:Boolean(nestedOffset),nestedOffsetCalcFunc,position:position+1,isNested:element.groupId}),react.createElement(reorderableItem,{position,onStartReordering:handleStartReordering(element),disabled:element.isBackground},react.createElement(elementLayer,{element}))):null,$[2]=element,$[3]=handleStartReordering,$[4]=id,$[5]=nestedOffset,$[6]=nestedOffsetCalcFunc,$[7]=position,$[8]=t2):t2=$[8],t2}));ReorderableLayer.propTypes={id:prop_types_default().string.isRequired,position:prop_types_default().number.isRequired,handleStartReordering:prop_types_default().func.isRequired};const reorderableElementLayer=ReorderableLayer;function reorderableLayer_extends(){return reorderableLayer_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},reorderableLayer_extends.apply(null,arguments)}function ReorderableElement(t0){const $=(0,dist.c)(17);let isGroup,rest,t1;$[0]!==t0?(({isGroup,isFirstElementAfterGroup:t1,...rest}=t0),$[0]=t0,$[1]=isGroup,$[2]=rest,$[3]=t1):(isGroup=$[1],rest=$[2],t1=$[3]);const isFirstElementAfterGroup=void 0!==t1&&t1,setSelectedElementsById=(0,app.P3)(reorderableLayer_temp),focusCanvas=(0,useFocusCanvas.A)(),renamableLayer=(0,app.yu)(reorderableLayer_temp2);let t2,t3;$[4]!==focusCanvas||$[5]!==renamableLayer||$[6]!==setSelectedElementsById?(t2=element=>()=>{setSelectedElementsById({elementIds:[element.id]}),renamableLayer&&focusCanvas()},t3=[setSelectedElementsById,focusCanvas,renamableLayer],$[4]=focusCanvas,$[5]=renamableLayer,$[6]=setSelectedElementsById,$[7]=t2,$[8]=t3):(t2=$[7],t3=$[8]);const handleStartReordering=(0,src.hb)(t2,t3);let t4;$[9]!==handleStartReordering||$[10]!==rest?(t4={...rest,handleStartReordering},$[9]=handleStartReordering,$[10]=rest,$[11]=t4):t4=$[11];const props=t4;if(isGroup){let t5;return $[12]!==props?(t5=react.createElement(reorderableGroupLayer,props),$[12]=props,$[13]=t5):t5=$[13],t5}let t5;return $[14]!==isFirstElementAfterGroup||$[15]!==props?(t5=react.createElement(reorderableElementLayer,reorderableLayer_extends({nestedOffset:isFirstElementAfterGroup,nestedOffsetCalcFunc},props)),$[14]=isFirstElementAfterGroup,$[15]=props,$[16]=t5):t5=$[16],t5}function reorderableLayer_temp2(t0){const{state}=t0;return state.renamableLayer}function reorderableLayer_temp(t0){const{actions}=t0;return actions.setSelectedElementsById}ReorderableElement.propTypes={isGroup:prop_types_default().bool.isRequired,isFirstElementAfterGroup:prop_types_default().bool};const reorderableLayer=ReorderableElement;__webpack_require__("./node_modules/core-js/modules/esnext.array.group.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js");function useLayers_temp2(t0,position){const{id,groupId,layerName}=t0;return{id,groupId,layerName,position}}function useLayers_temp(t0){const{state,actions}=t0;return{elements:state.currentPage?.elements||[],arrangeElement:actions.arrangeElement,arrangeGroup:actions.arrangeGroup}}const layer_useLayers=function useLayers(){const $=(0,dist.c)(14),{elements,arrangeElement,arrangeGroup}=(0,app.P3)(useLayers_temp);let t0,t1;$[0]!==elements?(t0=()=>elements.map(useLayers_temp2),t1=[elements],$[0]=elements,$[1]=t0,$[2]=t1):(t0=$[1],t1=$[2]);const elementLayers=(0,src.Kr)(t0,t1);let t2,t3;elementLayers.reverse(),$[3]!==elementLayers?(t2=()=>{const groupIds=new Set;return elementLayers.flatMap(((element,index,list)=>{const elementLayer={isGroup:!1,isFirstElementAfterGroup:index>0&&Boolean(list[index-1].groupId),id:element.id,position:element.position};if(!(element.groupId&&!groupIds.has(element.groupId)))return elementLayer;groupIds.add(element.groupId);return[{isGroup:!0,id:element.groupId,position:element.position,name:element.groupId},elementLayer]}))},t3=[elementLayers],$[3]=elementLayers,$[4]=t2,$[5]=t3):(t2=$[4],t3=$[5]);const layers=(0,src.Kr)(t2,t3);let t4,t5;$[6]!==arrangeElement||$[7]!==arrangeGroup||$[8]!==elementLayers?(t4=(oldPosObj,newPosObj,evt)=>{const{position:oldPos}=oldPosObj,{position:newPos,data:t6}=newPosObj,{groupId:newGroupId}=t6,offsetTopHalf=nestedOffsetCalcFunc(evt),oldPosElement=elementLayers.find((e=>e.position===oldPos)),elementAboveNewPos=elementLayers.find((e_0=>e_0.position===(newPos<=2?1:newPos+1)));let groupId_0=newGroupId;offsetTopHalf&&elementAboveNewPos?.groupId&&(groupId_0=elementAboveNewPos.groupId),oldPosObj.data?.group?newPosObj.data?.groupId||arrangeGroup({groupId:oldPosObj.data.group,position:newPos}):arrangeElement({elementId:oldPosElement.id,position:newPos,groupId:groupId_0})},t5=[arrangeElement,arrangeGroup,elementLayers],$[6]=arrangeElement,$[7]=arrangeGroup,$[8]=elementLayers,$[9]=t4,$[10]=t5):(t4=$[9],t5=$[10]);const handleDragPosition=(0,src.hb)(t4,t5);let t6;return $[11]!==handleDragPosition||$[12]!==layers?(t6={layers,handleDragPosition},$[11]=handleDragPosition,$[12]=layers,$[13]=t6):t6=$[13],t6};function layerList_extends(){return layerList_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},layerList_extends.apply(null,arguments)}const ReorderableLayerList=(0,styled_components_browser_esm.Ay)(reorderable).attrs({"aria-orientation":"vertical","aria-label":(0,i18n.__)("Layers List","web-stories")}).withConfig({displayName:"layerList__ReorderableLayerList",componentId:"sc-1ykjl19-0"})(["flex-direction:column;width:100%;height:100%;align-items:stretch;user-select:",";overflow-y:auto;padding-bottom:4px;"],(({hasUserSelect})=>hasUserSelect?"none":"initial"));function layerList_temp3(layer){return react.createElement(reorderableLayer,layerList_extends({key:layer.id},layer))}function layerList_temp2(){return 35}function layerList_temp(value){return value.onOpenMenu}const layerList=function LayerList(){const $=(0,dist.c)(6),onOpenMenu=(0,app.lS)(layerList_temp),{layers,handleDragPosition}=layer_useLayers();if(0===layers.length)return null;let t0,t1;return $[0]!==layers?(t0=layers.map(layerList_temp3),$[0]=layers,$[1]=t0):t0=$[1],$[2]!==handleDragPosition||$[3]!==onOpenMenu||$[4]!==t0?(t1=react.createElement(ReorderableLayerList,{onContextMenu:onOpenMenu,onPositionChange:handleDragPosition,mode:"vertical",getItemSize:layerList_temp2},t0),$[2]=handleDragPosition,$[3]=onOpenMenu,$[4]=t0,$[5]=t1):t1=$[5],t1},layerPanel_Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"layerPanel__Container",componentId:"sc-1ogzglc-0"})(["filter:drop-shadow(0px -4px 8px rgba(0,0,0,0.2));max-height:","px;background-color:",";"],(({maxHeight})=>maxHeight),(({theme})=>theme.colors.bg.secondary));function layerPanel_temp(t0){const{state}=t0;return state.sidebarContentHeight}const layerPanel=(0,src.ph)((function LayerPanel(){const $=(0,dist.c)(3),sidebarContentHeight=(0,useSidebar.A)(layerPanel_temp);let t0,t1;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(panel.wq,{padding:"0"},react.createElement(layerList,null)),$[0]=t0):t0=$[0],$[1]!==sidebarContentHeight?(t1=react.createElement(layerPanel_Container,{maxHeight:sidebarContentHeight},t0),$[1]=sidebarContentHeight,$[2]=t1):t1=$[2],t1}));var secondaryPopup=__webpack_require__("./packages/story-editor/src/components/secondaryPopup/index.js");const layers_Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"layers__Container",componentId:"sc-12gh0kb-0"})(["background-color:",";overflow:auto;z-index:",";"],(({theme})=>theme.colors.bg.secondary),zIndex.GM),StyledNavigationWrapper=(0,styled_components_browser_esm.Ay)(secondaryPopup._B).withConfig({displayName:"layers__StyledNavigationWrapper",componentId:"sc-12gh0kb-1"})(["width:260px;"]);function layers_temp3(state_1){return!state_1}function layers_temp2(t0){const{state:state_0}=t0;return{renamableLayer:state_0.renamableLayer}}function layers_temp(t0){const{state}=t0;return state.currentPage?.elements?.length}const layers_layers=function Layers(){const $=(0,dist.c)(26),numElements=(0,app.P3)(layers_temp),[isOpen,setIsOpen]=(0,src.J0)(!1),ref=(0,src.li)(),{renamableLayer}=(0,app.yu)(layers_temp2);let t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10;return $[0]!==renamableLayer||$[1]!==setIsOpen?(t0=()=>{renamableLayer&&setIsOpen(!0)},$[0]=renamableLayer,$[1]=setIsOpen,$[2]=t0):t0=$[2],$[3]!==renamableLayer?(t1=[renamableLayer],$[3]=renamableLayer,$[4]=t1):t1=$[4],(0,src.vJ)(t0,t1),$[5]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n.__)("Layers Panel","web-stories"),$[5]=t2):t2=$[5],$[6]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(layers_Container,null,react.createElement(layerPanel,null)),$[6]=t3):t3=$[6],$[7]!==isOpen||$[8]!==ref?(t4=react.createElement(StyledNavigationWrapper,{alignRight:!0,ref,isOpen},t3),$[7]=isOpen,$[8]=ref,$[9]=t4):t4=$[9],$[10]!==isOpen||$[11]!==t4?(t5=react.createElement(secondaryPopup.Ay,{isOpen,placement:popup_constants.W.Right,ariaLabel:t2},t4),$[10]=isOpen,$[11]=t4,$[12]=t5):t5=$[12],$[13]===Symbol.for("react.memo_cache_sentinel")?(t6=(0,i18n.__)("Layers","web-stories"),$[13]=t6):t6=$[13],$[14]!==setIsOpen?(t7=()=>setIsOpen(layers_temp3),$[14]=setIsOpen,$[15]=t7):t7=$[15],$[16]!==numElements?(t8=(0,sprintf.A)((0,i18n.__)("Layers (%d)","web-stories"),numElements),$[16]=numElements,$[17]=t8):t8=$[17],$[18]!==isOpen||$[19]!==numElements||$[20]!==t7||$[21]!==t8?(t9=react.createElement(toggleButton.f,{hasMenuList:!0,isOpen,notificationCount:numElements,copy:t6,onClick:t7,"aria-label":t8}),$[18]=isOpen,$[19]=numElements,$[20]=t7,$[21]=t8,$[22]=t9):t9=$[22],$[23]!==t5||$[24]!==t9?(t10=react.createElement(react.Fragment,null,t5,t9),$[23]=t5,$[24]=t9,$[25]=t10):t10=$[25],t10};var box_with_dots=__webpack_require__("./packages/design-system/src/icons/box_with_dots.svg"),styles=__webpack_require__("./packages/story-editor/src/app/highlights/styles.js");const toolbarToggle_StyledButton=(0,styled_components_browser_esm.Ay)(toggleButton.f).withConfig({displayName:"toolbarToggle__StyledButton",componentId:"sc-1hbzga5-0"})(["",""],(({isHighlighted})=>isHighlighted&&(0,styled_components_browser_esm.AH)([""," ",""],styles.A.OUTLINE,styles.A.FLASH))),LOCAL_STORAGE_KEY=localStore.$.ELEMENT_TOOLBAR_SETTINGS;function toolbarToggle_temp2(state_0){return{highlight:state_0[highlights.xP.ElementToolbarToggle],resetHighlight:state_0.onFocusOut}}function toolbarToggle_temp(t0){const{state,actions}=t0;return{displayFloatingMenu:state.displayFloatingMenu,setDisplayFloatingMenu:actions.setDisplayFloatingMenu}}const toolbarToggle=function ToolbarToggle(){const $=(0,dist.c)(15),{displayFloatingMenu,setDisplayFloatingMenu}=(0,app.yu)(toolbarToggle_temp),{highlight,resetHighlight}=(0,highlights.N)(toolbarToggle_temp2);let t0;$[0]!==setDisplayFloatingMenu?(t0=()=>{const local=localStore.x.getItemByKey(LOCAL_STORAGE_KEY)||{};localStore.x.setItemByKey(LOCAL_STORAGE_KEY,{...local,isDisplayed:!0}),setDisplayFloatingMenu(!0)},$[0]=setDisplayFloatingMenu,$[1]=t0):t0=$[1];const handleToolbarVisibility=t0;if(displayFloatingMenu)return null;let t1,t2,t3,t4;$[2]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Show element toolbar","web-stories"),$[2]=t1):t1=$[2],$[3]!==highlight?.focus||$[4]!==highlight?.showEffect?(t2=node=>{node&&highlight?.focus&&highlight?.showEffect&&node.focus()},$[3]=highlight?.focus,$[4]=highlight?.showEffect,$[5]=t2):t2=$[5],$[6]===Symbol.for("react.memo_cache_sentinel")?(t3=(0,i18n.__)("Show element toolbar","web-stories"),t4=(0,i18n.__)("Show element toolbar","web-stories"),$[6]=t3,$[7]=t4):(t3=$[6],t4=$[7]);const t5=highlight?.showEffect;let t6,t7;return $[8]!==resetHighlight?(t6=()=>resetHighlight(),$[8]=resetHighlight,$[9]=t6):t6=$[9],$[10]!==handleToolbarVisibility||$[11]!==t2||$[12]!==t5||$[13]!==t6?(t7=react.createElement(tooltip.A,{title:t1,placement:popup_constants.W.Top,hasTail:!0},react.createElement(toolbarToggle_StyledButton,{ref:t2,onClick:handleToolbarVisibility,"aria-label":t3,label:t4,isOpen:!1,isHighlighted:t5,onAnimationEnd:t6,MainIcon:box_with_dots.A})),$[10]=handleToolbarVisibility,$[11]=t2,$[12]=t5,$[13]=t6,$[14]=t7):t7=$[14],t7},primaryMenu_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"primaryMenu__Wrapper",componentId:"sc-1n6k8y9-0"})(["display:flex;align-items:flex-end;justify-content:flex-end;width:100%;height:100%;z-index:",";"],zIndex.GM),MenuItems=styled_components_browser_esm.Ay.div.withConfig({displayName:"primaryMenu__MenuItems",componentId:"sc-1n6k8y9-1"})(["position:relative;display:flex;flex-direction:row;align-items:center;margin-right:","px;gap:","px;"],16,8);const primaryMenu=function PrimaryMenu(){const $=(0,dist.c)(1);let t0;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(primaryMenu_Wrapper,null,react.createElement(MenuItems,{id:"primary-menu-items"},react.createElement(toolbarToggle,null),react.createElement(zoomSelector,null),react.createElement(gridViewButton,null),react.createElement(layers_layers,null))),$[0]=t0):t0=$[0],t0};var icons_keyboard=__webpack_require__("./packages/design-system/src/icons/keyboard.svg"),keyboardOnlyOutline=__webpack_require__("./packages/story-editor/src/utils/keyboardOnlyOutline.js"),shortcutMenu=__webpack_require__("./packages/story-editor/src/components/keyboardShortcutsMenu/shortcutMenu.js"),keyboardShortcutsMenu_constants=__webpack_require__("./packages/story-editor/src/components/keyboardShortcutsMenu/constants.js");const keyboardShortcutsMenu_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"keyboardShortcutsMenu__Wrapper",componentId:"sc-1nngfyy-0"})(["z-index:",";"],zIndex.GM);function keyboardShortcutsMenu_temp(t0){const{actions:t1,state:t2}=t0,{close,toggle}=t1,{isOpen}=t2;return{close,toggle,isOpen}}const keyboardShortcutsMenu=function KeyboardShortcutsMenu(){const $=(0,dist.c)(25),anchorRef=(0,src.li)(),wrapperRef=(0,src.li)(),{close:close_0,toggle:toggle_0,isOpen:isOpen_0}=(0,keyboardShortcutsMenuContext.R)(keyboardShortcutsMenu_temp);let t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10;return $[0]!==anchorRef?.current||$[1]!==isOpen_0?(t0=()=>{(0,keyboardOnlyOutline.Ho)()&&!isOpen_0&&anchorRef?.current?.focus?.()},$[0]=anchorRef?.current,$[1]=isOpen_0,$[2]=t0):t0=$[2],$[3]!==isOpen_0?(t1=[isOpen_0],$[3]=isOpen_0,$[4]=t1):t1=$[4],(0,src.vJ)(t0,t1),$[5]!==toggle_0?(t2=[toggle_0],$[5]=toggle_0,$[6]=t2):t2=$[6],(0,keyboard.pP)(keyboardShortcutsMenu_constants.l,toggle_0,t2),$[7]!==close_0?(t3=[close_0],$[7]=close_0,$[8]=t3):t3=$[8],(0,src.g$)(wrapperRef,close_0,t3),$[9]===Symbol.for("react.memo_cache_sentinel")?(t4=(0,i18n.__)("Keyboard Shortcuts","web-stories"),$[9]=t4):t4=$[9],$[10]!==toggle_0?(t5=react.createElement(shortcutMenu.A,{toggleMenu:toggle_0}),$[10]=toggle_0,$[11]=t5):t5=$[11],$[12]!==isOpen_0||$[13]!==t5?(t6=react.createElement(secondaryPopup.Ay,{popupId:"keyboard_shortcut_menu",isOpen:isOpen_0,ariaLabel:t4},t5),$[12]=isOpen_0,$[13]=t5,$[14]=t6):t6=$[14],$[15]===Symbol.for("react.memo_cache_sentinel")?(t7=(0,i18n.__)("Keyboard Shortcuts","web-stories"),t8=(0,i18n.__)("Keyboard Shortcuts","web-stories"),$[15]=t7,$[16]=t8):(t7=$[15],t8=$[16]),$[17]!==anchorRef||$[18]!==isOpen_0||$[19]!==toggle_0?(t9=react.createElement(toggleButton.f,{ref:anchorRef,isOpen:isOpen_0,"aria-owns":"keyboard_shortcut_menu",onClick:toggle_0,"aria-label":t7,label:t8,MainIcon:icons_keyboard.A,shortcut:"mod+/"}),$[17]=anchorRef,$[18]=isOpen_0,$[19]=toggle_0,$[20]=t9):t9=$[20],$[21]!==t6||$[22]!==t9||$[23]!==wrapperRef?(t10=react.createElement(directionAware.A,null,react.createElement(keyboardShortcutsMenu_Wrapper,{ref:wrapperRef},t6,t9)),$[21]=t6,$[22]=t9,$[23]=wrapperRef,$[24]=t10):t10=$[24],t10};var global_styles=__webpack_require__("./packages/design-system/src/theme/global/styles.ts"),helpCenter=__webpack_require__("./packages/story-editor/src/app/helpCenter/index.ts"),helpCenter_constants=__webpack_require__("./packages/story-editor/src/app/helpCenter/constants.ts"),helpCenter_navigator=__webpack_require__("./packages/story-editor/src/components/helpCenter/navigator/index.js"),TransitionGroup=__webpack_require__("./node_modules/react-transition-group/esm/TransitionGroup.js"),helpCenter_menu=__webpack_require__("./packages/story-editor/src/components/helpCenter/menu/index.js"),quickTip=__webpack_require__("./packages/story-editor/src/components/helpCenter/quickTip/index.js");function companion_extends(){return companion_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},companion_extends.apply(null,arguments)}function Companion(t0){const $=(0,dist.c)(9),{tipKey,onTipSelect,isLeftToRightTransition,readTips,components}=t0,{state:t1}=(0,app.S7)(),{tips}=t1;let t2;$[0]!==tips?(t2={...tips,[helpCenter_constants.OS[0]]:helpCenter_constants.OS[1]},$[0]=tips,$[1]=t2):t2=$[1];const tip=tipKey&&t2[tipKey];let t3;return $[2]!==components||$[3]!==isLeftToRightTransition||$[4]!==onTipSelect||$[5]!==readTips||$[6]!==tip||$[7]!==tipKey?(t3=react.createElement(TransitionGroup.A,null,tip?react.createElement(quickTip.x,companion_extends({key:tipKey,isDone:tipKey===helpCenter_constants.OS[0],transitionKey:tipKey,isLeftToRightTransition},tip)):react.createElement(helpCenter_menu.W,{key:"menu",readTips,onTipSelect,components})),$[2]=components,$[3]=isLeftToRightTransition,$[4]=onTipSelect,$[5]=readTips,$[6]=tip,$[7]=tipKey,$[8]=t3):t3=$[8],t3}Companion.propTypes={readTips:prop_types_default().object,tipKey:prop_types_default().string,onTipSelect:prop_types_default().func.isRequired,isLeftToRightTransition:prop_types_default().bool.isRequired,components:prop_types_default().object};const companion=(0,src.ph)(Companion);var toggle=__webpack_require__("./packages/story-editor/src/components/helpCenter/toggle/index.js"),helpCenter_utils=__webpack_require__("./packages/story-editor/src/components/helpCenter/utils.js");const helpCenter_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"helpCenter__Wrapper",componentId:"sc-12zoy5g-0"})(["z-index:",";"],zIndex.GM),HelpCenter=t0=>{const $=(0,dist.c)(38),{components}=t0,ref=(0,src.li)(null),{state,actions}=(0,helpCenter.S)();let t1,t2,t3,t4,t5,t6,t7;$[0]!==state.isOpen?(t1=()=>{state.isOpen&&(0,helpCenter_utils.W)()},t2=[state.isOpen],$[0]=state.isOpen,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]),(0,src.vJ)(t1,t2),$[3]!==actions?(t3=()=>{actions.openToUnreadTip(helpCenter_constants.Rk.ADD_BACKGROUND_MEDIA)},t4=[actions],$[3]=actions,$[4]=t3,$[5]=t4):(t3=$[4],t4=$[5]),(0,story.r2)(story.IM.onReplaceBackgroundMedia,(0,src.hb)(t3,t4)),$[6]!==actions?(t5=()=>{actions.openToUnreadTip(helpCenter_constants.Rk.CROP_SELECTED_ELEMENTS)},t6=[actions],$[6]=actions,$[7]=t5,$[8]=t6):(t5=$[7],t6=$[8]),(0,story.r2)(story.IM.onReplaceForegroundMedia,(0,src.hb)(t5,t6)),$[9]===Symbol.for("react.memo_cache_sentinel")?(t7=react.createElement(global_styles.P,null),$[9]=t7):t7=$[9];const t8=state.isOpen;let t9;$[10]===Symbol.for("react.memo_cache_sentinel")?(t9=(0,i18n.__)("Help Center","web-stories"),$[10]=t9):t9=$[10];const t10=state.navigationFlow[state.navigationIndex];let t11,t12,t13,t14,t15;return $[11]!==actions.goToTip||$[12]!==components||$[13]!==state.isLeftToRightTransition||$[14]!==state.readTips||$[15]!==t10?(t11=react.createElement(companion,{readTips:state.readTips,tipKey:t10,onTipSelect:actions.goToTip,isLeftToRightTransition:state.isLeftToRightTransition,components}),$[11]=actions.goToTip,$[12]=components,$[13]=state.isLeftToRightTransition,$[14]=state.readTips,$[15]=t10,$[16]=t11):t11=$[16],$[17]!==actions.close||$[18]!==actions.goToMenu||$[19]!==actions.goToNext||$[20]!==actions.goToPrev||$[21]!==state.hasBottomNavigation||$[22]!==state.isNextDisabled||$[23]!==state.isOpen||$[24]!==state.isPrevDisabled||$[25]!==t11?(t12=react.createElement(helpCenter_navigator.A,{isOpen:state.isOpen,onNext:actions.goToNext,onPrev:actions.goToPrev,onAllTips:actions.goToMenu,onClose:actions.close,hasBottomNavigation:state.hasBottomNavigation,isNextDisabled:state.isNextDisabled,isPrevDisabled:state.isPrevDisabled},t11),$[17]=actions.close,$[18]=actions.goToMenu,$[19]=actions.goToNext,$[20]=actions.goToPrev,$[21]=state.hasBottomNavigation,$[22]=state.isNextDisabled,$[23]=state.isOpen,$[24]=state.isPrevDisabled,$[25]=t11,$[26]=t12):t12=$[26],$[27]!==state.isOpen||$[28]!==t12?(t13=react.createElement(secondaryPopup.Ay,{popupId:helpCenter_constants.DE,isOpen:t8,ariaLabel:t9},t12),$[27]=state.isOpen,$[28]=t12,$[29]=t13):t13=$[29],$[30]!==actions.toggle||$[31]!==state.isOpen||$[32]!==state.unreadTipsCount?(t14=react.createElement(toggle.l,{isOpen:state.isOpen,onClick:actions.toggle,notificationCount:state.unreadTipsCount,popupId:helpCenter_constants.DE}),$[30]=actions.toggle,$[31]=state.isOpen,$[32]=state.unreadTipsCount,$[33]=t14):t14=$[33],$[34]!==ref||$[35]!==t13||$[36]!==t14?(t15=react.createElement(directionAware.A,null,react.createElement(react.Fragment,null,t7,react.createElement(helpCenter_Wrapper,{ref},t13,t14))),$[34]=ref,$[35]=t13,$[36]=t14,$[37]=t15):t15=$[37],t15},secondaryMenu_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"secondaryMenu__Wrapper",componentId:"sc-4921wn-0"})(["display:flex;align-items:flex-end;justify-content:flex-start;width:100%;height:100%;"]),secondaryMenu_MenuItems=styled_components_browser_esm.Ay.div.withConfig({displayName:"secondaryMenu__MenuItems",componentId:"sc-4921wn-1"})(["position:relative;display:flex;flex-direction:row;align-items:center;margin-left:","px;gap:","px;"],16,8),POPUPS_HELP_CENTER="help_center",POPUPS_CHECKLIST="checklist",POPUPS_KEYBOARD_SHORTCUTS="keyboard_shortcuts";const secondaryMenu=function SecondaryMenu({menu}){const expandedPopupRef=(0,src.li)(""),{close:closeHelpCenter,isHelpCenterOpen:isHelpCenterOpen_0}=(0,app.S7)((({actions:{close},state:{isOpen:isHelpCenterOpen}})=>({close,isHelpCenterOpen}))),{close:closeChecklist,open:openChecklist,isChecklistOpen:isChecklistOpen_0}=(0,checklist.qc)((({actions:{close:close_0,open},state:{isOpen:isChecklistOpen}})=>({close:close_0,open,isChecklistOpen}))),{close:closeKeyboardShortcutsMenu,isKeyboardShortcutsMenuOpen:isKeyboardShortcutsMenuOpen_0}=(0,keyboardShortcutsMenuContext.R)((({actions:{close:close_1},state:{isOpen:isKeyboardShortcutsMenuOpen}})=>({close:close_1,isKeyboardShortcutsMenuOpen}))),{handleResetReviewChecklist:handleResetReviewChecklist_0,reviewChecklistRequested:reviewChecklistRequested_0}=(0,checklist.Em)((({actions:{handleResetReviewChecklist},state:{reviewChecklistRequested}})=>({reviewChecklistRequested,handleResetReviewChecklist}))),isActiveTrimOrEdit=(0,app.yu)((({state:{editingElementState:{isTrimMode},isEditing}})=>isTrimMode||isEditing)),setPopupRef=(0,src.hb)(((newPopup="")=>{expandedPopupRef.current=newPopup}),[]);return(0,src.vJ)((()=>{isChecklistOpen_0&&expandedPopupRef.current!==POPUPS_CHECKLIST&&(closeHelpCenter(),closeKeyboardShortcutsMenu(),setPopupRef(POPUPS_CHECKLIST))}),[closeHelpCenter,closeKeyboardShortcutsMenu,isChecklistOpen_0,setPopupRef]),(0,src.vJ)((()=>{isHelpCenterOpen_0&&expandedPopupRef.current!==POPUPS_HELP_CENTER&&(closeChecklist(),closeKeyboardShortcutsMenu(),setPopupRef(POPUPS_HELP_CENTER))}),[closeChecklist,closeKeyboardShortcutsMenu,isHelpCenterOpen_0,setPopupRef]),(0,src.vJ)((()=>{isKeyboardShortcutsMenuOpen_0&&expandedPopupRef.current!==POPUPS_KEYBOARD_SHORTCUTS&&(closeChecklist(),closeHelpCenter(),setPopupRef(POPUPS_KEYBOARD_SHORTCUTS))}),[closeChecklist,closeHelpCenter,isKeyboardShortcutsMenuOpen_0,setPopupRef]),(0,src.vJ)((()=>{reviewChecklistRequested_0&&(setPopupRef(),handleResetReviewChecklist_0(),openChecklist())}),[reviewChecklistRequested_0,handleResetReviewChecklist_0,openChecklist,setPopupRef]),(0,src.vJ)((()=>{isActiveTrimOrEdit&&expandedPopupRef.current&&(setPopupRef(),closeChecklist(),closeHelpCenter())}),[closeChecklist,closeHelpCenter,isActiveTrimOrEdit,setPopupRef]),react.createElement(secondaryMenu_Wrapper,null,react.createElement(secondaryMenu_MenuItems,null,react.createElement(HelpCenter,{components:menu?.helpCenter}),menu?.checklist&&react.createElement(checklist.bY,{items:menu.checklist}),react.createElement(keyboardShortcutsMenu,null)))},footerLayout_Wrapper=styled_components_browser_esm.Ay.section.withConfig({displayName:"footerLayout__Wrapper",componentId:"sc-gme2s1-0"})(["position:relative;display:grid;grid:'secondary carousel primary' auto / 1fr minmax(auto,calc(100% - ","px)) 1fr;width:100%;max-width:100%;height:100%;"],3*MAX_MENU_WIDTH),footerLayout_Area=styled_components_browser_esm.Ay.div.withConfig({displayName:"footerLayout__Area",componentId:"sc-gme2s1-1"})(["grid-area:",";display:flex;align-items:flex-end;justify-content:center;z-index:",";"],(({area})=>area),(({zIndex="auto"})=>zIndex));function FooterLayout(t0){const $=(0,dist.c)(13),{footer,zIndex}=t0;let t1,t2,t3,t4;$[0]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Workspace Footer","web-stories"),$[0]=t1):t1=$[0],$[1]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(footerLayout_Area,{area:"carousel"},react.createElement(carouselContainer,null)),$[1]=t2):t2=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(primaryMenu,null),$[2]=t3):t3=$[2],$[3]!==zIndex?(t4=react.createElement(footerLayout_Area,{area:"primary",zIndex},t3),$[3]=zIndex,$[4]=t4):t4=$[4];const t5=footer?.secondaryMenu;let t6,t7,t8;return $[5]!==t5?(t6=react.createElement(secondaryMenu,{menu:t5}),$[5]=t5,$[6]=t6):t6=$[6],$[7]!==t6||$[8]!==zIndex?(t7=react.createElement(footerLayout_Area,{area:"secondary",zIndex},t6),$[7]=t6,$[8]=zIndex,$[9]=t7):t7=$[9],$[10]!==t4||$[11]!==t7?(t8=react.createElement(directionAware.A,null,react.createElement(footerLayout_Wrapper,{"aria-label":t1},t2,t4,t7)),$[10]=t4,$[11]=t7,$[12]=t8):t8=$[12],t8}FooterLayout.propTypes={footer:prop_types_default().object,zIndex:prop_types_default().number};const footerLayout=FooterLayout,Outer=styled_components_browser_esm.Ay.section.withConfig({displayName:"footer__Outer",componentId:"sc-124zhi3-0"})(["height:100%;"]),footer_Inner=(0,styled_components_browser_esm.Ay)(Outer).withConfig({displayName:"footer__Inner",componentId:"sc-124zhi3-1"})(["margin-right:","px;"],(({marginRight})=>marginRight));function Footer(t0){const $=(0,dist.c)(15),{footer,zIndex}=t0,ref=(0,src.li)(),[workspaceWidth,setWorkspaceWidth]=(0,src.J0)(0);let t1,t2,t3,t4;$[0]!==setWorkspaceWidth?(t1=t2=>{const{width}=t2;return setWorkspaceWidth(width)},$[0]=setWorkspaceWidth,$[1]=t1):t1=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t2=[],$[2]=t2):t2=$[2],(0,src.pO)(ref,t1,t2),$[3]!==workspaceWidth?(t3=()=>workspaceWidth>=1e3?8:0,t4=[workspaceWidth],$[3]=workspaceWidth,$[4]=t3,$[5]=t4):(t3=$[4],t4=$[5]);const margin=(0,src.Kr)(t3,t4);let t5,t6,t7;return $[6]!==footer||$[7]!==zIndex?(t5=react.createElement(footerLayout,{footer,zIndex}),$[6]=footer,$[7]=zIndex,$[8]=t5):t5=$[8],$[9]!==margin||$[10]!==t5?(t6=react.createElement(footer_Inner,{marginRight:margin},t5),$[9]=margin,$[10]=t5,$[11]=t6):t6=$[11],$[12]!==ref||$[13]!==t6?(t7=react.createElement(checklist.Ye,null,react.createElement(keyboardShortcutsMenuContext.N,null,react.createElement(Outer,{ref},t6))),$[12]=ref,$[13]=t6,$[14]=t7):t7=$[14],t7}Footer.propTypes={footer:prop_types_default().object,zIndex:prop_types_default().number};const footer_footer=(0,src.ph)(Footer);var contextMenu=__webpack_require__("./packages/design-system/src/components/contextMenu/contextMenu.tsx"),utils_noop=__webpack_require__("./packages/design-system/src/utils/noop.ts"),components_separator=__webpack_require__("./packages/design-system/src/components/contextMenu/components/separator.tsx"),components_button=__webpack_require__("./packages/design-system/src/components/contextMenu/components/button.tsx"),icon=__webpack_require__("./packages/design-system/src/components/contextMenu/components/icon.tsx"),icons=__webpack_require__("./packages/design-system/src/icons/index.ts"),app_history=__webpack_require__("./packages/story-editor/src/app/history/index.ts"),useInsertElement=__webpack_require__("./packages/story-editor/src/components/canvas/useInsertElement.ts"),textPresets=__webpack_require__("./packages/story-editor/src/components/library/panes/text/textPresets.ts");const ACTIONS={ADD_ANIMATION:{trackingEventName:"add_animation",text:(0,i18n.__)("Add animation","web-stories")},ADD_LINK:{trackingEventName:"add_link",text:(0,i18n.__)("Add link","web-stories")},ADD_CAPTIONS:{trackingEventName:"add_captions",text:(0,i18n.__)("Add captions","web-stories")},AUTO_STYLE_TEXT:{trackingEventName:"auto_style_text",text:(0,i18n.__)("Adaptive text colors","web-stories")},CHANGE_BACKGROUND_COLOR:{trackingEventName:"change_background_color",text:(0,i18n.__)("Change background color","web-stories")},CHANGE_TEXT_COLOR:{trackingEventName:"change_text_color",text:(0,i18n.__)("Change color","web-stories")},CHANGE_COLOR:{trackingEventName:"change_color",text:(0,i18n.__)("Change color","web-stories")},RESET_ELEMENT:{trackingEventName:"reset_element",text:(0,i18n.__)("Reset element","web-stories")},CHANGE_FONT:{trackingEventName:"change_font",text:(0,i18n.__)("Edit text","web-stories")},INSERT_BACKGROUND_MEDIA:{trackingEventName:"insert_background_media",text:(0,i18n.__)("Insert background media","web-stories")},INSERT_TEXT:{trackingEventName:"insert_text",text:(0,i18n.__)("Insert text","web-stories")},REPLACE_BACKGROUND_MEDIA:{trackingEventName:"replace_background_media",text:(0,i18n.__)("Replace background","web-stories")},REPLACE_MEDIA:{trackingEventName:"replace_media",text:(0,i18n.__)("Replace media","web-stories")},TRIM_VIDEO:{trackingEventName:"trim_video",text:(0,i18n.__)("Trim video","web-stories")},INSERT_AUDIO_STICKER:{trackingEventName:"insert_audio_sticker",text:(0,i18n.__)("Insert audio sticker","web-stories")}},RESET_PROPERTIES_ANIMATION="animation",RESET_PROPERTIES_OVERLAY="overlay",RESET_PROPERTIES_STYLES="styles",RESET_DEFAULTS_TEXT_BORDER_RADIUS={locked:!0,topLeft:2,topRight:2,bottomLeft:2,bottomRight:2},RESET_DEFAULTS_STANDARD_BORDER_RADIUS=0;const utils_getResetProperties=(selectedElement,selectedElementAnimations=[])=>{if(!selectedElement)return[];const resetProperties=[];return selectedElement?.overlay&&resetProperties.push(RESET_PROPERTIES_OVERLAY),selectedElementAnimations?.length&&resetProperties.push(RESET_PROPERTIES_ANIMATION),(selectedElement?.opacity<100||!function isBorderRadiusDefault(element){return element?.type===elements_src.bV.TEXT&&element?.borderRadius?element.borderRadius.locked&&element.borderRadius.topLeft===RESET_DEFAULTS_TEXT_BORDER_RADIUS.topLeft:!element?.borderRadius||element.borderRadius===RESET_DEFAULTS_STANDARD_BORDER_RADIUS}(selectedElement)||selectedElement?.border)&&resetProperties.push(RESET_PROPERTIES_STYLES),resetProperties};var color_bucket=__webpack_require__("./packages/design-system/src/icons/color_bucket.svg"),useApplyTextAutoStyle=__webpack_require__("./packages/story-editor/src/utils/useApplyTextAutoStyle.js");const quickActions_useTextActions=function useTextActions(t0){const $=(0,dist.c)(8),{selectedElement,updater,commonActions,actionProps}=t0;let t1;$[0]!==selectedElement?.id||$[1]!==updater?(t1=properties=>updater({elementIds:[selectedElement?.id],properties}),$[0]=selectedElement?.id,$[1]=updater,$[2]=t1):t1=$[2];const applyTextAutoStyle=(0,useApplyTextAutoStyle.A)(selectedElement,t1);let t2,t3;return $[3]!==actionProps||$[4]!==applyTextAutoStyle||$[5]!==commonActions?(t2=()=>[{Icon:color_bucket.A,label:ACTIONS.AUTO_STYLE_TEXT.text,onClick:()=>{applyTextAutoStyle(),(0,tracking_src.sx)("quick_action",{name:ACTIONS.AUTO_STYLE_TEXT.trackingEventName,element:"text"})},...actionProps},...commonActions],t3=[actionProps,applyTextAutoStyle,commonActions],$[3]=actionProps,$[4]=applyTextAutoStyle,$[5]=commonActions,$[6]=t2,$[7]=t3):(t2=$[6],t3=$[7]),(0,src.Kr)(t2,t3)};var settings=__webpack_require__("./packages/design-system/src/icons/settings.svg"),mic=__webpack_require__("./packages/design-system/src/icons/mic.svg"),mic_off=__webpack_require__("./packages/design-system/src/icons/mic_off.svg"),camera=__webpack_require__("./packages/design-system/src/icons/camera.svg"),camera_off=__webpack_require__("./packages/design-system/src/icons/camera_off.svg"),background_blur=__webpack_require__("./packages/design-system/src/icons/background_blur.svg"),background_blur_off=__webpack_require__("./packages/design-system/src/icons/background_blur_off.svg"),picture_swap=__webpack_require__("./packages/design-system/src/icons/picture_swap.svg"),captions=__webpack_require__("./packages/design-system/src/icons/captions.svg"),circle_speed=__webpack_require__("./packages/design-system/src/icons/circle_speed.svg"),eraser=__webpack_require__("./packages/design-system/src/icons/eraser.svg"),scissors=__webpack_require__("./packages/design-system/src/icons/scissors.svg"),mediaRecording_constants=__webpack_require__("./packages/story-editor/src/components/mediaRecording/constants.js"),updateProperties=__webpack_require__("./packages/story-editor/src/components/style/updateProperties.js");const quickActions_useElementReset=function useElementReset(){const showSnackbar_0=(0,useSnackbar.d)((({showSnackbar})=>showSnackbar)),{selectedElementAnimations:selectedElementAnimations_0,updateElementsById:updateElementsById_0}=(0,story.P3)((({state:{selectedElementAnimations},actions:{updateElementsById}})=>({selectedElementAnimations,updateElementsById}))),{undo:undo_0}=(0,app_history.W6)((({actions:{undo}})=>({undo}))),undoRef=(0,src.li)(undo_0);undoRef.current=undo_0;const handleResetProperties=(0,src.hb)(((elementType,elementId,properties)=>{const newProperties={};properties.includes(RESET_PROPERTIES_OVERLAY)&&(newProperties.overlay=null),properties.includes(RESET_PROPERTIES_ANIMATION)&&updateElementsById_0({elementIds:[elementId],properties:currentProperties=>(0,updateProperties.A)(currentProperties,{animation:{...selectedElementAnimations_0?.[0],delete:!0}},!0)}),properties.includes(RESET_PROPERTIES_STYLES)&&(newProperties.opacity=100,newProperties.border=null,newProperties.borderRadius=null),elementType===elements_src.RJ.Text&&(newProperties.borderRadius=RESET_DEFAULTS_TEXT_BORDER_RADIUS),updateElementsById_0({elementIds:[elementId],properties:currentProperties_0=>(0,updateProperties.A)(currentProperties_0,newProperties,!0)})}),[selectedElementAnimations_0,updateElementsById_0]);return(0,src.hb)((({elementId:elementId_0,resetProperties,elementType:elementType_0})=>{handleResetProperties(elementType_0,elementId_0,resetProperties),showSnackbar_0({actionLabel:(0,i18n.__)("Undo","web-stories"),dismissible:!1,message:(0,i18n.__)("Element properties have been reset","web-stories"),onAction:()=>{undoRef.current(),(0,tracking_src.sx)("quick_action",{name:`undo_${ACTIONS.RESET_ELEMENT.trackingEventName}`,element:elementType_0,isBackground:!0})},actionHelpText:(0,sprintf.A)((0,i18n.__)("Press %s to undo the last change","web-stories"),(0,utils.KV)("mod+z"))})}),[handleResetProperties,showSnackbar_0])},quickActionIconAttrs={width:24,height:24},StyledSettings=(0,styled_components_browser_esm.Ay)(settings.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__StyledSettings",componentId:"sc-1770zw4-0"})([""]),Mic=(0,styled_components_browser_esm.Ay)(mic.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__Mic",componentId:"sc-1770zw4-1"})([""]),MicOff=(0,styled_components_browser_esm.Ay)(mic_off.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__MicOff",componentId:"sc-1770zw4-2"})([""]),Video=(0,styled_components_browser_esm.Ay)(camera.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__Video",componentId:"sc-1770zw4-3"})([""]),VideoOff=(0,styled_components_browser_esm.Ay)(camera_off.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__VideoOff",componentId:"sc-1770zw4-4"})([""]),BackgroundBlur=(0,styled_components_browser_esm.Ay)(background_blur.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__BackgroundBlur",componentId:"sc-1770zw4-5"})([""]),BackgroundBlurOff=(0,styled_components_browser_esm.Ay)(background_blur_off.A).attrs(quickActionIconAttrs).withConfig({displayName:"useMediaActions__BackgroundBlurOff",componentId:"sc-1770zw4-6"})([""]);function useMediaActions_temp(t0){const{state,actions}=t0;return{hasAudio:state.hasAudio,hasVideo:state.hasVideo,videoEffect:state.videoEffect,audioInput:state.audioInput,videoInput:state.videoInput,isReady:!("ready"!==state.inputStatus||state.file?.type?.startsWith("image")||state.isCountingDown||"ready"!==state.status&&"idle"!==state.status),isProcessing:state.isProcessing,isAdjustingTrim:state.isAdjustingTrim,isProcessingTrim:state.isProcessingTrim,toggleRecordingMode:actions.toggleRecordingMode,toggleVideo:actions.toggleVideo,toggleAudio:actions.toggleAudio,toggleSettings:actions.toggleSettings,muteAudio:actions.muteAudio,unMuteAudio:actions.unMuteAudio,startTrim:actions.startTrim,setVideoEffect:actions.setVideoEffect}}const quickActions_useMediaActions=function useMediaActions(t0){const $=(0,dist.c)(70),{actionProps,selectedElement,handleFocusPanel,resetProperties,commonActions}=t0,{capabilities:t1}=(0,config.UK)(),{hasUploadMediaAction}=t1,dispatchStoryEvent=(0,story._b)(),{toggleRecordingMode,toggleVideo,toggleAudio,hasVideo,hasAudio,videoEffect,setVideoEffect,toggleSettings,audioInput,videoInput,isReady,isProcessing,isAdjustingTrim,isProcessingTrim,startTrim}=(0,mediaRecording.be)(useMediaActions_temp),showClearAction=resetProperties.length>0;let t2;$[0]!==actionProps||$[1]!==commonActions||$[2]!==dispatchStoryEvent||$[3]!==hasUploadMediaAction||$[4]!==selectedElement?.type?(t2=()=>{const actions_0=[];return hasUploadMediaAction&&actions_0.push({Icon:picture_swap.A,label:ACTIONS.REPLACE_MEDIA.text,onClick:()=>{dispatchStoryEvent(story.IM.onReplaceForegroundMedia),(0,tracking_src.sx)("quick_action",{name:ACTIONS.REPLACE_MEDIA.trackingEventName,element:selectedElement?.type})},wrapWithMediaPicker:!0,...actionProps}),[...actions_0,...commonActions]},$[0]=actionProps,$[1]=commonActions,$[2]=dispatchStoryEvent,$[3]=hasUploadMediaAction,$[4]=selectedElement?.type,$[5]=t2):t2=$[5];const t3=selectedElement?.type;let t4;$[6]!==actionProps||$[7]!==commonActions||$[8]!==dispatchStoryEvent||$[9]!==hasUploadMediaAction||$[10]!==t3?(t4=[hasUploadMediaAction,commonActions,actionProps,dispatchStoryEvent,t3],$[6]=actionProps,$[7]=commonActions,$[8]=dispatchStoryEvent,$[9]=hasUploadMediaAction,$[10]=t3,$[11]=t4):t4=$[11];const foregroundImageActions=(0,src.Kr)(t2,t4);let t5,t6;$[12]!==handleFocusPanel?(t5=()=>({handleFocusAnimationPanel:handleFocusPanel(highlights.xP.Animation),handleFocusCaptionsPanel:handleFocusPanel(highlights.xP.Captions)}),t6=[handleFocusPanel],$[12]=handleFocusPanel,$[13]=t5,$[14]=t6):(t5=$[13],t6=$[14]);const{handleFocusAnimationPanel,handleFocusCaptionsPanel}=(0,src.Kr)(t5,t6);let t7;$[15]!==actionProps||$[16]!==foregroundImageActions||$[17]!==handleFocusCaptionsPanel||$[18]!==selectedElement?.type||$[19]!==showClearAction?(t7=()=>{const[baseActions,clearActions]=showClearAction?[foregroundImageActions.slice(0,foregroundImageActions.length-1),foregroundImageActions.slice(-1)]:[foregroundImageActions,[]];return[...baseActions,{Icon:captions.A,label:ACTIONS.ADD_CAPTIONS.text,onClick:evt=>{handleFocusCaptionsPanel()(evt),(0,tracking_src.sx)("quick_action",{name:ACTIONS.ADD_CAPTIONS.trackingEventName,element:selectedElement?.type})},...actionProps},...clearActions]},$[15]=actionProps,$[16]=foregroundImageActions,$[17]=handleFocusCaptionsPanel,$[18]=selectedElement?.type,$[19]=showClearAction,$[20]=t7):t7=$[20];const t8=selectedElement?.type;let t9;$[21]!==actionProps||$[22]!==foregroundImageActions||$[23]!==handleFocusCaptionsPanel||$[24]!==showClearAction||$[25]!==t8?(t9=[actionProps,foregroundImageActions,handleFocusCaptionsPanel,t8,showClearAction],$[21]=actionProps,$[22]=foregroundImageActions,$[23]=handleFocusCaptionsPanel,$[24]=showClearAction,$[25]=t8,$[26]=t9):t9=$[26];const videoActions=(0,src.Kr)(t7,t9),handleElementReset=quickActions_useElementReset();let t10;$[27]!==actionProps||$[28]!==dispatchStoryEvent||$[29]!==handleElementReset||$[30]!==handleFocusAnimationPanel||$[31]!==hasUploadMediaAction||$[32]!==resetProperties||$[33]!==selectedElement?.id||$[34]!==selectedElement?.type||$[35]!==showClearAction?(t10=()=>{const baseActions_0=[{Icon:circle_speed.A,label:ACTIONS.ADD_ANIMATION.text,onClick:evt_0=>{handleFocusAnimationPanel()(evt_0),(0,tracking_src.sx)("quick_action",{name:ACTIONS.ADD_ANIMATION.trackingEventName,element:selectedElement?.type,isBackground:!0})},...actionProps}];hasUploadMediaAction&&baseActions_0.unshift({Icon:picture_swap.A,label:ACTIONS.REPLACE_BACKGROUND_MEDIA.text,onClick:()=>{dispatchStoryEvent(story.IM.onReplaceBackgroundMedia),(0,tracking_src.sx)("quick_action",{name:ACTIONS.REPLACE_BACKGROUND_MEDIA.trackingEventName,element:selectedElement?.type,isBackground:!0})},wrapWithMediaPicker:!0,...actionProps});const clearAction={Icon:eraser.A,label:ACTIONS.RESET_ELEMENT.text,onClick:()=>{handleElementReset({elementId:selectedElement?.id,resetProperties,elementType:elements_src.bV.IMAGE}),(0,tracking_src.sx)("quick_action",{name:ACTIONS.RESET_ELEMENT.trackingEventName,element:selectedElement?.type,isBackground:!0})},separator:"top",...actionProps};return showClearAction?[...baseActions_0,clearAction]:baseActions_0},$[27]=actionProps,$[28]=dispatchStoryEvent,$[29]=handleElementReset,$[30]=handleFocusAnimationPanel,$[31]=hasUploadMediaAction,$[32]=resetProperties,$[33]=selectedElement?.id,$[34]=selectedElement?.type,$[35]=showClearAction,$[36]=t10):t10=$[36];const t11=selectedElement?.id,t12=selectedElement?.type;let t13;$[37]!==actionProps||$[38]!==dispatchStoryEvent||$[39]!==handleElementReset||$[40]!==handleFocusAnimationPanel||$[41]!==hasUploadMediaAction||$[42]!==resetProperties||$[43]!==showClearAction||$[44]!==t11||$[45]!==t12?(t13=[actionProps,dispatchStoryEvent,handleElementReset,handleFocusAnimationPanel,hasUploadMediaAction,resetProperties,t11,t12,showClearAction],$[37]=actionProps,$[38]=dispatchStoryEvent,$[39]=handleElementReset,$[40]=handleFocusAnimationPanel,$[41]=hasUploadMediaAction,$[42]=resetProperties,$[43]=showClearAction,$[44]=t11,$[45]=t12,$[46]=t13):t13=$[46];const backgroundElementMediaActions=(0,src.Kr)(t10,t13);let t14,t15;$[47]!==actionProps||$[48]!==audioInput||$[49]!==hasAudio||$[50]!==hasVideo||$[51]!==isAdjustingTrim||$[52]!==isProcessing||$[53]!==isProcessingTrim||$[54]!==isReady||$[55]!==setVideoEffect||$[56]!==startTrim||$[57]!==toggleAudio||$[58]!==toggleRecordingMode||$[59]!==toggleSettings||$[60]!==toggleVideo||$[61]!==videoEffect||$[62]!==videoInput?(t14=()=>[{Icon:cross.A,label:(0,i18n.__)("Close","web-stories"),onClick:()=>{(0,tracking_src.sx)("media_recording_mode_toggled",{status:"closed"}),toggleRecordingMode()},...actionProps},{Icon:StyledSettings,label:(0,i18n.__)("Options","web-stories"),onClick:()=>{(0,tracking_src.sx)("media_recording_open_settings"),toggleSettings()},disabled:!isReady,separator:"top",...actionProps},audioInput&&{Icon:hasAudio?Mic:MicOff,label:hasAudio?(0,i18n.__)("Disable Audio","web-stories"):(0,i18n.__)("Enable Audio","web-stories"),onClick:()=>{(0,tracking_src.sx)("media_recording_audio_toggled",{status:hasAudio?"muted":"unmuted"}),toggleAudio()},disabled:!isReady||!hasVideo,...actionProps},videoInput&&{Icon:hasVideo?Video:VideoOff,label:hasVideo?(0,i18n.__)("Disable Video","web-stories"):(0,i18n.__)("Enable Video","web-stories"),onClick:()=>{(0,tracking_src.sx)("media_recording_video_toggled",{status:hasVideo?"off":"on"}),toggleVideo()},disabled:!isReady||!hasAudio,...actionProps},videoInput&&{Icon:videoEffect===mediaRecording_constants.R4.BLUR?BackgroundBlur:BackgroundBlurOff,label:videoEffect===mediaRecording_constants.R4.BLUR?(0,i18n.__)("Disable Background Blur","web-stories"):(0,i18n.__)("Enable Background Blur","web-stories"),onClick:()=>{(0,tracking_src.sx)("media_recording_background_blur_px",{value:videoEffect===mediaRecording_constants.R4.BLUR?0:mediaRecording_constants.qO});const newVideoEffect=videoEffect===mediaRecording_constants.R4.BLUR?mediaRecording_constants.R4.NONE:mediaRecording_constants.R4.BLUR;setVideoEffect(newVideoEffect)},disabled:!isReady||!hasVideo,...actionProps},{Icon:scissors.A,label:(0,i18n.__)("Trim Video","web-stories"),onClick:()=>{(0,tracking_src.sx)("media_recording_trim_start"),startTrim()},disabled:!isProcessing||isAdjustingTrim||!hasVideo||isProcessingTrim,...actionProps}].filter(Boolean),t15=[actionProps,isReady,audioInput,hasAudio,hasVideo,videoInput,videoEffect,isProcessing,isAdjustingTrim,isProcessingTrim,toggleRecordingMode,toggleSettings,toggleAudio,toggleVideo,setVideoEffect,startTrim],$[47]=actionProps,$[48]=audioInput,$[49]=hasAudio,$[50]=hasVideo,$[51]=isAdjustingTrim,$[52]=isProcessing,$[53]=isProcessingTrim,$[54]=isReady,$[55]=setVideoEffect,$[56]=startTrim,$[57]=toggleAudio,$[58]=toggleRecordingMode,$[59]=toggleSettings,$[60]=toggleVideo,$[61]=videoEffect,$[62]=videoInput,$[63]=t14,$[64]=t15):(t14=$[63],t15=$[64]);const mediaRecordingActions=(0,src.Kr)(t14,t15);let t16;return $[65]!==backgroundElementMediaActions||$[66]!==foregroundImageActions||$[67]!==mediaRecordingActions||$[68]!==videoActions?(t16={backgroundElementMediaActions,foregroundImageActions,mediaRecordingActions,videoActions},$[65]=backgroundElementMediaActions,$[66]=foregroundImageActions,$[67]=mediaRecordingActions,$[68]=videoActions,$[69]=t16):t16=$[69],t16};var icons_link=__webpack_require__("./packages/design-system/src/icons/link.svg");function useForegroundActions_temp(t0){const{state:t1}=t0,{currentPageNumber}=t1;return{currentPageNumber}}const quickActions_useForegroundActions=function useForegroundActions(t0){const $=(0,dist.c)(18),{actionProps,selectedElement,handleFocusPanel,resetProperties}=t0,{currentPageNumber:currentPageNumber_0}=(0,story.P3)(useForegroundActions_temp),handleElementReset=quickActions_useElementReset(),showClearAction=resetProperties.length>0;let t1;$[0]!==actionProps||$[1]!==currentPageNumber_0||$[2]!==handleElementReset||$[3]!==handleFocusPanel||$[4]!==resetProperties||$[5]!==selectedElement?.id||$[6]!==selectedElement?.type||$[7]!==showClearAction?(t1=()=>{const handleFocusAnimationPanel=handleFocusPanel(highlights.xP.Animation),handleFocusLinkPanel=handleFocusPanel(highlights.xP.Link),commonActions=[];return currentPageNumber_0>1&&commonActions.push({Icon:circle_speed.A,label:ACTIONS.ADD_ANIMATION.text,onClick:evt=>{handleFocusAnimationPanel()(evt),(0,tracking_src.sx)("quick_action",{name:ACTIONS.ADD_ANIMATION.trackingEventName,element:selectedElement?.type})},...actionProps}),commonActions.push({Icon:icons_link.A,label:ACTIONS.ADD_LINK.text,onClick:evt_0=>{handleFocusLinkPanel()(evt_0),(0,tracking_src.sx)("quick_action",{name:ACTIONS.ADD_LINK.trackingEventName,element:selectedElement?.type})},...actionProps}),showClearAction&&commonActions.push({Icon:eraser.A,label:ACTIONS.RESET_ELEMENT.text,onClick:()=>{handleElementReset({elementId:selectedElement?.id,resetProperties,elementType:selectedElement?.type}),(0,tracking_src.sx)("quick_action",{name:ACTIONS.RESET_ELEMENT.trackingEventName,element:selectedElement?.type})},separator:"top",...actionProps}),commonActions},$[0]=actionProps,$[1]=currentPageNumber_0,$[2]=handleElementReset,$[3]=handleFocusPanel,$[4]=resetProperties,$[5]=selectedElement?.id,$[6]=selectedElement?.type,$[7]=showClearAction,$[8]=t1):t1=$[8];const t2=selectedElement?.type,t3=selectedElement?.id;let t4;return $[9]!==actionProps||$[10]!==currentPageNumber_0||$[11]!==handleElementReset||$[12]!==handleFocusPanel||$[13]!==resetProperties||$[14]!==showClearAction||$[15]!==t2||$[16]!==t3?(t4=[handleFocusPanel,currentPageNumber_0,actionProps,showClearAction,t2,t3,resetProperties,handleElementReset],$[9]=actionProps,$[10]=currentPageNumber_0,$[11]=handleElementReset,$[12]=handleFocusPanel,$[13]=resetProperties,$[14]=showClearAction,$[15]=t2,$[16]=t3,$[17]=t4):t4=$[17],(0,src.Kr)(t1,t4)},{Bucket,LetterTPlus,Media,AudioSticker}=icons,quickActions_useQuickActions=()=>{const{backgroundElement,selectedElementAnimations:selectedElementAnimations_0,selectedElements:selectedElements_0,updateElementsById:updateElementsById_0}=(0,story.P3)((({state:{currentPage,currentPageNumber,selectedElementAnimations,selectedElements},actions:{updateElementsById}})=>({backgroundElement:currentPage?.elements.find((element=>element.isBackground)),currentPageNumber,selectedElementAnimations,selectedElements,updateElementsById}))),{undo:undo_0}=(0,app_history.W6)((({actions:{undo}})=>({undo}))),{setHighlights:setHighlights_0}=(0,highlights.N)((({setHighlights})=>({setHighlights}))),{isInRecordingMode}=(0,mediaRecording.be)((({state})=>({isInRecordingMode:state.isInRecordingMode})));(0,src.li)(undo_0).current=undo_0;const selectedElement=selectedElements_0?.[0],handleMouseDown=(0,src.hb)((ev=>{ev.stopPropagation()}),[]),handleFocusPanel=(0,src.hb)((highlight=>elementId=>ev_0=>{ev_0.preventDefault(),setHighlights_0({elementId:elementId||selectedElement?.id,highlight})}),[setHighlights_0,selectedElement]),resetProperties=(0,src.Kr)((()=>utils_getResetProperties(selectedElement,selectedElementAnimations_0)),[selectedElement,selectedElementAnimations_0]),handleFocusMediaPanel=(0,src.Kr)((()=>{const panelToFocus=(selectedElements_0?.[0]?.resource?.id?.toString()||"").startsWith("media/")?highlights.xP.Media3p:highlights.xP.Media;return handleFocusPanel(panelToFocus)}),[handleFocusPanel,selectedElements_0]),{handleFocusPageBackground}=(0,src.Kr)((()=>({handleFocusPageBackground:handleFocusPanel(highlights.xP.PageBackground)})),[handleFocusPanel]),insertElement=(0,useInsertElement.A)(),actionMenuProps=(0,src.Kr)((()=>({tooltipPlacement:popup_constants.W.Right,onMouseDown:handleMouseDown})),[handleMouseDown]),hasAudioAnywhere=(0,story.P3)((({state:state_0})=>state_0.story?.backgroundAudio||state_0.pages?.some((page=>page.backgroundAudio||page.elements.filter((element_0=>element_0.type===elements_src.RJ.Video)).some((element_1=>!element_1.resource.isMuted)))))),noElementSelectedActions=(0,src.Kr)((()=>{const actions=[{Icon:Bucket,label:ACTIONS.CHANGE_BACKGROUND_COLOR.text,onClick:evt=>{handleFocusPageBackground(backgroundElement?.id)(evt),(0,tracking_src.sx)("quick_action",{name:ACTIONS.CHANGE_BACKGROUND_COLOR.trackingEventName,element:"none"})},...actionMenuProps},{Icon:Media,label:ACTIONS.INSERT_BACKGROUND_MEDIA.text,onClick:evt_0=>{handleFocusMediaPanel()(evt_0),(0,tracking_src.sx)("quick_action",{name:ACTIONS.INSERT_BACKGROUND_MEDIA.trackingEventName,element:"none"})},separator:"top",...actionMenuProps},{Icon:LetterTPlus,label:ACTIONS.INSERT_TEXT.text,onClick:()=>{setHighlights_0({highlight:highlights.xP.StylePane}),insertElement("text",textPresets.C),(0,tracking_src.sx)("quick_action",{name:ACTIONS.INSERT_TEXT.trackingEventName,element:"none"})},...actionMenuProps}];return hasAudioAnywhere&&actions.push({Icon:AudioSticker,label:ACTIONS.INSERT_AUDIO_STICKER.text,onClick:()=>{insertElement("audioSticker",constants.XK)},...actionMenuProps}),actions}),[actionMenuProps,backgroundElement,handleFocusMediaPanel,handleFocusPageBackground,setHighlights_0,insertElement,hasAudioAnywhere]),foregroundCommonActions=quickActions_useForegroundActions({actionProps:actionMenuProps,selectedElement,handleFocusPanel,resetProperties}),textActions=quickActions_useTextActions({selectedElement,updater:updateElementsById_0,commonActions:foregroundCommonActions,actionProps:actionMenuProps}),{backgroundElementMediaActions,foregroundImageActions,mediaRecordingActions,videoActions}=quickActions_useMediaActions({selectedElement,handleFocusPanel,resetProperties,commonActions:foregroundCommonActions});if(isInRecordingMode)return mediaRecordingActions;if(selectedElements_0.length>1)return[];const isBackgroundElementMedia=Boolean(backgroundElement&&backgroundElement?.resource),noElementsSelected=0===selectedElements_0.length,isBackgroundSelected=selectedElements_0?.[0]?.isBackground;if(noElementsSelected||isBackgroundSelected&&!isBackgroundElementMedia)return noElementSelectedActions;if(isBackgroundSelected&&isBackgroundElementMedia)return backgroundElementMediaActions;switch(selectedElements_0?.[0]?.type){case elements_src.RJ.Image:case elements_src.RJ.Gif:return foregroundImageActions;case elements_src.RJ.Shape:case elements_src.RJ.Sticker:return foregroundCommonActions;case elements_src.RJ.Text:return textActions;case elements_src.RJ.Video:return videoActions;default:return[]}};var translateToExclusiveList=__webpack_require__("./packages/i18n/src/translateToExclusiveList.ts"),src_mimeTypes=__webpack_require__("./packages/media/src/mimeTypes.ts"),resourceList=__webpack_require__("./packages/media/src/resourceList.ts"),media=__webpack_require__("./packages/story-editor/src/app/media/index.js"),useFFmpeg=__webpack_require__("./packages/story-editor/src/app/media/utils/useFFmpeg.ts");function mediaPicker_extends(){return mediaPicker_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},mediaPicker_extends.apply(null,arguments)}const mediaPicker=({render,...props})=>{const{allowedMimeTypes:{image:allowedImageMimeTypes,vector:allowedVectorMimeTypes,video:allowedVideoMimeTypes},MediaUpload}=(0,config.UK)(),{selectedElements:selectedElements_0,updateElementsById:updateElementsById_0}=(0,story.P3)((({state:{selectedElements},actions:{updateElementsById}})=>({selectedElements,updateElementsById}))),{resetWithFetch:resetWithFetch_0,postProcessingResource:postProcessingResource_0,optimizeVideo:optimizeVideo_0,optimizeGif:optimizeGif_0,canTranscodeResource:canTranscodeResource_0}=(0,media.HZ)((({state:{canTranscodeResource},actions:{resetWithFetch,postProcessingResource,optimizeVideo,optimizeGif}})=>({canTranscodeResource,resetWithFetch,postProcessingResource,optimizeVideo,optimizeGif}))),{isTranscodingEnabled}=(0,useFFmpeg.A)(),{showSnackbar}=(0,useSnackbar.d)();let allowedMimeTypes=(0,src.Kr)((()=>[...allowedImageMimeTypes,...allowedVectorMimeTypes,...allowedVideoMimeTypes]),[allowedImageMimeTypes,allowedVectorMimeTypes,allowedVideoMimeTypes]);const allowedFileTypes=(0,src.Kr)((()=>allowedMimeTypes.flatMap((type=>(0,src_mimeTypes.n)(type)))),[allowedMimeTypes]);isTranscodingEnabled&&(allowedMimeTypes=allowedMimeTypes.concat(media.sX));const transcodableMimeTypes=media.sX.filter((x=>!allowedVideoMimeTypes.includes(x)));let onSelectErrorMessage=(0,i18n.__)("No file types are currently supported.","web-stories");allowedFileTypes.length&&(onSelectErrorMessage=(0,sprintf.A)((0,i18n.__)("Please choose only %s to insert into page.","web-stories"),(0,translateToExclusiveList.A)(allowedFileTypes)));const insertMediaElement=(0,src.hb)(((resource,thumbnailURL)=>{resourceList.A.set(resource.id,{url:thumbnailURL,type:"cached"}),updateElementsById_0({elementIds:[selectedElements_0?.[0]?.id],properties:{type:resource.type,resource}})}),[selectedElements_0,updateElementsById_0]),handleMediaSelect=(0,src.hb)((resource_0=>{try{isTranscodingEnabled&&canTranscodeResource_0(resource_0)&&(transcodableMimeTypes.includes(resource_0.mimeType)&&optimizeVideo_0({resource:resource_0}),"image/gif"===resource_0.mimeType&&optimizeGif_0({resource:resource_0})),insertMediaElement(resource_0,resource_0.sizes?.medium?.sourceUrl||resource_0.src),postProcessingResource_0(resource_0)}catch(e){showSnackbar({message:e.message,dismissable:!0})}}),[isTranscodingEnabled,canTranscodeResource_0,insertMediaElement,postProcessingResource_0,transcodableMimeTypes,optimizeVideo_0,optimizeGif_0,showSnackbar]);return react.createElement(MediaUpload,mediaPicker_extends({title:(0,i18n.__)("Replace media","web-stories"),buttonInsertText:(0,i18n.__)("Replace media","web-stories"),onSelect:handleMediaSelect,onClose:resetWithFetch_0,type:allowedMimeTypes,onSelectErrorMessage,render:open=>render({onClick:open})},props))};var plus_outline=__webpack_require__("./packages/design-system/src/icons/plus_outline.svg");function pageMenuButton_extends(){return pageMenuButton_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pageMenuButton_extends.apply(null,arguments)}const pageMenuButton_StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"pageMenuButton__StyledButton",componentId:"sc-x8fz92-0"})(["margin-top:12px;"]);function PageMenuButtonWithRef(t0,forwardedRef){const $=(0,dist.c)(13);let children,rest,shortcut,title,t1,t2;return $[0]!==t0?(({children,title,shortcut,...rest}=t0),$[0]=t0,$[1]=children,$[2]=rest,$[3]=shortcut,$[4]=title):(children=$[1],rest=$[2],shortcut=$[3],title=$[4]),$[5]!==children||$[6]!==forwardedRef||$[7]!==rest?(t1=react.createElement(pageMenuButton_StyledButton,pageMenuButton_extends({variant:button_constants.Ak.Square,type:button_constants.VQ.Secondary,size:button_constants.Mp.Small,ref:forwardedRef},rest),children),$[5]=children,$[6]=forwardedRef,$[7]=rest,$[8]=t1):t1=$[8],$[9]!==shortcut||$[10]!==t1||$[11]!==title?(t2=react.createElement(tooltip.A,{title,shortcut,placement:popup_constants.W.Right,hasTail:!0},t1),$[9]=shortcut,$[10]=t1,$[11]=title,$[12]=t2):t2=$[12],t2}const PageMenuButton=(0,src.Rf)(PageMenuButtonWithRef);PageMenuButton.propTypes={children:prop_types_default().node,title:prop_types_default().string,shortcut:prop_types_default().string},PageMenuButtonWithRef.propTypes=PageMenuButton.propTypes;const pageMenuButton=PageMenuButton;var stop_outline=__webpack_require__("./packages/design-system/src/icons/stop_outline.svg"),play_outline=__webpack_require__("./packages/design-system/src/icons/play_outline.svg");function animationToggle_temp(t0){const{state:t1,actions:t2}=t0,{animationState,currentPageNumber}=t1,{updateAnimationState}=t2;return{animationState,updateAnimationState,isFirstPage:1===currentPageNumber}}const animationToggle=function AnimationToggle(){const $=(0,dist.c)(20),{animationState:animationState_0,updateAnimationState:updateAnimationState_0,isFirstPage}=(0,app.P3)(animationToggle_temp);let t0;$[0]===Symbol.for("react.memo_cache_sentinel")?(t0=[animation_src.TR.Playing,animation_src.TR.PlayingSelected],$[0]=t0):t0=$[0];const isPlaying=t0.includes(animationState_0);let t1;$[1]!==isFirstPage||$[2]!==isPlaying?(t1=isFirstPage?(0,i18n.__)("Animations Disabled","web-stories"):isPlaying?(0,i18n.__)("Stop","web-stories"):(0,i18n.__)("Play","web-stories"),$[1]=isFirstPage,$[2]=isPlaying,$[3]=t1):t1=$[3];const tooltip=t1;let t2;$[4]!==isFirstPage||$[5]!==isPlaying?(t2=isFirstPage?(0,i18n.__)("Page Animations Disabled","web-stories"):isPlaying?(0,i18n.__)("Stop Page Animations","web-stories"):(0,i18n.__)("Play Page Animations","web-stories"),$[4]=isFirstPage,$[5]=isPlaying,$[6]=t2):t2=$[6];const label=t2,shortcut=isFirstPage?null:"mod+enter",Icon=isPlaying?stop_outline.A:play_outline.A;let t3,t4;$[7]!==isPlaying||$[8]!==updateAnimationState_0?(t3=()=>{updateAnimationState_0({animationState:isPlaying?animation_src.TR.Reset:animation_src.TR.Playing}),(0,tracking_src.sx)("canvas_play_animations",{status:isPlaying?"stop":"play"})},t4=[isPlaying,updateAnimationState_0],$[7]=isPlaying,$[8]=updateAnimationState_0,$[9]=t3,$[10]=t4):(t3=$[9],t4=$[10]);const toggleAnimationState=(0,src.hb)(t3,t4);let t5,t6;return $[11]!==Icon?(t5=react.createElement(Icon,null),$[11]=Icon,$[12]=t5):t5=$[12],$[13]!==isFirstPage||$[14]!==label||$[15]!==shortcut||$[16]!==t5||$[17]!==toggleAnimationState||$[18]!==tooltip?(t6=react.createElement(pageMenuButton,{title:tooltip,shortcut,onClick:toggleAnimationState,"aria-label":label,disabled:isFirstPage},t5),$[13]=isFirstPage,$[14]=label,$[15]=shortcut,$[16]=t5,$[17]=toggleAnimationState,$[18]=tooltip,$[19]=t6):t6=$[19],t6},pageMenu_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"pageMenu__Wrapper",componentId:"sc-m9u2n8-0"})(["margin-top:auto;padding:0 4px;pointer-events:all;"]);function pageMenu_temp(t0){const{state:t1,actions:t2}=t0,{currentPage,pages}=t1,{deleteCurrentPage,addPage}=t2;return{currentPage,numberOfPages:pages.length,deleteCurrentPage,addPage,hasVisibleAnimations:currentPage?.animations?.some((animation=>animation.targets.some((id=>!currentPage.elements.find((element=>element.id===id))?.isHidden))))}}const pageMenu=(0,src.ph)((function PageMenu(){const $=(0,dist.c)(40),{currentPage:currentPage_0,numberOfPages,deleteCurrentPage:deleteCurrentPage_0,addPage:addPage_0,hasVisibleAnimations}=(0,app.P3)(pageMenu_temp),addPageButtonRef=(0,src.li)(null),deletePageButtonRef=(0,src.li)(null);let t0,t1,t2,t3;$[0]!==addPageButtonRef.current?(t0={node:addPageButtonRef.current,eventData:constants.Zy.PAGE_ADD},$[0]=addPageButtonRef.current,$[1]=t0):t0=$[1],(0,usePerformanceTracking.A)(t0),$[2]!==deletePageButtonRef.current?(t1={node:deletePageButtonRef.current,eventData:constants.Zy.PAGE_DELETE},$[2]=deletePageButtonRef.current,$[3]=t1):t1=$[3],(0,usePerformanceTracking.A)(t1),$[4]!==deleteCurrentPage_0?(t2=()=>deleteCurrentPage_0(),t3=[deleteCurrentPage_0],$[4]=deleteCurrentPage_0,$[5]=t2,$[6]=t3):(t2=$[5],t3=$[6]);const handleDeletePage=(0,src.hb)(t2,t3);let t4,t5;$[7]!==addPage_0?(t4=()=>addPage_0({page:(0,elements_src.a3)()}),t5=[addPage_0],$[7]=addPage_0,$[8]=t4,$[9]=t5):(t4=$[8],t5=$[9]);const handleAddPage=(0,src.hb)(t4,t5);let t6,t7;$[10]!==addPage_0||$[11]!==currentPage_0?(t6=()=>addPage_0({page:(0,elements_src.hi)(currentPage_0)}),t7=[addPage_0,currentPage_0],$[10]=addPage_0,$[11]=currentPage_0,$[12]=t6,$[13]=t7):(t6=$[12],t7=$[13]);const handleDuplicatePage=(0,src.hb)(t6,t7),disableDeleteButton=numberOfPages<=1;if(!currentPage_0)return null;let t8,t9,t10,t11,t12,t13,t14,t15,t16,t17,t18,t19,t20,t21,t22;return $[14]===Symbol.for("react.memo_cache_sentinel")?(t8=(0,i18n.__)("Page actions","web-stories"),$[14]=t8):t8=$[14],$[15]!==hasVisibleAnimations?(t9=hasVisibleAnimations&&react.createElement(animationToggle,null),$[15]=hasVisibleAnimations,$[16]=t9):t9=$[16],$[17]===Symbol.for("react.memo_cache_sentinel")?(t10=(0,i18n.__)("New Page","web-stories"),$[17]=t10):t10=$[17],$[18]===Symbol.for("react.memo_cache_sentinel")?(t11=(0,i18n.__)("Add New Page","web-stories"),t12=react.createElement(plus_outline.A,null),$[18]=t11,$[19]=t12):(t11=$[18],t12=$[19]),$[20]!==addPageButtonRef||$[21]!==handleAddPage?(t13=react.createElement(pageMenuButton,{ref:addPageButtonRef,title:t10,onClick:handleAddPage,"aria-label":t11},t12),$[20]=addPageButtonRef,$[21]=handleAddPage,$[22]=t13):t13=$[22],$[23]===Symbol.for("react.memo_cache_sentinel")?(t14=(0,i18n.__)("Duplicate Page","web-stories"),$[23]=t14):t14=$[23],$[24]===Symbol.for("react.memo_cache_sentinel")?(t15=(0,i18n.__)("Duplicate Page","web-stories"),t16=react.createElement(page_plus.A,null),$[24]=t15,$[25]=t16):(t15=$[24],t16=$[25]),$[26]!==handleDuplicatePage?(t17=react.createElement(pageMenuButton,{title:t14,onClick:handleDuplicatePage,"aria-label":t15},t16),$[26]=handleDuplicatePage,$[27]=t17):t17=$[27],$[28]===Symbol.for("react.memo_cache_sentinel")?(t18=(0,i18n.__)("Delete Page","web-stories"),$[28]=t18):t18=$[28],$[29]===Symbol.for("react.memo_cache_sentinel")?(t19=(0,i18n.__)("Delete Page","web-stories"),t20=react.createElement(trash.A,null),$[29]=t19,$[30]=t20):(t19=$[29],t20=$[30]),$[31]!==deletePageButtonRef||$[32]!==disableDeleteButton||$[33]!==handleDeletePage?(t21=react.createElement(pageMenuButton,{ref:deletePageButtonRef,title:t18,disabled:disableDeleteButton,onClick:handleDeletePage,"aria-label":t19},t20),$[31]=deletePageButtonRef,$[32]=disableDeleteButton,$[33]=handleDeletePage,$[34]=t21):t21=$[34],$[35]!==t13||$[36]!==t17||$[37]!==t21||$[38]!==t9?(t22=react.createElement(pageMenu_Wrapper,{role:"group","aria-label":t8},t9,t13,t17,t21),$[35]=t13,$[36]=t17,$[37]=t21,$[38]=t9,$[39]=t22):t22=$[39],t22}));function pageSideMenu_extends(){return pageSideMenu_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pageSideMenu_extends.apply(null,arguments)}const MenusWrapper=styled_components_browser_esm.Ay.section.withConfig({displayName:"pageSideMenu__MenusWrapper",componentId:"sc-sll2i1-0"})(["position:absolute;display:flex;flex-direction:column;align-items:center;justify-content:space-between;z-index:",";pointer-events:none;min-height:100%;",""],(({$zIndex})=>$zIndex),(({isZoomed,theme})=>isZoomed&&`\n    min-height: initial;\n    background-color: ${(0,polished_esm.B3)(theme.colors.standard.black,.45)};\n    border-radius: ${theme.borders.radius.small};\n    padding: 8px;\n    margin-left: -24px;\n  `)),Divider=styled_components_browser_esm.Ay.div.withConfig({displayName:"pageSideMenu__Divider",componentId:"sc-sll2i1-1"})(["width:20px;height:1px;margin:13px auto 1px;background-color:",";"],(({theme})=>theme.colors.divider.primary)),StyledContextMenu=(0,styled_components_browser_esm.Ay)(contextMenu.A).withConfig({displayName:"pageSideMenu__StyledContextMenu",componentId:"sc-sll2i1-2"})(["pointer-events:all;"]);function pageSideMenu_temp4(t0){const{Icon,label,onClick,separator,tooltipPlacement,wrapWithMediaPicker,...quickAction}=t0,action=t1=>{const externalOnClick=void 0===t1?utils_noop.l:t1;return react.createElement(src.FK,{key:label},"top"===separator&&react.createElement(components_separator.A,null),react.createElement(tooltip.A,{placement:tooltipPlacement,title:label},react.createElement(components_button.A,pageSideMenu_extends({"aria-label":label,onClick:evt=>{onClick(evt),externalOnClick(evt)}},quickAction),react.createElement(icon.A,{title:label},react.createElement(Icon,null)))),"bottom"===separator&&react.createElement(components_separator.A,null))};return wrapWithMediaPicker?react.createElement(mediaPicker,{key:label,render:t2=>{const{onClick:openMediaPicker}=t2;return action(openMediaPicker)}}):action()}function pageSideMenu_temp3(e){e.stopPropagation()}function pageSideMenu_temp2(t0){const{state:t1}=t0,{isInRecordingMode}=t1;return{isInRecordingMode}}function pageSideMenu_temp(t0){const{state:t1}=t0,{zoomSetting}=t1;return{zoomSetting}}const pageSideMenu=function PageSideMenu(){const $=(0,dist.c)(11),{zoomSetting:zoomSetting_0}=(0,app.gK)(pageSideMenu_temp),quickActions=quickActions_useQuickActions(),{isInRecordingMode:isInRecordingMode_0}=(0,mediaRecording.be)(pageSideMenu_temp2),isZoomed=zoomSetting_0!==constants.gw.Fit;let t0;$[0]===Symbol.for("react.memo_cache_sentinel")?(t0=(0,i18n.__)("Page side menu","web-stories"),$[0]=t0):t0=$[0];const t1=isInRecordingMode_0?zIndex.VT:zIndex.ll;let t2,t3,t4;return $[1]!==quickActions?(t2=quickActions.length?react.createElement(StyledContextMenu,{isInline:!0,isAlwaysVisible:!0,isIconMenu:!0,disableControlledTabNavigation:!0,"data-testid":"Element quick actions","aria-label":(0,i18n.__)("Group of available options for selected element","web-stories"),onMouseDown:pageSideMenu_temp3},quickActions.map(pageSideMenu_temp4)):null,$[1]=quickActions,$[2]=t2):t2=$[2],$[3]!==isInRecordingMode_0||$[4]!==isZoomed?(t3=!isInRecordingMode_0&&react.createElement(react.Fragment,null,isZoomed&&react.createElement(Divider,null),react.createElement(pageMenu,null)),$[3]=isInRecordingMode_0,$[4]=isZoomed,$[5]=t3):t3=$[5],$[6]!==isZoomed||$[7]!==t1||$[8]!==t2||$[9]!==t3?(t4=react.createElement(MenusWrapper,{"aria-label":t0,isZoomed,$zIndex:t1},t2,t3),$[6]=isZoomed,$[7]=t1,$[8]=t2,$[9]=t3,$[10]=t4):t4=$[10],t4};function NavLayer(t0){const $=(0,dist.c)(11),{header,footer}=t0,t1=Boolean(footer?.secondaryMenu?.checklist);let t2,t3,t4,t5,t6;return $[0]!==header?(t2=react.createElement(HeadArea,{pointerEvents:"initial",zIndex:zIndex.mD},header),$[0]=header,$[1]=t2):t2=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(directionAware.A,null,react.createElement(PageMenuArea,null,react.createElement(pageSideMenu,null))),$[2]=t3):t3=$[2],$[3]!==footer?(t4=react.createElement(FooterArea,{pointerEvents:"initial"},react.createElement(footer_footer,{footer,zIndex:zIndex.mD})),$[3]=footer,$[4]=t4):t4=$[4],$[5]!==t2||$[6]!==t4?(t5=react.createElement(Layer,{pointerEvents:"none",onMouseDown:navLayer_temp},t2,t3,t4),$[5]=t2,$[6]=t4,$[7]=t5):t5=$[7],$[8]!==t1||$[9]!==t5?(t6=react.createElement(checklist.Pi,{hasChecklist:t1},t5),$[8]=t1,$[9]=t5,$[10]=t6):t6=$[10],t6}function navLayer_temp(evt){return evt.stopPropagation()}NavLayer.propTypes={header:prop_types_default().node,footer:prop_types_default().object};const navLayer=(0,src.ph)(NavLayer),LassoMode_OFF=0,LassoMode_ON=1,LassoMode_MAYBE=2,selectionCanvas_Container=(0,moveable_src.rs)(styled_components_browser_esm.Ay.div.withConfig({displayName:"selectionCanvas__Container",componentId:"sc-qsqc5z-0"})(["position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;user-select:none;"])),Lasso=styled_components_browser_esm.Ay.div.withConfig({displayName:"selectionCanvas__Lasso",componentId:"sc-qsqc5z-1"})(["display:none;position:absolute;border:1px dotted ",";z-index:1;"],(({theme})=>theme.colors.border.selection));const selectionCanvas=function SelectionCanvas({children}){const currentPageElements=(0,app.P3)((({state})=>state.currentPage?.elements||constants.qW)),{selectedElements:selectedElements_0,clearSelection:clearSelection_0,setSelectedElementsById:setSelectedElementsById_0}=(0,app.P3)((({state:{selectedElements},actions:{clearSelection,setSelectedElementsById}})=>({selectedElements,clearSelection,setSelectedElementsById}))),{isEditing:isEditing_0,nodesById:nodesById_0,clearEditing:clearEditing_0}=(0,app.yu)((({state:{isEditing,nodesById},actions:{clearEditing}})=>({isEditing,nodesById,clearEditing}))),overlayRef=(0,src.li)(null),lassoRef=(0,src.li)(null),startRef=(0,src.li)([0,0]),endRef=(0,src.li)([0,0]),lassoModeRef=(0,src.li)(LassoMode_OFF),getLassoBox=(0,src.hb)((()=>{const[x1,y1]=startRef.current,[x2,y2]=endRef.current;return[Math.min(x1,x2),Math.min(y1,y2),Math.abs(x1-x2),Math.abs(y1-y2)]}),[]),updateLasso=(0,src.hb)((()=>{const lasso=lassoRef.current;if(!lasso)return;const lassoMode=lassoModeRef.current,[x_0,y_0,w_0,h_0]=getLassoBox();let offsetX=0,offsetY=0;for(let offsetNode=overlayRef.current;offsetNode;offsetNode=offsetNode.offsetParent)offsetX+=offsetNode.offsetLeft,offsetY+=offsetNode.offsetTop;const relativeX=x_0-offsetX,relativeY=y_0-offsetY;lasso.style.left=`${relativeX}px`,lasso.style.top=`${relativeY}px`,lasso.style.width=`${w_0}px`,lasso.style.height=`${h_0}px`,lasso.style.display=lassoMode===LassoMode_ON?"block":"none"}),[getLassoBox]),onMouseDown=(0,src.hb)((evt=>{nodesById_0[currentPageElements[0]?.id]?.contains(evt.target)||(selectedElements_0.length&&clearSelection_0(),isEditing_0&&clearEditing_0()),startRef.current=[evt.pageX,evt.pageY],endRef.current=[evt.pageX,evt.pageY],lassoModeRef.current=LassoMode_MAYBE,updateLasso()}),[clearEditing_0,clearSelection_0,currentPageElements,isEditing_0,nodesById_0,selectedElements_0.length,updateLasso]),onMouseMove=(0,src.hb)((evt_0=>{if(lassoModeRef.current===LassoMode_OFF)return;const[x1_0,y1_0]=startRef.current,x2_0=evt_0.pageX,y2_0=evt_0.pageY;endRef.current[0]=x2_0,endRef.current[1]=y2_0,updateLasso(),Math.abs(x1_0-x2_0)+Math.abs(y1_0-y2_0)>10&&(lassoModeRef.current=LassoMode_ON)}),[updateLasso]),getElementPolygon=(0,useElementPolygon.A)(),selectIntersection=(0,src.hb)((({x:lx,y:ly,width:lw,height:lh})=>{const lassoP=new(SAT_default().Box)(new(SAT_default().Vector)(lx,ly),lw,lh).toPolygon(),newSelectedElementIds=currentPageElements.filter((({isBackground,isLocked,isHidden})=>!isBackground&&!isLocked&&!isHidden)).map((({id,...rest})=>{const elementP=getElementPolygon({id,...rest});return SAT_default().testPolygonPolygon(lassoP,elementP)?id:null})).filter((id_0=>id_0));setSelectedElementsById_0({elementIds:newSelectedElementIds,withLinked:!0})}),[currentPageElements,setSelectedElementsById_0,getElementPolygon]),onMouseUp=(0,src.hb)((()=>{if(lassoModeRef.current===LassoMode_ON){const[lx_0,ly_0,lwidth,lheight]=getLassoBox();clearSelection_0(),clearEditing_0(),selectIntersection({x:lx_0,y:ly_0,width:lwidth,height:lheight})}lassoModeRef.current=LassoMode_OFF,updateLasso()}),[clearEditing_0,clearSelection_0,getLassoBox,selectIntersection,updateLasso]);return(0,src.vJ)((()=>(document.addEventListener("mouseup",onMouseUp),()=>{document.removeEventListener("mouseup",onMouseUp)})),[onMouseUp]),(0,src.vJ)(updateLasso),react.createElement(selectionCanvas_Container,{onMouseDown,onMouseMove,"data-fix-caret":!0},children,react.createElement(moveable_src.Ox,{ref:overlayRef},react.createElement(Lasso,{ref:lassoRef})))};var uploadDropTarget=__webpack_require__("./packages/story-editor/src/components/uploadDropTarget/index.js"),useUploadWithPreview=__webpack_require__("./packages/story-editor/src/components/canvas/useUploadWithPreview.js");const MESSAGE_ID="edit-story-canvas-upload-message";function CanvasUploadDropTarget(t0){const $=(0,dist.c)(7),{children}=t0,uploadWithPreview=(0,useUploadWithPreview.A)();let t1,t2;$[0]!==uploadWithPreview?(t1=files=>{files&&files.length>0&&uploadWithPreview(files)},t2=[uploadWithPreview],$[0]=uploadWithPreview,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const onDropHandler=(0,src.hb)(t1,t2);let t3,t4;return $[3]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(uploadDropTarget.Mj,null,react.createElement(Layer,null,react.createElement(PageArea,{overlay:react.createElement(uploadDropTarget.X4,{id:MESSAGE_ID,message:(0,i18n.__)("Upload to media library and add to the page.","web-stories")})}))),$[3]=t3):t3=$[3],$[4]!==children||$[5]!==onDropHandler?(t4=react.createElement(uploadDropTarget._G,{onDrop:onDropHandler,labelledBy:MESSAGE_ID},children,t3),$[4]=children,$[5]=onDropHandler,$[6]=t4):t4=$[6],t4}CanvasUploadDropTarget.propTypes={children:prop_types_default().node.isRequired};const canvasUploadDropTarget=CanvasUploadDropTarget;__webpack_require__("./node_modules/core-js/modules/esnext.json.parse.js");var dragEvent=__webpack_require__("./packages/story-editor/src/utils/dragEvent.ts");const canvasElementDropzone_Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"canvasElementDropzone__Container",componentId:"sc-8cm35g-0"})(["width:100%;height:100%;"]);function CanvasElementDropzone(t0){const $=(0,dist.c)(14),{children}=t0,insertElement=(0,useInsertElement.A)(),{activeDropTargetId}=(0,dropTargets.h)(canvasElementDropzone_temp),{pageContainer}=(0,app.yu)(canvasElementDropzone_temp2),{editorToDataX,editorToDataY}=(0,useUnits.A)(canvasElementDropzone_temp3);let t1,t2;$[0]!==activeDropTargetId||$[1]!==editorToDataX||$[2]!==editorToDataY||$[3]!==insertElement||$[4]!==pageContainer?(t1=e=>{if((0,dragEvent.d)(e,"resource/media")&&!activeDropTargetId){const{resource,offset:t3}=JSON.parse(e.dataTransfer.getData("resource/media")),{x:offsetX,y:offsetY,w:offsetWidth,h:offsetHeight}=t3,{x,y}=pageContainer.getBoundingClientRect();insertElement(resource.type,{resource,x:editorToDataX(e.clientX-x-offsetX),y:editorToDataY(e.clientY-y-offsetY),width:editorToDataX(offsetWidth),height:editorToDataY(offsetHeight)}),e.stopPropagation(),e.preventDefault()}},t2=[activeDropTargetId,pageContainer,insertElement,editorToDataX,editorToDataY],$[0]=activeDropTargetId,$[1]=editorToDataX,$[2]=editorToDataY,$[3]=insertElement,$[4]=pageContainer,$[5]=t1,$[6]=t2):(t1=$[5],t2=$[6]);const onDropHandler=(0,src.hb)(t1,t2);let t3,t4;$[7]!==activeDropTargetId?(t3=e_0=>{(0,dragEvent.d)(e_0,"resource/media")&&!activeDropTargetId&&(e_0.stopPropagation(),e_0.preventDefault())},t4=[activeDropTargetId],$[7]=activeDropTargetId,$[8]=t3,$[9]=t4):(t3=$[8],t4=$[9]);const onDragOverHandler=(0,src.hb)(t3,t4);let t5;return $[10]!==children||$[11]!==onDragOverHandler||$[12]!==onDropHandler?(t5=react.createElement(canvasElementDropzone_Container,{onDrop:onDropHandler,onDragOver:onDragOverHandler},children),$[10]=children,$[11]=onDragOverHandler,$[12]=onDropHandler,$[13]=t5):t5=$[13],t5}function canvasElementDropzone_temp3(state_1){return{editorToDataX:state_1.actions.editorToDataX,editorToDataY:state_1.actions.editorToDataY}}function canvasElementDropzone_temp2(state_0){return{pageContainer:state_0.state.pageContainer}}function canvasElementDropzone_temp(state){return{activeDropTargetId:state.state.activeDropTargetId}}CanvasElementDropzone.propTypes={children:prop_types_default().node.isRequired};const canvasElementDropzone=CanvasElementDropzone;var circular=__webpack_require__("./packages/design-system/src/components/circularProgress/circular.tsx"),useEyeDropperApi=__webpack_require__("./packages/story-editor/src/components/eyedropper/useEyeDropperApi.js");const utils_getColorFromPixelData=function getColorFromPixelData(pixelData,x,y,width){const colorIndices=((x,y,width)=>{const red=4*(Math.floor(y)*width+Math.floor(x));return[red,red+1,red+2,red+3]})(x,y,width),[redIndex,greenIndex,blueIndex,alphaIndex]=colorIndices;return{r:pixelData[redIndex],g:pixelData[greenIndex],b:pixelData[blueIndex],a:pixelData[alphaIndex]/255}},EyedropperBackground=(0,styled_components_browser_esm.Ay)(Layer).withConfig({displayName:"eyedropperLayer__EyedropperBackground",componentId:"sc-nf74gq-0"})(["background:",";cursor:not-allowed;z-index:2;"],(({theme})=>theme.colors.opacity.black64)),eyedropperLayer_DisplayPageArea=(0,styled_components_browser_esm.Ay)(PageArea).withConfig({displayName:"eyedropperLayer__DisplayPageArea",componentId:"sc-nf74gq-1"})(["position:absolute;"]),EyedropperCanvas=styled_components_browser_esm.Ay.div.withConfig({displayName:"eyedropperLayer__EyedropperCanvas",componentId:"sc-nf74gq-2"})(["background:transparent;border-radius:5px;position:absolute;z-index:2;transform:translateZ(0);top:0;left:0;bottom:0;right:0;cursor:default;"]),ColorInfo=styled_components_browser_esm.Ay.div.withConfig({displayName:"eyedropperLayer__ColorInfo",componentId:"sc-nf74gq-3"})(["text-transform:uppercase;margin-top:30px;padding:9px;min-width:102px;text-align:center;"]),Circle=styled_components_browser_esm.Ay.div.withConfig({displayName:"eyedropperLayer__Circle",componentId:"sc-nf74gq-4"})(["transform:translateY(20px);background:",";border:2px solid black;border-radius:50%;overflow:hidden;width:","px;height:","px;"],(({theme})=>theme.colors.bg.primary),198,200),Magnifier=styled_components_browser_esm.Ay.div.withConfig({displayName:"eyedropperLayer__Magnifier",componentId:"sc-nf74gq-5"})(["position:absolute;top:0;left:0;transform:translateY(-2000px);pointer-events:none;"]),Center=styled_components_browser_esm.Ay.div.withConfig({displayName:"eyedropperLayer__Center",componentId:"sc-nf74gq-6"})(["position:absolute;top:0;left:0;right:0;bottom:0;z-index:3;background:",";cursor:not-allowed;display:flex;justify-content:center;align-items:center;"],(({theme})=>theme.colors.opacity.black64)),CanvasImage=styled_components_browser_esm.Ay.img.withConfig({displayName:"eyedropperLayer__CanvasImage",componentId:"sc-nf74gq-7"})(["width:100%;"]);const eyedropperLayer=function EyedropperLayer(){const{fullbleedContainer:fullbleedContainer_0,isEyedropperActive:isEyedropperActive_0,eyedropperCallback:eyedropperCallback_0,eyedropperImg:eyedropperImg_0,eyedropperPixelData:eyedropperPixelData_0,setIsEyedropperActive:setIsEyedropperActive_0,setEyedropperImg:setEyedropperImg_0,setEyedropperPixelData:setEyedropperPixelData_0}=(0,app.yu)((({state:{fullbleedContainer,isEyedropperActive,eyedropperCallback,eyedropperImg,eyedropperPixelData},actions:{setIsEyedropperActive,setEyedropperImg,setEyedropperPixelData}})=>({fullbleedContainer,isEyedropperActive,eyedropperCallback,eyedropperImg,eyedropperPixelData,setIsEyedropperActive,setEyedropperImg,setEyedropperPixelData}))),{isEyeDropperApiSupported}=(0,useEyeDropperApi.A)({}),{pageWidth:pageWidth_0}=(0,app.gK)((({state:{pageWidth}})=>({pageWidth}))),fullHeight=pageWidth_0/src_constants.yK,img=eyedropperImg_0,imgRef=(0,src.li)(),magnifierRef=(0,src.li)(),magnifierInfoRef=(0,src.li)(),magnifierColorRef=(0,src.li)(),eyedropperCanvasRef=(0,src.li)(),closeEyedropper=()=>{setIsEyedropperActive_0(!1),setEyedropperImg_0(null),setEyedropperPixelData_0(null)};return(0,src.g$)(eyedropperCanvasRef,closeEyedropper,[isEyedropperActive_0,img]),(0,keyboard.pP)("esc",closeEyedropper),isEyeDropperApiSupported?null:isEyedropperActive_0&&!img?react.createElement(react.Fragment,null,react.createElement(Center,{onClick:closeEyedropper},react.createElement(circular.A,null))):isEyedropperActive_0&&img?react.createElement(EyedropperBackground,{"data-testid":"eyedropperLayer",onMouseMove:e=>{const{left,top,width,height}=fullbleedContainer_0.getBoundingClientRect(),x_0=(e.clientX-left)*(pageWidth_0/width),y_0=(e.clientY-top)*(fullHeight/height);if(x_0<0||y_0<0||x_0>width||y_0>height)return void(magnifierInfoRef.current.style.display="none");magnifierInfoRef.current.style.display="block",magnifierInfoRef.current.style.transform=`translate(${x_0-100}px, ${y_0}px)`,((x,y)=>{const canvas=magnifierRef.current;if(canvas){const ctx=canvas.getContext("2d");ctx.imageSmoothingEnabled=!1,ctx.mozImageSmoothingEnabled=!1,ctx.webkitImageSmoothingEnabled=!1,ctx.msImageSmoothingEnabled=!1,ctx.clearRect(0,0,200,200),ctx.drawImage(imgRef.current,Math.round(x-3.5),Math.round(y-3.5),7,7,0,0,200,200),ctx.beginPath(),ctx.rect(Math.round(100)-14.285714285714286,Math.round(100)-14.285714285714286,28.571428571428573,28.571428571428573),ctx.stroke()}})(x_0,y_0);const rgbaObject=utils_getColorFromPixelData(eyedropperPixelData_0,x_0,y_0,width),{r,g,b,a}=rgbaObject,hex=(0,polished_esm.B3)(r,g,b,a);magnifierColorRef.current.style.background=`rgba(${r},${g},${b},${a})`,magnifierColorRef.current.style.color=(0,polished_esm.W0)(hex,"#333","#EDEDED",!1),magnifierColorRef.current.innerText=hex}},react.createElement(eyedropperLayer_DisplayPageArea,{withSafezone:!1,showOverflow:!0},react.createElement(EyedropperCanvas,{ref:eyedropperCanvasRef,onClick:e_0=>{const{left:left_0,top:top_0,width:width_0,height:height_0}=fullbleedContainer_0.getBoundingClientRect(),x_1=(e_0.clientX-left_0)*(pageWidth_0/width_0),y_1=(e_0.clientY-top_0)*(fullHeight/height_0),rgbaObject_0=utils_getColorFromPixelData(eyedropperPixelData_0,x_1,y_1,pageWidth_0);eyedropperCallback_0(rgbaObject_0)}},react.createElement(CanvasImage,{ref:imgRef,src:img,alt:""}),react.createElement(Magnifier,{ref:magnifierInfoRef},react.createElement(Circle,null,react.createElement("canvas",{ref:magnifierRef,width:200,height:200})),react.createElement(ColorInfo,{ref:magnifierColorRef}))))):null};var contextMenu_constants=__webpack_require__("./packages/design-system/src/components/contextMenu/constants.ts"),icons_media=__webpack_require__("./packages/design-system/src/icons/media.svg"),theme=__webpack_require__("./packages/design-system/src/theme/theme.ts"),colors=__webpack_require__("./packages/design-system/src/theme/colors.ts"),useStory=__webpack_require__("./packages/story-editor/src/app/story/useStory.ts"),isEmptyStory=__webpack_require__("./packages/story-editor/src/app/story/utils/isEmptyStory.ts");const emptyStateLayer_DisplayPageArea=(0,styled_components_browser_esm.Ay)(PageArea).withConfig({displayName:"emptyStateLayer__DisplayPageArea",componentId:"sc-1ypjr32-0"})(["position:absolute;z-index:1;"]),EmptyStateMessage=styled_components_browser_esm.Ay.div.withConfig({displayName:"emptyStateLayer__EmptyStateMessage",componentId:"sc-1ypjr32-1"})(["display:flex;flex-direction:column;align-items:center;padding:20px;text-align:center;svg{pointer-events:none;}p{margin-top:14px;}"]),emptyStateLayer_StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"emptyStateLayer__StyledButton",componentId:"sc-1ypjr32-2"})(["pointer-events:initial;"]);function emptyStateLayer_temp3(state){return{isAnythingTransforming:state.state.isAnythingTransforming}}function emptyStateLayer_temp2(t0){const{state:t1}=t0,{pages}=t1;return{pages}}function emptyStateLayer_temp(t0){const{isMenuOpen,onOpenMenu}=t0;return{isMenuOpen,onOpenMenu}}const emptyStateLayer=function EmptyStateLayer(){const $=(0,dist.c)(16),{isRTL}=(0,app.UK)(),{isMenuOpen:isMenuOpen_0,onOpenMenu:onOpenMenu_0}=(0,app.lS)(emptyStateLayer_temp),{pages:pages_0}=(0,useStory.A)(emptyStateLayer_temp2),{isAnythingTransforming}=(0,transform_src.Gy)(emptyStateLayer_temp3);if(!(0,isEmptyStory.A)(pages_0)||isAnythingTransforming)return null;let t0;$[0]!==isRTL||$[1]!==onOpenMenu_0?(t0=e=>{const bb=e.target.getBoundingClientRect();e.clientX=bb.left-(isRTL?-1:1)*contextMenu_constants.o/2+bb.width/2,e.clientY=bb.top-132+bb.height,onOpenMenu_0(e)},$[0]=isRTL,$[1]=onOpenMenu_0,$[2]=t0):t0=$[2];const onButtonClick=t0;let t1,t2,t3,t4,t5,t6,t7,t8;return $[3]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Empty state layer","web-stories"),$[3]=t1):t1=$[3],$[4]===Symbol.for("react.memo_cache_sentinel")?(t2=(0,i18n.__)("Add content","web-stories"),$[4]=t2):t2=$[4],$[5]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(icons_media.A,null),$[5]=t3):t3=$[5],$[6]!==isMenuOpen_0||$[7]!==onButtonClick?(t4=react.createElement(emptyStateLayer_StyledButton,{type:button_constants.VQ.Secondary,variant:button_constants.Ak.Circle,onClick:onButtonClick,"aria-haspopup":"true","aria-label":t2,"aria-describedby":"emptystate-message","aria-expanded":isMenuOpen_0},t3),$[6]=isMenuOpen_0,$[7]=onButtonClick,$[8]=t4):t4=$[8],$[9]===Symbol.for("react.memo_cache_sentinel")?(t5={...theme.w,colors:colors.B},$[9]=t5):t5=$[9],$[10]===Symbol.for("react.memo_cache_sentinel")?(t6=react.createElement(styled_components_browser_esm.NP,{theme:t5},react.createElement(typography_text.E.Paragraph,{id:"emptystate-message",size:types.$.Small},(0,i18n.__)("Add an image, video or template to get started","web-stories"))),$[10]=t6):t6=$[10],$[11]!==t4?(t7=react.createElement(emptyStateLayer_DisplayPageArea,{withSafezone:!1},react.createElement(EmptyStateMessage,null,t4,t6)),$[11]=t4,$[12]=t7):t7=$[12],$[13]!==onOpenMenu_0||$[14]!==t7?(t8=react.createElement(Layer,{onContextMenu:onOpenMenu_0,pointerEvents:"none","aria-label":t1},t7),$[13]=onOpenMenu_0,$[14]=t7,$[15]=t8):t8=$[15],t8};var stylis_rtl=__webpack_require__("./node_modules/stylis-plugin-rtl/dist/stylis-rtl.js"),useConfig=__webpack_require__("./packages/story-editor/src/app/config/useConfig.ts"),videoTrimContext=__webpack_require__("./packages/story-editor/src/components/videoTrim/videoTrimContext.js"),useVideoNode=__webpack_require__("./packages/story-editor/src/components/videoTrim/useVideoNode.js");function VideoRecordingTrimProvider(t0){const $=(0,dist.c)(28),{children,onTrim,videoData}=t0,{hasChanged,currentTime,startOffset,endOffset,maxOffset,videoNode,setStartOffset,setEndOffset,setVideoNode,setIsDraggingHandles}=(0,useVideoNode.A)(videoData);let t1,t2;$[0]!==endOffset||$[1]!==onTrim||$[2]!==startOffset?(t1=()=>{onTrim({start:startOffset,end:endOffset}),(0,tracking_src.sx)("recording_video_trim",{start_offset:startOffset,end_offset:endOffset})},t2=[endOffset,startOffset,onTrim],$[0]=endOffset,$[1]=onTrim,$[2]=startOffset,$[3]=t1,$[4]=t2):(t1=$[3],t2=$[4]);const performTrim=(0,src.hb)(t1,t2);let t3,t4,t5,t6;$[5]!==currentTime||$[6]!==endOffset||$[7]!==hasChanged||$[8]!==maxOffset||$[9]!==startOffset||$[10]!==videoData||$[11]!==videoNode?(t3={videoData,hasChanged,isTrimMode:!0,currentTime,startOffset,endOffset,maxOffset,videoNode},$[5]=currentTime,$[6]=endOffset,$[7]=hasChanged,$[8]=maxOffset,$[9]=startOffset,$[10]=videoData,$[11]=videoNode,$[12]=t3):t3=$[12],$[13]!==onTrim?(t4=()=>onTrim(),$[13]=onTrim,$[14]=t4):t4=$[14],$[15]!==performTrim||$[16]!==setEndOffset||$[17]!==setIsDraggingHandles||$[18]!==setStartOffset||$[19]!==setVideoNode||$[20]!==t4?(t5={performTrim,setVideoNode,setStartOffset,setEndOffset,setIsDraggingHandles,toggleTrimMode:t4},$[15]=performTrim,$[16]=setEndOffset,$[17]=setIsDraggingHandles,$[18]=setStartOffset,$[19]=setVideoNode,$[20]=t4,$[21]=t5):t5=$[21],$[22]!==t3||$[23]!==t5?(t6={state:t3,actions:t5},$[22]=t3,$[23]=t5,$[24]=t6):t6=$[24];const value=t6;let t7;return $[25]!==children||$[26]!==value?(t7=react.createElement(videoTrimContext.A.Provider,{value},children),$[25]=children,$[26]=value,$[27]=t7):t7=$[27],t7}VideoRecordingTrimProvider.propTypes={children:prop_types_default().node.isRequired,onTrim:prop_types_default().func.isRequired,videoData:prop_types_default().object};const recordingProvider=VideoRecordingTrimProvider;Object.defineProperty(stylis_rtl.Ay,"name",{value:"stylisRTLPlugin"});const mediaRecordingLayer_DisplayPageArea=(0,styled_components_browser_esm.Ay)(PageArea).withConfig({displayName:"mediaRecordingLayer__DisplayPageArea",componentId:"sc-18wneqt-0"})(["position:absolute;"]),mediaRecordingLayer_LayerWithGrayout=(0,moveable_src.rs)((0,styled_components_browser_esm.Ay)(Layer).withConfig({displayName:"mediaRecordingLayer__LayerWithGrayout",componentId:"sc-18wneqt-1"})(["background-color:",";z-index:",";"],(({theme})=>theme.colors.opacity.overlayExtraDark),zIndex.Gu)),StyledFooter=(0,styled_components_browser_esm.Ay)(FooterArea).withConfig({displayName:"mediaRecordingLayer__StyledFooter",componentId:"sc-18wneqt-2"})(["display:flex;align-items:start;flex-direction:row;justify-content:center;z-index:",";"],zIndex.Gu);const mediaRecordingLayer=function MediaRecordingLayer(){const{isRTL}=(0,useConfig.A)(),{status,inputStatus,audioInput,videoInput,hasVideo,isAdjustingTrim,trimData,originalMediaBlobUrl,duration,updateMediaDevices,getMediaStream,resetStream,onTrim,videoEffect}=(0,mediaRecording.be)((({state,actions})=>({status:state.status,inputStatus:state.inputStatus,audioInput:state.audioInput,videoInput:state.videoInput,hasVideo:state.hasVideo,isAdjustingTrim:state.isAdjustingTrim,trimData:state.trimData,originalMediaBlobUrl:state.originalMediaBlobUrl,duration:state.duration,videoEffect:state.videoEffect,updateMediaDevices:actions.updateMediaDevices,getMediaStream:actions.getMediaStream,resetStream:actions.resetStream,onTrim:actions.onTrim}))),isReady="ready"===inputStatus||"ready"===status;(0,src.vJ)((()=>{!async function run(){resetStream(),await getMediaStream()}()}),[audioInput,videoInput,hasVideo,videoEffect]),(0,src.vJ)((()=>{isReady&&updateMediaDevices()}),[isReady,updateMediaDevices]);const videoData=(0,src.Kr)((()=>isAdjustingTrim?{element:{width:480*src_constants.yK,height:480,scale:1,focalX:50,focalY:50,flip:{}},resource:{src:originalMediaBlobUrl,length:duration},...trimData}:null),[isAdjustingTrim,trimData,originalMediaBlobUrl,duration]);return react.createElement(styled_components_browser_esm.ID,{stylisPlugins:isRTL?[stylis_rtl.Ay]:[]},react.createElement(recordingProvider,{onTrim,videoData},react.createElement(mediaRecordingLayer_LayerWithGrayout,{"aria-label":(0,i18n.__)("Media Recording layer","web-stories")},react.createElement(PageTitleContainer,null,react.createElement(mediaRecording.i$,null)),react.createElement(mediaRecordingLayer_DisplayPageArea,{withSafezone:!1,showOverflow:!0},react.createElement(mediaRecording.Iu,null)),react.createElement(StyledFooter,{showOverflow:!0},isAdjustingTrim?react.createElement(videoTrimmer,null):react.createElement(mediaRecording.wi,null))),react.createElement(mediaRecording.bB,null)))},Background=styled_components_browser_esm.Ay.section.attrs({"aria-label":(0,i18n.__)("Canvas","web-stories"),"data-fix-caret":!0}).withConfig({displayName:"canvasLayout__Background",componentId:"sc-1ciyn0c-0"})(["background-color:",";width:100%;height:100%;position:relative;user-select:none;"],(({theme})=>theme.colors.bg.primary));function CanvasLayout(t0){const $=(0,dist.c)(27),{header,footer}=t0,boundingBoxTrackingRef=(0,app.yR)(app.DN.CANVAS_CONTAINER),setCanvasContainer=(0,app.yu)(canvasLayout_temp),backgroundRef=(0,src.li)(null),setBackgroundRef=(0,src.jn)(backgroundRef,setCanvasContainer,boundingBoxTrackingRef);!function useLayoutParams(containerRef){const $=(0,dist.c)(4),{setWorkspaceSize:setWorkspaceSize_0}=(0,app.gK)(layout_temp),footerHeight=footer_useFooterHeight();let t0,t1;$[0]!==footerHeight||$[1]!==setWorkspaceSize_0?(t0=t2=>{const{width,height}=t2,availableHeight=height-constants.uF-constants.h1-footerHeight-16;setWorkspaceSize_0({width,height,availableHeight})},t1=[setWorkspaceSize_0,footerHeight],$[0]=footerHeight,$[1]=setWorkspaceSize_0,$[2]=t0,$[3]=t1):(t0=$[2],t1=$[3]),(0,src.pO)(containerRef,t0,t1)}(backgroundRef);const layoutParamsCss=function useLayoutParamsCssVars(){const $=(0,dist.c)(13),{pageWidth:pageWidth_0,pageHeight:pageHeight_0,pagePadding:pagePadding_0,viewportWidth:viewportWidth_0,viewportHeight:viewportHeight_0,hasPageNavigation:hasPageNavigation_0,hasVerticalOverflow:hasVerticalOverflow_0,hasHorizontalOverflow:hasHorizontalOverflow_0,scrollLeft:scrollLeft_0,scrollTop:scrollTop_0}=(0,app.gK)(layout_temp2),fullHeight=pageWidth_0/src_constants.yK,t0=`${hasPageNavigation_0?PAGE_NAV_WIDTH:0}px`,t1=(hasPageNavigation_0?20:0)+"px",t2=`${pageWidth_0}px`,t3=`${pageHeight_0}px`,t4=`${pagePadding_0}px`,t5=`${fullHeight}px`,t6=`${viewportWidth_0}px`,t7=`${viewportHeight_0}px`,t8=hasHorizontalOverflow_0?"scroll":"visible",t9=hasVerticalOverflow_0?"scroll":"auto",t10=-scrollLeft_0+"px",t11=-scrollTop_0+"px";let t12;return $[0]!==t0||$[1]!==t1||$[2]!==t10||$[3]!==t11||$[4]!==t2||$[5]!==t3||$[6]!==t4||$[7]!==t5||$[8]!==t6||$[9]!==t7||$[10]!==t8||$[11]!==t9?(t12={"--page-nav-width":t0,"--page-nav-gap":t1,"--page-width-px":t2,"--page-height-px":t3,"--page-padding-px":t4,"--fullbleed-height-px":t5,"--viewport-width-px":t6,"--viewport-height-px":t7,"--overflow-x":t8,"--overflow-y":t9,"--scroll-left-px":t10,"--scroll-top-px":t11},$[0]=t0,$[1]=t1,$[2]=t10,$[3]=t11,$[4]=t2,$[5]=t3,$[6]=t4,$[7]=t5,$[8]=t6,$[9]=t7,$[10]=t8,$[11]=t9,$[12]=t12):t12=$[12],t12}(),{pageWidth:pageWidth_0,pageHeight:pageHeight_0}=(0,app.gK)(canvasLayout_temp2),{isInRecordingMode:isInRecordingMode_0}=(0,mediaRecording.be)(canvasLayout_temp3),hasDimensions=0!==pageWidth_0&&0!==pageHeight_0;let t1,t2,t3,t4,t5,t6,t7,t8,t9,t10;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t1=[],$[0]=t1):t1=$[0],$[1]!==hasDimensions||$[2]!==isInRecordingMode_0?(t2=hasDimensions&&!isInRecordingMode_0&&react.createElement(displayLayer,null),$[1]=hasDimensions,$[2]=isInRecordingMode_0,$[3]=t2):t2=$[3],$[4]!==hasDimensions||$[5]!==isInRecordingMode_0?(t3=hasDimensions&&!isInRecordingMode_0&&react.createElement(framesLayer,null),$[4]=hasDimensions,$[5]=isInRecordingMode_0,$[6]=t3):t3=$[6],$[7]!==footer||$[8]!==header?(t4=react.createElement(navLayer,{header,footer}),$[7]=footer,$[8]=header,$[9]=t4):t4=$[9],$[10]!==t2||$[11]!==t3||$[12]!==t4?(t5=react.createElement(selectionCanvas,null,t2,t3,t4),$[10]=t2,$[11]=t3,$[12]=t4,$[13]=t5):t5=$[13],$[14]===Symbol.for("react.memo_cache_sentinel")?(t6=react.createElement(editLayer,null),$[14]=t6):t6=$[14],$[15]!==isInRecordingMode_0?(t7=!isInRecordingMode_0&&react.createElement(react.Fragment,null,react.createElement(eyedropperLayer,null),react.createElement(emptyStateLayer,null),react.createElement(floatingMenu_layer,null)),$[15]=isInRecordingMode_0,$[16]=t7):t7=$[16],$[17]!==isInRecordingMode_0?(t8=isInRecordingMode_0&&react.createElement(mediaRecordingLayer,null),$[17]=isInRecordingMode_0,$[18]=t8):t8=$[18],$[19]!==t5||$[20]!==t7||$[21]!==t8?(t9=react.createElement(canvasUploadDropTarget,null,react.createElement(canvasElementDropzone,null,t5,t6,t7,t8)),$[19]=t5,$[20]=t7,$[21]=t8,$[22]=t9):t9=$[22],$[23]!==layoutParamsCss||$[24]!==setBackgroundRef||$[25]!==t9?(t10=react.createElement(styled_components_browser_esm.ID,{stylisPlugins:t1},react.createElement(editLayerFocusManager.Ay,null,react.createElement(Background,{ref:setBackgroundRef,style:layoutParamsCss},t9))),$[23]=layoutParamsCss,$[24]=setBackgroundRef,$[25]=t9,$[26]=t10):t10=$[26],t10}function canvasLayout_temp3(t0){const{state:t1}=t0,{isInRecordingMode}=t1;return{isInRecordingMode}}function canvasLayout_temp2(t0){const{state:t1}=t0,{pageWidth,pageHeight}=t1;return{pageWidth,pageHeight}}function canvasLayout_temp(state){return state.actions.setCanvasContainer}CanvasLayout.propTypes={header:prop_types_default().node,footer:prop_types_default().object};const canvasLayout=(0,src.ph)(CanvasLayout);function Canvas(t0){const $=(0,dist.c)(3),{header,footer}=t0;let t1;return $[0]!==footer||$[1]!==header?(t1=react.createElement(canvasLayout,{header,footer}),$[0]=footer,$[1]=header,$[2]=t1):t1=$[2],t1}Canvas.propTypes={header:prop_types_default().node,footer:prop_types_default().object};const canvas_canvas=Canvas;__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");var rich_text_src=__webpack_require__("./packages/rich-text/src/index.ts"),pageCanvas=__webpack_require__("./packages/story-editor/src/app/pageCanvas/index.ts");const canvas_useInsertTextSet=function useInsertTextSet(shouldUseSmartColor=!1){const insertElement=(0,useInsertElement.A)(),calculateAccessibleTextColors=(0,pageCanvas.zN)(),{setSelectedElementsById:setSelectedElementsById_0}=(0,story.P3)((({actions:{setSelectedElementsById}})=>({setSelectedElementsById}))),insertTextSet=(0,src.T0)((async(toAdd,applySmartColor=shouldUseSmartColor)=>{const htmlFormatters=(0,rich_text_src.$d)(),{setColor}=htmlFormatters,addedElements=[],hasPredefinedColor=toAdd.some((element=>element.content?.includes("color:")));let textElementsContrasts=[],firstValidColor=null;const white={r:255,g:255,b:255},black={r:0,g:0,b:0},whiteScrim={...white,a:.3},blackScrim={...black,a:.3};let preferredScrimColor,scrimsCount,useScrim;if(applySmartColor&&!hasPredefinedColor){textElementsContrasts=await Promise.all(toAdd.map((element_0=>"text"===element_0.type?calculateAccessibleTextColors(element_0):null))),firstValidColor=textElementsContrasts.find((c=>c));const allColorsEqual=textElementsContrasts.every((contrast=>null===contrast||contrast.color?.r===firstValidColor.color?.r&&contrast.color?.g===firstValidColor.color?.g&&contrast.color?.b===firstValidColor.color?.b&&contrast.color?.a===firstValidColor.color?.a));scrimsCount=textElementsContrasts.reduce(((acc,contrast_0)=>contrast_0?.backgroundColor?acc+1:acc),0);const blackScrims=textElementsContrasts.reduce(((acc_0,contrast_1)=>0===contrast_1?.backgroundColor?.r&&0===contrast_1?.backgroundColor?.g&&0===contrast_1?.backgroundColor?.b?acc_0+1:acc_0),0);if(preferredScrimColor=scrimsCount-blackScrims>0?blackScrim:whiteScrim,useScrim=scrimsCount>0||!1===allColorsEqual,useScrim){const{textSetHeight,textSetWidth}=toAdd[0],getMinDim=dim=>Math.min.apply(null,toAdd.map((e=>e[dim]))),scrim={x:getMinDim("x")-24,y:getMinDim("y")-24,width:textSetWidth+48,height:textSetHeight+48,backgroundColor:{color:preferredScrimColor},type:"shape"};addedElements.push(insertElement(elements_src.bV.SHAPE,scrim))}}toAdd.forEach(((element_1,index)=>{const toInsert=(0,objectWithout.A)(element_1,["id","normalizedOffsetX","normalizedOffsetY","textSetWidth","textSetHeight"]);if(applySmartColor&&!hasPredefinedColor){const scrimContrastingTextColor=0===preferredScrimColor.r?white:black,autoColor=useScrim?{color:scrimContrastingTextColor}:textElementsContrasts[index];"text"===element_1.type&&autoColor.color&&(toInsert.content=setColor(toInsert.content,autoColor)),"shape"===element_1.type&&firstValidColor.color&&(element_1.border?toInsert.border.color=firstValidColor:toInsert.backgroundColor=firstValidColor)}addedElements.push(insertElement(element_1.type,toInsert))})),setSelectedElementsById_0({elementIds:addedElements.map((({id})=>id))})}),[calculateAccessibleTextColors,shouldUseSmartColor,insertElement,setSelectedElementsById_0]),insertTextSetByOffset=(0,src.hb)(((elements,{offsetX,offsetY})=>{if(!elements.length)return;const positionedTextSet=elements.map((element_2=>{const x_0=element_2.normalizedOffsetX+offsetX,y_0=element_2.normalizedOffsetY+offsetY,{width,height}=element_2;return x_0>src_constants.bj||x_0+width<0||y_0>src_constants._b||y_0+height<-src_constants.vT?null:{...element_2,x:x_0,y:y_0}})).filter((el=>el));insertTextSet(positionedTextSet,!1)}),[insertTextSet]);return{insertTextSet,insertTextSetByOffset}}},"./packages/story-editor/src/components/canvas/utils/useSnapping.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_units__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/units/src/constants.ts"),_dropTargets__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/components/dropTargets/index.js"),_app__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/app/index.js");function _temp4(t0){const{SAFE_ZONE}=t0;return SAFE_ZONE}function _temp3(t0){const{state:state_0}=t0;return{activeDropTargetId:state_0.activeDropTargetId,isDropTargetingDisabled:state_0.isDropTargetingDisabled}}function _temp2(t0){const{state:t1}=t0,{pageWidth,pageHeight}=t1;return{pageWidth,pageHeight}}function _temp(t0){const{state}=t0;return state.designSpaceGuideline}const __WEBPACK_DEFAULT_EXPORT__=function useSnapping(t0){const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(26);let{canSnap,otherNodes,snappingOffsetX:t1,isDragging}=t0;const snappingOffsetX=void 0===t1?null:t1,canvasRect=(0,_app__WEBPACK_IMPORTED_MODULE_5__.fX)(_app__WEBPACK_IMPORTED_MODULE_5__.DN.CANVAS_CONTAINER),pageRect=(0,_app__WEBPACK_IMPORTED_MODULE_5__.fX)(_app__WEBPACK_IMPORTED_MODULE_5__.DN.PAGE_CONTAINER),designSpaceGuideline=(0,_app__WEBPACK_IMPORTED_MODULE_5__.yu)(_temp),{pageWidth:pageWidth_0,pageHeight:pageHeight_0}=(0,_app__WEBPACK_IMPORTED_MODULE_5__.gK)(_temp2),{activeDropTargetId,isDropTargetingDisabled}=(0,_dropTargets__WEBPACK_IMPORTED_MODULE_4__.h)(_temp3),triggerOnboarding=(0,_app__WEBPACK_IMPORTED_MODULE_5__.OB)(_temp4);let t2,t3;canSnap=canSnap&&!isDropTargetingDisabled&&!activeDropTargetId,$[0]!==designSpaceGuideline||$[1]!==isDragging||$[2]!==triggerOnboarding?(t2=t4=>{const{elements}=t4,isSnappingDesignSpace=elements.flat().some((t5=>{const{center,element}=t5;return element===designSpaceGuideline&&!center}));isDragging&&isSnappingDesignSpace&&triggerOnboarding()},t3=[isDragging,designSpaceGuideline,triggerOnboarding],$[0]=designSpaceGuideline,$[1]=isDragging,$[2]=triggerOnboarding,$[3]=t2,$[4]=t3):(t2=$[3],t3=$[4]);const handleSnap=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.hb)(t2,t3);if(!canvasRect||!pageRect){let t4;return $[5]===Symbol.for("react.memo_cache_sentinel")?(t4={},$[5]=t4):t4=$[5],t4}const canvasOffsetX=snappingOffsetX||canvasRect.x,offsetX=Math.ceil(pageRect.x-canvasOffsetX),offsetY=Math.floor(pageRect.y-canvasRect.y);let t4;$[6]!==canSnap||$[7]!==offsetX||$[8]!==pageWidth_0?(t4=canSnap?[offsetX,offsetX+pageWidth_0/2,offsetX+pageWidth_0]:[],$[6]=canSnap,$[7]=offsetX,$[8]=pageWidth_0,$[9]=t4):t4=$[9];const verticalGuidelines=t4,fullBleedOffset=(pageWidth_0/_googleforcreators_units__WEBPACK_IMPORTED_MODULE_6__.yK-pageHeight_0)/2;let t5;$[10]!==canSnap||$[11]!==fullBleedOffset||$[12]!==offsetY||$[13]!==pageHeight_0?(t5=canSnap?[offsetY-fullBleedOffset,offsetY,offsetY+pageHeight_0/2,offsetY+pageHeight_0,offsetY+pageHeight_0+fullBleedOffset]:[],$[10]=canSnap,$[11]=fullBleedOffset,$[12]=offsetY,$[13]=pageHeight_0,$[14]=t5):t5=$[14];const horizontalGuidelines=t5;let t6;$[15]!==canSnap||$[16]!==designSpaceGuideline||$[17]!==otherNodes?(t6=canSnap?[...otherNodes,designSpaceGuideline]:[],$[15]=canSnap,$[16]=designSpaceGuideline,$[17]=otherNodes,$[18]=t6):t6=$[18];const elementGuidelines=t6;let t7;$[19]===Symbol.for("react.memo_cache_sentinel")?(t7={left:!0,top:!0,right:!0,bottom:!0,center:!0,middle:!0},$[19]=t7):t7=$[19];const snapDirections=t7;let t8;return $[20]!==canSnap||$[21]!==elementGuidelines||$[22]!==handleSnap||$[23]!==horizontalGuidelines||$[24]!==verticalGuidelines?(t8={snappable:canSnap,snapGap:canSnap,snapDirections,elementSnapDirections:snapDirections,isDisplaySnapDigit:!1,onSnap:handleSnap,horizontalGuidelines,verticalGuidelines,elementGuidelines},$[20]=canSnap,$[21]=elementGuidelines,$[22]=handleSnap,$[23]=horizontalGuidelines,$[24]=verticalGuidelines,$[25]=t8):t8=$[25],t8}},"./packages/story-editor/src/components/elementLink/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>createLink,f:()=>getLinkFromElement});var _googleforcreators_elements__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/elements/src/index.ts");function getLinkFromElement(element){return element.link||null}function createLink({url="",needsProxy=!1,rel=[],type=_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_0__.J.Regular,pageId=null,...rest}={}){return{needsProxy,url,rel,type,pageId,...rest}}},"./packages/story-editor/src/components/helpCenter/menu/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>Menu});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts"),constants=__webpack_require__("./packages/story-editor/src/app/helpCenter/constants.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),expandPresetStyles=__webpack_require__("./packages/design-system/src/theme/helpers/expandPresetStyles.ts"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts");const Panel=styled_components_browser_esm.Ay.div.withConfig({displayName:"header__Panel",componentId:"sc-1aci6do-0"})(["padding:24px 0 16px 0;border-bottom:1px solid ",";"],(({theme})=>theme.colors.bg.tertiary)),Heading=styled_components_browser_esm.Ay.h1.withConfig({displayName:"header__Heading",componentId:"sc-1aci6do-1"})([""," color:",";line-height:32px;margin:0 0 8px 0;"],expandPresetStyles.x((({label},{Medium})=>label[Medium])),(({theme})=>theme.colors.fg.primary));function Header(){const $=(0,dist.c)(2);let t0,t1;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(Heading,{as:"h2"},(0,i18n.__)("Web Stories Help Center","web-stories")),$[0]=t0):t0=$[0],$[1]===Symbol.for("react.memo_cache_sentinel")?(t1=react.createElement(Panel,null,t0,react.createElement(typography_text.E.Paragraph,{size:types.$.XSmall},(0,i18n.__)("Discover tips & resources to help you get the most out of your Web Stories.","web-stories"))),$[1]=t1):t1=$[1],t1}__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),arrow_left=__webpack_require__("./packages/design-system/src/icons/arrow_left.svg"),button_constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),config=__webpack_require__("./packages/story-editor/src/app/config/index.ts"),utils=__webpack_require__("./packages/story-editor/src/components/helpCenter/utils.js"),app=__webpack_require__("./packages/story-editor/src/app/index.js");const tips_Panel=styled_components_browser_esm.Ay.div.withConfig({displayName:"tips__Panel",componentId:"sc-1bvshes-0"})(["padding:24px 0;"]),StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"tips__StyledButton",componentId:"sc-1bvshes-1"})([""," display:flex;justify-content:space-between;width:100%;padding:6px 0;"],expandPresetStyles.x((({label},{Small})=>label[Small]))),ButtonText=styled_components_browser_esm.Ay.span.withConfig({displayName:"tips__ButtonText",componentId:"sc-1bvshes-2"})(["vertical-align:middle;text-align:left;",""],(({unread,theme})=>unread&&(0,styled_components_browser_esm.AH)(["&::before{content:' ';display:inline-block;height:10px;width:10px;margin-right:16px;border-radius:",";background-color:",";}"],theme.borders.radius.round,theme.colors.accent.primary))),ArrowWrap=styled_components_browser_esm.Ay.div.withConfig({displayName:"tips__ArrowWrap",componentId:"sc-1bvshes-3"})(["width:32px;margin:-9px;transform-origin:50% 50%;transform:",";"],(({$isRTL})=>$isRTL?"none":"rotate(180deg)")),StyledArrow=(0,styled_components_browser_esm.Ay)(arrow_left.A).withConfig({displayName:"tips__StyledArrow",componentId:"sc-1bvshes-4"})(["width:100%;"]);function Tip(t0){const $=(0,dist.c)(10),{children,onClick,unread:t1}=t0,unread=void 0===t1||t1,{isRTL}=(0,config.UK)();let t2,t3,t4,t5;return $[0]!==children||$[1]!==unread?(t2=react.createElement(ButtonText,{unread},children),$[0]=children,$[1]=unread,$[2]=t2):t2=$[2],$[3]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(StyledArrow,null),$[3]=t3):t3=$[3],$[4]!==isRTL?(t4=react.createElement(ArrowWrap,{$isRTL:isRTL},t3),$[4]=isRTL,$[5]=t4):t4=$[5],$[6]!==onClick||$[7]!==t2||$[8]!==t4?(t5=react.createElement(StyledButton,{size:button_constants.Mp.Small,onClick},t2,t4),$[6]=onClick,$[7]=t2,$[8]=t4,$[9]=t5):t5=$[9],t5}function Tips(t0){const $=(0,dist.c)(11),{onTipSelect:t1,readTips}=t0,onTipSelect=void 0===t1?noop.l:t1,{state:t2}=(0,app.S7)(),{tips}=t2;let T0,t3,t4;if($[0]!==onTipSelect||$[1]!==readTips||$[2]!==tips){const tipsIterable=Object.entries(tips);let t4;T0=tips_Panel,$[5]!==onTipSelect||$[6]!==readTips?(t4=t5=>{const[key,tip]=t5;return react.createElement(Tip,{unread:!readTips[key],key,onClick:()=>{(0,utils.W)(),onTipSelect(key)}},tip.title)},$[5]=onTipSelect,$[6]=readTips,$[7]=t4):t4=$[7],t3=tipsIterable.map(t4),$[0]=onTipSelect,$[1]=readTips,$[2]=tips,$[3]=T0,$[4]=t3}else T0=$[3],t3=$[4];return $[8]!==T0||$[9]!==t3?(t4=react.createElement(T0,null,t3),$[8]=T0,$[9]=t3,$[10]=t4):t4=$[10],t4}Tip.propTypes={children:prop_types_default().node,onClick:prop_types_default().func,unread:prop_types_default().bool};var theme_constants=__webpack_require__("./packages/design-system/src/theme/constants/index.ts"),scheduledTransition=__webpack_require__("./packages/story-editor/src/components/transition/scheduledTransition.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const DURATION=1.2*constants.xt,enterStyles=(0,styled_components_browser_esm.AH)(["opacity:1;transform:none;"]),exitStyles=(0,styled_components_browser_esm.AH)(["position:absolute;bottom:0;opacity:0.6;transform:scale(0.96);"]),transitionStyles={entering:enterStyles,entered:enterStyles,exiting:exitStyles,exited:exitStyles},Manager=styled_components_browser_esm.Ay.div.withConfig({displayName:"transitioner__Manager",componentId:"sc-aat78p-0"})(["position:relative;color:",";opacity:0.6;transform-origin:50% 50%;transform:scale(0.96);transition:transform ","ms ",",opacity ","ms ",";z-index:",";",";"],(({theme})=>theme.colors.fg.primary),DURATION,theme_constants.U.default,DURATION,theme_constants.U.default,constants.Mu.MENU,(({state})=>transitionStyles[state]));function Transitioner(t0){const $=(0,dist.c)(8);let children,props,t1,t2;return $[0]!==t0?(({children,...props}=t0),$[0]=t0,$[1]=children,$[2]=props):(children=$[1],props=$[2]),$[3]!==children?(t1=state=>react.createElement(Manager,{state},children),$[3]=children,$[4]=t1):t1=$[4],$[5]!==props||$[6]!==t1?(t2=react.createElement(scheduledTransition.x,_extends({},props,{timeout:DURATION,mountOnEnter:!0,unmountOnExit:!0}),t1),$[5]=props,$[6]=t1,$[7]=t2):t2=$[7],t2}Transitioner.propTypes={children:prop_types_default().node};const Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"menu__Container",componentId:"sc-ztoh5v-0"})(["padding:0 ","px;max-height:60vh;overflow-y:scroll;*{user-select:text;}"],constants.hE);function Menu(t0){const $=(0,dist.c)(17);let components,readTips,t1,transitionProps;$[0]!==t0?(({onTipSelect:t1,readTips,components,...transitionProps}=t0),$[0]=t0,$[1]=components,$[2]=readTips,$[3]=t1,$[4]=transitionProps):(components=$[1],readTips=$[2],t1=$[3],transitionProps=$[4]);const onTipSelect=void 0===t1?noop.l:t1,Footer=components?.Footer;let t2,t3,t4,t5,t6;return $[5]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(Header,null),$[5]=t2):t2=$[5],$[6]!==onTipSelect||$[7]!==readTips?(t3=react.createElement(Tips,{readTips,onTipSelect}),$[6]=onTipSelect,$[7]=readTips,$[8]=t3):t3=$[8],$[9]!==Footer?(t4=Footer&&react.createElement(Footer,null),$[9]=Footer,$[10]=t4):t4=$[10],$[11]!==t3||$[12]!==t4?(t5=react.createElement(Container,{"data-testid":"help_center_container"},t2,t3,t4),$[11]=t3,$[12]=t4,$[13]=t5):t5=$[13],$[14]!==t5||$[15]!==transitionProps?(t6=react.createElement(Transitioner,transitionProps,t5),$[14]=t5,$[15]=transitionProps,$[16]=t6):t6=$[16],t6}Menu.propTypes={readTips:prop_types_default().object,onTipSelect:prop_types_default().func.isRequired,components:prop_types_default().shape({Footer:prop_types_default().elementType})}},"./packages/story-editor/src/components/helpCenter/navigator/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>helpCenter_navigator});var react=__webpack_require__("./node_modules/react/index.js"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),src=__webpack_require__("./packages/react/src/index.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),fullSize=__webpack_require__("./packages/design-system/src/theme/helpers/fullSize.ts"),constants=__webpack_require__("./packages/story-editor/src/app/helpCenter/constants.ts"),secondaryPopup=__webpack_require__("./packages/story-editor/src/components/secondaryPopup/index.js"),dist=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js"),__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js")),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),theme_constants=__webpack_require__("./packages/design-system/src/theme/constants/index.ts"),arrow_left=__webpack_require__("./packages/design-system/src/icons/arrow_left.svg"),button_constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),config=__webpack_require__("./packages/story-editor/src/app/config/index.ts"),utils=__webpack_require__("./packages/story-editor/src/components/helpCenter/utils.js");const secondaryTextStyle=(0,styled_components_browser_esm.AH)(["color:",";"],(({theme})=>theme.colors.fg.secondary)),AllTips=styled_components_browser_esm.Ay.span.withConfig({displayName:"bottomNavigation__AllTips",componentId:"sc-yk08yc-0"})(["",""],secondaryTextStyle),BottomNavBar=(0,styled_components_browser_esm.Ay)(secondaryPopup.jq).withConfig({displayName:"bottomNavigation__BottomNavBar",componentId:"sc-yk08yc-1"})(["position:absolute;bottom:0;transition:transform ","ms ",";z-index:2;",""],constants.xt,theme_constants.U.default,(({isHidden})=>isHidden&&(0,styled_components_browser_esm.AH)(["transform:translateY(100%);"]))),BottomNavButtons=styled_components_browser_esm.Ay.div.withConfig({displayName:"bottomNavigation__BottomNavButtons",componentId:"sc-yk08yc-2"})(["display:flex;padding:0 16px;white-space:nowrap;"]),ArrowWrap=styled_components_browser_esm.Ay.div.withConfig({displayName:"bottomNavigation__ArrowWrap",componentId:"sc-yk08yc-3"})([""," margin:-5px -16px;"," svg{display:block;}"],secondaryTextStyle,(({$isRTL})=>$isRTL&&(0,styled_components_browser_esm.AH)(["transform:rotate(180deg);"])));function BottomNavigation(t0){const $=(0,dist.c)(40),{onAllTips,onPrev,onNext,hasBottomNavigation,isNextDisabled,isPrevDisabled}=t0,{isRTL}=(0,config.UK)(),prevButtonRef=(0,src.li)(null),nextButtonRef=(0,src.li)(null);let t1;$[0]!==isNextDisabled||$[1]!==isPrevDisabled?(t1={isPrevDisabled,isNextDisabled},$[0]=isNextDisabled,$[1]=isPrevDisabled,$[2]=t1):t1=$[2];const[local,setLocal]=(0,src.J0)(t1);let t2,t3;$[3]!==isNextDisabled||$[4]!==isPrevDisabled||$[5]!==nextButtonRef||$[6]!==prevButtonRef||$[7]!==setLocal?(t2=()=>{[isPrevDisabled&&document.activeElement===prevButtonRef.current,isNextDisabled&&document.activeElement===nextButtonRef.current].forEach(_temp),setLocal({isPrevDisabled,isNextDisabled})},$[3]=isNextDisabled,$[4]=isPrevDisabled,$[5]=nextButtonRef,$[6]=prevButtonRef,$[7]=setLocal,$[8]=t2):t2=$[8],$[9]!==isNextDisabled||$[10]!==isPrevDisabled?(t3=[isPrevDisabled,isNextDisabled],$[9]=isNextDisabled,$[10]=isPrevDisabled,$[11]=t3):t3=$[11],(0,src.vJ)(t2,t3);const t4=!hasBottomNavigation,t5=!hasBottomNavigation;let t6;$[12]!==onAllTips?(t6=()=>{(0,utils.W)(),onAllTips()},$[12]=onAllTips,$[13]=t6):t6=$[13];const t7=!hasBottomNavigation;let t8,t9,t10,t11;$[14]===Symbol.for("react.memo_cache_sentinel")?(t8=react.createElement(arrow_left.A,null),$[14]=t8):t8=$[14],$[15]!==isRTL?(t9=react.createElement(ArrowWrap,{$isRTL:isRTL},t8),$[15]=isRTL,$[16]=t9):t9=$[16],$[17]===Symbol.for("react.memo_cache_sentinel")?(t10=react.createElement(AllTips,null,(0,i18n.__)("All Tips","web-stories")),$[17]=t10):t10=$[17],$[18]!==t6||$[19]!==t7||$[20]!==t9?(t11=react.createElement(BottomNavButtons,null,react.createElement(secondaryPopup.ir,{onClick:t6,type:button_constants.VQ.Plain,size:button_constants.Mp.Small,disabled:t7},t9,t10)),$[18]=t6,$[19]=t7,$[20]=t9,$[21]=t11):t11=$[21];const t12=!hasBottomNavigation||local.isPrevDisabled;let t13,t14;$[22]===Symbol.for("react.memo_cache_sentinel")?(t13=(0,i18n.__)("Previous","web-stories"),$[22]=t13):t13=$[22],$[23]!==onPrev||$[24]!==prevButtonRef||$[25]!==t12?(t14=react.createElement(secondaryPopup.ir,{ref:prevButtonRef,onClick:onPrev,type:button_constants.VQ.Plain,size:button_constants.Mp.Small,disabled:t12},t13),$[23]=onPrev,$[24]=prevButtonRef,$[25]=t12,$[26]=t14):t14=$[26];const t15=!hasBottomNavigation||local.isNextDisabled;let t16,t17,t18,t19;return $[27]===Symbol.for("react.memo_cache_sentinel")?(t16=(0,i18n.__)("Next","web-stories"),$[27]=t16):t16=$[27],$[28]!==nextButtonRef||$[29]!==onNext||$[30]!==t15?(t17=react.createElement(secondaryPopup.ir,{ref:nextButtonRef,onClick:onNext,type:button_constants.VQ.Plain,size:button_constants.Mp.Small,disabled:t15},t16),$[28]=nextButtonRef,$[29]=onNext,$[30]=t15,$[31]=t17):t17=$[31],$[32]!==t14||$[33]!==t17?(t18=react.createElement(BottomNavButtons,null,t14,t17),$[32]=t14,$[33]=t17,$[34]=t18):t18=$[34],$[35]!==t11||$[36]!==t18||$[37]!==t4||$[38]!==t5?(t19=react.createElement(BottomNavBar,{"aria-hidden":t4,isHidden:t5},t11,t18),$[35]=t11,$[36]=t18,$[37]=t4,$[38]=t5,$[39]=t19):t19=$[39],t19}function _temp(condition){return(condition=>fn=>{condition&&fn()})(condition)(utils.W)}BottomNavigation.propTypes={onNext:prop_types_default().func.isRequired,onPrev:prop_types_default().func.isRequired,onAllTips:prop_types_default().func.isRequired,hasBottomNavigation:prop_types_default().bool,isNextDisabled:prop_types_default().bool,isPrevDisabled:prop_types_default().bool};var noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts");const Layout=styled_components_browser_esm.Ay.div.withConfig({displayName:"navigator__Layout",componentId:"sc-3xgugm-0"})([""," contain:content;"],fullSize.N),Content=styled_components_browser_esm.Ay.div.withConfig({displayName:"navigator__Content",componentId:"sc-3xgugm-1"})([""]),ContentInner=styled_components_browser_esm.Ay.div.withConfig({displayName:"navigator__ContentInner",componentId:"sc-3xgugm-2"})(["position:relative;"]);const helpCenter_navigator=(0,src.ph)((function Navigator({children,isOpen,onClose,onNext,onPrev,onAllTips,hasBottomNavigation,isNextDisabled,isPrevDisabled}){const innerRef=(0,src.li)(null),layoutRef=(0,src.li)(null);return(0,src.vJ)((()=>function removeInnerElementFromLayoutFlow(innerEl,outerEl){if(!innerEl||!outerEl)return noop.l;const{height}=innerEl.getBoundingClientRect();outerEl.style.height=`${height}px`,innerEl.style.position="absolute",innerEl.style.bottom=0,innerEl.style.content="contain";let id=requestAnimationFrame((()=>{id=requestAnimationFrame((()=>{outerEl.style.transition=`height ${constants.xt}ms ${theme_constants.U.default}`}))}));return()=>cancelAnimationFrame(id)}(innerRef.current,layoutRef.current)),[]),(0,src.pO)(innerRef,(({height})=>{layoutRef.current&&(layoutRef.current.style.height=`${height}px`)}),[]),react.createElement(secondaryPopup._B,{isOpen},react.createElement(secondaryPopup.IS,{onClose,label:(0,i18n.__)("Quick Tips","web-stories"),popupId:constants.DE}),react.createElement(Layout,{ref:layoutRef},react.createElement(Content,{ref:innerRef},react.createElement(ContentInner,null,children))),react.createElement(BottomNavigation,{onNext,onPrev,onAllTips,hasBottomNavigation,isNextDisabled,isPrevDisabled}))}))},"./packages/story-editor/src/components/helpCenter/quickTip/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>QuickTip});var react=__webpack_require__("./node_modules/react/index.js"),dist=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js")),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),translateWithMarkup=__webpack_require__("./packages/i18n/src/translateWithMarkup.tsx"),expandPresetStyles=__webpack_require__("./packages/design-system/src/theme/helpers/expandPresetStyles.ts"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),centerContent=__webpack_require__("./packages/design-system/src/theme/helpers/centerContent.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),typography_link=__webpack_require__("./packages/design-system/src/components/typography/link/index.tsx"),visuallyHidden=__webpack_require__("./packages/design-system/src/components/visuallyHidden.ts"),secondaryPopup=__webpack_require__("./packages/story-editor/src/components/secondaryPopup/index.js"),constants=__webpack_require__("./packages/story-editor/src/app/helpCenter/constants.ts"),app=__webpack_require__("./packages/story-editor/src/app/index.js"),theme_constants=__webpack_require__("./packages/design-system/src/theme/constants/index.ts"),scheduledTransition=__webpack_require__("./packages/story-editor/src/components/transition/scheduledTransition.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const DELAY=80,DURATION=constants.xt-DELAY,Opacity=styled_components_browser_esm.Ay.div.withConfig({displayName:"transitioner__Opacity",componentId:"sc-cc5d3w-0"})([""]),enterStyles=()=>(0,styled_components_browser_esm.AH)(["transition-delay:","ms;transform:none;","{opacity:1;}"],DELAY,Opacity),exitStyles=({isLeftToRightTransition})=>(0,styled_components_browser_esm.AH)(["position:absolute;bottom:0;","{opacity:0;}",""],Opacity,isLeftToRightTransition?(0,styled_components_browser_esm.AH)(["transform:translateX(-100%);"]):(0,styled_components_browser_esm.AH)(["transform:translateX(100%);"])),transitionStyles={entering:enterStyles,entered:enterStyles,exiting:exitStyles,exited:exitStyles},Manager=styled_components_browser_esm.Ay.div.withConfig({displayName:"transitioner__Manager",componentId:"sc-cc5d3w-1"})(["position:relative;color:",";background-color:",";transition:transform ","ms ",";transform-origin:50% 50%;z-index:",";"," ","{opacity:0.6;transition:opacity ","ms ",";}",";"],(({theme})=>theme.colors.fg.primary),(({theme})=>theme.colors.bg.primary),DURATION,theme_constants.U.default,constants.Mu.QUICK_TIP,(({isLeftToRightTransition})=>isLeftToRightTransition?(0,styled_components_browser_esm.AH)(["transform:translateX(100%);"]):(0,styled_components_browser_esm.AH)(["transform:translateX(-100%);"])),Opacity,DURATION,theme_constants.U.default,(({state,...props})=>transitionStyles[state]?.(props)));function Transitioner(t0){const $=(0,dist.c)(11);let children,isLeftToRightTransition,props,t1,t2,t3;return $[0]!==t0?(({children,isLeftToRightTransition,...props}=t0),$[0]=t0,$[1]=children,$[2]=isLeftToRightTransition,$[3]=props):(children=$[1],isLeftToRightTransition=$[2],props=$[3]),$[4]===Symbol.for("react.memo_cache_sentinel")?(t1={enter:DURATION+DELAY,exit:DURATION},$[4]=t1):t1=$[4],$[5]!==children||$[6]!==isLeftToRightTransition?(t2=state=>react.createElement(Manager,{state,isLeftToRightTransition},react.createElement(Opacity,null,children)),$[5]=children,$[6]=isLeftToRightTransition,$[7]=t2):t2=$[7],$[8]!==props||$[9]!==t2?(t3=react.createElement(scheduledTransition.x,_extends({},props,{timeout:t1,mountOnEnter:!0,unmountOnExit:!0}),t2),$[8]=props,$[9]=t2,$[10]=t3):t3=$[10],t3}var _circle,_path,_path2;function doneCheckmark_extends(){return doneCheckmark_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},doneCheckmark_extends.apply(null,arguments)}Transitioner.propTypes={children:prop_types_default().node,isLeftToRightTransition:prop_types_default().bool};const SvgDoneCheckmark=({title,titleId,...props})=>react.createElement("svg",doneCheckmark_extends({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 135 136","aria-labelledby":titleId},props),title?react.createElement("title",{id:titleId},title):null,_circle||(_circle=react.createElement("circle",{cx:67.5,cy:68.5,r:67.5,fill:"currentColor"})),_path||(_path=react.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M67.5 93.146c13.889 0 25.148-11.259 25.148-25.147 0-13.889-11.26-25.147-25.147-25.147-13.889 0-25.148 11.258-25.148 25.147s11.26 25.147 25.148 25.147"})),_path2||(_path2=react.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M81.698 57.64a1.5 1.5 0 0 1 .037 2.12l-17.93 18.563a1.5 1.5 0 0 1-2.157 0l-7.383-7.643a1.5 1.5 0 1 1 2.158-2.084l6.304 6.526 16.85-17.445a1.5 1.5 0 0 1 2.121-.037",clipRule:"evenodd"}))),doneCheckmark=(0,react.memo)(SvgDoneCheckmark);function quickTip_extends(){return quickTip_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},quickTip_extends.apply(null,arguments)}const Panel=styled_components_browser_esm.Ay.div.withConfig({displayName:"quickTip__Panel",componentId:"sc-1kyj87z-0"})(["width:100%;padding-bottom:","px;*{user-select:text;}"],secondaryPopup.BN),Overflow=styled_components_browser_esm.Ay.div.withConfig({displayName:"quickTip__Overflow",componentId:"sc-1kyj87z-1"})(["position:relative;width:100%;max-height:70vh;padding:","px;strong{font-weight:700;}"],constants.hE),Video=styled_components_browser_esm.Ay.video.withConfig({displayName:"quickTip__Video",componentId:"sc-1kyj87z-2"})(["height:180px;margin-bottom:","px;max-width:100%;"],constants.hE),Title=styled_components_browser_esm.Ay.h1.withConfig({displayName:"quickTip__Title",componentId:"sc-1kyj87z-3"})([""," color:",";line-height:32px;margin:0 0 8px 0;"],expandPresetStyles.x((({label},{Medium})=>label[Medium])),(({theme})=>theme.colors.fg.primary)),Paragraph=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).withConfig({displayName:"quickTip__Paragraph",componentId:"sc-1kyj87z-4"})(["& + &{margin-top:8px;}"]),DoneContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"quickTip__DoneContainer",componentId:"sc-1kyj87z-5"})([""," height:180px;margin-bottom:","px;color:#f4f2ef;svg{display:block;path{color:#4285f4;}}"],centerContent.F,constants.hE);function QuickTip(t0){const $=(0,dist.c)(38);let description,figureAlt,figureSrc,figureSrcImg,href,t1,t2,title,transitionProps;$[0]!==t0?(({title,description,isLeftToRightTransition:t1,figureSrc,figureSrcImg,figureAlt,href,isDone:t2,...transitionProps}=t0),$[0]=t0,$[1]=description,$[2]=figureAlt,$[3]=figureSrc,$[4]=figureSrcImg,$[5]=href,$[6]=t1,$[7]=t2,$[8]=title,$[9]=transitionProps):(description=$[1],figureAlt=$[2],figureSrc=$[3],figureSrcImg=$[4],href=$[5],t1=$[6],t2=$[7],title=$[8],transitionProps=$[9]);const isLeftToRightTransition=void 0===t1||t1,isDone=void 0!==t2&&t2,{cdnURL}=(0,app.UK)();let t3,t4,t5,t6,t7,t8,t9;if($[10]!==cdnURL||$[11]!==figureSrc?(t3=Boolean(figureSrc)&&react.createElement(Video,{controls:!1,autoPlay:!0,loop:!0,muted:!0,noControls:!0,preload:"true",crossOrigin:"anonymous"},react.createElement("source",{src:`${cdnURL}${figureSrc}.webm`,type:"video/webm"}),react.createElement("source",{src:`${cdnURL}${figureSrc}.mp4`,type:"video/mp4"})),$[10]=cdnURL,$[11]=figureSrc,$[12]=t3):t3=$[12],$[13]!==cdnURL||$[14]!==figureAlt||$[15]!==figureSrcImg?(t4=figureSrcImg&&react.createElement(Video,{as:"img",alt:figureAlt,src:`${cdnURL}${figureSrcImg}.png`,crossOrigin:"anonymous"}),$[13]=cdnURL,$[14]=figureAlt,$[15]=figureSrcImg,$[16]=t4):t4=$[16],$[17]!==isDone?(t5=isDone&&react.createElement(DoneContainer,null,react.createElement(doneCheckmark,{height:135,width:135})),$[17]=isDone,$[18]=t5):t5=$[18],$[19]!==title?(t6=react.createElement(Title,null,title),$[19]=title,$[20]=t6):t6=$[20],$[21]!==description||$[22]!==href||$[23]!==title){let t8;$[25]!==href||$[26]!==title?(t8=(paragraph,i)=>react.createElement(Paragraph,{key:`${title}-${i}`,size:types.$.Small},react.createElement(translateWithMarkup.A,{mapping:{a:react.createElement(typography_link.N,{size:types.$.Small,rel:"noreferrer",target:"_blank",href}),screenreader:react.createElement(visuallyHidden.s,null)}},paragraph)),$[25]=href,$[26]=title,$[27]=t8):t8=$[27],t7=description.map(t8),$[21]=description,$[22]=href,$[23]=title,$[24]=t7}else t7=$[24];return $[28]!==t3||$[29]!==t4||$[30]!==t5||$[31]!==t6||$[32]!==t7?(t8=react.createElement(Panel,null,react.createElement(Overflow,null,t3,t4,t5,t6,t7)),$[28]=t3,$[29]=t4,$[30]=t5,$[31]=t6,$[32]=t7,$[33]=t8):t8=$[33],$[34]!==isLeftToRightTransition||$[35]!==t8||$[36]!==transitionProps?(t9=react.createElement(Transitioner,quickTip_extends({},transitionProps,{isLeftToRightTransition}),t8),$[34]=isLeftToRightTransition,$[35]=t8,$[36]=transitionProps,$[37]=t9):t9=$[37],t9}QuickTip.propTypes={figureAlt:prop_types_default().string,figureSrc:prop_types_default().string,figureSrcImg:prop_types_default().string,href:prop_types_default().string,isDone:prop_types_default().bool,title:prop_types_default().string.isRequired,description:prop_types_default().arrayOf(prop_types_default().string).isRequired,isLeftToRightTransition:prop_types_default().bool}},"./packages/story-editor/src/components/helpCenter/toggle/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l:()=>Toggle});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/i18n/src/sprintf.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/i18n/src/i18n.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/design-system/src/icons/question_mark_outline.svg"),_toggleButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/story-editor/src/components/toggleButton/index.js"),_utils_noop__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/story-editor/src/utils/noop.ts");function Toggle(t0){const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(9),{isOpen:t1,popupId:t2,onClick:t3,notificationCount:t4}=t0,isOpen=void 0!==t1&&t1,popupId=void 0===t2?"":t2,onClick=void 0===t3?_utils_noop__WEBPACK_IMPORTED_MODULE_3__.l:t3,notificationCount=void 0===t4?0:t4;let t5,t6,t7;return $[0]!==notificationCount?(t5=notificationCount>0?(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_4__.A)((0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_5__._n)("Help Center: %s unread notification","Help Center: %s unread notifications",notificationCount,"web-stories"),notificationCount):(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_5__.__)("Help Center","web-stories"),$[0]=notificationCount,$[1]=t5):t5=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t6=(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_5__.__)("Help","web-stories"),$[2]=t6):t6=$[2],$[3]!==isOpen||$[4]!==notificationCount||$[5]!==onClick||$[6]!==popupId||$[7]!==t5?(t7=react__WEBPACK_IMPORTED_MODULE_0__.createElement(_toggleButton__WEBPACK_IMPORTED_MODULE_2__.f,{"aria-owns":popupId,"aria-label":t5,onClick,isOpen,label:t6,MainIcon:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_6__.A,notificationCount}),$[3]=isOpen,$[4]=notificationCount,$[5]=onClick,$[6]=popupId,$[7]=t5,$[8]=t7):t7=$[8],t7}Toggle.propTypes={isOpen:prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool,popupId:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string,onClick:prop_types__WEBPACK_IMPORTED_MODULE_7___default().func,notificationCount:prop_types__WEBPACK_IMPORTED_MODULE_7___default().number}},"./packages/story-editor/src/components/helpCenter/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>forceFocusCompanion});var _app_helpCenter_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/story-editor/src/app/helpCenter/constants.ts");function forceFocusCompanion(){document.querySelector(_app_helpCenter_constants__WEBPACK_IMPORTED_MODULE_0__.Gk)?.focus()}},"./packages/story-editor/src/components/keyboardShortcutsMenu/constants.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>TOP_MARGIN,l:()=>TOGGLE_SHORTCUTS_MENU});const TOP_MARGIN=16,TOGGLE_SHORTCUTS_MENU="mod+/"},"./packages/story-editor/src/components/keyboardShortcutsMenu/keyboardShortcutsMenuContext/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>provider,R:()=>useKeyboardShortcutsMenu});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),src=__webpack_require__("./packages/react/src/index.ts"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts");const context=(0,src.q6)({state:{isOpen:!1},actions:{toggle:noop.l,close:noop.l}});function _temp(prevIsOpen){return!prevIsOpen}const provider=function KeyboardShortcutsMenuProvider(t0){const $=(0,dist.c)(18),{children}=t0,[isOpen,setIsOpen]=(0,src.J0)(!1);let t1,t2;$[0]!==isOpen||$[1]!==setIsOpen?(t1=e=>{e.preventDefault(),(0,tracking_src.sx)("shortcuts_menu_toggled",{status:isOpen?"closed":"open"}),setIsOpen(_temp)},$[0]=isOpen,$[1]=setIsOpen,$[2]=t1):t1=$[2],$[3]!==isOpen?(t2=[isOpen],$[3]=isOpen,$[4]=t2):t2=$[4];const toggle=(0,src.hb)(t1,t2);let t3,t4;$[5]!==isOpen||$[6]!==setIsOpen?(t3=()=>{isOpen&&((0,tracking_src.sx)("shortcuts_menu_toggled",{status:"closed"}),setIsOpen(!1))},$[5]=isOpen,$[6]=setIsOpen,$[7]=t3):t3=$[7],$[8]!==isOpen?(t4=[isOpen],$[8]=isOpen,$[9]=t4):t4=$[9];const close=(0,src.hb)(t3,t4);let t5,t6;$[10]!==close||$[11]!==isOpen||$[12]!==toggle?(t5=()=>({state:{isOpen},actions:{toggle,close}}),t6=[close,isOpen,toggle],$[10]=close,$[11]=isOpen,$[12]=toggle,$[13]=t5,$[14]=t6):(t5=$[13],t6=$[14]);const contextValue=(0,src.Kr)(t5,t6);let t7;return $[15]!==children||$[16]!==contextValue?(t7=react.createElement(context.Provider,{value:contextValue},children),$[15]=children,$[16]=contextValue,$[17]=t7):t7=$[17],t7};function useKeyboardShortcutsMenu(t0){const selector=void 0===t0?src.D_:t0;return(0,src.i7)(context,selector)}},"./packages/story-editor/src/components/keyboardShortcutsMenu/shortcutMenu.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>shortcutMenu});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),v4=__webpack_require__("./packages/story-editor/node_modules/uuid/dist/esm-browser/v4.js"),src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),outline=__webpack_require__("./packages/design-system/src/theme/helpers/outline.ts"),keyboard=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx"),cross=__webpack_require__("./packages/design-system/src/icons/cross.svg"),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),src_constants=__webpack_require__("./packages/story-editor/src/constants/index.ts"),headline=__webpack_require__("./packages/design-system/src/components/typography/headline/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),translateWithMarkup=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/i18n/src/translateWithMarkup.tsx")),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),utils=__webpack_require__("./packages/design-system/src/components/keyboard/utils.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const isMacOS=(0,utils.fi)(),LargeKey=props=>react.createElement("kbd",_extends({className:"large-key"},props)),ShiftKeyWrapper=props=>{const $=(0,dist.c)(2);let t0;return $[0]!==props?(t0=isMacOS?react.createElement("kbd",props):react.createElement(LargeKey,props),$[0]=props,$[1]=t0):t0=$[1],t0},shortcuts={header:{label:(0,i18n.__)("Keyboard Shortcuts","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"/"))},landmarks:[{label:(0,i18n.__)("Element","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,(0,utils.KV)("alt")),react.createElement("kbd",null,"1"))},{label:(0,i18n.__)("Workspace","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,(0,utils.KV)("alt")),react.createElement("kbd",null,"2"))},{label:(0,i18n.__)("Design panels","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,(0,utils.KV)("alt")),react.createElement("kbd",null,"3"))}],sections:[{title:(0,i18n.__)("Basics","web-stories"),commands:[{label:(0,i18n.__)("Undo","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"Z"))},{label:(0,i18n.__)("Redo","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement(ShiftKeyWrapper,null,(0,utils.KV)("shift")),react.createElement("kbd",null,"Z"))},{label:(0,i18n.__)("Save","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"S"))},{label:(0,i18n.__)("Play / Stop","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,(0,utils.KV)("enter")))}]},{title:(0,i18n.__)("Text","web-stories"),commands:[{label:(0,i18n.__)("Insert/edit link","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"K"))},{label:(0,i18n.__)("Bold","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"B"))},{label:(0,i18n.__)("Italic","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"I"))},{label:(0,i18n.__)("Underline","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"U"))}]},{title:(0,i18n.__)("Element","web-stories"),commands:[{label:(0,i18n.__)("Copy","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"C"))},{label:(0,i18n.__)("Cut","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"X"))},{label:(0,i18n.__)("Duplicate","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"D"))},{label:(0,i18n.__)("Paste","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"V"))},{label:(0,i18n.__)("Copy Styles","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,(0,utils.KV)("alt")),react.createElement("kbd",null,"O"))},{label:(0,i18n.__)("Paste Styles","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,(0,utils.KV)("alt")),react.createElement("kbd",null,"P"))},{label:(0,i18n.__)("Select all","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"A"))},{label:(0,i18n.__)("Select multiple","web-stories"),shortcut:react.createElement("kbd",null,react.createElement(translateWithMarkup.A,{mapping:{lkbd:react.createElement(LargeKey,null),shortcut:react.createElement(keyboard.rm,{shortcut:"shift"})}},(0,sprintf.A)((0,i18n.__)("<lkbd>%s</lkbd> <span>+ click</span>","web-stories"),(0,utils.KV)("shift"))))},{label:(0,i18n.__)("Move forward or back","web-stories"),shortcut:react.createElement("kbd",null,react.createElement(translateWithMarkup.A,{mapping:{kbd:react.createElement("kbd",null),lkbd:react.createElement(LargeKey,null)}},(0,sprintf.A)((0,i18n.__)("<lkbd>%1$s</lkbd> <kbd>%2$s</kbd> <span>or</span> <kbd>%3$s</kbd>","web-stories"),(0,utils.KV)("mod"),(0,utils.KV)("up"),(0,utils.KV)("down"))))},{label:(0,i18n.__)("Move to front or back","web-stories"),shortcut:react.createElement("kbd",null,react.createElement(translateWithMarkup.A,{mapping:{kbd:react.createElement("kbd",null),lkbd:react.createElement(LargeKey,null)}},(0,sprintf.A)((0,i18n.__)("<lkbd>%1$s</lkbd> <lkbd>%2$s</lkbd> <kbd>%3$s</kbd> <span>or</span> <kbd>%4$s</kbd>","web-stories"),(0,utils.KV)("mod"),(0,utils.KV)("shift"),(0,utils.KV)("up"),(0,utils.KV)("down"))))},{label:(0,i18n.__)("Enter crop/edit mode","web-stories"),shortcut:react.createElement("kbd",null,react.createElement(translateWithMarkup.A,{mapping:{kbd:react.createElement("kbd",null)}},(0,sprintf.A)((0,i18n.__)("<kbd>%s</kbd> <span>or double-click</span>","web-stories"),(0,utils.KV)("enter"))))},{label:(0,i18n.__)("Delete","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("delete")))},{disabled:!0,label:(0,i18n.__)("Insert/edit link","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",null,"A"))},{label:(0,i18n.__)("Disable snapping and drop targeting","web-stories"),shortcut:react.createElement("kbd",null,react.createElement(translateWithMarkup.A,{mapping:{lkbd:react.createElement(LargeKey,null)}},(0,sprintf.A)((0,i18n.__)("<span>Hold</span> <lkbd>%s</lkbd>","web-stories"),(0,utils.KV)("mod"))))},{label:(0,i18n.__)("Access floating toolbar","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("ctrl")),react.createElement("kbd",{className:"large-key"},(0,utils.KV)("alt")),react.createElement("kbd",null,"P"))},{label:(0,i18n.__)("Open context menu","web-stories"),shortcut:react.createElement("kbd",null,react.createElement("kbd",{className:"large-key"},(0,utils.KV)("mod")),react.createElement("kbd",{className:"large-key"},(0,utils.KV)("alt")),react.createElement("kbd",{className:"large-key"},(0,utils.KV)("shift")),react.createElement("kbd",null,"M"))},{label:(0,i18n.__)("Move element 1px","web-stories"),shortcut:react.createElement("kbd",null,react.createElement(translateWithMarkup.A,{mapping:{lkbd:react.createElement(LargeKey,null),shortcut:react.createElement(keyboard.rm,{shortcut:"shift"})}},(0,sprintf.A)((0,i18n.__)("<lkbd>%s</lkbd> <span>+ arrow keys</span>","web-stories"),(0,utils.KV)("shift"))))}]}]},header=shortcuts.header,landmarks=shortcuts.landmarks.filter((o=>!o.disabled)),sections=shortcuts.sections.map((section=>({...section,commands:section.commands.filter((o=>!o.disabled))})));var prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),expandPresetStyles=__webpack_require__("./packages/design-system/src/theme/helpers/expandPresetStyles.ts");function shortcutLabel_extends(){return shortcutLabel_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},shortcutLabel_extends.apply(null,arguments)}const Wrapper=styled_components_browser_esm.Ay.dd.withConfig({displayName:"shortcutLabel__Wrapper",componentId:"sc-6tlmvo-0"})(["display:block;margin:0;kbd{"," display:flex;justify-content:",";align-items:center;margin:0;padding:0;color:",";background-color:transparent;& > kbd{display:flex;justify-content:center;align-items:center;padding:0 5px;height:24px;width:24px;border-radius:",";border:1px solid ",";color:",";}& > kbd.large-key{width:auto;}kbd + kbd{margin-left:2px;}kbd + span{margin-left:4px;}span + kbd{margin-left:4px;}}"],expandPresetStyles.x((({paragraph},{XSmall})=>paragraph[XSmall])),(({alignment})=>alignment),(({theme})=>theme.colors.fg.secondary),(({theme})=>theme.borders.radius.medium),(({theme})=>theme.colors.border.defaultNormal),(({theme})=>theme.colors.fg.primary));function ShortCutLabel(t0){const $=(0,dist.c)(8);let keys,rest,t1;$[0]!==t0?(({keys,alignment:t1,...rest}=t0),$[0]=t0,$[1]=keys,$[2]=rest,$[3]=t1):(keys=$[1],rest=$[2],t1=$[3]);const alignment=void 0===t1?"center":t1;let t2;return $[4]!==alignment||$[5]!==keys||$[6]!==rest?(t2=react.createElement(Wrapper,shortcutLabel_extends({alignment},rest),keys),$[4]=alignment,$[5]=keys,$[6]=rest,$[7]=t2):t2=$[7],t2}ShortCutLabel.propTypes={keys:prop_types_default().PropTypes.element,alignment:prop_types_default().oneOf(["left","center","right"])};const shortcutLabel=ShortCutLabel;function headerShortcut_extends(){return headerShortcut_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},headerShortcut_extends.apply(null,arguments)}const List=styled_components_browser_esm.Ay.dl.withConfig({displayName:"headerShortcut__List",componentId:"sc-1egg06k-0"})(["margin:24px;display:flex;flex-shrink:0;"]),Item=styled_components_browser_esm.Ay.dt.withConfig({displayName:"headerShortcut__Item",componentId:"sc-1egg06k-1"})(["margin:0 12px 0 0;"]);const headerShortcut=function HeaderShortcut(props){const $=(0,dist.c)(5),{label,shortcut}=header;let t0,t1,t2;return $[0]!==props?(t0=react.createElement(Item,null,react.createElement(headline.$,headerShortcut_extends({as:"h2",size:types.$.XSmall},props),label)),$[0]=props,$[1]=t0):t0=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t1=react.createElement(shortcutLabel,{keys:shortcut}),$[2]=t1):t1=$[2],$[3]!==t0?(t2=react.createElement(List,null,t0,t1),$[3]=t0,$[4]=t2):t2=$[4],t2};var typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts");const LandmarksWrapper=styled_components_browser_esm.Ay.dl.withConfig({displayName:"landmarkShortcuts__LandmarksWrapper",componentId:"sc-k7r8e2-0"})(["background-color:",";margin:0;padding:16px 24px;display:flex;justify-content:space-between;user-select:text;"],(({theme})=>theme.colors.bg.secondary)),Landmark=styled_components_browser_esm.Ay.div.withConfig({displayName:"landmarkShortcuts__Landmark",componentId:"sc-k7r8e2-1"})(["display:flex;flex-direction:column;"]),Label=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).attrs({size:types.$.XSmall}).withConfig({displayName:"landmarkShortcuts__Label",componentId:"sc-k7r8e2-2"})(["text-align:center;margin-top:8px;white-space:nowrap;display:inline-block;"]);function _temp(t0){const{label,shortcut}=t0;return react.createElement(Landmark,{key:label},react.createElement(shortcutLabel,{keys:shortcut}),react.createElement("dt",null,react.createElement(Label,null,label)))}const landmarkShortcuts=function LandmarkShortcuts(){const $=(0,dist.c)(1);let t0;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(LandmarksWrapper,null,landmarks.map(_temp)),$[0]=t0):t0=$[0],t0},Header=(0,styled_components_browser_esm.Ay)(headline.$).attrs({as:"h3",size:types.$.XXSmall}).withConfig({displayName:"shortcutMenuSection__Header",componentId:"sc-xssjcb-0"})(["margin-top:24px;color:",";"],(({theme})=>theme.colors.fg.primary)),shortcutMenuSection_List=styled_components_browser_esm.Ay.dl.withConfig({displayName:"shortcutMenuSection__List",componentId:"sc-xssjcb-1"})(["display:grid;grid-template-columns:1fr;row-gap:12px;align-items:center;margin:12px 0 0;"]),ListRow=styled_components_browser_esm.Ay.div.withConfig({displayName:"shortcutMenuSection__ListRow",componentId:"sc-xssjcb-2"})(["display:grid;grid-template-columns:1fr 1fr;grid-template-rows:auto;column-gap:5px;align-items:center;dd{grid-column:1;grid-row:1;}dt{grid-column:2;grid-row:1;}"]),shortcutMenuSection_Label=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).attrs({size:types.$.Small}).withConfig({displayName:"shortcutMenuSection__Label",componentId:"sc-xssjcb-3"})(["display:inline-block;color:",";"],(({theme})=>theme.colors.fg.secondary));function ShortcutMenuSection(t0){const $=(0,dist.c)(10),{title,commands}=t0,headerId=`header-${(0,v4.A)()}`;let t1,t2,t3,t4;return $[0]!==title?(t1=react.createElement(Header,{id:headerId},title),$[0]=title,$[1]=t1):t1=$[1],$[2]!==commands?(t2=commands.map(shortcutMenuSection_temp),$[2]=commands,$[3]=t2):t2=$[3],$[4]!==t2||$[5]!==title?(t3=react.createElement(shortcutMenuSection_List,{title},t2),$[4]=t2,$[5]=title,$[6]=t3):t3=$[6],$[7]!==t1||$[8]!==t3?(t4=react.createElement(react.Fragment,null,t1,t3),$[7]=t1,$[8]=t3,$[9]=t4):t4=$[9],t4}function shortcutMenuSection_temp(t0){const{label,shortcut}=t0;return react.createElement(ListRow,{key:label},react.createElement(shortcutLabel,{keys:shortcut,alignment:"left"}),react.createElement("dt",null,react.createElement(shortcutMenuSection_Label,null,label)))}ShortcutMenuSection.propTypes={title:prop_types_default().string.isRequired,commands:prop_types_default().array.isRequired};const shortcutMenuSection=ShortcutMenuSection,ContentWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"regularShortcuts__ContentWrapper",componentId:"sc-fl8s7-0"})(["display:flex;flex-direction:column;margin:0 24px 24px;*{user-select:text;}"]);function regularShortcuts_temp(t0){const{title,commands}=t0;return react.createElement(shortcutMenuSection,{key:title,title,commands})}const regularShortcuts=function RegularShortcuts(){const $=(0,dist.c)(1);let t0;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(ContentWrapper,null,sections.map(regularShortcuts_temp)),$[0]=t0):t0=$[0],t0};var keyboardShortcutsMenu_constants=__webpack_require__("./packages/story-editor/src/components/keyboardShortcutsMenu/constants.js"),keyboardShortcutsMenuContext=__webpack_require__("./packages/story-editor/src/components/keyboardShortcutsMenu/keyboardShortcutsMenuContext/index.ts");const Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"shortcutMenu__Container",componentId:"sc-m0xcqa-0"})(["position:absolute;left:0;bottom:0;width:352px;border-radius:",";background-color:",";border:","px solid ",";"],(({theme})=>theme.borders.radius.small),(({theme})=>theme.colors.bg.primary),1,(({theme})=>theme.colors.border.defaultNormal)),EXTRA_SPACE=src_constants.ah+src_constants.uF+keyboardShortcutsMenu_constants.E-2,FlexContent=styled_components_browser_esm.Ay.div.withConfig({displayName:"shortcutMenu__FlexContent",componentId:"sc-m0xcqa-1"})(["display:flex;flex-direction:column;max-height:calc( 100vh - ","px - ","px );"],EXTRA_SPACE,(({bottomOffset})=>bottomOffset)),CloseContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"shortcutMenu__CloseContainer",componentId:"sc-m0xcqa-2"})(["position:absolute;right:4px;top:4px;"]),ScrollableContent=styled_components_browser_esm.Ay.div.withConfig({displayName:"shortcutMenu__ScrollableContent",componentId:"sc-m0xcqa-3"})(["overflow:auto;flex-shrink:1;",";"],outline.Q),HEADER_ID=`kb-header-${(0,v4.A)()}`;function shortcutMenu_temp(t0){const{actions,state}=t0;return{toggle:actions.toggle,close:actions.close,isOpen:state.isOpen}}const shortcutMenu=function ShortcutMenu(){const $=(0,dist.c)(24),anchorRef=(0,src.li)(),containerRef=(0,src.li)(),{close,toggle,isOpen}=(0,keyboardShortcutsMenuContext.R)(shortcutMenu_temp),[bottomOffset,setBottomOffset]=(0,src.J0)(0);let t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11;return $[0]!==containerRef.current||$[1]!==setBottomOffset?(t0=()=>{const node=containerRef.current;if(!node)return;const calc=()=>{const nodeRect=node.getBoundingClientRect(),docRect=node.ownerDocument.documentElement.getBoundingClientRect();setBottomOffset(docRect.height-nodeRect.y-nodeRect.height)};return calc(),setTimeout(calc),window.addEventListener("resize",calc),()=>window.removeEventListener("resize",calc)},$[0]=containerRef.current,$[1]=setBottomOffset,$[2]=t0):t0=$[2],$[3]===Symbol.for("react.memo_cache_sentinel")?(t1=[],$[3]=t1):t1=$[3],(0,src.Nf)(t0,t1),$[4]!==anchorRef||$[5]!==isOpen?(t2=()=>{isOpen&&anchorRef.current&&anchorRef.current.focus()},$[4]=anchorRef,$[5]=isOpen,$[6]=t2):t2=$[6],$[7]!==isOpen?(t3=[isOpen],$[7]=isOpen,$[8]=t3):t3=$[8],(0,src.vJ)(t2,t3),$[9]!==toggle?(t4=[toggle],$[9]=toggle,$[10]=t4):t4=$[10],(0,keyboard._h)(containerRef,keyboardShortcutsMenu_constants.l,toggle,t4),(0,keyboard._h)(containerRef,"esc",close),$[11]===Symbol.for("react.memo_cache_sentinel")?(t5=(0,i18n.__)("Close Menu","web-stories"),t6=react.createElement(cross.A,null),$[11]=t5,$[12]=t6):(t5=$[11],t6=$[12]),$[13]!==anchorRef||$[14]!==close?(t7=react.createElement(CloseContainer,null,react.createElement(button_button.$,{ref:anchorRef,type:constants.VQ.Plain,size:constants.Mp.Small,variant:constants.Ak.Circle,onClick:close,"aria-label":t5},t6)),$[13]=anchorRef,$[14]=close,$[15]=t7):t7=$[15],$[16]===Symbol.for("react.memo_cache_sentinel")?(t8=react.createElement(headerShortcut,{id:HEADER_ID}),$[16]=t8):t8=$[16],$[17]===Symbol.for("react.memo_cache_sentinel")?(t9=react.createElement(ScrollableContent,{role:"presentation",tabIndex:0},react.createElement(landmarkShortcuts,null),react.createElement(regularShortcuts,null)),$[17]=t9):t9=$[17],$[18]!==bottomOffset?(t10=react.createElement(FlexContent,{bottomOffset},t8,t9),$[18]=bottomOffset,$[19]=t10):t10=$[19],$[20]!==containerRef||$[21]!==t10||$[22]!==t7?(t11=react.createElement(Container,{ref:containerRef},t7,t10),$[20]=containerRef,$[21]=t10,$[22]=t7,$[23]=t11):t11=$[23],t11}},"./packages/story-editor/src/components/library/panes/shared/libraryMoveable.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/react/src/index.ts"),styled_components__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./packages/units/src/dimensions.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx"),_googleforcreators_moveable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/moveable/src/index.ts"),_googleforcreators_transform__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/transform/src/index.ts"),_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/constants/index.ts"),_dropTargets__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/components/dropTargets/index.js"),_app_layout__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/story-editor/src/app/layout/index.ts"),_canvas_useInsertElement__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/story-editor/src/components/canvas/useInsertElement.ts"),_canvas__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/story-editor/src/components/canvas/index.js"),_utils_isTargetOutOfContainer__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./packages/story-editor/src/utils/isTargetOutOfContainer.ts"),_canvas_utils_useSnapping__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/story-editor/src/components/canvas/utils/useSnapping.js"),_app__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/story-editor/src/app/index.js"),_utils_objectWithout__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/story-editor/src/utils/objectWithout.ts"),_utils_noop__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./packages/story-editor/src/utils/noop.ts"),_utils_usePerformanceTracking__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./packages/story-editor/src/utils/usePerformanceTracking.ts"),_shopping_constants__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./packages/story-editor/src/components/library/panes/shopping/constants.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const TargetBox=styled_components__WEBPACK_IMPORTED_MODULE_13__.Ay.div.withConfig({displayName:"libraryMoveable__TargetBox",componentId:"sc-jgbz52-0"})(["position:absolute;width:100%;height:100%;top:0;z-index:1;cursor:pointer;"]);const __WEBPACK_DEFAULT_EXPORT__=function LibraryMoveable({type,elementProps={},handleDrag,handleDragEnd,onClick=_utils_noop__WEBPACK_IMPORTED_MODULE_14__.l,cloneElement,cloneProps,elements=[],active=!1}){const CloneElement=cloneElement,[isDragging,setIsDragging]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.J0)(!1),[didManuallyReset,setDidManuallyReset]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.J0)(!1),[hover,setHover]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.J0)(!1),cloneRef=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)(null),targetBoxRef=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)(null),targetBoxSizeRef=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)(null),overlayRef=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)(null),moveable=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)(null),pageSize=(0,_app_layout__WEBPACK_IMPORTED_MODULE_6__.g)((({state:{pageWidth,pageHeight}})=>({width:pageWidth,height:pageHeight}))),{setZoomSetting:setZoomSetting_0}=(0,_app_layout__WEBPACK_IMPORTED_MODULE_6__.g)((({actions:{setZoomSetting}})=>({setZoomSetting}))),insertElement=(0,_canvas_useInsertElement__WEBPACK_IMPORTED_MODULE_7__.A)(),{backgroundElement}=(0,_app__WEBPACK_IMPORTED_MODULE_10__.P3)((state=>({backgroundElement:state.state.currentPage?.elements?.[0]??{}}))),{fullbleedContainer,nodesById,pageContainer}=(0,_app__WEBPACK_IMPORTED_MODULE_10__.yu)((state_0=>({fullbleedContainer:state_0.state.fullbleedContainer,pageContainer:state_0.state.pageContainer,nodesById:state_0.state.nodesById}))),{activeDropTargetId:activeDropTargetId_0,setDraggingResource:setDraggingResource_0}=(0,_dropTargets__WEBPACK_IMPORTED_MODULE_5__.h)((({state:{activeDropTargetId},actions:{setDraggingResource}})=>({activeDropTargetId,setDraggingResource}))),{clearTransforms,pushTransform}=(0,_googleforcreators_transform__WEBPACK_IMPORTED_MODULE_3__.Gy)((state_1=>({clearTransforms:state_1.actions.clearTransforms,pushTransform:state_1.actions.pushTransform}))),frame={translate:[0,0]},{insertTextSetByOffset}=(0,_canvas__WEBPACK_IMPORTED_MODULE_8__.On)(),eventTrackerRef=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)({}),resetMoveable=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)((()=>{targetBoxRef.current&&cloneRef.current&&(targetBoxRef.current.style.transform=null,cloneRef.current.style.transform=null,cloneRef.current.style.opacity=0,setIsDragging(!1),clearTransforms(),setDraggingResource_0(null))}),[setDraggingResource_0,clearTransforms]);(0,_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__._h)(isDragging?document.body:{current:null},"esc",(()=>{setDidManuallyReset(!0),resetMoveable()}),[isDragging,resetMoveable]);const getTargetOffset=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)((()=>{let offsetX=0,offsetY=0;for(let offsetNode=overlayRef.current;offsetNode;offsetNode=offsetNode.offsetParent)offsetX+=offsetNode.offsetLeft,offsetY+=offsetNode.offsetTop;return{offsetX,offsetY}}),[overlayRef]);(0,_utils_usePerformanceTracking__WEBPACK_IMPORTED_MODULE_12__.A)({node:targetBoxRef.current,eventData:{..._constants__WEBPACK_IMPORTED_MODULE_4__.Zy.INSERT_ELEMENT,label:type},eventType:"pointerdown"});const{offsetX:snappingOffsetX}=getTargetOffset(),snapProps=(0,_canvas_utils_useSnapping__WEBPACK_IMPORTED_MODULE_9__.A)({isDragging:!0,canSnap:!0,otherNodes:Object.values((0,_utils_objectWithout__WEBPACK_IMPORTED_MODULE_11__.A)(nodesById,[backgroundElement.id])),snappingOffsetX});return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(TargetBox,{ref:targetBoxRef,onPointerOver:()=>setHover(!0),onPointerOut:()=>setHover(!1)}),(isDragging||active||hover)&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_moveable__WEBPACK_IMPORTED_MODULE_2__.Ox,{ref:overlayRef,zIndex:1,pointerEvents:"none",render:()=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(CloneElement,_extends({ref:cloneRef},cloneProps))}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_moveable__WEBPACK_IMPORTED_MODULE_2__.uW,_extends({ref:moveable,className:"default-moveable hide-handles",target:targetBoxRef.current,edge:!0,draggable:!0,origin:!1,pinchable:!0,onDragStart:({set,inputEvent:inputEvent_0})=>{inputEvent_0.stopPropagation(),setDidManuallyReset(!1),set(frame.translate),setIsDragging(!0),(evt=>{const{timeStamp,clientX,clientY}=evt;eventTrackerRef.current={timeStamp,clientX,clientY}})(inputEvent_0),setZoomSetting_0(_constants__WEBPACK_IMPORTED_MODULE_4__.gw.Fit);const{offsetX:offsetX_0,offsetY:offsetY_0}=getTargetOffset(),targetBox=targetBoxRef.current.getBoundingClientRect();targetBoxSizeRef.current={width:targetBox.width,height:targetBox.height},targetBoxRef.current.style.width=`${cloneProps.width}px`,targetBoxRef.current.style.height=`${cloneProps.height}px`;const x1=targetBox.left-offsetX_0,y1=targetBox.top-offsetY_0;cloneRef.current.style.left=`${x1}px`,cloneRef.current.style.top=`${y1}px`,moveable.current&&moveable.current.updateRect()},onDrag:({beforeTranslate,inputEvent})=>{if(pushTransform(null,{drag:beforeTranslate}),didManuallyReset)return!1;frame.translate=beforeTranslate,cloneRef.current&&(0,_googleforcreators_moveable__WEBPACK_IMPORTED_MODULE_2__.hW)(eventTrackerRef.current,inputEvent)&&(1===cloneRef.current.style.opacity||activeDropTargetId_0?activeDropTargetId_0&&(cloneRef.current.style.opacity=0):cloneRef.current.style.opacity=1,cloneRef.current.style.transform=`translate(${beforeTranslate[0]}px, ${beforeTranslate[1]}px)`,targetBoxRef.current.style.transform=`translate(${beforeTranslate[0]}px, ${beforeTranslate[1]}px)`),handleDrag?.(inputEvent)},onDragEnd:({inputEvent:inputEvent_1})=>{if(didManuallyReset)return!1;if(targetBoxRef.current.style.width=`${targetBoxSizeRef.current.width}px`,targetBoxRef.current.style.height=`${targetBoxSizeRef.current.height}px`,!(0,_googleforcreators_moveable__WEBPACK_IMPORTED_MODULE_2__.hW)(eventTrackerRef.current,inputEvent_1))return resetMoveable(),onClick(),!1;if(activeDropTargetId_0&&handleDragEnd)handleDragEnd();else if(!(0,_utils_isTargetOutOfContainer__WEBPACK_IMPORTED_MODULE_16__.A)(cloneRef.current,fullbleedContainer)){const{x,y,width:w,height:h}=cloneRef.current.getBoundingClientRect(),{x:pageX,y:pageY}=pageContainer.getBoundingClientRect();"textSet"===type?insertTextSetByOffset(elements,{offsetX:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.z0)(x-pageX,pageSize.width),offsetY:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.GC)(y-pageY,pageSize.height)}):insertElement(type,"product"===type?{...elementProps,width:_shopping_constants__WEBPACK_IMPORTED_MODULE_18__.x,height:_shopping_constants__WEBPACK_IMPORTED_MODULE_18__.c,x:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.z0)(x-pageX,pageSize.width),y:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.GC)(y-pageY,pageSize.height)}:{...elementProps,x:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.z0)(x-pageX,pageSize.width),y:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.GC)(y-pageY,pageSize.height),width:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.z0)(w,pageSize.width),height:(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_17__.GC)(h,pageSize.height)})}resetMoveable()}},snapProps))))}},"./packages/story-editor/src/components/library/panes/shopping/constants.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>PRODUCT_HEIGHT,x:()=>PRODUCT_WIDTH});const PRODUCT_WIDTH=25,PRODUCT_HEIGHT=25},"./packages/story-editor/src/components/library/panes/shopping/productList.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>productList});var react=__webpack_require__("./node_modules/react/index.js"),src=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js"),__webpack_require__("./packages/react/src/index.ts")),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),constants=__webpack_require__("./packages/story-editor/src/constants/index.ts"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);function useProductNavigation(t0){const $=(0,dist.c)(19),{isMenuFocused,products:t1}=t0;let t2;$[0]!==t1?(t2=void 0===t1?[]:t1,$[0]=t1,$[1]=t2):t2=$[1];const products=t2;let t3;$[2]===Symbol.for("react.memo_cache_sentinel")?(t3=[],$[2]=t3):t3=$[2];const currentRowsRef=(0,src.li)(t3),[currentFocusIndex,setCurrentFocusIndex]=(0,src.J0)(0);let t4,t5,t6,t7;$[3]!==currentFocusIndex||$[4]!==currentRowsRef.current||$[5]!==isMenuFocused?(t4=()=>{const el=currentRowsRef.current[`row-${currentFocusIndex}`];el&&isMenuFocused&&!el.contains(document.activeElement)&&el.focus()},$[3]=currentFocusIndex,$[4]=currentRowsRef.current,$[5]=isMenuFocused,$[6]=t4):t4=$[6],$[7]!==currentFocusIndex||$[8]!==isMenuFocused?(t5=[currentFocusIndex,isMenuFocused],$[7]=currentFocusIndex,$[8]=isMenuFocused,$[9]=t5):t5=$[9],(0,src.vJ)(t4,t5),$[10]!==products||$[11]!==setCurrentFocusIndex?(t6=evt=>{const{key}=evt;"ArrowUp"===key?(evt.preventDefault(),setCurrentFocusIndex(_temp)):"ArrowDown"===key&&(evt.preventDefault(),setCurrentFocusIndex((index_0=>Math.min(products.length-1,index_0+1))))},$[10]=products,$[11]=setCurrentFocusIndex,$[12]=t6):t6=$[12],$[13]!==products?(t7=[products],$[13]=products,$[14]=t7):t7=$[14];const handleListNav=(0,src.hb)(t6,t7);let t8;return $[15]!==currentRowsRef||$[16]!==handleListNav||$[17]!==setCurrentFocusIndex?(t8={handleListNav,currentRowsRef,setCurrentFocusIndex},$[15]=currentRowsRef,$[16]=handleListNav,$[17]=setCurrentFocusIndex,$[18]=t8):t8=$[18],t8}function _temp(index){return Math.max(0,index-1)}useProductNavigation.propTypes={isMenuFocused:prop_types_default().bool,products:prop_types_default().arrayOf(prop_types_default().object)};const shopping_useProductNavigation=useProductNavigation;var typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),libraryMoveable=__webpack_require__("./packages/story-editor/src/components/library/panes/shared/libraryMoveable.js"),shopping_constants=__webpack_require__("./packages/story-editor/src/components/library/panes/shopping/constants.js");const imgPlaceholder=(0,styled_components_browser_esm.AH)(["display:block;margin-right:10px;border-radius:4px;background-color:",";width:41px;height:41px;"],(({theme})=>theme.colors.interactiveBg.disable)),StyledImgPlaceHolder=styled_components_browser_esm.Ay.div.withConfig({displayName:"productImage__StyledImgPlaceHolder",componentId:"sc-17w7h9b-0"})(["",""],imgPlaceholder),ProductImageWrap=styled_components_browser_esm.Ay.div.withConfig({displayName:"productImage__ProductImageWrap",componentId:"sc-17w7h9b-1"})(["position:relative;"]),StyledImage=styled_components_browser_esm.Ay.img.withConfig({displayName:"productImage__StyledImage",componentId:"sc-17w7h9b-2"})([""," object-fit:cover;"],imgPlaceholder),StyledImageClone=styled_components_browser_esm.Ay.img.withConfig({displayName:"productImage__StyledImageClone",componentId:"sc-17w7h9b-3"})(["opacity:0;position:absolute;object-fit:cover;border-radius:4px;width:","px;height:","px;"],shopping_constants.x,shopping_constants.c);function ProductImage(t0){const $=(0,dist.c)(3),{product}=t0,imageSrc=product?.productImages[0]?.url||"";let t1;return $[0]!==imageSrc||$[1]!==product?.productImages?(t1=imageSrc?react.createElement(StyledImage,{alt:product?.productImages[0]?.alt,src:imageSrc,loading:"lazy",decoding:"async",draggable:!1,crossOrigin:"anonymous"}):react.createElement(StyledImgPlaceHolder,null),$[0]=imageSrc,$[1]=product?.productImages,$[2]=t1):t1=$[2],t1}function DraggableProductImage(t0){const $=(0,dist.c)(9),{product,draggable}=t0,src=product?.productImages[0]?.url||"";let t1,t2,t3;return $[0]!==product?(t1=react.createElement(ProductImage,{product}),$[0]=product,$[1]=t1):t1=$[1],$[2]!==draggable||$[3]!==product||$[4]!==src?(t2=draggable&&src&&react.createElement(libraryMoveable.A,{type:"product",elementProps:{product},cloneElement:StyledImageClone,cloneProps:{loading:"lazy",decoding:"async",crossOrigin:"anonymous",src}}),$[2]=draggable,$[3]=product,$[4]=src,$[5]=t2):t2=$[5],$[6]!==t1||$[7]!==t2?(t3=react.createElement(ProductImageWrap,null,t1,t2),$[6]=t1,$[7]=t2,$[8]=t3):t3=$[8],t3}ProductImage.propTypes={product:prop_types_default().object.isRequired},DraggableProductImage.propTypes={product:prop_types_default().object.isRequired,draggable:prop_types_default().bool};const productImage=DraggableProductImage;var checkmark=__webpack_require__("./packages/design-system/src/icons/checkmark.svg"),cross=__webpack_require__("./packages/design-system/src/icons/cross.svg"),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),plus_filled=__webpack_require__("./packages/design-system/src/icons/plus_filled.svg"),button_constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),tooltip=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js"),noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts");const Checkmark=(0,styled_components_browser_esm.Ay)(checkmark.A).withConfig({displayName:"productButton__Checkmark",componentId:"sc-8ap58c-0"})(["width:16px !important;height:16px !important;border-radius:100%;color:",";background-color:",";"],(({theme})=>theme.colors.interactiveBg.disable),(({theme})=>theme.colors.fg.positive)),Cross=(0,styled_components_browser_esm.Ay)(cross.A).withConfig({displayName:"productButton__Cross",componentId:"sc-8ap58c-1"})(["width:16px !important;height:16px !important;border-radius:100%;color:",";background-color:",";"],(({theme})=>theme.colors.interactiveBg.disable),(({theme})=>theme.colors.fg.negative)),StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"productButton__StyledButton",componentId:"sc-8ap58c-2"})(["","{display:none;}&:hover ",",&:focus-within ",",&:active ","{display:none;}&:hover ",",&:focus-within ",",&:active ","{display:block;}"],Cross,Checkmark,Checkmark,Checkmark,Cross,Cross,Cross),StyledActionsContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"productButton__StyledActionsContainer",componentId:"sc-8ap58c-3"})(["margin-right:10px;"]),DISABLED_PRODUCT_TEXT=(0,sprintf.A)((0,i18n._n)("Only %d item can be added per page.","Only %d items can be added per page.",constants.Wk,"web-stories"),constants.Wk),DISABLED_PRODUCT_IMAGE_TEXT=(0,i18n.__)("Products without images cannot be added.","web-stories"),TooltipWrapper=t0=>{const $=(0,dist.c)(4),{hasImage,disabled,children}=t0;if(hasImage){if(disabled){let t1;return $[2]!==children?(t1=react.createElement(tooltip.A,{hasTail:!0,title:DISABLED_PRODUCT_TEXT},children),$[2]=children,$[3]=t1):t1=$[3],t1}return children}{let t1;return $[0]!==children?(t1=react.createElement(tooltip.A,{hasTail:!0,title:DISABLED_PRODUCT_IMAGE_TEXT},children),$[0]=children,$[1]=t1):t1=$[1],t1}};function ProductButton(t0){const $=(0,dist.c)(22),{product,onClick,onFocus,isOnPage,canAddMore}=t0;let t1;$[0]!==product?.productTitle?(t1=(0,sprintf.A)((0,i18n.__)("Add %s","web-stories"),product?.productTitle),$[0]=product?.productTitle,$[1]=t1):t1=$[1];const ADD_PRODUCT_TEXT=t1,hasImage=Boolean(product?.productImages?.length);let t2;$[2]!==product?.productTitle?(t2=(0,sprintf.A)((0,i18n.__)("Remove %s","web-stories"),product?.productTitle),$[2]=product?.productTitle,$[3]=t2):t2=$[3];const disabled=!isOnPage&&!canAddMore;let ariaLabel;ariaLabel=hasImage?isOnPage?t2:disabled?DISABLED_PRODUCT_TEXT:ADD_PRODUCT_TEXT:DISABLED_PRODUCT_IMAGE_TEXT;const t3=!hasImage||disabled;let t4,t5,t6,t7;return $[4]!==disabled||$[5]!==hasImage||$[6]!==isOnPage||$[7]!==onClick||$[8]!==product?(t4=hasImage&&!disabled?()=>{onClick(product,isOnPage)}:noop.l,$[4]=disabled,$[5]=hasImage,$[6]=isOnPage,$[7]=onClick,$[8]=product,$[9]=t4):t4=$[9],$[10]!==isOnPage?(t5=isOnPage?react.createElement(react.Fragment,null,react.createElement(Checkmark,null),react.createElement(Cross,null)):react.createElement(plus_filled.A,null),$[10]=isOnPage,$[11]=t5):t5=$[11],$[12]!==ariaLabel||$[13]!==onFocus||$[14]!==t3||$[15]!==t4||$[16]!==t5?(t6=react.createElement(StyledActionsContainer,null,react.createElement(StyledButton,{"aria-label":ariaLabel,"aria-disabled":t3,onClick:t4,type:button_constants.VQ.Tertiary,size:button_constants.Mp.Small,variant:button_constants.Ak.Square,onFocus},t5)),$[12]=ariaLabel,$[13]=onFocus,$[14]=t3,$[15]=t4,$[16]=t5,$[17]=t6):t6=$[17],$[18]!==disabled||$[19]!==hasImage||$[20]!==t6?(t7=react.createElement(TooltipWrapper,{hasImage,disabled},t6),$[18]=disabled,$[19]=hasImage,$[20]=t6,$[21]=t7):t7=$[21],t7}ProductButton.propTypes={product:prop_types_default().object.isRequired,onClick:prop_types_default().func,onFocus:prop_types_default().func,isOnPage:prop_types_default().bool,canAddMore:prop_types_default().bool};const productButton=ProductButton;var config=__webpack_require__("./packages/story-editor/src/app/config/index.ts");const StyledPrice=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.XSmall}).withConfig({displayName:"productPrice__StyledPrice",componentId:"sc-1b0ir4w-0"})(["color:",";"],(({theme})=>theme.colors.fg.tertiary));function ProductPrice(t0){const $=(0,dist.c)(6),{price,currency}=t0,{locale:t1}=(0,config.UK)(),{locale}=t1;if(price&&currency&&locale){let t2,t3;return $[0]!==currency||$[1]!==locale||$[2]!==price?(t2=new Intl.NumberFormat(locale,{style:"currency",currency}).format(price),$[0]=currency,$[1]=locale,$[2]=price,$[3]=t2):t2=$[3],$[4]!==t2?(t3=react.createElement(StyledPrice,null,t2),$[4]=t2,$[5]=t3):t3=$[5],t3}return null}ProductPrice.propTypes={price:prop_types_default().number,currency:prop_types_default().string};const productPrice=ProductPrice,StyledDescription=styled_components_browser_esm.Ay.div.withConfig({displayName:"product__StyledDescription",componentId:"sc-1bhc150-0"})(["padding-left:12px;"]),StyledTitle=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.Small}).withConfig({displayName:"product__StyledTitle",componentId:"sc-1bhc150-1"})(["color:",";"],(({theme})=>theme.colors.fg.primary));function Product(t0){const $=(0,dist.c)(21),{product,onClick,onFocus,isOnPage,canAddMore}=t0;let t1;$[0]!==canAddMore||$[1]!==isOnPage||$[2]!==onClick||$[3]!==onFocus||$[4]!==product?(t1=react.createElement(productButton,{product,isOnPage,canAddMore,onClick,onFocus}),$[0]=canAddMore,$[1]=isOnPage,$[2]=onClick,$[3]=onFocus,$[4]=product,$[5]=t1):t1=$[5];const t2=!isOnPage&&canAddMore;let t3;$[6]!==product||$[7]!==t2?(t3=react.createElement(productImage,{product,draggable:t2}),$[6]=product,$[7]=t2,$[8]=t3):t3=$[8];const t4=product?.productTitle;let t5;$[9]!==t4?(t5=react.createElement(StyledTitle,{isBold:!0},t4),$[9]=t4,$[10]=t5):t5=$[10];const t6=product?.productPrice,t7=product?.productPriceCurrency;let t8,t9,t10;return $[11]!==t6||$[12]!==t7?(t8=react.createElement(productPrice,{price:t6,currency:t7}),$[11]=t6,$[12]=t7,$[13]=t8):t8=$[13],$[14]!==t5||$[15]!==t8?(t9=react.createElement(StyledDescription,null,t5,t8),$[14]=t5,$[15]=t8,$[16]=t9):t9=$[16],$[17]!==t1||$[18]!==t3||$[19]!==t9?(t10=react.createElement(react.Fragment,null,t1,t3,t9),$[17]=t1,$[18]=t3,$[19]=t9,$[20]=t10):t10=$[20],t10}Product.propTypes={product:prop_types_default().object.isRequired,onClick:prop_types_default().func.isRequired,onFocus:prop_types_default().func,isOnPage:prop_types_default().bool,canAddMore:prop_types_default().bool};const shopping_product=Product,StyledListItem=styled_components_browser_esm.Ay.div.withConfig({displayName:"productList__StyledListItem",componentId:"sc-16x13t7-0"})(["display:flex;width:100%;padding:5px 0;align-items:center;border-bottom:1px solid ",";transition:background-color ease-in-out 300ms;"],(({theme})=>theme.colors.divider.tertiary));const productList=function ProductList({products=[],onPageProducts=[],onClick,isMenuFocused=!0}){const{handleListNav,currentRowsRef,setCurrentFocusIndex}=shopping_useProductNavigation({isMenuFocused,products});(0,src.vJ)((()=>{isMenuFocused||setCurrentFocusIndex(0)}),[isMenuFocused,setCurrentFocusIndex]);const canAddMore=onPageProducts.length<constants.Wk;return react.createElement("div",{"aria-label":(0,i18n.__)("Products list","web-stories"),role:"list",onKeyDown:handleListNav},products.map(((product,index_0)=>react.createElement(StyledListItem,{role:"listitem",key:product?.productId,tabIndex:-1,ref:el=>currentRowsRef.current[`row-${index_0}`]=el},react.createElement(shopping_product,{product,canAddMore,isOnPage:onPageProducts.some((item=>item.product.productId===product?.productId)),onClick,onFocus:evt_0=>{var evt,index;evt=evt_0,index=index_0,currentRowsRef.current[`row-${index}`]&&"focus"===evt.type&&setCurrentFocusIndex(index)}})))))}},"./packages/story-editor/src/components/mediaRecording/constants.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{By:()=>AUDIO_FILE_TYPE,FD:()=>PHOTO_FILE_TYPE,K_:()=>VIDEO_FILE_TYPE,O8:()=>SETTINGS_POPUP_ZINDEX,Ob:()=>MAX_RECORDING_DURATION_IN_SECONDS,R4:()=>VIDEO_EFFECTS,aj:()=>VIDEO_MIME_TYPE,dN:()=>AUDIO_MIME_TYPE,qO:()=>BACKGROUND_BLUR_PX,uG:()=>COUNTDOWN_TIME_IN_SECONDS,ub:()=>MAX_RECORDING_DURATION_IN_MINUTES,z$:()=>PHOTO_MIME_TYPE});const MAX_RECORDING_DURATION_IN_SECONDS=120,MAX_RECORDING_DURATION_IN_MINUTES=2,COUNTDOWN_TIME_IN_SECONDS=3,BACKGROUND_BLUR_PX=3,VIDEO_MIME_TYPE="video/mp4",VIDEO_FILE_TYPE="mp4",AUDIO_MIME_TYPE="audio/mpeg",AUDIO_FILE_TYPE="mp3",PHOTO_MIME_TYPE="image/jpeg",PHOTO_FILE_TYPE="jpeg",SETTINGS_POPUP_ZINDEX=11,VIDEO_EFFECTS={NONE:"none",BLUR:"blur"}},"./packages/story-editor/src/components/mediaRecording/context.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./packages/react/src/index.ts").q6)({state:{},actions:{}})},"./packages/story-editor/src/components/mediaRecording/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i$:()=>durationIndicator,wi:()=>footer,Iu:()=>mediaRecording,j0:()=>provider,bB:()=>settingsModal,be:()=>useMediaRecording.A});var useMediaRecording=__webpack_require__("./packages/story-editor/src/components/mediaRecording/useMediaRecording.js"),react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts");const countdown_Number=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({as:"div"}).withConfig({displayName:"countdown__Number",componentId:"sc-14vheov-0"})(["position:absolute;top:0;left:0;bottom:0;right:0;display:flex;align-items:center;justify-content:center;font-size:70px;font-weight:bold;color:",";"],(({theme})=>theme.colors.standard.white));function _temp(t0){const{state}=t0;return{countdown:state.countdown}}const countdown=function Countdown(){const $=(0,dist.c)(2),{countdown}=(0,useMediaRecording.A)(_temp);if(countdown>0){let t0;return $[0]!==countdown?(t0=react.createElement(countdown_Number,null,countdown),$[0]=countdown,$[1]=t0):t0=$[1],t0}return null};var polished_esm=__webpack_require__("./node_modules/polished/dist/polished.esm.js"),constants=__webpack_require__("./packages/story-editor/src/components/mediaRecording/constants.js");const ProgressIndicator=styled_components_browser_esm.Ay.progress.withConfig({displayName:"progressBar__ProgressIndicator",componentId:"sc-oxcipv-0"})(["appearance:none;border:none;width:100%;height:8px;position:absolute;top:0;left:0;right:0;background-color:",";border-top-left-radius:5px;border-top-right-radius:5px;&::-webkit-progress-bar{background-color:",";border-top-left-radius:5px;border-top-right-radius:5px;}&::-webkit-progress-value{background-color:",";border-top-left-radius:5px;}&::-moz-progress-bar{background-color:",";border-top-left-radius:5px;}"],(({theme})=>(0,polished_esm.B3)(theme.colors.fg.primary,.3)),(({theme})=>(0,polished_esm.B3)(theme.colors.fg.primary,.3)),(({theme})=>theme.colors.fg.primary),(({theme})=>theme.colors.fg.primary));function progressBar_temp(t0){const{state}=t0;return{duration:state.duration,isRecording:["recording","paused"].includes(state.status)}}const progressBar=function ProgressBar(){const $=(0,dist.c)(2),{duration,isRecording}=(0,useMediaRecording.A)(progressBar_temp);if(!isRecording)return null;let t0;return $[0]!==duration?(t0=react.createElement(ProgressIndicator,{value:duration,max:constants.Ob}),$[0]=duration,$[1]=t0):t0=$[1],t0};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js");var i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),src=__webpack_require__("./packages/react/src/index.ts"),useVideoTrim=__webpack_require__("./packages/story-editor/src/components/videoTrim/useVideoTrim.js"),noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),camera=__webpack_require__("./packages/design-system/src/icons/camera.svg"),gif=__webpack_require__("./packages/design-system/src/icons/gif.svg"),components_form=__webpack_require__("./packages/story-editor/src/components/form/index.js");const Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"videoMode__Wrapper",componentId:"sc-y6q7x7-0"})(["position:absolute;z-index:2;top:20px;right:20px;width:70px;"]),StyledSwitch=(0,styled_components_browser_esm.Ay)(components_form.dO).withConfig({displayName:"videoMode__StyledSwitch",componentId:"sc-y6q7x7-1"})(["background:",";"],(({theme})=>theme.colors.bg.tertiary)),CameraIcon=(0,styled_components_browser_esm.Ay)(camera.A).attrs({title:(0,i18n.__)("Use as video","web-stories")}).withConfig({displayName:"videoMode__CameraIcon",componentId:"sc-y6q7x7-2"})(["flex:1;"]),GifIcon=(0,styled_components_browser_esm.Ay)(gif.A).attrs({title:(0,i18n.__)("Use as GIF","web-stories")}).withConfig({displayName:"videoMode__GifIcon",componentId:"sc-y6q7x7-3"})(["flex:1;"]);function VideoMode(t0){const $=(0,dist.c)(6),{value,onChange}=t0;let t1,t2,t3,t4;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Video Mode","web-stories"),$[0]=t1):t1=$[0],$[1]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(CameraIcon,null),t3=react.createElement(GifIcon,null),$[1]=t2,$[2]=t3):(t2=$[1],t3=$[2]),$[3]!==onChange||$[4]!==value?(t4=react.createElement(Wrapper,null,react.createElement(StyledSwitch,{groupLabel:t1,name:"video-mode-switch",value,onLabel:t2,offLabel:t3,onChange})),$[3]=onChange,$[4]=value,$[5]=t4):t4=$[5],t4}VideoMode.propTypes={value:prop_types_default().bool.isRequired,onChange:prop_types_default().func.isRequired};const videoMode=VideoMode;var play_filled=__webpack_require__("./packages/design-system/src/icons/play_filled.svg"),stop_filled=__webpack_require__("./packages/design-system/src/icons/stop_filled.svg"),keyboard=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx"),config=__webpack_require__("./packages/story-editor/src/app/config/index.ts");const Controls=styled_components_browser_esm.Ay.div.withConfig({displayName:"playPauseButton__Controls",componentId:"sc-bvqqpx-0"})(["position:absolute;z-index:2;"]),ButtonWrapper=styled_components_browser_esm.Ay.button.attrs({tabIndex:-1}).withConfig({displayName:"playPauseButton__ButtonWrapper",componentId:"sc-bvqqpx-1"})(["cursor:pointer;pointer-events:initial;width:","px;height:","px;overflow:hidden;background:transparent;border:none;padding:0;"],82,82),iconCss=(0,styled_components_browser_esm.AH)(["width:","px;height:","px;color:",";filter:drop-shadow( 0px 0px 10px "," );"],72,72,(({theme})=>theme.colors.standard.white),(({theme})=>(0,polished_esm.B3)(theme.colors.bg.primary,.4))),Play=(0,styled_components_browser_esm.Ay)(play_filled.A).withConfig({displayName:"playPauseButton__Play",componentId:"sc-bvqqpx-2"})(["",";"],iconCss),Pause=(0,styled_components_browser_esm.Ay)(stop_filled.A).withConfig({displayName:"playPauseButton__Pause",componentId:"sc-bvqqpx-3"})(["",";"],iconCss);function PlayPauseButton(t0){const $=(0,dist.c)(29),{videoRef}=t0,{isRTL}=(0,config.UK)(),[showControls,setShowControls]=(0,src.J0)(!0),[isPlaying,setIsPlaying]=(0,src.J0)(!0);let t1,t2,t3,t4,t5;$[0]!==setIsPlaying||$[1]!==videoRef?.current?(t1=()=>{const videoNode=videoRef?.current,onVideoEnd=()=>{videoNode&&(videoNode.currentTime=0),setIsPlaying(!1)};return videoNode?.addEventListener("ended",onVideoEnd),()=>videoNode?.removeEventListener("ended",onVideoEnd)},$[0]=setIsPlaying,$[1]=videoRef?.current,$[2]=t1):t1=$[2],$[3]!==videoRef?(t2=[videoRef],$[3]=videoRef,$[4]=t2):t2=$[4],(0,src.vJ)(t1,t2),$[5]!==setIsPlaying||$[6]!==videoRef?.current?(t3=()=>{const videoNode_0=videoRef?.current;if(!videoNode_0)return;const onVideoPlay=()=>setIsPlaying(!0),onVideoPause=()=>setIsPlaying(!1),onTimeUpdate=t4=>{const{target:t5}=t4,{paused}=t5;return setIsPlaying(!paused)};return videoNode_0.addEventListener("play",onVideoPlay),videoNode_0.addEventListener("pause",onVideoPause),videoNode_0.addEventListener("timeupdate",onTimeUpdate),()=>{videoNode_0.removeEventListener("play",onVideoPlay),videoNode_0.removeEventListener("pause",onVideoPause),videoNode_0.removeEventListener("timeupdate",onTimeUpdate)}},$[5]=setIsPlaying,$[6]=videoRef?.current,$[7]=t3):t3=$[7],$[8]!==videoRef?(t4=[videoRef],$[8]=videoRef,$[9]=t4):t4=$[9],(0,src.vJ)(t3,t4),$[10]!==isPlaying||$[11]!==setShowControls||$[12]!==videoRef?.current?(t5=evt=>{evt.stopPropagation();const videoNode_1=videoRef?.current;videoNode_1&&(isPlaying?(videoNode_1.pause(),setShowControls(!0)):videoNode_1.play().catch(noop.l))},$[10]=isPlaying,$[11]=setShowControls,$[12]=videoRef?.current,$[13]=t5):t5=$[13];const handlePlayPause=t5;let t6,t7;$[14]===Symbol.for("react.memo_cache_sentinel")?(t6={key:["space"]},$[14]=t6):t6=$[14],$[15]!==handlePlayPause?(t7=[handlePlayPause],$[15]=handlePlayPause,$[16]=t7):t7=$[16],(0,keyboard._h)(videoRef,t6,handlePlayPause,t7);const nodeRef=(0,src.li)();let t8;$[17]!==isPlaying?(t8=isPlaying?(0,i18n.__)("Click to pause","web-stories"):(0,i18n.__)("Click to play","web-stories"),$[17]=isPlaying,$[18]=t8):t8=$[18];const buttonLabel=t8,Icon=isPlaying?Pause:Play;let t9,t10;return $[19]!==Icon||$[20]!==buttonLabel||$[21]!==handlePlayPause||$[22]!==isPlaying||$[23]!==isRTL||$[24]!==nodeRef||$[25]!==showControls?(t9=showControls&&react.createElement(ButtonWrapper,{ref:nodeRef,"aria-label":buttonLabel,"aria-pressed":isPlaying,key:"wrapper",onClick:handlePlayPause},react.createElement(Icon,{$isRTL:isRTL})),$[19]=Icon,$[20]=buttonLabel,$[21]=handlePlayPause,$[22]=isPlaying,$[23]=isRTL,$[24]=nodeRef,$[25]=showControls,$[26]=t9):t9=$[26],$[27]!==t9?(t10=react.createElement(Controls,null,t9),$[27]=t9,$[28]=t10):t10=$[28],t10}PlayPauseButton.propTypes={videoRef:prop_types_default().object};const playPauseButton=PlayPauseButton;var types=__webpack_require__("./packages/design-system/src/theme/types.ts");const MessageWrap=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaRecording__MessageWrap",componentId:"sc-tmkrsc-0"})(["display:flex;flex-direction:column;align-items:center;align-content:center;padding:20px;height:100%;justify-content:center;text-align:center;user-select:text;"]),MessageHeading=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.XLarge}).withConfig({displayName:"mediaRecording__MessageHeading",componentId:"sc-tmkrsc-1"})(["margin:0 0 14px;"]),MessageText=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.Small}).withConfig({displayName:"mediaRecording__MessageText",componentId:"sc-tmkrsc-2"})(["margin:0 0 14px;"]),components_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaRecording__Wrapper",componentId:"sc-tmkrsc-3"})(["background-color:",";border-radius:5px;position:absolute;transform:translateZ(0);top:0;left:0;bottom:0;right:0;cursor:default;"],(({theme})=>theme.colors.standard.white)),VideoWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaRecording__VideoWrapper",componentId:"sc-tmkrsc-4"})(["width:100%;height:100%;background:#000;margin:0 auto;display:flex;align-items:center;justify-content:center;overflow:hidden;"]),Photo=styled_components_browser_esm.Ay.img.withConfig({displayName:"mediaRecording__Photo",componentId:"sc-tmkrsc-5"})(["display:block;width:100%;height:100%;object-fit:cover;border-radius:5px;"]),Video=styled_components_browser_esm.Ay.video.attrs({autoPlay:!0,disablePictureInPicture:!0}).withConfig({displayName:"mediaRecording__Video",componentId:"sc-tmkrsc-6"})(["display:block;position:absolute;z-index:1;width:100%;height:100%;object-fit:cover;border-radius:5px;",";"],(({$isProcessing})=>$isProcessing&&"filter: blur(5px)")),Canvas=styled_components_browser_esm.Ay.canvas.withConfig({displayName:"mediaRecording__Canvas",componentId:"sc-tmkrsc-7"})(["display:block;position:absolute;z-index:2;width:100%;height:100%;object-fit:cover;border-radius:5px;",";"],(({$isProcessing})=>$isProcessing&&"filter: blur(5px)")),AudioWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"audio__AudioWrapper",componentId:"sc-yvjjwu-0"})(["background:",";border-radius:5px;width:100%;height:100%;"],(({theme})=>theme.colors.bg.secondary));function Audio(t0){const $=(0,dist.c)(2),{liveStream}=t0;let t1;return $[0]!==liveStream?(t1=react.createElement(AudioWrapper,null,react.createElement(AudioAnalyser,{source:liveStream})),$[0]=liveStream,$[1]=t1):t1=$[1],t1}Audio.propTypes={liveStream:prop_types_default().object};const AudioAnalyser=({source})=>{const[data,setData]=(0,src.J0)([]),raf=(0,src.li)(),audioContextRef=(0,src.li)(),analyserRef=(0,src.li)(),prevRafTime=(0,src.li)();return analyserRef.current||(audioContextRef.current=new window.AudioContext,analyserRef.current=audioContextRef.current.createAnalyser()),(0,src.vJ)((()=>{if(0===source.getAudioTracks().length)return noop.l;const audioNode=audioContextRef.current.createMediaStreamSource(source);audioNode.connect(analyserRef.current);const tick=time=>{if(void 0!==prevRafTime.current){const dataArray=new Uint8Array(analyserRef.current.frequencyBinCount);analyserRef.current.getByteTimeDomainData(dataArray),setData(dataArray)}prevRafTime.current=time,raf.current=requestAnimationFrame(tick)};return raf.current=requestAnimationFrame(tick),()=>{cancelAnimationFrame(raf.current),analyserRef.current.disconnect(),audioNode.disconnect()}}),[source]),react.createElement(AudioVisualiser,{data})},AudioVisualiser=({data})=>{const ref=(0,src.li)(),canvas=ref.current;if(canvas){canvas.style.width="100%",canvas.style.height="100%",canvas.width=canvas.offsetWidth,canvas.height=canvas.offsetHeight;const height=canvas.height,width=canvas.width,context=canvas.getContext("2d"),sliceWidth=Number(width)/data.length;context.lineWidth=2,context.strokeStyle="#FFF",context.clearRect(0,0,width,height),context.beginPath(),context.moveTo(0,height/2);let x=0;for(const item of data){const y=item/255*height;context.lineTo(x,y),x+=sliceWidth}context.lineTo(x,height/2),context.stroke()}return react.createElement("canvas",{ref})},audio=Audio,mediaRecording_blur=(context,amount)=>{if(amount<=0)return context;const{height,width}=context.canvas,imageData=context.getImageData(0,0,width,height),{data}=imageData,wm=width-1,hm=height-1,rad1=amount+1,mulSum=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1][amount],shgSum=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18][amount],r=[],g=[],b=[],a=[],vmin=[],vmax=[];let p,p1,p2,pa,iterations=3;for(;iterations-- >0;){let yw=0,yi=0;for(let y=0;y<height;y++){let rsum=data[yw]*rad1,gsum=data[yw+1]*rad1,bsum=data[yw+2]*rad1,asum=data[yw+3]*rad1;for(let i=1;i<=amount;i++)p=yw+((i>wm?wm:i)<<2),rsum+=data[p++],gsum+=data[p++],bsum+=data[p++],asum+=data[p];for(let x=0;x<width;x++)r[yi]=rsum,g[yi]=gsum,b[yi]=bsum,a[yi]=asum,0===y&&(vmin[x]=((p=x+rad1)<wm?p:wm)<<2,vmax[x]=(p=x-amount)>0?p<<2:0),p1=yw+vmin[x],p2=yw+vmax[x],rsum+=data[p1++]-data[p2++],gsum+=data[p1++]-data[p2++],bsum+=data[p1++]-data[p2++],asum+=data[p1]-data[p2],yi++;yw+=width<<2}for(let x=0;x<width;x++){let yp=x,rsum=r[yp]*rad1,gsum=g[yp]*rad1,bsum=b[yp]*rad1,asum=a[yp]*rad1;for(let i=1;i<=amount;i++)yp+=i>hm?0:width,rsum+=r[yp],gsum+=g[yp],bsum+=b[yp],asum+=a[yp];yi=x<<2;for(let y=0;y<height;y++)data[yi+3]=pa=asum*mulSum>>>shgSum,pa>0?(pa=255/pa,data[yi]=(rsum*mulSum>>>shgSum)*pa,data[yi+1]=(gsum*mulSum>>>shgSum)*pa,data[yi+2]=(bsum*mulSum>>>shgSum)*pa):data[yi]=data[yi+1]=data[yi+2]=0,0===x&&(vmin[y]=((p=y+rad1)<hm?p:hm)*width,vmax[y]=(p=y-amount)>0?p*width:0),p1=x+vmin[y],p2=x+vmax[y],rsum+=r[p1]-r[p2],gsum+=g[p1]-g[p2],bsum+=b[p1]-b[p2],asum+=a[p1]-a[p2],yi+=width<<2}}return context.putImageData(imageData,0,0),context};const playbackMedia=function PlaybackMedia(){const{mediaBlob,mediaBlobUrl,originalMediaBlobUrl,liveStream,hasVideo,hasAudio,videoEffect,isGif,isImageCapture,isAdjustingTrim,toggleIsGif,streamNode,setStreamNode,isProcessingTrim,setCanvasStream,setCanvasNode}=(0,useMediaRecording.A)((({state,actions})=>({mediaBlob:state.mediaBlob,mediaBlobUrl:state.mediaBlobUrl,originalMediaBlobUrl:state.originalMediaBlobUrl,liveStream:state.liveStream,hasVideo:state.hasVideo,hasAudio:state.hasAudio,videoEffect:state.videoEffect,isGif:state.isGif,streamNode:state.streamNode,isImageCapture:Boolean(state.file?.type?.startsWith("image")),isAdjustingTrim:state.isAdjustingTrim,toggleIsGif:actions.toggleIsGif,setStreamNode:actions.setStreamNode,isProcessingTrim:state.isProcessingTrim,setCanvasStream:actions.setCanvasStream,setCanvasNode:actions.setCanvasNode}))),setVideoNode=(0,useVideoTrim.A)((({actions:{setVideoNode}})=>setVideoNode)),isMuted=!hasAudio||isGif,hasVideoEffect=videoEffect&&videoEffect!==constants.R4.NONE,onToggleVideoMode=(0,src.hb)((()=>{toggleIsGif(),videoRef.current&&videoRef.current.play().catch(noop.l)}),[toggleIsGif]),rafRef=(0,src.li)(),canvasRef=(0,src.li)(),videoRef=(0,src.li)(),updateVideoNode=(0,src.hb)((node=>{setVideoNode(node),videoRef.current=node}),[setVideoNode]),selfieSegmentation=(0,src.li)(),onSelfieSegmentationResults=results=>{const canvas=canvasRef.current;if(!canvas||!results.image||0===results.image.width)return;const context=canvasRef.current.getContext("2d"),canvasBlur="filter"in CanvasRenderingContext2D.prototype;context.save(),canvasBlur?(context.globalCompositeOperation="copy",context.filter=`blur(${constants.qO}px)`,context.drawImage(results.segmentationMask,0,0,canvas.width,canvas.height),context.globalCompositeOperation="source-in",context.filter="none",context.drawImage(results.image,0,0,canvas.width,canvas.height),context.globalCompositeOperation="destination-over",context.filter=`blur(${constants.qO}px)`,context.drawImage(results.image,0,0,canvas.width,canvas.height)):(context.drawImage(results.image,0,0,canvas.width,canvas.height),mediaRecording_blur(context,constants.qO),context.globalCompositeOperation="destination-out",context.drawImage(results.segmentationMask,0,0,canvas.width,canvas.height),context.globalCompositeOperation="destination-over",context.drawImage(results.image,0,0,canvas.width,canvas.height)),context.restore()};(0,src.vJ)((()=>{hasVideoEffect&&!selfieSegmentation.current&&(async()=>{const{SelfieSegmentation}=await __webpack_require__.e(8886).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@mediapipe/selfie_segmentation/selfie_segmentation.js",23));selfieSegmentation.current=new SelfieSegmentation({locateFile:file=>`https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${file}`}),selfieSegmentation.current.setOptions({modelSelection:1}),await selfieSegmentation.current.initialize()})()}),[hasVideoEffect]),(0,src.vJ)((()=>{!async function run(){if(hasVideoEffect&&canvasRef.current){canvasRef.current.getContext("2d"),setCanvasNode(canvasRef.current);const canvasStreamRaw=canvasRef.current.captureStream(),liveStreamAudio=liveStream.getAudioTracks();liveStreamAudio.length>0&&canvasStreamRaw.addTrack(liveStreamAudio[0]),setCanvasStream(canvasStreamRaw)}if(videoEffect===constants.R4.BLUR&&selfieSegmentation.current){selfieSegmentation.current.onResults(onSelfieSegmentationResults);const sendFrame=async()=>{if(streamNode&&streamNode.videoWidth&&canvasRef.current)try{await selfieSegmentation.current.send({image:streamNode})}catch{}canvasRef.current&&(rafRef.current=requestAnimationFrame(sendFrame))};streamNode&&hasVideoEffect&&await sendFrame()}}()}),[videoEffect,hasVideoEffect,streamNode,setCanvasStream,setCanvasNode]);const hasPlayButton=!isGif&&!isProcessingTrim||isAdjustingTrim,mediaSrc=isAdjustingTrim?originalMediaBlobUrl:mediaBlobUrl,hasVideoModeSwitch=mediaBlobUrl&&hasVideo&&!isAdjustingTrim&&!isProcessingTrim;return(0,src.vJ)((()=>(mediaBlobUrl&&rafRef.current&&cancelAnimationFrame(rafRef.current),()=>{rafRef.current&&cancelAnimationFrame(rafRef.current)})),[mediaBlobUrl]),isImageCapture?react.createElement(VideoWrapper,null,react.createElement(Photo,{decoding:"async",src:mediaBlobUrl,alt:(0,i18n.__)("Image capture","web-stories")})):react.createElement(react.Fragment,null,hasVideoModeSwitch&&react.createElement(videoMode,{value:!isGif,onChange:onToggleVideoMode}),react.createElement(VideoWrapper,null,mediaBlobUrl&&(hasVideo?react.createElement(react.Fragment,null,react.createElement(Video,{ref:updateVideoNode,src:mediaSrc,muted:isMuted,loop:isGif||isAdjustingTrim,$isProcessing:isProcessingTrim,tabIndex:0}),hasPlayButton&&react.createElement(playPauseButton,{videoRef})):react.createElement("audio",{controls:"controls",src:mediaBlobUrl})),!mediaBlob&&!mediaBlobUrl&&liveStream&&(hasVideo?react.createElement(react.Fragment,null,react.createElement(Video,{ref:setStreamNode,muted:!0,onLoadedMetadata:()=>{canvasRef.current&&(canvasRef.current.width=streamNode.videoWidth,canvasRef.current.height=streamNode.videoHeight)}}),hasVideoEffect&&react.createElement(Canvas,{ref:canvasRef,width:640,height:480})):react.createElement(audio,{liveStream}))))};var theme=__webpack_require__("./packages/design-system/src/theme/theme.ts"),colors=__webpack_require__("./packages/design-system/src/theme/colors.ts"),exclamation_triangle=__webpack_require__("./packages/design-system/src/icons/exclamation_triangle.svg"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts");const StyledHeading=(0,styled_components_browser_esm.Ay)(MessageHeading).withConfig({displayName:"errorDialog__StyledHeading",componentId:"sc-mbe9k2-0"})(["display:flex;align-items:center;"]);function ErrorMessage(t0){const $=(0,dist.c)(10),{error,hasVideo}=t0;let t1,t2,t3,t4,t5,errorMessage=error?.message;if(window.isSecureContext){if("NotAllowedError"===error?.name){let t1;$[1]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Permission denied","web-stories"),$[1]=t1):t1=$[1],errorMessage=t1}else if(!hasVideo||"NotFoundError"===error?.name||"OverConstrainedError"===error?.name){let t1;$[2]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("No camera found","web-stories"),$[2]=t1):t1=$[2],errorMessage=t1}}else{let t1;$[0]===Symbol.for("react.memo_cache_sentinel")?(t1=(0,i18n.__)("Requires a secure browsing context (HTTPS)","web-stories"),$[0]=t1):t1=$[0],errorMessage=t1}return $[3]===Symbol.for("react.memo_cache_sentinel")?(t1={...theme.w,colors:colors.B},$[3]=t1):t1=$[3],$[4]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(StyledHeading,null,react.createElement(exclamation_triangle.A,{size:32,height:32,"aria-hidden":!0}),(0,i18n.__)("Error","web-stories")),$[4]=t2):t2=$[4],$[5]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(MessageText,null,(0,i18n.__)("Could not initialize recording.","web-stories")),$[5]=t3):t3=$[5],$[6]!==errorMessage?(t4=errorMessage&&react.createElement(MessageText,null,(0,sprintf.A)((0,i18n.__)("Reason: %s","web-stories"),errorMessage)),$[6]=errorMessage,$[7]=t4):t4=$[7],$[8]!==t4?(t5=react.createElement(MessageWrap,null,react.createElement(styled_components_browser_esm.NP,{theme:t1},t2,t3,t4)),$[8]=t4,$[9]=t5):t5=$[9],t5}function errorDialog_temp(t0){const{state}=t0;return{error:state.error,hasVideo:Boolean(state.videoInput)}}ErrorMessage.propTypes={error:prop_types_default().shape({name:prop_types_default().string,message:prop_types_default().string}),hasVideo:prop_types_default().bool.isRequired};const errorDialog=function ErrorDialog(){const $=(0,dist.c)(3),{error,hasVideo}=(0,useMediaRecording.A)(errorDialog_temp);let t0;return $[0]!==error||$[1]!==hasVideo?(t0=react.createElement(components_Wrapper,null,react.createElement(ErrorMessage,{error,hasVideo})),$[0]=error,$[1]=hasVideo,$[2]=t0):t0=$[2],t0};const permissionsDialog=function PermissionsDialog(){const $=(0,dist.c)(3);let t0,t1,t2;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0={...theme.w,colors:colors.B},$[0]=t0):t0=$[0],$[1]===Symbol.for("react.memo_cache_sentinel")?(t1=react.createElement(MessageHeading,null,(0,i18n.__)("Media Recording","web-stories")),$[1]=t1):t1=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(components_Wrapper,null,react.createElement(MessageWrap,null,react.createElement(styled_components_browser_esm.NP,{theme:t0},t1,react.createElement(MessageText,null,(0,i18n.__)("To get started, you need to allow access to your camera and microphone.","web-stories"))))),$[2]=t2):t2=$[2],t2};var useLiveRegion=__webpack_require__("./packages/design-system/src/utils/useLiveRegion.ts"),loadingSpinner=__webpack_require__("./packages/design-system/src/components/loadingSpinner/loadingSpinner.tsx");const processingOverlay_Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"processingOverlay__Wrapper",componentId:"sc-ksu3mm-0"})(["position:absolute;left:0;top:0;height:100%;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;background-color:rgba(0 0 0 / 0.5);gap:2em;padding:3em;"]);const processingOverlay=function ProcessingOverlay(){const $=(0,dist.c)(5),speak=(0,useLiveRegion.A)();let t0,t1,t2,t3;return $[0]!==speak?(t0=()=>{speak((0,i18n.__)("Video trimming in progress. Please wait up to a few minutes depending on output video length.","web-stories"))},t1=[speak],$[0]=speak,$[1]=t0,$[2]=t1):(t0=$[1],t1=$[2]),(0,src.vJ)(t0,t1),$[3]===Symbol.for("react.memo_cache_sentinel")?(t2=react.createElement(loadingSpinner.A,null),$[3]=t2):t2=$[3],$[4]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(processingOverlay_Wrapper,null,t2,react.createElement(typography_text.E.Paragraph,null,(0,i18n.__)("Video trimming in progress. Please wait up to a few minutes depending on output video length.","web-stories"))),$[4]=t3):t3=$[4],t3};function mediaRecording_temp(t0){const{state}=t0;return{status:state.status,error:state.error,needsPermissions:("idle"===state.status||"acquiring_media"===state.status)&&!state.videoInput,isProcessingTrim:state.isProcessingTrim}}const mediaRecording=function MediaRecording(){const $=(0,dist.c)(11),{status,error,needsPermissions,isProcessingTrim}=(0,useMediaRecording.A)(mediaRecording_temp);if("failed"===status||Boolean(error)){let t0;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(errorDialog,null),$[0]=t0):t0=$[0],t0}if(needsPermissions){let t0;return $[1]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(permissionsDialog,null),$[1]=t0):t0=$[1],t0}let t0,t1,t2,t3,t4,t5;return $[2]===Symbol.for("react.memo_cache_sentinel")?(t0=react.createElement(playbackMedia,null),$[2]=t0):t0=$[2],$[3]!==isProcessingTrim?(t1=isProcessingTrim&&react.createElement(processingOverlay,null),$[3]=isProcessingTrim,$[4]=t1):t1=$[4],$[5]!==t1?(t2=react.createElement(components_Wrapper,null,t0,t1),$[5]=t1,$[6]=t2):t2=$[6],$[7]===Symbol.for("react.memo_cache_sentinel")?(t3=react.createElement(progressBar,null),t4=react.createElement(countdown,null),$[7]=t3,$[8]=t4):(t3=$[7],t4=$[8]),$[9]!==t2?(t5=react.createElement(react.Fragment,null,t2,t3,t4),$[9]=t2,$[10]=t5):t5=$[10],t5};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");var use_media_recorder=__webpack_require__("./node_modules/@wmik/use-media-recorder/index.js"),use_media_recorder_default=__webpack_require__.n(use_media_recorder),localStore=__webpack_require__("./packages/design-system/src/utils/localStore.ts"),useSnackbar=__webpack_require__("./packages/design-system/src/contexts/snackbar/useSnackbar.ts"),blobToFile=__webpack_require__("./packages/media/src/blobToFile.ts"),src_blob=__webpack_require__("./packages/media/src/blob.ts"),date_src=__webpack_require__("./packages/date/src/index.ts"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),context=__webpack_require__("./packages/story-editor/src/components/mediaRecording/context.js"),formatMsToHMS=__webpack_require__("./packages/media/src/formatMsToHMS.ts"),useFFmpeg=__webpack_require__("./packages/story-editor/src/app/media/utils/useFFmpeg.ts");const mediaRecording_useTrim=function useTrim({setDuration,onTrimmed,file,isRecording}){const[trimData,setTrimData]=(0,src.J0)({start:0,end:null}),[isAdjustingTrim,setIsAdjustingTrim]=(0,src.J0)(!1),[isProcessingTrim,setIsProcessingTrim]=(0,src.J0)(!1),{trimVideo}=(0,useFFmpeg.A)(),hasCancelledTrimRef=(0,src.li)(),onTrim=(0,src.hb)((async newTrimData=>{if(setIsAdjustingTrim(!1),newTrimData){hasCancelledTrimRef.current=!1,setIsProcessingTrim(!0);const start=(0,formatMsToHMS.A)(newTrimData.start),end=(0,formatMsToHMS.A)(newTrimData.end),result=await trimVideo(file,start,end);if(hasCancelledTrimRef.current)return;setTrimData(newTrimData),setIsProcessingTrim(!1),onTrimmed(result),setDuration(newTrimData.end-newTrimData.start)}}),[file,onTrimmed,setDuration,trimVideo]),startTrim=(0,src.hb)((()=>setIsAdjustingTrim(!0)),[]),resetTrim=(0,src.hb)((()=>{setIsAdjustingTrim(!1),setTrimData({start:0,end:null})}),[]),cancelTrim=(0,src.hb)((()=>{hasCancelledTrimRef.current=!0,setIsProcessingTrim(!1)}),[]);return(0,src.vJ)((()=>{isRecording&&resetTrim()}),[isRecording,resetTrim]),{trimData,isAdjustingTrim,isProcessingTrim,onTrim,startTrim,resetTrim,cancelTrim}};function MediaRecordingProvider(t0){const $=(0,dist.c)(256),{children}=t0,[isInRecordingMode,setIsInRecordingMode]=(0,src.J0)(!1),[isSettingsOpen,setIsSettingsOpen]=(0,src.J0)(!1),[isProcessing,setIsProcessing]=(0,src.J0)(!1),[streamNode,setStreamNode]=(0,src.J0)(null),[canvasStream,setCanvasStream]=(0,src.J0)(null),[canvasNode,setCanvasNode]=(0,src.J0)(null),[countdown,setCountdown]=(0,src.J0)(0),[duration,setDuration]=(0,src.J0)(0),[isGif,setIsGif]=(0,src.J0)(!1),[hasVideo,setHasVideo]=(0,src.J0)(!0),[hasAudio,setHasAudio]=(0,src.J0)(!0);let t1;$[0]===Symbol.for("react.memo_cache_sentinel")?(t1=localStore.x.getItemByKey(localStore.$.MEDIA_RECORDING_VIDEO_INPUT),$[0]=t1):t1=$[0];const[videoInput,setVideoInput]=(0,src.J0)(t1);let t2;$[1]===Symbol.for("react.memo_cache_sentinel")?(t2=localStore.x.getItemByKey(localStore.$.MEDIA_RECORDING_AUDIO_INPUT),$[1]=t2):t2=$[1];const[audioInput,setAudioInput]=(0,src.J0)(t2);let t3;$[2]===Symbol.for("react.memo_cache_sentinel")?(t3=localStore.x.getItemByKey(localStore.$.MEDIA_RECORDING_VIDEO_EFFECT),$[2]=t3):t3=$[2];const[videoEffect,setVideoEffect]=(0,src.J0)(t3);let t4;$[3]===Symbol.for("react.memo_cache_sentinel")?(t4=[],$[3]=t4):t4=$[3];const[mediaDevices,setMediaDevices]=(0,src.J0)(t4),[file,setFile]=(0,src.J0)(null),[originalFile,setOriginalFile]=(0,src.J0)(null);let t5,t6;$[4]!==audioInput||$[5]!==mediaDevices||$[6]!==setAudioInput||$[7]!==setVideoInput||$[8]!==videoInput?(t5=()=>{mediaDevices.length&&(setVideoInput(mediaDevices.find((device_0=>device_0.deviceId===videoInput))?.deviceId||mediaDevices.find(provider_temp)?.deviceId),setAudioInput(mediaDevices.find((device_2=>device_2.deviceId===audioInput))?.deviceId||mediaDevices.find(_temp2)?.deviceId))},$[4]=audioInput,$[5]=mediaDevices,$[6]=setAudioInput,$[7]=setVideoInput,$[8]=videoInput,$[9]=t5):t5=$[9],$[10]!==audioInput||$[11]!==mediaDevices||$[12]!==videoInput?(t6=[audioInput,mediaDevices,videoInput],$[10]=audioInput,$[11]=mediaDevices,$[12]=videoInput,$[13]=t6):t6=$[13],(0,src.vJ)(t5,t6);const[mediaBlobUrl,setMediaBlobUrl]=(0,src.J0)(),[originalMediaBlobUrl,setOriginalMediaBlobUrl]=(0,src.J0)(),{showSnackbar}=(0,useSnackbar.d)();let t7,t8;$[14]!==hasVideo||$[15]!==setFile||$[16]!==setMediaBlobUrl||$[17]!==setOriginalFile||$[18]!==setOriginalMediaBlobUrl||$[19]!==showSnackbar?(t7=blob=>{try{const recordedBlob=(0,src_blob.gO)(blob);setOriginalMediaBlobUrl(recordedBlob),setMediaBlobUrl(recordedBlob);const recordedFile=function createFile(blob,hasVideo){const FILE_TYPE=hasVideo?constants.K_:constants.By,MIME_TYPE=hasVideo?constants.aj:constants.dN,captureType=hasVideo?"webcam":"audio";return(0,blobToFile.A)(blob,`${captureType}-capture-${(0,date_src.GP)(new Date,"Y-m-d-H-i")}.${FILE_TYPE}`,MIME_TYPE)}(blob,hasVideo);setOriginalFile(recordedFile),setFile(recordedFile)}catch(t8){const e=t8;(0,tracking_src.Oz)("media_recording_capture",e.message),showSnackbar({message:(0,i18n.__)("There was an error recording a video. Please try again.","web-stories"),dismissable:!0})}},$[14]=hasVideo,$[15]=setFile,$[16]=setMediaBlobUrl,$[17]=setOriginalFile,$[18]=setOriginalMediaBlobUrl,$[19]=showSnackbar,$[20]=t7):t7=$[20],$[21]!==hasVideo||$[22]!==showSnackbar?(t8=[showSnackbar,hasVideo],$[21]=hasVideo,$[22]=showSnackbar,$[23]=t8):t8=$[23];const onStop=(0,src.hb)(t7,t8);let t9,t10,t11,t12;$[24]!==audioInput||$[25]!==hasAudio?(t9=!!hasAudio&&(!audioInput||{deviceId:audioInput}),$[24]=audioInput,$[25]=hasAudio,$[26]=t9):t9=$[26],$[27]!==hasVideo||$[28]!==videoInput?(t10=!!hasVideo&&(!videoInput||{deviceId:videoInput}),$[27]=hasVideo,$[28]=videoInput,$[29]=t10):t10=$[29],$[30]!==t10||$[31]!==t9?(t11={audio:t9,video:t10},$[30]=t10,$[31]=t9,$[32]=t11):t11=$[32],$[33]!==onStop||$[34]!==t11?(t12={recordScreen:!1,mediaStreamConstraints:t11,onStop},$[33]=onStop,$[34]=t11,$[35]=t12):t12=$[35];const mediaRecorder=use_media_recorder_default()(t12);let t13;$[36]!==canvasStream||$[37]!==onStop?(t13={recordScreen:!1,customMediaStream:canvasStream,onStop},$[36]=canvasStream,$[37]=onStop,$[38]=t13):t13=$[38];const canvasRecorder=use_media_recorder_default()(t13);let t14;$[39]!==canvasRecorder||$[40]!==hasVideo||$[41]!==mediaRecorder||$[42]!==videoEffect?(t14=videoEffect&&"none"!==videoEffect&&hasVideo?{...mediaRecorder,inputStatus:mediaRecorder.status,status:canvasRecorder.status,startRecording:canvasRecorder.startRecording,pauseRecording:canvasRecorder.pauseRecording,resumeRecording:canvasRecorder.resumeRecording,stopRecording:canvasRecorder.stopRecording,mediaBlob:canvasRecorder.mediaBlob,clearMediaBlob:canvasRecorder.clearMediaBlob,getMediaStream:async()=>{canvasRecorder.clearMediaStream(),await mediaRecorder.getMediaStream()}}:{...mediaRecorder,inputStatus:mediaRecorder.status},$[39]=canvasRecorder,$[40]=hasVideo,$[41]=mediaRecorder,$[42]=videoEffect,$[43]=t14):t14=$[43];const currentRecorder=t14,{error,inputStatus,status,mediaBlob,stopRecording:originalStopRecording,startRecording,liveStream,getMediaStream,clearMediaStream,clearMediaBlob,muteAudio,unMuteAudio,pauseRecording,resumeRecording}=currentRecorder,isRecording="recording"===status;let t15,t16;$[44]!==setFile||$[45]!==setMediaBlobUrl?(t15=trimmedFile=>{setMediaBlobUrl((0,src_blob.gO)(trimmedFile)),setFile(trimmedFile)},$[44]=setFile,$[45]=setMediaBlobUrl,$[46]=t15):t15=$[46],$[47]===Symbol.for("react.memo_cache_sentinel")?(t16=[],$[47]=t16):t16=$[47];const onTrimmed=(0,src.hb)(t15,t16);let t17;$[48]!==isRecording||$[49]!==onTrimmed||$[50]!==originalFile||$[51]!==setDuration?(t17={setDuration,onTrimmed,file:originalFile,isRecording},$[48]=isRecording,$[49]=onTrimmed,$[50]=originalFile,$[51]=setDuration,$[52]=t17):t17=$[52];const{trimData,isAdjustingTrim,isProcessingTrim,startTrim,onTrim,resetTrim,cancelTrim}=mediaRecording_useTrim(t17);let t18,t19;$[53]!==error?.name||$[54]!==setHasVideo||$[55]!==setVideoInput?(t18=()=>{"NotFoundError"!==error?.name&&"NotReadableError"!==error?.name&&"OverConstrainedError"!==error?.name||(setHasVideo(!1),setVideoInput(null))},$[53]=error?.name,$[54]=setHasVideo,$[55]=setVideoInput,$[56]=t18):t18=$[56],$[57]!==error?(t19=[error],$[57]=error,$[58]=t19):t19=$[58],(0,src.vJ)(t18,t19);const speak=(0,useLiveRegion.A)();let t20,t21;$[59]!==originalStopRecording||$[60]!==setIsProcessing||$[61]!==speak?(t20=()=>{setIsProcessing(!0),originalStopRecording(),speak((0,i18n.__)("Recording stopped","web-stories"))},$[59]=originalStopRecording,$[60]=setIsProcessing,$[61]=speak,$[62]=t20):t20=$[62],$[63]!==originalStopRecording||$[64]!==speak?(t21=[originalStopRecording,speak],$[63]=originalStopRecording,$[64]=speak,$[65]=t21):t21=$[65];const stopRecording=(0,src.hb)(t20,t21);let t22,t23;$[66]!==setMediaDevices?(t22=async()=>{if(navigator.mediaDevices)try{const devices=await navigator.mediaDevices.enumerateDevices();setMediaDevices(devices.filter(_temp3).filter(_temp4))}catch{}},$[66]=setMediaDevices,$[67]=t22):t22=$[67],$[68]===Symbol.for("react.memo_cache_sentinel")?(t23=[],$[68]=t23):t23=$[68];const updateMediaDevices=(0,src.hb)(t22,t23);let t24,t25,t26,t27;$[69]!==updateMediaDevices?(t24=()=>{if(navigator.mediaDevices)return navigator.mediaDevices.addEventListener("devicechange",updateMediaDevices),()=>{navigator.mediaDevices.removeEventListener("devicechange",updateMediaDevices)}},t25=[updateMediaDevices],$[69]=updateMediaDevices,$[70]=t24,$[71]=t25):(t24=$[70],t25=$[71]),(0,src.vJ)(t24,t25),$[72]!==hasVideo||$[73]!==setHasVideo?(t26=()=>{setHasVideo(!hasVideo)},$[72]=hasVideo,$[73]=setHasVideo,$[74]=t26):t26=$[74],$[75]!==hasVideo?(t27=[hasVideo],$[75]=hasVideo,$[76]=t27):t27=$[76];const toggleVideo=(0,src.hb)(t26,t27);let t28,t29;$[77]!==hasAudio||$[78]!==muteAudio||$[79]!==setHasAudio||$[80]!==unMuteAudio?(t28=()=>{setHasAudio(!hasAudio),hasAudio?muteAudio():unMuteAudio()},$[77]=hasAudio,$[78]=muteAudio,$[79]=setHasAudio,$[80]=unMuteAudio,$[81]=t28):t28=$[81],$[82]!==hasAudio||$[83]!==muteAudio||$[84]!==unMuteAudio?(t29=[hasAudio,muteAudio,unMuteAudio],$[82]=hasAudio,$[83]=muteAudio,$[84]=unMuteAudio,$[85]=t29):t29=$[85];const toggleAudio=(0,src.hb)(t28,t29),previousBlobUrl=(0,src.ZC)(mediaBlobUrl);let t30,t31,t32,t33,t34,t35,t36,t37,t38,t39;$[86]!==mediaBlobUrl||$[87]!==originalMediaBlobUrl||$[88]!==previousBlobUrl?(t30=()=>{previousBlobUrl&&previousBlobUrl!==mediaBlobUrl&&previousBlobUrl!==originalMediaBlobUrl&&(0,src_blob.eW)(previousBlobUrl)},t31=[mediaBlobUrl,previousBlobUrl,originalMediaBlobUrl],$[86]=mediaBlobUrl,$[87]=originalMediaBlobUrl,$[88]=previousBlobUrl,$[89]=t30,$[90]=t31):(t30=$[89],t31=$[90]),(0,src.vJ)(t30,t31),$[91]!==duration||$[92]!==isRecording||$[93]!==setDuration?(t32=()=>{let timeout;return duration>=0&&isRecording&&(timeout=setTimeout((()=>setDuration(_temp5)),1e3)),()=>clearTimeout(timeout)},$[91]=duration,$[92]=isRecording,$[93]=setDuration,$[94]=t32):t32=$[94],$[95]!==duration||$[96]!==isRecording?(t33=[duration,isRecording],$[95]=duration,$[96]=isRecording,$[97]=t33):t33=$[97],(0,src.vJ)(t32,t33),$[98]!==countdown||$[99]!==setCountdown?(t34=()=>{let timeout_0;return countdown>0&&(timeout_0=setTimeout((()=>setCountdown(countdown-1)),1e3)),()=>clearTimeout(timeout_0)},$[98]=countdown,$[99]=setCountdown,$[100]=t34):t34=$[100],$[101]!==countdown?(t35=[countdown],$[101]=countdown,$[102]=t35):t35=$[102],(0,src.vJ)(t34,t35),$[103]!==duration||$[104]!==stopRecording?(t36=()=>{duration>constants.Ob&&stopRecording()},t37=[duration,stopRecording],$[103]=duration,$[104]=stopRecording,$[105]=t36,$[106]=t37):(t36=$[105],t37=$[106]),(0,src.vJ)(t36,t37),$[107]!==canvasRecorder||$[108]!==clearMediaBlob||$[109]!==clearMediaStream||$[110]!==liveStream?(t38=()=>{liveStream&&liveStream.getTracks().forEach(_temp6),canvasRecorder.liveStream&&canvasRecorder.liveStream.getTracks().forEach(_temp7),clearMediaBlob(),clearMediaStream(),canvasRecorder.clearMediaStream()},t39=[clearMediaBlob,clearMediaStream,liveStream,canvasRecorder],$[107]=canvasRecorder,$[108]=clearMediaBlob,$[109]=clearMediaStream,$[110]=liveStream,$[111]=t38,$[112]=t39):(t38=$[111],t39=$[112]);const resetStream=(0,src.hb)(t38,t39);let t40,t41;$[113]!==resetStream||$[114]!==resetTrim||$[115]!==setCountdown||$[116]!==setDuration||$[117]!==setFile||$[118]!==setIsGif||$[119]!==setIsProcessing||$[120]!==setMediaBlobUrl?(t40=()=>{setFile(null),setIsGif(!1),setMediaBlobUrl(null),setCountdown(0),setIsProcessing(!1),setDuration(0),resetTrim(),resetStream()},$[113]=resetStream,$[114]=resetTrim,$[115]=setCountdown,$[116]=setDuration,$[117]=setFile,$[118]=setIsGif,$[119]=setIsProcessing,$[120]=setMediaBlobUrl,$[121]=t40):t40=$[121],$[122]!==resetStream||$[123]!==resetTrim?(t41=[resetStream,resetTrim],$[122]=resetStream,$[123]=resetTrim,$[124]=t41):t41=$[124];const resetState=(0,src.hb)(t40,t41);let t42,t43;$[125]!==canvasRecorder||$[126]!==isInRecordingMode||$[127]!==resetState||$[128]!==setIsInRecordingMode||$[129]!==stopRecording?(t42=()=>{setIsInRecordingMode(_temp8),"recording"===canvasRecorder.status?stopRecording():(resetState(),!0===isInRecordingMode&&canvasRecorder.clearMediaStream())},$[125]=canvasRecorder,$[126]=isInRecordingMode,$[127]=resetState,$[128]=setIsInRecordingMode,$[129]=stopRecording,$[130]=t42):t42=$[130],$[131]!==canvasRecorder||$[132]!==isInRecordingMode||$[133]!==resetState||$[134]!==stopRecording?(t43=[resetState,canvasRecorder,isInRecordingMode,stopRecording],$[131]=canvasRecorder,$[132]=isInRecordingMode,$[133]=resetState,$[134]=stopRecording,$[135]=t43):t43=$[135];const toggleRecordingMode=(0,src.hb)(t42,t43);let t44,t45;$[136]!==setIsSettingsOpen?(t44=()=>setIsSettingsOpen(_temp9),$[136]=setIsSettingsOpen,$[137]=t44):t44=$[137],$[138]===Symbol.for("react.memo_cache_sentinel")?(t45=[],$[138]=t45):t45=$[138];const toggleSettings=(0,src.hb)(t44,t45);let t46,t47;$[139]!==setIsGif?(t46=()=>setIsGif(_temp10),$[139]=setIsGif,$[140]=t46):t46=$[140],$[141]===Symbol.for("react.memo_cache_sentinel")?(t47=[],$[141]=t47):t47=$[141];const toggleIsGif=(0,src.hb)(t46,t47),isCountingDown=countdown>0,wasCountingDown=(0,src.ZC)(isCountingDown);let t48,t49;$[142]!==audioInput||$[143]!==cancelTrim||$[144]!==canvasNode||$[145]!==canvasStream||$[146]!==clearMediaBlob||$[147]!==clearMediaStream||$[148]!==countdown||$[149]!==duration||$[150]!==error||$[151]!==file||$[152]!==getMediaStream||$[153]!==hasAudio||$[154]!==hasVideo||$[155]!==inputStatus||$[156]!==isAdjustingTrim||$[157]!==isCountingDown||$[158]!==isGif||$[159]!==isInRecordingMode||$[160]!==isProcessing||$[161]!==isProcessingTrim||$[162]!==isSettingsOpen||$[163]!==liveStream||$[164]!==mediaBlob||$[165]!==mediaBlobUrl||$[166]!==mediaDevices||$[167]!==muteAudio||$[168]!==onTrim||$[169]!==originalMediaBlobUrl||$[170]!==pauseRecording||$[171]!==resetState||$[172]!==resetStream||$[173]!==resumeRecording||$[174]!==setAudioInput||$[175]!==setCanvasNode||$[176]!==setCanvasStream||$[177]!==setCountdown||$[178]!==setDuration||$[179]!==setFile||$[180]!==setMediaBlobUrl||$[181]!==setStreamNode||$[182]!==setVideoEffect||$[183]!==setVideoInput||$[184]!==startRecording||$[185]!==startTrim||$[186]!==status||$[187]!==stopRecording||$[188]!==streamNode||$[189]!==toggleAudio||$[190]!==toggleIsGif||$[191]!==toggleRecordingMode||$[192]!==toggleSettings||$[193]!==toggleVideo||$[194]!==trimData||$[195]!==unMuteAudio||$[196]!==updateMediaDevices||$[197]!==videoEffect||$[198]!==videoInput||$[199]!==wasCountingDown?(t48=()=>({state:{isInRecordingMode,hasVideo,hasAudio,mediaDevices,audioInput,videoInput,videoEffect,isSettingsOpen,error,inputStatus,status,mediaBlob,mediaBlobUrl,originalMediaBlobUrl,liveStream,file,isGif,duration,countdown,isProcessing,isCountingDown:isCountingDown||wasCountingDown,trimData,isAdjustingTrim,streamNode,isProcessingTrim,canvasStream,canvasNode},actions:{toggleRecordingMode,setMediaBlobUrl,toggleVideo,toggleAudio,toggleSettings,toggleIsGif,setAudioInput,setVideoInput,setVideoEffect,updateMediaDevices,stopRecording,startRecording,getMediaStream,clearMediaStream,clearMediaBlob,setFile,muteAudio,unMuteAudio,setDuration,setCountdown,resetState,resetStream,onTrim,startTrim,setStreamNode,pauseRecording,resumeRecording,cancelTrim,setCanvasStream,setCanvasNode}}),$[142]=audioInput,$[143]=cancelTrim,$[144]=canvasNode,$[145]=canvasStream,$[146]=clearMediaBlob,$[147]=clearMediaStream,$[148]=countdown,$[149]=duration,$[150]=error,$[151]=file,$[152]=getMediaStream,$[153]=hasAudio,$[154]=hasVideo,$[155]=inputStatus,$[156]=isAdjustingTrim,$[157]=isCountingDown,$[158]=isGif,$[159]=isInRecordingMode,$[160]=isProcessing,$[161]=isProcessingTrim,$[162]=isSettingsOpen,$[163]=liveStream,$[164]=mediaBlob,$[165]=mediaBlobUrl,$[166]=mediaDevices,$[167]=muteAudio,$[168]=onTrim,$[169]=originalMediaBlobUrl,$[170]=pauseRecording,$[171]=resetState,$[172]=resetStream,$[173]=resumeRecording,$[174]=setAudioInput,$[175]=setCanvasNode,$[176]=setCanvasStream,$[177]=setCountdown,$[178]=setDuration,$[179]=setFile,$[180]=setMediaBlobUrl,$[181]=setStreamNode,$[182]=setVideoEffect,$[183]=setVideoInput,$[184]=startRecording,$[185]=startTrim,$[186]=status,$[187]=stopRecording,$[188]=streamNode,$[189]=toggleAudio,$[190]=toggleIsGif,$[191]=toggleRecordingMode,$[192]=toggleSettings,$[193]=toggleVideo,$[194]=trimData,$[195]=unMuteAudio,$[196]=updateMediaDevices,$[197]=videoEffect,$[198]=videoInput,$[199]=wasCountingDown,$[200]=t48):t48=$[200],$[201]!==audioInput||$[202]!==cancelTrim||$[203]!==canvasNode||$[204]!==canvasStream||$[205]!==clearMediaBlob||$[206]!==clearMediaStream||$[207]!==countdown||$[208]!==duration||$[209]!==error||$[210]!==file||$[211]!==getMediaStream||$[212]!==hasAudio||$[213]!==hasVideo||$[214]!==inputStatus||$[215]!==isAdjustingTrim||$[216]!==isCountingDown||$[217]!==isGif||$[218]!==isInRecordingMode||$[219]!==isProcessing||$[220]!==isProcessingTrim||$[221]!==isSettingsOpen||$[222]!==liveStream||$[223]!==mediaBlob||$[224]!==mediaBlobUrl||$[225]!==mediaDevices||$[226]!==muteAudio||$[227]!==onTrim||$[228]!==originalMediaBlobUrl||$[229]!==pauseRecording||$[230]!==resetState||$[231]!==resetStream||$[232]!==resumeRecording||$[233]!==setCanvasNode||$[234]!==setCanvasStream||$[235]!==setStreamNode||$[236]!==startRecording||$[237]!==startTrim||$[238]!==status||$[239]!==stopRecording||$[240]!==streamNode||$[241]!==toggleAudio||$[242]!==toggleIsGif||$[243]!==toggleRecordingMode||$[244]!==toggleSettings||$[245]!==toggleVideo||$[246]!==trimData||$[247]!==unMuteAudio||$[248]!==updateMediaDevices||$[249]!==videoEffect||$[250]!==videoInput||$[251]!==wasCountingDown?(t49=[isInRecordingMode,hasVideo,hasAudio,mediaDevices,audioInput,videoInput,videoEffect,isSettingsOpen,error,inputStatus,status,mediaBlob,mediaBlobUrl,originalMediaBlobUrl,liveStream,file,isGif,duration,countdown,isCountingDown,wasCountingDown,isProcessing,trimData,isAdjustingTrim,streamNode,isProcessingTrim,toggleRecordingMode,toggleVideo,toggleAudio,toggleSettings,toggleIsGif,updateMediaDevices,stopRecording,startRecording,getMediaStream,clearMediaStream,clearMediaBlob,muteAudio,unMuteAudio,resetState,resetStream,onTrim,startTrim,setStreamNode,pauseRecording,resumeRecording,cancelTrim,canvasStream,setCanvasStream,canvasNode,setCanvasNode],$[201]=audioInput,$[202]=cancelTrim,$[203]=canvasNode,$[204]=canvasStream,$[205]=clearMediaBlob,$[206]=clearMediaStream,$[207]=countdown,$[208]=duration,$[209]=error,$[210]=file,$[211]=getMediaStream,$[212]=hasAudio,$[213]=hasVideo,$[214]=inputStatus,$[215]=isAdjustingTrim,$[216]=isCountingDown,$[217]=isGif,$[218]=isInRecordingMode,$[219]=isProcessing,$[220]=isProcessingTrim,$[221]=isSettingsOpen,$[222]=liveStream,$[223]=mediaBlob,$[224]=mediaBlobUrl,$[225]=mediaDevices,$[226]=muteAudio,$[227]=onTrim,$[228]=originalMediaBlobUrl,$[229]=pauseRecording,$[230]=resetState,$[231]=resetStream,$[232]=resumeRecording,$[233]=setCanvasNode,$[234]=setCanvasStream,$[235]=setStreamNode,$[236]=startRecording,$[237]=startTrim,$[238]=status,$[239]=stopRecording,$[240]=streamNode,$[241]=toggleAudio,$[242]=toggleIsGif,$[243]=toggleRecordingMode,$[244]=toggleSettings,$[245]=toggleVideo,$[246]=trimData,$[247]=unMuteAudio,$[248]=updateMediaDevices,$[249]=videoEffect,$[250]=videoInput,$[251]=wasCountingDown,$[252]=t49):t49=$[252];const value=(0,src.Kr)(t48,t49);let t50;return $[253]!==children||$[254]!==value?(t50=react.createElement(context.A.Provider,{value},children),$[253]=children,$[254]=value,$[255]=t50):t50=$[255],t50}function _temp10(state_1){return!state_1}function _temp9(state_0){return!state_0}function _temp8(state){return!state}function _temp7(track_0){return track_0.stop()}function _temp6(track){return track.stop()}function _temp5(seconds){return seconds+1}function _temp4(device_4){return device_4.label}function _temp3(device_3){return"audiooutput"!==device_3.kind}function _temp2(device_1){return"audioinput"===device_1.kind}function provider_temp(device){return"videoinput"===device.kind}MediaRecordingProvider.propTypes={children:prop_types_default().node.isRequired};const provider=MediaRecordingProvider;__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var dropdown=__webpack_require__("./packages/design-system/src/components/dropDown/dropdown.tsx"),dialog=__webpack_require__("./packages/story-editor/src/components/dialog/index.js");const Row=styled_components_browser_esm.Ay.div.withConfig({displayName:"settingsModal__Row",componentId:"sc-1xjwc1a-0"})(["margin-bottom:16px;"]),Label=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({as:"label",size:types.$.Small}).withConfig({displayName:"settingsModal__Label",componentId:"sc-1xjwc1a-1"})(["display:inline-block;margin-bottom:8px;"]);function settingsModal_temp5(t0){const{deviceId:deviceId_0,label:label_0}=t0;return{value:deviceId_0,label:label_0}}function settingsModal_temp4(device_0){return"audioinput"===device_0.kind}function settingsModal_temp3(t0){const{deviceId,label}=t0;return{value:deviceId,label}}function settingsModal_temp2(device){return"videoinput"===device.kind}function settingsModal_temp(t0){const{state,actions}=t0;return{mediaDevices:state.mediaDevices,hasAudio:state.hasAudio,videoInput:state.videoInput,audioInput:state.audioInput,videoEffect:state.videoEffect,isSettingsOpen:state.isSettingsOpen,setAudioInput:actions.setAudioInput,setVideoInput:actions.setVideoInput,setVideoEffect:actions.setVideoEffect,clearMediaStream:actions.clearMediaStream,clearMediaBlob:actions.clearMediaBlob,toggleSettings:actions.toggleSettings}}const settingsModal=function SettingsModal(){const $=(0,dist.c)(74),{mediaDevices,hasAudio,videoInput,audioInput,videoEffect,isSettingsOpen,setAudioInput,setVideoInput,setVideoEffect,clearMediaStream,clearMediaBlob,toggleSettings}=(0,useMediaRecording.A)(settingsModal_temp),[localVideoInput,setLocalVideoInput]=(0,src.J0)(videoInput),[localAudioInput,setLocalAudioInput]=(0,src.J0)(audioInput),[localVideoEffect,setLocalVideoEffect]=(0,src.J0)(videoEffect);let t0,t1,t2,t3,t4,t5;$[0]!==setLocalVideoInput||$[1]!==videoInput?(t0=()=>setLocalVideoInput(videoInput),$[0]=setLocalVideoInput,$[1]=videoInput,$[2]=t0):t0=$[2],$[3]!==videoInput?(t1=[videoInput],$[3]=videoInput,$[4]=t1):t1=$[4],(0,src.vJ)(t0,t1),$[5]!==audioInput||$[6]!==setLocalAudioInput?(t2=()=>setLocalAudioInput(audioInput),$[5]=audioInput,$[6]=setLocalAudioInput,$[7]=t2):t2=$[7],$[8]!==audioInput?(t3=[audioInput],$[8]=audioInput,$[9]=t3):t3=$[9],(0,src.vJ)(t2,t3),$[10]!==audioInput||$[11]!==clearMediaBlob||$[12]!==clearMediaStream||$[13]!==localAudioInput||$[14]!==localVideoEffect||$[15]!==localVideoInput||$[16]!==setAudioInput||$[17]!==setVideoEffect||$[18]!==setVideoInput||$[19]!==toggleSettings||$[20]!==videoEffect||$[21]!==videoInput?(t4=()=>{toggleSettings(),setVideoInput(localVideoInput),localStore.x.setItemByKey(localStore.$.MEDIA_RECORDING_VIDEO_INPUT,localVideoInput),setAudioInput(localAudioInput),localStore.x.setItemByKey(localStore.$.MEDIA_RECORDING_AUDIO_INPUT,localAudioInput),setVideoEffect(localVideoEffect),localStore.x.setItemByKey(localStore.$.MEDIA_RECORDING_VIDEO_EFFECT,localVideoEffect),videoInput===localVideoInput&&audioInput===localAudioInput&&videoEffect===localVideoEffect||((0,tracking_src.sx)("media_recording_settings_changed"),clearMediaStream(),clearMediaBlob())},t5=[audioInput,clearMediaBlob,clearMediaStream,localAudioInput,localVideoInput,localVideoEffect,setAudioInput,setVideoInput,setVideoEffect,toggleSettings,videoInput,videoEffect],$[10]=audioInput,$[11]=clearMediaBlob,$[12]=clearMediaStream,$[13]=localAudioInput,$[14]=localVideoEffect,$[15]=localVideoInput,$[16]=setAudioInput,$[17]=setVideoEffect,$[18]=setVideoInput,$[19]=toggleSettings,$[20]=videoEffect,$[21]=videoInput,$[22]=t4,$[23]=t5):(t4=$[22],t5=$[23]);const onSaveChanges=(0,src.hb)(t4,t5);let t6;$[24]!==mediaDevices?(t6=mediaDevices.filter(settingsModal_temp2).map(settingsModal_temp3),$[24]=mediaDevices,$[25]=t6):t6=$[25];const videoInputs=t6;let t7;$[26]!==mediaDevices?(t7=mediaDevices.filter(settingsModal_temp4).map(settingsModal_temp5),$[26]=mediaDevices,$[27]=t7):t7=$[27];const audioInputs=t7;let t8,t9;$[28]===Symbol.for("react.memo_cache_sentinel")?(t8={value:constants.R4.NONE,label:(0,i18n.__)("None","web-stories")},$[28]=t8):t8=$[28],$[29]===Symbol.for("react.memo_cache_sentinel")?(t9=[t8,{value:constants.R4.BLUR,label:(0,i18n.__)("Background blur","web-stories")}],$[29]=t9):t9=$[29];const videoEffects=t9;let t10,t11;$[30]!==setLocalVideoInput?(t10=(_event,value)=>setLocalVideoInput(value),$[30]=setLocalVideoInput,$[31]=t10):t10=$[31],$[32]===Symbol.for("react.memo_cache_sentinel")?(t11=[],$[32]=t11):t11=$[32];const onChangeVideoInput=(0,src.hb)(t10,t11);let t12,t13;$[33]!==setLocalAudioInput?(t12=(evt,value_0)=>setLocalAudioInput(value_0),$[33]=setLocalAudioInput,$[34]=t12):t12=$[34],$[35]===Symbol.for("react.memo_cache_sentinel")?(t13=[],$[35]=t13):t13=$[35];const onChangeAudioInput=(0,src.hb)(t12,t13);let t14,t15;$[36]!==setLocalVideoEffect?(t14=(_event_0,value_1)=>setLocalVideoEffect(value_1),$[36]=setLocalVideoEffect,$[37]=t14):t14=$[37],$[38]===Symbol.for("react.memo_cache_sentinel")?(t15=[],$[38]=t15):t15=$[38];const onChangeVideoEffect=(0,src.hb)(t14,t15);let t16,t17;$[39]!==audioInput||$[40]!==setLocalAudioInput||$[41]!==setLocalVideoInput||$[42]!==toggleSettings||$[43]!==videoInput?(t16=()=>{toggleSettings(),setLocalVideoInput(videoInput),setLocalAudioInput(audioInput)},$[39]=audioInput,$[40]=setLocalAudioInput,$[41]=setLocalVideoInput,$[42]=toggleSettings,$[43]=videoInput,$[44]=t16):t16=$[44],$[45]!==audioInput||$[46]!==toggleSettings||$[47]!==videoInput?(t17=[audioInput,toggleSettings,videoInput],$[45]=audioInput,$[46]=toggleSettings,$[47]=videoInput,$[48]=t17):t17=$[48];const onClose=(0,src.hb)(t16,t17);let t18,t19,t20,t21,t22,t23,t24,t25,t26;return $[49]===Symbol.for("react.memo_cache_sentinel")?(t18=(0,i18n.__)("Media Recording Options","web-stories"),t19=(0,i18n.__)("Options","web-stories"),$[49]=t18,$[50]=t19):(t18=$[49],t19=$[50]),$[51]===Symbol.for("react.memo_cache_sentinel")?(t20=(0,i18n.__)("Save","web-stories"),t21=(0,i18n.__)("Cancel","web-stories"),$[51]=t20,$[52]=t21):(t20=$[51],t21=$[52]),$[53]===Symbol.for("react.memo_cache_sentinel")?(t22=react.createElement(Row,null,react.createElement(typography_text.E.Paragraph,null,(0,i18n.__)("Choose the camera and microphone to use for the recording.","web-stories"))),$[53]=t22):t22=$[53],$[54]!==localVideoInput||$[55]!==onChangeVideoInput||$[56]!==videoInputs?(t23=videoInputs.length>0&&react.createElement(Row,null,react.createElement(Label,{htmlFor:"camera"},(0,i18n.__)("Camera","web-stories")),react.createElement(dropdown.A,{id:"camera",ariaLabel:(0,i18n.__)("Video Input","web-stories"),placeholder:(0,i18n.__)("Select Video Input","web-stories"),options:videoInputs,onMenuItemClick:onChangeVideoInput,selectedValue:localVideoInput,popupZIndex:constants.O8})),$[54]=localVideoInput,$[55]=onChangeVideoInput,$[56]=videoInputs,$[57]=t23):t23=$[57],$[58]!==audioInputs||$[59]!==hasAudio||$[60]!==localAudioInput||$[61]!==onChangeAudioInput?(t24=audioInputs.length>0&&react.createElement(Row,null,react.createElement(Label,{htmlFor:"microphone"},(0,i18n.__)("Microphone","web-stories")),react.createElement(dropdown.A,{id:"microphone",ariaLabel:(0,i18n.__)("Audio Input","web-stories"),placeholder:(0,i18n.__)("Select Audio Input","web-stories"),options:audioInputs,onMenuItemClick:onChangeAudioInput,selectedValue:localAudioInput,disabled:!hasAudio,popupZIndex:constants.O8})),$[58]=audioInputs,$[59]=hasAudio,$[60]=localAudioInput,$[61]=onChangeAudioInput,$[62]=t24):t24=$[62],$[63]!==localVideoEffect||$[64]!==onChangeVideoEffect||$[65]!==videoInputs.length?(t25=videoInputs.length>0&&react.createElement(Row,null,react.createElement(Label,{htmlFor:"video-effect"},(0,i18n.__)("Video Effect","web-stories")),react.createElement(dropdown.A,{id:"video-effect",ariaLabel:(0,i18n.__)("Video Effect","web-stories"),placeholder:(0,i18n.__)("Select Video Effect","web-stories"),options:videoEffects,onMenuItemClick:onChangeVideoEffect,selectedValue:localVideoEffect,popupZIndex:constants.O8})),$[63]=localVideoEffect,$[64]=onChangeVideoEffect,$[65]=videoInputs.length,$[66]=t25):t25=$[66],$[67]!==isSettingsOpen||$[68]!==onClose||$[69]!==onSaveChanges||$[70]!==t23||$[71]!==t24||$[72]!==t25?(t26=react.createElement(dialog.A,{onClose,isOpen:isSettingsOpen,contentLabel:t18,title:t19,onPrimary:onSaveChanges,primaryText:t20,secondaryText:t21},t22,t23,t24,t25),$[67]=isSettingsOpen,$[68]=onClose,$[69]=onSaveChanges,$[70]=t23,$[71]=t24,$[72]=t25,$[73]=t26):t26=$[73],t26};var button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),button_constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),photo_camera=__webpack_require__("./packages/design-system/src/icons/photo_camera.svg"),mic=__webpack_require__("./packages/design-system/src/icons/mic.svg"),getVideoLengthDisplay=__webpack_require__("./packages/media/src/getVideoLengthDisplay.ts"),getVideoLength=__webpack_require__("./packages/media/src/getVideoLength.ts"),getCanvasBlob=__webpack_require__("./packages/media/src/getCanvasBlob.ts"),getImageFromVideo=__webpack_require__("./packages/media/src/getImageFromVideo.ts"),propTypes=__webpack_require__("./packages/media/src/types/propTypes.ts"),getResourceFromLocalFile=__webpack_require__("./packages/story-editor/src/app/media/utils/getResourceFromLocalFile.ts"),useUploadWithPreview=__webpack_require__("./packages/story-editor/src/components/canvas/useUploadWithPreview.js"),uploader=__webpack_require__("./packages/story-editor/src/app/uploader/index.ts"),app=__webpack_require__("./packages/story-editor/src/app/index.js"),highlights=__webpack_require__("./packages/story-editor/src/app/highlights/index.ts"),objectPick=__webpack_require__("./packages/story-editor/src/utils/objectPick.ts");const BaseButton=(0,styled_components_browser_esm.Ay)(button_button.$).attrs({type:button_constants.VQ.Primary,size:button_constants.Mp.Small}).withConfig({displayName:"footer__BaseButton",componentId:"sc-cffjy6-0"})([""]),RecordingButton=(0,styled_components_browser_esm.Ay)(BaseButton).withConfig({displayName:"footer__RecordingButton",componentId:"sc-cffjy6-1"})(["margin-right:20px;padding-top:12px;padding-bottom:12px;svg{margin:-9px 10px -9px 0;}"]),PauseButton=(0,styled_components_browser_esm.Ay)(BaseButton).attrs({type:button_constants.VQ.Secondary}).withConfig({displayName:"footer__PauseButton",componentId:"sc-cffjy6-2"})(["margin-right:20px;padding-top:12px;padding-bottom:12px;"]),StopButton=(0,styled_components_browser_esm.Ay)(BaseButton).withConfig({displayName:"footer__StopButton",componentId:"sc-cffjy6-3"})(["padding-top:12px;padding-bottom:12px;background-color:",";border-color:",";color:",";&:active,&:hover,&:focus{background-color:",";border-color:",";}"],(({theme})=>theme.colors.interactiveBg.negativeNormal),(({theme})=>theme.colors.interactiveBg.negativeNormal),(({theme})=>theme.colors.gray[5]),(({theme})=>theme.colors.interactiveBg.negativeHover),(({theme})=>theme.colors.interactiveBg.negativeHover)),CaptureButton=(0,styled_components_browser_esm.Ay)(BaseButton).attrs({type:button_constants.VQ.Quaternary}).withConfig({displayName:"footer__CaptureButton",componentId:"sc-cffjy6-4"})(["background-color:",";padding-top:12px;padding-bottom:12px;svg{margin:-9px 10px -9px 0;}"],(({theme})=>theme.colors.opacity.overlayDark)),InsertButton=(0,styled_components_browser_esm.Ay)(button_button.$).attrs({type:button_constants.VQ.Primary,size:button_constants.Mp.Small}).withConfig({displayName:"footer__InsertButton",componentId:"sc-cffjy6-5"})([""]),RetryButton=(0,styled_components_browser_esm.Ay)(button_button.$).attrs({type:button_constants.VQ.Plain,size:button_constants.Mp.Small}).withConfig({displayName:"footer__RetryButton",componentId:"sc-cffjy6-6"})(["margin-right:20px;"]);const footer=function Footer(){const{status,file,isGif,isMuted,hasMediaToInsert,countdown,duration,isCountingDown,setMediaBlobUrl,setDuration,setCountdown,startRecording,stopRecording,setFile,toggleRecordingMode,getMediaStream,resetState,resetStream,streamNode,canvasStream,liveStream,hasVideo,videoEffect,pauseRecording,resumeRecording,isProcessingTrim,cancelTrim,canvasNode}=(0,useMediaRecording.A)((({state,actions})=>({status:state.status,file:state.file,isGif:state.isGif,isMuted:!state.hasAudio||state.isGif,countdown:state.countdown,duration:state.duration,isCountingDown:state.isCountingDown,hasVideo:state.hasVideo,videoEffect:state.videoEffect,hasMediaToInsert:Boolean(state.mediaBlobUrl),liveStream:state.liveStream,streamNode:state.streamNode,canvasStream:state.canvasStream,isProcessingTrim:state.isProcessingTrim,startRecording:actions.startRecording,stopRecording:actions.stopRecording,setFile:actions.setFile,setMediaBlobUrl:actions.setMediaBlobUrl,setDuration:actions.setDuration,setCountdown:actions.setCountdown,toggleRecordingMode:actions.toggleRecordingMode,getMediaStream:actions.getMediaStream,resetState:actions.resetState,resetStream:actions.resetStream,pauseRecording:actions.pauseRecording,resumeRecording:actions.resumeRecording,cancelTrim:actions.cancelTrim,canvasNode:state.canvasNode}))),videoNode_0=(0,useVideoTrim.A)((({state:{videoNode}})=>videoNode)),uploadWithPreview=(0,useUploadWithPreview.A)(),speak=(0,useLiveRegion.A)(),{allowedMimeTypes:{audio:allowedAudioMimeTypes}}=(0,app.UK)(),onPause=(0,src.hb)((()=>{pauseRecording(),(0,tracking_src.sx)("media_recording_pause")}),[pauseRecording]),onResume=(0,src.hb)((()=>{resumeRecording(),(0,tracking_src.sx)("media_recording_resume")}),[resumeRecording]),onRetry=(0,src.hb)((async()=>{resetState(),await getMediaStream(),(0,tracking_src.sx)("media_recording_retry")}),[getMediaStream,resetState]),debouncedStartRecording=(0,src.YQ)(startRecording,1e3*constants.uG),onStart=(0,src.hb)((()=>{speak((0,sprintf.A)((0,i18n._n)("Starting recording in %d second","Starting recording in %d seconds",constants.uG,"web-stories"),constants.uG)),setDuration(0),setCountdown(constants.uG),debouncedStartRecording()}),[debouncedStartRecording,setCountdown,setDuration,speak]),[isInserting,setIsInserting]=(0,src.J0)(!1),isRecording=["recording","stopping","stopped","paused"].includes(status),isPaused="paused"===status,onInsert=(0,src.hb)((async()=>{setIsInserting(!0),speak((0,i18n.__)("Inserting…","web-stories"));const args={additionalData:{mediaSource:"recording",altText:(0,i18n.__)("Camera Capture","web-stories")}},{resource,posterFile}=await(0,getResourceFromLocalFile.A)(file);if(args.resource={...resource,alt:(0,i18n.__)("Camera Capture","web-stories")},file.type.startsWith("video")){args.additionalData.isMuted=isMuted,args.additionalData.isGif=isGif,args.resource.length=duration,args.resource.lengthFormatted=(0,getVideoLengthDisplay.A)(duration),args.resource.isOptimized=!0,args.resource.isMuted=isMuted,args.posterFile=posterFile;const{length,lengthFormatted}=(0,getVideoLength.A)(videoNode_0);args.resource.length=length||duration,args.resource.lengthFormatted=length?lengthFormatted:(0,getVideoLengthDisplay.A)(duration)}uploadWithPreview([file],!0,args),isRecording&&(setMediaBlobUrl(null),setFile(null)),(0,tracking_src.sx)("media_recording_capture",{type:isGif?"gif":"video",muted:isMuted,duration}),setIsInserting(!1),toggleRecordingMode()}),[speak,file,uploadWithPreview,isRecording,isGif,isMuted,duration,toggleRecordingMode,videoNode_0,setMediaBlobUrl,setFile]);(0,src.vJ)((()=>{streamNode&&!streamNode.srcObject&&liveStream&&(streamNode.srcObject=liveStream),streamNode&&!liveStream&&(streamNode.srcObject=null)}),[streamNode,liveStream]);const{showSnackbar}=(0,useSnackbar.d)(),captureImage=(0,src.hb)((async()=>{const hasVideoEffect=videoEffect&&videoEffect!==constants.R4.NONE,inputStream=hasVideoEffect?canvasStream:streamNode;if(!inputStream)return;let blob;try{blob=hasVideoEffect?await(0,getCanvasBlob.A)(canvasNode):await(0,getImageFromVideo.A)(inputStream),setMediaBlobUrl((0,src_blob.gO)(blob))}catch(e){(0,tracking_src.Oz)("media_recording_capture",e.message),showSnackbar({message:(0,i18n.__)("There was an error taking a photo. Please try again.","web-stories"),dismissable:!0})}const imageFile=(0,blobToFile.A)(blob,`image-capture-${(0,date_src.GP)(new Date,"Y-m-d-H-i")}.${constants.FD}`,constants.z$);setFile(imageFile),resetStream()}),[resetStream,setFile,setMediaBlobUrl,showSnackbar,streamNode,canvasStream,videoEffect,canvasNode]),debouncedCaptureImage=(0,src.YQ)(captureImage,1e3*constants.uG),onCapture=(0,src.hb)((()=>{speak((0,sprintf.A)((0,i18n._n)("Taking photo in %d second","Taking photo in %d seconds",constants.uG,"web-stories"),constants.uG)),setCountdown(constants.uG),debouncedCaptureImage(),(0,tracking_src.sx)("media_recording_capture",{type:"image"})}),[debouncedCaptureImage,setCountdown,speak]),{actions:{uploadFile}}=(0,uploader.k)(),{updateCurrentPageProperties:updateCurrentPageProperties_0,backgroundElementId,setSelectedElementsById:setSelectedElementsById_0}=(0,app.P3)((({state:{currentPage},actions:{updateCurrentPageProperties,setSelectedElementsById}})=>({backgroundElementId:currentPage?.elements.find((({isBackground})=>isBackground))?.id,updateCurrentPageProperties,setSelectedElementsById,currentPage}))),{setHighlights:setHighlights_0}=(0,highlights.N)((({setHighlights})=>({setHighlights}))),{convertToMp3}=(0,useFFmpeg.A)(),onAudioInsert=async()=>{setIsInserting(!0),speak((0,i18n.__)("Inserting…","web-stories"));const mp3File=await convertToMp3(file),resource_0=await uploadFile(mp3File,{mediaSource:"recording"},allowedAudioMimeTypes),backgroundAudio={resource:(0,objectPick.A)(resource_0,Object.keys(propTypes.vj))};setSelectedElementsById_0({elementIds:[backgroundElementId]}),setHighlights_0({highlight:highlights.xP.PageBackgroundAudio}),updateCurrentPageProperties_0({properties:{backgroundAudio}}),setIsInserting(!1),toggleRecordingMode()};return"acquiring_media"===status?null:isProcessingTrim?react.createElement(RetryButton,{onClick:cancelTrim},(0,i18n.__)("Cancel trimming","web-stories")):hasMediaToInsert?react.createElement(react.Fragment,null,react.createElement(RetryButton,{onClick:onRetry,disabled:isInserting},(0,i18n.__)("Retry","web-stories")),react.createElement(InsertButton,{onClick:hasVideo?onInsert:onAudioInsert,disabled:isInserting},isInserting?(0,i18n.__)("Inserting…","web-stories"):hasVideo?(0,i18n.__)("Insert","web-stories"):(0,i18n.__)("Insert page background audio","web-stories"))):0===countdown?react.createElement(react.Fragment,null,isRecording&&react.createElement(react.Fragment,null,react.createElement(PauseButton,{onClick:isPaused?onResume:onPause,"aria-label":isPaused?(0,i18n.__)("Resume Recording","web-stories"):(0,i18n.__)("Pause Recording","web-stories")},isPaused?(0,i18n.__)("Resume","web-stories"):(0,i18n.__)("Pause","web-stories")),react.createElement(StopButton,{onClick:stopRecording,"aria-label":(0,i18n.__)("Stop Recording","web-stories")},(0,i18n.__)("Stop","web-stories"))),!isRecording&&!isCountingDown&&(hasVideo?react.createElement(react.Fragment,null,react.createElement(RecordingButton,{onClick:onStart},react.createElement(camera.A,{width:24,height:24,"aria-hidden":!0}),(0,i18n.__)("Record Video","web-stories")),react.createElement(CaptureButton,{onClick:onCapture},react.createElement(photo_camera.A,{width:24,height:24,"aria-hidden":!0}),(0,i18n.__)("Take a photo","web-stories"))):react.createElement(RecordingButton,{onClick:onStart},react.createElement(mic.A,{width:24,height:24,"aria-hidden":!0}),(0,i18n.__)("Record Audio","web-stories")))):null};var popup_constants=__webpack_require__("./packages/design-system/src/components/popup/constants.ts"),tooltip=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js");const durationIndicator_Wrapper=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.Small}).withConfig({displayName:"durationIndicator__Wrapper",componentId:"sc-5z5bu3-0"})(["font-variant-numeric:tabular-nums;&:before{content:'';display:inline-block;width:10px;height:10px;margin-right:5px;border-radius:100%;background-color:",";}"],(({theme})=>theme.colors.interactiveBg.negativeNormal));function durationIndicator_temp(t0){const{state}=t0;return{duration:state.duration,isRecording:["recording","paused"].includes(state.status)}}const durationIndicator=function DurationIndicator(){const $=(0,dist.c)(9),{duration,isRecording}=(0,useMediaRecording.A)(durationIndicator_temp);if(!isRecording)return null;let t0,t1,t2,t3,t4;return $[0]===Symbol.for("react.memo_cache_sentinel")?(t0=(0,sprintf.A)((0,i18n._n)("Maximum duration is %d minute","Maximum duration is %d minutes",constants.ub,"web-stories"),String(constants.ub)),t1={maxWidth:"20em"},$[0]=t0,$[1]=t1):(t0=$[0],t1=$[1]),$[2]!==duration?(t2=(0,getVideoLengthDisplay.A)(duration),$[2]=duration,$[3]=t2):t2=$[3],$[4]!==t2?(t3=react.createElement(durationIndicator_Wrapper,null,t2),$[4]=t2,$[5]=t3):t3=$[5],$[6]!==t0||$[7]!==t3?(t4=react.createElement(tooltip.A,{position:popup_constants.W.Top,title:t0,styleOverride:t1},t3),$[6]=t0,$[7]=t3,$[8]=t4):t4=$[8],t4}},"./packages/story-editor/src/components/mediaRecording/useMediaRecording.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/react/src/index.ts"),_context__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/story-editor/src/components/mediaRecording/context.js");const __WEBPACK_DEFAULT_EXPORT__=function useMediaRecording(selector){return(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.i7)(_context__WEBPACK_IMPORTED_MODULE_1__.A,selector??_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.D_)}},"./packages/story-editor/src/components/panels/design/textStyle/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ei:()=>removeHiddenPadding,io:()=>getHiddenPadding,oB:()=>applyHiddenPadding});var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/story-editor/src/constants/index.ts");function applyHiddenPadding(element){return element?.padding?.hasHiddenPadding?element.padding:{...element.padding,hasHiddenPadding:!0,...["vertical","horizontal"].reduce(((padding,axis)=>(padding[axis]=(element?.padding?.[axis]||0)+_constants__WEBPACK_IMPORTED_MODULE_0__.n_[axis],padding)),{})}}function removeHiddenPadding(element){return element?.padding?.hasHiddenPadding?{...element.padding,hasHiddenPadding:!1,...["vertical","horizontal"].reduce(((padding,axis)=>(padding[axis]=(element?.padding?.[axis]||0)-_constants__WEBPACK_IMPORTED_MODULE_0__.n_[axis],padding)),{})}:element.padding}function getHiddenPadding(element={},axis="horizontal"){return element?.padding?.hasHiddenPadding?_constants__WEBPACK_IMPORTED_MODULE_0__.n_[axis]:0}},"./packages/story-editor/src/components/uploadDropTarget/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_G:()=>dropTarget,X4:()=>message,Mj:()=>overlay});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),src=__webpack_require__("./packages/react/src/index.ts"),dragEvent=__webpack_require__("./packages/story-editor/src/utils/dragEvent.ts");const context=(0,src.q6)({}),DropTargetComponent=styled_components_browser_esm.Ay.div.withConfig({displayName:"dropTarget__DropTargetComponent",componentId:"sc-12rok6t-0"})(["position:relative;width:100%;height:100%;"]),Content=styled_components_browser_esm.Ay.div.withConfig({displayName:"dropTarget__Content",componentId:"sc-12rok6t-1"})(["position:relative;width:100%;height:100%;"]),Glasspane=styled_components_browser_esm.Ay.div.withConfig({displayName:"dropTarget__Glasspane",componentId:"sc-12rok6t-2"})(["position:absolute;z-index:1000;top:0;left:0;width:100%;height:100%;"]);function disableDefaults(evt){evt.preventDefault(),evt.stopPropagation()}function UploadDropTarget(t0){const $=(0,dist.c)(34),{disabled:t1,label:t2,labelledBy:t3,onDrop:t4,children}=t0,disabled=void 0!==t1&&t1,label=void 0===t2?null:t2,labelledBy=void 0===t3?null:t3,onDrop=void 0===t4?null:t4,[isDragging,setIsDragging]=(0,src.J0)(!1);let t5,t6;$[0]!==disabled||$[1]!==setIsDragging?(t5=e=>{const{dataTransfer}=e;(0,dragEvent.e)(e)&&(disableDefaults(e),disabled?dataTransfer.effectAllowed="none":(dataTransfer.effectAllowed="copy",setIsDragging(!0)))},$[0]=disabled,$[1]=setIsDragging,$[2]=t5):t5=$[2],$[3]!==disabled?(t6=[disabled],$[3]=disabled,$[4]=t6):t6=$[4];const onDragEnter=(0,src.hb)(t5,t6);let t7,t8;$[5]!==setIsDragging?(t7=evt=>{disableDefaults(evt),setIsDragging(!1)},$[5]=setIsDragging,$[6]=t7):t7=$[6],$[7]===Symbol.for("react.memo_cache_sentinel")?(t8=[],$[7]=t8):t8=$[7];const onDragLeave=(0,src.hb)(t7,t8);let t9,t10;$[8]!==disabled||$[9]!==onDrop||$[10]!==setIsDragging?(t9=evt_0=>{disableDefaults(evt_0),setIsDragging(!1),!disabled&&onDrop&&onDrop([...evt_0.dataTransfer.files])},$[8]=disabled,$[9]=onDrop,$[10]=setIsDragging,$[11]=t9):t9=$[11],$[12]!==disabled||$[13]!==onDrop?(t10=[disabled,onDrop],$[12]=disabled,$[13]=onDrop,$[14]=t10):t10=$[14];const onDropHandler=(0,src.hb)(t9,t10);let t11,t12,t13,t14,t15;return $[15]!==isDragging||$[16]!==label||$[17]!==labelledBy||$[18]!==onDragEnter||$[19]!==onDragLeave||$[20]!==onDropHandler?(t11=isDragging&&react.createElement(Glasspane,{onDragEnter,onDragLeave,onDragOver:disableDefaults,onDrop:onDropHandler,"aria-label":label,"aria-labelledby":labelledBy}),$[15]=isDragging,$[16]=label,$[17]=labelledBy,$[18]=onDragEnter,$[19]=onDragLeave,$[20]=onDropHandler,$[21]=t11):t11=$[21],$[22]!==isDragging?(t12={isDragging},$[22]=isDragging,$[23]=t12):t12=$[23],$[24]!==children?(t13=react.createElement(Content,null,children),$[24]=children,$[25]=t13):t13=$[25],$[26]!==t12||$[27]!==t13?(t14=react.createElement(context.Provider,{value:t12},t13),$[26]=t12,$[27]=t13,$[28]=t14):t14=$[28],$[29]!==onDragEnter||$[30]!==onDropHandler||$[31]!==t11||$[32]!==t14?(t15=react.createElement(DropTargetComponent,{onDragEnter,onDrop:onDropHandler,onDragOver:disableDefaults},t11,t14),$[29]=onDragEnter,$[30]=onDropHandler,$[31]=t11,$[32]=t14,$[33]=t15):t15=$[33],t15}UploadDropTarget.propTypes={disabled:prop_types_default().bool,label:prop_types_default().string,labelledBy:prop_types_default().string,onDrop:prop_types_default().func,children:prop_types_default().node.isRequired};const dropTarget=UploadDropTarget;__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js");var src_mimeTypes=__webpack_require__("./packages/media/src/mimeTypes.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),translateToExclusiveList=__webpack_require__("./packages/i18n/src/translateToExclusiveList.ts"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),arrow_cloud=__webpack_require__("./packages/design-system/src/icons/arrow_cloud.svg"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),config=__webpack_require__("./packages/story-editor/src/app/config/index.ts"),polished_esm=__webpack_require__("./node_modules/polished/dist/polished.esm.js");const use=function useUploadDropTarget(selector){return(0,src.i7)(context,selector??src.D_)};function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const Overlay=styled_components_browser_esm.Ay.div.withConfig({displayName:"overlay__Overlay",componentId:"sc-u0s4sf-0"})(["position:absolute;z-index:999;top:0;left:0;width:100%;height:100%;background-color:",";"],(({theme})=>(0,polished_esm.B3)(theme.colors.bg.primary,.6)));function _temp(state){return{isDragging:state.isDragging}}const overlay=(0,src.Rf)((function UploadDropTargetOverlayWithRef(props,ref){const $=(0,dist.c)(3),{isDragging}=use(_temp);if(!isDragging)return null;let t0;return $[0]!==props||$[1]!==ref?(t0=react.createElement(Overlay,_extends({ref},props)),$[0]=props,$[1]=ref,$[2]=t0):t0=$[2],t0})),Container=(0,styled_components_browser_esm.Ay)(overlay).withConfig({displayName:"message__Container",componentId:"sc-1cdb29v-0"})(["display:flex;align-items:center;justify-content:center;"]),Box=styled_components_browser_esm.Ay.div.withConfig({displayName:"message__Box",componentId:"sc-1cdb29v-1"})(["width:100%;max-width:240px;padding:16px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;"]),Text=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).withConfig({displayName:"message__Text",componentId:"sc-1cdb29v-2"})(["color:",";margin-bottom:14px;margin-top:0px;"],(({theme})=>theme.colors.standard.white)),Icon=(0,styled_components_browser_esm.Ay)(arrow_cloud.A).withConfig({displayName:"message__Icon",componentId:"sc-1cdb29v-3"})(["height:52px;width:52px;color:",";"],(({theme})=>theme.colors.standard.white));function UploadDropTargetMessage(t0){const $=(0,dist.c)(25);let message,rest;$[0]!==t0?(({message,...rest}=t0),$[0]=t0,$[1]=message,$[2]=rest):(message=$[1],rest=$[2]);const{allowedMimeTypes:t1}=(0,config.UK)(),{image:allowedImageMimeTypes,vector:allowedVectorMimeTypes,video:allowedVideoMimeTypes}=t1;let t2,t3;$[3]!==allowedImageMimeTypes||$[4]!==allowedVectorMimeTypes||$[5]!==allowedVideoMimeTypes?(t2=()=>[...allowedImageMimeTypes,...allowedVectorMimeTypes,...allowedVideoMimeTypes],t3=[allowedImageMimeTypes,allowedVideoMimeTypes,allowedVectorMimeTypes],$[3]=allowedImageMimeTypes,$[4]=allowedVectorMimeTypes,$[5]=allowedVideoMimeTypes,$[6]=t2,$[7]=t3):(t2=$[6],t3=$[7]);const allowedMimeTypes=(0,src.Kr)(t2,t3);let t4,t5;$[8]!==allowedMimeTypes?(t4=()=>allowedMimeTypes.flatMap(message_temp),t5=[allowedMimeTypes],$[8]=allowedMimeTypes,$[9]=t4,$[10]=t5):(t4=$[9],t5=$[10]);const allowedFileTypes=(0,src.Kr)(t4,t5);let t6;$[11]===Symbol.for("react.memo_cache_sentinel")?(t6=(0,i18n.__)("No file types are currently supported.","web-stories"),$[11]=t6):t6=$[11];let t7,t8,t9,t10,t11,description=t6;if(allowedFileTypes.length){let t7;$[12]!==allowedFileTypes?(t7=(0,sprintf.A)((0,i18n.__)("You can upload %s.","web-stories"),(0,translateToExclusiveList.A)(allowedFileTypes)),$[12]=allowedFileTypes,$[13]=t7):t7=$[13],description=t7}return $[14]===Symbol.for("react.memo_cache_sentinel")?(t7=react.createElement(Icon,null),$[14]=t7):t7=$[14],$[15]!==message?(t8=react.createElement(Text,{isBold:!0,size:types.$.Medium},message),$[15]=message,$[16]=t8):t8=$[16],$[17]!==description?(t9=react.createElement(Text,{size:types.$.Small},description),$[17]=description,$[18]=t9):t9=$[18],$[19]!==t8||$[20]!==t9?(t10=react.createElement(Box,null,t7,t8,t9),$[19]=t8,$[20]=t9,$[21]=t10):t10=$[21],$[22]!==rest||$[23]!==t10?(t11=react.createElement(Container,rest,t10),$[22]=rest,$[23]=t10,$[24]=t11):t11=$[24],t11}function message_temp(type){return(0,src_mimeTypes.n)(type)}UploadDropTargetMessage.propTypes={message:prop_types_default().string.isRequired};const message=(0,src.ph)(UploadDropTargetMessage)},"./packages/story-editor/src/components/videoTrim/useVideoNode.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/react/src/index.ts"),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/story-editor/src/constants/index.ts"),_utils_noop__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/story-editor/src/utils/noop.ts");const __WEBPACK_DEFAULT_EXPORT__=function useVideoNode(videoData){const[currentTime,setCurrentTime]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[startOffset,rawSetStartOffset]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[originalStartOffset,setOriginalStartOffset]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[endOffset,rawSetEndOffset]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[originalEndOffset,setOriginalEndOffset]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[maxOffset,setMaxOffset]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[videoNode,setVideoNode]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(null),[isDraggingHandles,setIsDraggingHandles]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.J0)(!1),isPausedTracker=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.li)(!1);(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.vJ)((()=>{videoNode&&(isPausedTracker.current||(isDraggingHandles?videoNode.pause():(videoNode.currentTime=startOffset/1e3,videoNode.play().catch(_utils_noop__WEBPACK_IMPORTED_MODULE_2__.l))))}),[videoNode,isDraggingHandles,startOffset]);const paused=videoNode?videoNode.paused:null;(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.vJ)((()=>{isDraggingHandles||(isPausedTracker.current=paused)}),[paused,isDraggingHandles]),(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.vJ)((()=>{videoData||(rawSetStartOffset(null),setOriginalStartOffset(null),setCurrentTime(null),rawSetEndOffset(null),setOriginalEndOffset(null),setMaxOffset(null))}),[videoData]),(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.vJ)((()=>{if(videoNode&&videoData)return isFinite(videoNode.duration)&&null===startOffset?onLoadedMetadata({target:videoNode}):isFinite(videoNode.duration)?videoNode.addEventListener("loadedmetadata",onLoadedMetadata):(videoNode.currentTime=Number.MAX_SAFE_INTEGER,videoNode.addEventListener("timeupdate",onLoadedMetadata)),endOffset&&videoNode.addEventListener("timeupdate",onTimeUpdate),()=>{videoNode.removeEventListener("timeupdate",onTimeUpdate),videoNode.removeEventListener("timeupdate",onLoadedMetadata),videoNode.removeEventListener("loadedmetadata",onLoadedMetadata)};function restart(at){videoNode.currentTime=at/1e3,videoNode.play().catch(_utils_noop__WEBPACK_IMPORTED_MODULE_2__.l)}function onLoadedMetadata(evt){if(!isFinite(evt.target.duration))return;const duration=Math.floor(1e3*evt.target.duration);rawSetStartOffset(videoData.start),setOriginalStartOffset(videoData.start),setCurrentTime(videoData.start),rawSetEndOffset(videoData.end??duration),setOriginalEndOffset(videoData.end??duration),setMaxOffset(duration),restart(videoData.start)}function onTimeUpdate(evt_0){if(!endOffset)return;const currentOffset=Math.floor(1e3*evt_0.target.currentTime);setCurrentTime(Math.min(currentOffset,endOffset)),currentOffset>endOffset&&!isPausedTracker.current&&restart(startOffset)}}),[startOffset,endOffset,videoData,videoNode]);const setStartOffset=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.hb)((offset=>{offset=Math.min(endOffset-_constants__WEBPACK_IMPORTED_MODULE_1__.Pt,offset),offset=Math.max(0,offset),rawSetStartOffset(offset),videoNode.currentTime=offset/1e3}),[videoNode,endOffset]),setEndOffset=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.hb)((offset_0=>{offset_0=Math.max(startOffset+_constants__WEBPACK_IMPORTED_MODULE_1__.Pt,offset_0),offset_0=Math.min(maxOffset,offset_0),rawSetEndOffset(offset_0),videoNode.currentTime=offset_0/1e3}),[videoNode,startOffset,maxOffset]);return{hasChanged:(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_0__.Kr)((()=>startOffset!==originalStartOffset||endOffset!==originalEndOffset),[startOffset,originalStartOffset,endOffset,originalEndOffset]),currentTime,startOffset,endOffset,maxOffset,videoNode,setStartOffset,setEndOffset,setVideoNode,setIsDraggingHandles}}},"./packages/story-editor/src/utils/dragEvent.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function isDragType(e,type){return!!e?.dataTransfer?.types&&e.dataTransfer.types.includes(type)}function isDraggingFile(e){return isDragType(e,"Files")}__webpack_require__.d(__webpack_exports__,{d:()=>isDragType,e:()=>isDraggingFile})},"./packages/story-editor/src/utils/isTargetOutOfContainer.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function isTargetOutOfContainer(target,container){const{left,right,top,bottom}=target.getBoundingClientRect(),containerRect=container.getBoundingClientRect();return left>containerRect.right||right<containerRect.left||bottom<containerRect.top||top>containerRect.bottom}},"./packages/story-editor/src/utils/keyboardOnlyOutline.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__,Ho:()=>isKeyboardUser});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/react/src/index.ts"),styled_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js");const KEYBOARD_USER_CLASS="useskeyboard",KEYBOARD_USER_SELECTOR=`.${KEYBOARD_USER_CLASS}`,OutlineStyles=(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.DU)(["body:not(",") *:focus{outline:none !important;}"],KEYBOARD_USER_SELECTOR),ACCEPTED_KEYS=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Digit1","Digit2","Digit3"];function isKeyboardUser(){return document.body.classList.contains(KEYBOARD_USER_CLASS)}const __WEBPACK_DEFAULT_EXPORT__=()=>{const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(13),[usingKeyboard,setUsingKeyboard]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_2__.J0)(!1);let t0;$[0]!==setUsingKeyboard||$[1]!==usingKeyboard?(t0=e=>{!usingKeyboard&&ACCEPTED_KEYS.includes(e.code)&&setUsingKeyboard(!0)},$[0]=setUsingKeyboard,$[1]=usingKeyboard,$[2]=t0):t0=$[2];const handleKeydown=t0;let t1;$[3]!==setUsingKeyboard||$[4]!==usingKeyboard?(t1=()=>{usingKeyboard&&setUsingKeyboard(!1)},$[3]=setUsingKeyboard,$[4]=usingKeyboard,$[5]=t1):t1=$[5];const handleMousedown=t1;let t2,t3,t4,t5;return $[6]!==handleKeydown||$[7]!==handleMousedown?(t2=()=>(document.addEventListener("keydown",handleKeydown,!0),document.addEventListener("mousedown",handleMousedown,!0),function cleanup(){document.removeEventListener("keydown",handleKeydown,!0),document.removeEventListener("mousedown",handleMousedown,!0)}),$[6]=handleKeydown,$[7]=handleMousedown,$[8]=t2):t2=$[8],(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_2__.vJ)(t2),$[9]!==usingKeyboard?(t3=()=>{document.body.classList.toggle(KEYBOARD_USER_CLASS,usingKeyboard)},t4=[usingKeyboard],$[9]=usingKeyboard,$[10]=t3,$[11]=t4):(t3=$[10],t4=$[11]),(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_2__.vJ)(t3,t4),$[12]===Symbol.for("react.memo_cache_sentinel")?(t5=react__WEBPACK_IMPORTED_MODULE_0__.createElement(OutlineStyles,null),$[12]=t5):t5=$[12],t5}},"./packages/story-editor/src/utils/useApplyTextAutoStyle.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),_googleforcreators_rich_text__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/rich-text/src/index.ts"),_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/elements/src/index.ts"),_app_pageCanvas__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/story-editor/src/app/pageCanvas/index.ts"),_components_panels_design_textStyle_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/components/panels/design/textStyle/utils.js");const __WEBPACK_DEFAULT_EXPORT__=function useApplyTextAutoStyle(element,updater){const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(5);let t0;$[0]===Symbol.for("react.memo_cache_sentinel")?(t0=(0,_googleforcreators_rich_text__WEBPACK_IMPORTED_MODULE_1__.$d)(),$[0]=t0):t0=$[0];const htmlFormatters=t0,{setColor}=htmlFormatters,calculateAccessibleTextColors=(0,_app_pageCanvas__WEBPACK_IMPORTED_MODULE_3__.zN)();let t1;return $[1]!==calculateAccessibleTextColors||$[2]!==element||$[3]!==updater?(t1=async()=>{const autoColor=await calculateAccessibleTextColors(element),{color:fgColor,backgroundColor}=autoColor;if(backgroundColor||fgColor){const highlightProps=backgroundColor?{backgroundColor:{color:backgroundColor},backgroundTextMode:_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_2__.xu.HIGHLIGHT,padding:(0,_components_panels_design_textStyle_utils__WEBPACK_IMPORTED_MODULE_4__.oB)(element)}:null,content=fgColor?setColor(element.content,{color:fgColor}):element.content;updater({...highlightProps,content})}},$[1]=calculateAccessibleTextColors,$[2]=element,$[3]=updater,$[4]=t1):t1=$[4],t1}},"./packages/story-editor/src/utils/useElementPolygon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),sat__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/sat/SAT.js"),sat__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(sat__WEBPACK_IMPORTED_MODULE_1__),_googleforcreators_units__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/units/src/useUnits.ts"),_googleforcreators_masks__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/masks/src/index.ts"),_app_story_useStory__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/story-editor/src/app/story/useStory.ts"),_app_canvas_useCanvas__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/app/canvas/useCanvas.ts");function _temp4(t0){const{actions:t1}=t0,{getBox,getBoxWithBorder}=t1;return{getBoxWithBorder,getBox}}function _temp3(t0){const{state}=t0;return state.currentPage?.elements?.find(_temp2)}function _temp2(t0){const{isBackground}=t0;return isBackground}function _temp(t0){const{state:t1}=t0,{nodesById}=t1;return nodesById}const __WEBPACK_DEFAULT_EXPORT__=function useElementPolygon(){const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(5),nodesById_0=(0,_app_canvas_useCanvas__WEBPACK_IMPORTED_MODULE_4__.A)(_temp),bgElement=(0,_app_story_useStory__WEBPACK_IMPORTED_MODULE_3__.A)(_temp3),{getBoxWithBorder:getBoxWithBorder_0,getBox:getBox_0}=(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_5__.A)(_temp4);let t0;return $[0]!==bgElement||$[1]!==getBoxWithBorder_0||$[2]!==getBox_0||$[3]!==nodesById_0?(t0=element=>{const bgNode=nodesById_0[bgElement.id],{x:bgX,y:bgY,width:bgWidth,height:bgHeight}=bgNode.getBoundingClientRect(),bgPolygon=new(sat__WEBPACK_IMPORTED_MODULE_1___default().Box)(new(sat__WEBPACK_IMPORTED_MODULE_1___default().Vector)(bgX,bgY),bgWidth,bgHeight).toPolygon(),elementYOffset=-getBox_0(bgElement).y;if(element.isBackground)return bgPolygon;const{id,rotationAngle}=element;if(!nodesById_0[id])return null;const box=(0,_googleforcreators_masks__WEBPACK_IMPORTED_MODULE_2__.Fn)(element)?getBoxWithBorder_0(element):getBox_0(element),center=new(sat__WEBPACK_IMPORTED_MODULE_1___default().Vector)(bgPolygon.pos.x+box.x+box.width/2,bgPolygon.pos.y+elementYOffset+box.y+box.height/2),polygon=new(sat__WEBPACK_IMPORTED_MODULE_1___default().Box)(center,box.width,box.height).toPolygon(),offset=new(sat__WEBPACK_IMPORTED_MODULE_1___default().Vector)(-box.width/2,-box.height/2);return polygon.setOffset(offset),polygon.setAngle(rotationAngle*Math.PI/180),polygon},$[0]=bgElement,$[1]=getBoxWithBorder_0,$[2]=getBox_0,$[3]=nodesById_0,$[4]=t0):t0=$[4],t0}},"./packages/story-editor/src/utils/useElementsWithLinks.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/elements/src/index.ts"),_app_story__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/story-editor/src/app/story/index.ts"),_app_canvas__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/story-editor/src/app/canvas/index.ts");function _temp4(element_1){return(0,_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__.Bx)(element_1,!1)}function _temp3(element_0){return(0,_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__.Bx)(element_0,!0)}function _temp2(element){return(0,_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__.Bx)(element)}function _temp(state){return{pageAttachmentContainer:state.state.pageAttachmentContainer}}const __WEBPACK_DEFAULT_EXPORT__=function useElementsWithLinks(){const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_3__.c)(11),{pageAttachmentContainer}=(0,_app_canvas__WEBPACK_IMPORTED_MODULE_7__.yu)(_temp);let t0;$[0]!==pageAttachmentContainer?(t0=t1=>{const{state:state_0}=t1,elementsWithLinks=state_0.currentPage?.elements.filter(_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__.V7.linkable)||[],hasPageAttachment=Boolean(state_0.currentPage?.pageAttachment?.url?.length);return{hasInvalidLinkSelected:Boolean(pageAttachmentContainer&&hasPageAttachment&&state_0.selectedElements.filter(_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__.V7.linkable).some(_temp2)),hasLinksInAttachmentArea:Boolean(pageAttachmentContainer&&elementsWithLinks.some(_temp3)),hasElementsInAttachmentArea:Boolean(pageAttachmentContainer&&hasPageAttachment&&state_0.selectedElements.some(_temp4)),hasPageAttachment}},$[0]=pageAttachmentContainer,$[1]=t0):t0=$[1];const{hasLinksInAttachmentArea,hasInvalidLinkSelected,hasPageAttachment:hasPageAttachment_0,hasElementsInAttachmentArea}=(0,_app_story__WEBPACK_IMPORTED_MODULE_6__.P3)(t0);let t1,t2;$[2]!==hasPageAttachment_0||$[3]!==pageAttachmentContainer?(t1=element_2=>!!pageAttachmentContainer&&(!!hasPageAttachment_0&&(0,_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_5__.Bx)(element_2,!1)),t2=[pageAttachmentContainer,hasPageAttachment_0],$[2]=hasPageAttachment_0,$[3]=pageAttachmentContainer,$[4]=t1,$[5]=t2):(t1=$[4],t2=$[5]);const isElementInAttachmentArea=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_4__.hb)(t1,t2);let t3;return $[6]!==hasElementsInAttachmentArea||$[7]!==hasInvalidLinkSelected||$[8]!==hasLinksInAttachmentArea||$[9]!==isElementInAttachmentArea?(t3={hasLinksInAttachmentArea,hasInvalidLinkSelected,isElementInAttachmentArea,hasElementsInAttachmentArea},$[6]=hasElementsInAttachmentArea,$[7]=hasInvalidLinkSelected,$[8]=hasLinksInAttachmentArea,$[9]=isElementInAttachmentArea,$[10]=t3):t3=$[10],t3}},"./packages/story-editor/src/utils/useShapeMask.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_masks__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/masks/src/index.ts"),_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/elements/src/index.ts"),_app__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/app/index.js"),_components_canvas_useInsertElement__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/components/canvas/useInsertElement.ts"),_objectPick__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/story-editor/src/utils/objectPick.ts");const __WEBPACK_DEFAULT_EXPORT__=element=>{const $=(0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(10),{updateElementById}=(0,_app__WEBPACK_IMPORTED_MODULE_4__.P3)(_temp),insertElement=(0,_components_canvas_useInsertElement__WEBPACK_IMPORTED_MODULE_5__.A)();let t0;$[0]!==element.type?(t0=(0,_googleforcreators_elements__WEBPACK_IMPORTED_MODULE_3__.zh)(element.type),$[0]=element.type,$[1]=t0):t0=$[1];const{isMedia}=t0,hasShapeMask=isMedia&&element?.mask?.type!==_googleforcreators_masks__WEBPACK_IMPORTED_MODULE_2__.E_.RECTANGLE;let t1,t2;$[2]!==element||$[3]!==insertElement||$[4]!==updateElementById?(t1=()=>{if(!element)return;const shapeProps=(0,_objectPick__WEBPACK_IMPORTED_MODULE_6__.A)(element,["x","y","width","height","scale","rotationAngle"]);insertElement("shape",{...shapeProps,mask:{type:element.mask.type}}),updateElementById({elementId:element.id,properties:{mask:{type:_googleforcreators_masks__WEBPACK_IMPORTED_MODULE_2__.E_.RECTANGLE}}})},t2=[element,insertElement,updateElementById],$[2]=element,$[3]=insertElement,$[4]=updateElementById,$[5]=t1,$[6]=t2):(t1=$[5],t2=$[6]);const removeShapeMask=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)(t1,t2);let t3;return $[7]!==hasShapeMask||$[8]!==removeShapeMask?(t3={hasShapeMask,removeShapeMask},$[7]=hasShapeMask,$[8]=removeShapeMask,$[9]=t3):t3=$[9],t3};function _temp(t0){const{actions}=t0;return{updateElementById:actions.updateElementById,combineElements:actions.combineElements}}}}]);