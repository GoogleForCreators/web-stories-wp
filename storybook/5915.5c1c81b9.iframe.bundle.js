"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[5915],{"./packages/design-system/src/components/toggle/toggle.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/design-system/src/icons/checkmark_small.svg");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const Wrapper=styled_components__WEBPACK_IMPORTED_MODULE_1__.Ay.div.withConfig({displayName:"toggle__Wrapper",componentId:"sc-3bc7bd-0"})(["padding:","px;"],4),Background=styled_components__WEBPACK_IMPORTED_MODULE_1__.Ay.div.withConfig({displayName:"toggle__Background",componentId:"sc-3bc7bd-1"})((({theme})=>(0,styled_components__WEBPACK_IMPORTED_MODULE_1__.AH)(["position:absolute;top:-","px;left:-","px;height:","px;width:","px;background-color:transparent;border-radius:",";border:","px solid ",";pointer-events:none;transition:all 0.3s;"],1,1,20,44,theme.borders.radius.x_large,1,theme.colors.border.defaultNormal))),Circle=styled_components__WEBPACK_IMPORTED_MODULE_1__.Ay.span.withConfig({displayName:"toggle__Circle",componentId:"sc-3bc7bd-2"})((({theme})=>(0,styled_components__WEBPACK_IMPORTED_MODULE_1__.AH)(["pointer-events:none;:after{content:'';position:absolute;top:","px;left:","px;height:","px;width:","px;background-color:",";border-radius:",";cursor:pointer;transition:background-color 0.3s,border-color 0.3s,left 0.15s;}"],-5,-5,28,28,theme.colors.fg.secondary,theme.borders.radius.round))),IconContainer=styled_components__WEBPACK_IMPORTED_MODULE_1__.Ay.div.withConfig({displayName:"toggle__IconContainer",componentId:"sc-3bc7bd-3"})((({theme})=>(0,styled_components__WEBPACK_IMPORTED_MODULE_1__.AH)(["position:absolute;width:","px;top:","px;left:","px;z-index:1;opacity:0;transition:opacity 0.15s;pointer-events:none;svg{color:",";}"],32,-6,19,theme.colors.standard.white))),ToggleContainer=styled_components__WEBPACK_IMPORTED_MODULE_1__.Ay.div.withConfig({displayName:"toggle__ToggleContainer",componentId:"sc-3bc7bd-4"})((({theme})=>(0,styled_components__WEBPACK_IMPORTED_MODULE_1__.AH)(["position:relative;height:","px;width:","px;background-color:transparent;border-radius:",";input[type='checkbox']{position:absolute;top:-","px;left:-","px;height:","px;width:","px;margin:0;opacity:0;cursor:pointer;:disabled{cursor:default;~ ","{border-color:",";}:checked ~ ","{background-color:",";border-color:",";}~ ",":after{background-color:",";}:checked ~ ",":after{background-color:",";}~ "," svg{color:",";}}&:focus-visible{~ ","{outline:none;box-shadow:0 0 0 5px ",",0 0 0 7px ",";}}:checked{~ ","{background-color:",";border-color:",";}~ ",":after{left:","px;background-color:",";}~ ","{opacity:1;}}:hover{:not(:disabled) ~ ","{border-color:",";}:checked:not(:disabled) ~ ","{background-color:",";border-color:",";}}:active{~ ","{box-shadow:0 0 0 8px ",";}}}"],20,44,theme.borders.radius.x_large,.5,.5,20,44,Background,theme.colors.fg.disable,Background,theme.colors.fg.disable,theme.colors.fg.disable,Circle,theme.colors.fg.disable,Circle,theme.colors.bg.secondary,IconContainer,theme.colors.fg.disable,Background,theme.colors.bg.primary,theme.colors.border.focus,Background,theme.colors.interactiveBg.positivePress,theme.colors.interactiveBg.positivePress,Circle,21,theme.colors.interactiveBg.positiveNormal,IconContainer,Background,theme.colors.fg.secondary,Background,theme.colors.interactiveBg.positiveHover,theme.colors.interactiveBg.positiveHover,Background,theme.colors.shadow.active)));const __WEBPACK_DEFAULT_EXPORT__=function Toggle({className,...inputProps}){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(Wrapper,{className},react__WEBPACK_IMPORTED_MODULE_0__.createElement(ToggleContainer,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",_extends({type:"checkbox"},inputProps)),react__WEBPACK_IMPORTED_MODULE_0__.createElement(Background,null),react__WEBPACK_IMPORTED_MODULE_0__.createElement(IconContainer,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_icons__WEBPACK_IMPORTED_MODULE_2__.A,null)),react__WEBPACK_IMPORTED_MODULE_0__.createElement(Circle,null)))}},"./packages/story-editor/src/components/header/buttons/buttonWithChecklistWarning.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/i18n/src/i18n.ts"),styled_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/design-system/src/components/popup/constants.ts"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/react/src/index.ts"),_app__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/story-editor/src/app/index.js"),_constants_zIndex__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/story-editor/src/constants/zIndex.ts"),_utils_useIsUploadingToStory__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/story-editor/src/utils/useIsUploadingToStory.js"),_checklist__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/components/checklist/index.js"),_tooltip__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const Button=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__.$).withConfig({displayName:"buttonWithChecklistWarning__Button",componentId:"sc-jm08jq-0"})(["padding:4px 6px;height:32px;svg{width:24px;height:auto;}"]),InnerButton=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Rf)((function InnerButton({text,checkpoint,hasHighPriorityIssues=!1,onClick,...buttonProps},ref){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(Button,_extends({ref,variant:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.Ak.Rectangle,type:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.VQ.Primary,size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.Mp.Small,onClick:evt=>{evt.currentTarget.blur(),onClick?.(evt)}},buttonProps),text,hasHighPriorityIssues&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_checklist__WEBPACK_IMPORTED_MODULE_4__._r,{checkpoint}))})),__WEBPACK_DEFAULT_EXPORT__=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Rf)((function ButtonWithChecklistWarning({disabled,hasFutureDate,...buttonProps},ref){const isUploading=(0,_utils_useIsUploadingToStory__WEBPACK_IMPORTED_MODULE_3__.A)(),{isSaving,canPublish,status}=(0,_app__WEBPACK_IMPORTED_MODULE_2__.P3)((({state})=>({isSaving:state.meta?.isSaving,status:state.story.status,canPublish:Boolean(state?.capabilities?.publish)}))),{checkpoint,hasHighPriorityIssues}=(0,_checklist__WEBPACK_IMPORTED_MODULE_4__.Em)((({state:{checkpoint,hasHighPriorityIssues}})=>({checkpoint,hasHighPriorityIssues}))),TOOLTIP_TEXT={[_checklist__WEBPACK_IMPORTED_MODULE_4__.xh.ALL]:hasHighPriorityIssues?(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Make updates before publishing to improve discoverability and performance on search engines","web-stories"):"",[_checklist__WEBPACK_IMPORTED_MODULE_4__.xh.ONLY_RECOMMENDED]:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Review checklist to improve performance before publishing","web-stories"),[_checklist__WEBPACK_IMPORTED_MODULE_4__.xh.UNAVAILABLE]:""},TOOLTIP_TEXT_UPLOADING=(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Saving is disabled due to media currently being uploaded.","web-stories"),TOOLTIP_TEXT_REVIEW=(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Submit your work for review, and an Editor will be able to approve it for you.","web-stories");let toolTip=isUploading?TOOLTIP_TEXT_UPLOADING:TOOLTIP_TEXT[checkpoint];canPublish||(toolTip=TOOLTIP_TEXT_REVIEW);const publishText=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Kr)((()=>hasFutureDate&&"private"!==status?(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Schedule","web-stories"):(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Publish","web-stories")),[hasFutureDate,status]),text=canPublish?publishText:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Submit for review","web-stories");return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_tooltip__WEBPACK_IMPORTED_MODULE_5__.A,{title:toolTip,popupZIndexOverride:_constants_zIndex__WEBPACK_IMPORTED_MODULE_10__.Xl,hasTail:!0,placement:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_11__.W.BottomEnd},react__WEBPACK_IMPORTED_MODULE_0__.createElement(InnerButton,_extends({ref,text,disabled:disabled||isSaving||isUploading,checkpoint,hasHighPriorityIssues},buttonProps)))}))},"./packages/story-editor/src/components/panels/document/excerpt/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>EXCERPT_MAX_LENGTH});__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./packages/react/src/index.ts");var styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),components_form=(__webpack_require__("./packages/story-editor/src/app/story/index.ts"),__webpack_require__("./packages/story-editor/src/components/form/index.js")),panel=__webpack_require__("./packages/story-editor/src/components/panels/panel/index.js");__webpack_require__("./packages/story-editor/src/app/highlights/index.ts"),__webpack_require__("./packages/story-editor/src/app/highlights/styles.js");(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).withConfig({displayName:"excerpt__StyledText",componentId:"sc-t9wjp4-0"})(["color:",";margin-top:-4px;"],(({theme})=>theme.colors.fg.tertiary));const EXCERPT_MAX_LENGTH=200;(0,styled_components_browser_esm.Ay)(panel.RV).withConfig({displayName:"excerpt___StyledSimplePanel",componentId:"sc-t9wjp4-1"})(["",""],(p=>p.$_css)),(0,styled_components_browser_esm.Ay)(components_form.fs).withConfig({displayName:"excerpt___StyledTextArea",componentId:"sc-t9wjp4-2"})(["",""],(p=>p.$_css2))},"./packages/story-editor/src/components/panels/document/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ag:()=>pageAdvancement,Ej:()=>slug});__webpack_require__("./packages/story-editor/src/components/panels/document/excerpt/index.js");var react=__webpack_require__("./node_modules/react/index.js"),src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),story=__webpack_require__("./packages/story-editor/src/app/story/index.ts"),config=__webpack_require__("./packages/story-editor/src/app/config/index.ts"),generalPageAdvancement=__webpack_require__("./packages/story-editor/src/components/panels/shared/generalPageAdvancement.js");const pageAdvancement=function PageAdvancementPanel({nameOverride}){const{globalPageDuration}=(0,config.UK)(),{autoAdvance,defaultPageDuration,updateStory}=(0,story.P3)((({state:{story:{autoAdvance,defaultPageDuration}},actions:{updateStory}})=>({autoAdvance,defaultPageDuration:defaultPageDuration||globalPageDuration,updateStory}))),onUpdate=(0,src.hb)((newProps=>{const{pageDuration,...rest}=newProps,properties={...rest,defaultPageDuration:pageDuration};updateStory({properties})}),[updateStory]);return react.createElement(generalPageAdvancement.A,{panelName:nameOverride||"pageAdvancement",collapsedByDefault:!1,onUpdate,autoAdvance,pageDuration:defaultPageDuration},(0,i18n.__)("Control whether a story auto-advances between pages, or whether the reader has to manually tap to advance.","web-stories"))};var styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),input=__webpack_require__("./packages/design-system/src/components/input/input.tsx"),typography_link=__webpack_require__("./packages/design-system/src/components/typography/link/index.tsx"),types=__webpack_require__("./packages/design-system/src/theme/types.ts");function safeDecodeURIComponent(uriComponent){try{return decodeURIComponent(uriComponent)}catch(uriComponentError){return uriComponent}}var cleanForSlug=__webpack_require__("./packages/story-editor/src/utils/cleanForSlug.ts"),components_form=__webpack_require__("./packages/story-editor/src/components/form/index.js"),panel=__webpack_require__("./packages/story-editor/src/components/panels/panel/index.js"),styles=__webpack_require__("./packages/story-editor/src/components/panels/shared/styles.js");const MIN_MAX_PERMALINK={MIN:1,MAX:200},PermalinkRow=(0,styled_components_browser_esm.Ay)(components_form.fI).withConfig({displayName:"slug__PermalinkRow",componentId:"sc-12ylqoy-0"})(["margin-bottom:12px;input{color:",";:active,:focus,:focus-visible{color:",";}}"],(({theme})=>theme.colors.fg.tertiary),(({theme})=>theme.colors.fg.primary)),LinkContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"slug__LinkContainer",componentId:"sc-12ylqoy-1"})(["margin-bottom:16px;"]);const slug=function SlugPanel({nameOverride}){const{slug:savedSlug,link,permalinkConfig,updateStory}=(0,story.P3)((({state:{story:{slug="",link,permalinkConfig}},actions:{updateStory}})=>({slug:safeDecodeURIComponent(slug),link,permalinkConfig,updateStory}))),[slug,setSlug]=(0,src.J0)(savedSlug);(0,src.vJ)((()=>{setSlug(savedSlug)}),[savedSlug]);const updateSlug=(0,src.hb)((value=>{const newSlug=value.slice(0,MIN_MAX_PERMALINK.MAX);updateStory({properties:{slug:(0,cleanForSlug.A)(newSlug)}})}),[updateStory]),handleChange=(0,src.hb)((evt=>setSlug((0,cleanForSlug.A)(evt.target.value,!0))),[]),handleBlur=(0,src.hb)((evt=>updateSlug(evt.target.value)),[updateSlug]),displayLink=slug&&permalinkConfig&&((value,{MIN,MAX})=>value>=MIN&&value<=MAX)(slug.length,MIN_MAX_PERMALINK)?permalinkConfig.prefix+slug+permalinkConfig.suffix:link;return react.createElement(panel.RV,{name:nameOverride||"permalink",title:(0,i18n.__)("Permalink","web-stories"),collapsedByDefault:!1},permalinkConfig&&react.createElement(PermalinkRow,null,react.createElement(input.A,{value:String(slug),onChange:handleChange,onBlur:handleBlur,placeholder:(0,i18n.__)("Enter slug","web-stories"),"aria-label":(0,i18n.__)("URL slug","web-stories"),minLength:MIN_MAX_PERMALINK.MIN,maxLength:MIN_MAX_PERMALINK.MAX,containerStyleOverride:styles.t})),react.createElement(LinkContainer,null,react.createElement(typography_link.N,{rel:"noreferrer",target:"_blank",href:link,size:types.$.Small},displayLink)))};var typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts");__webpack_require__("./packages/story-editor/src/app/index.js"),__webpack_require__("./packages/story-editor/src/components/panels/shared/media/backgroundAudioPanelContent.js");(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.Small}).withConfig({displayName:"backgroundAudio__HelperText",componentId:"sc-1n4veap-0"})(["color:",";"],(({theme})=>theme.colors.fg.secondary));__webpack_require__("./packages/story-editor/src/components/panels/document/taxonomies/taxonomies.js")},"./packages/story-editor/src/components/panels/shared/generalPageAdvancement.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./packages/i18n/src/i18n.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./packages/i18n/src/sprintf.ts"),uuid__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/story-editor/node_modules/uuid/dist/esm-browser/v4.js"),_googleforcreators_tracking__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/tracking/src/index.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/design-system/src/theme/types.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./packages/design-system/src/components/toggle/toggle.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./packages/design-system/src/components/input/numericInput.tsx"),_googleforcreators_units__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/units/src/range.ts"),_googleforcreators_output__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/output/src/index.ts"),_form__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/components/form/index.js"),_panel__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/components/panels/panel/index.js"),_styles__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/story-editor/src/components/panels/shared/styles.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const SwitchRow=styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay.div.withConfig({displayName:"generalPageAdvancement__SwitchRow",componentId:"sc-12jhjbx-0"})(["margin-bottom:16px;"]),JustifyEndRow=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_form__WEBPACK_IMPORTED_MODULE_4__.fI).withConfig({displayName:"generalPageAdvancement__JustifyEndRow",componentId:"sc-12jhjbx-1"})(["justify-content:flex-end;gap:8px;"]),MutedText=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.E.Paragraph).attrs({size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_9__.$.Small}).withConfig({displayName:"generalPageAdvancement__MutedText",componentId:"sc-12jhjbx-2"})(["color:",";"],(({theme})=>theme.colors.fg.secondary)),LabelText=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.E.Label).attrs({size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_9__.$.Small}).withConfig({displayName:"generalPageAdvancement__LabelText",componentId:"sc-12jhjbx-3"})(["color:",";"],(({theme})=>theme.colors.fg.secondary)),MIN_MAX_PAGE_DURATION={MIN:1,MAX:20};const __WEBPACK_DEFAULT_EXPORT__=function GeneralPageAdvancementPanel({pageDuration=_googleforcreators_output__WEBPACK_IMPORTED_MODULE_3__.h4,autoAdvance=_googleforcreators_output__WEBPACK_IMPORTED_MODULE_3__.Pn,onUpdate,allowsOverride=!1,hasOverrideEnabled=!1,children,panelName,...rest}){const[duration,setDuration]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.J0)(pageDuration);(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.vJ)((()=>{setDuration(pageDuration)}),[pageDuration]);const onAdvanceChange=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)(((_evt,value)=>{onUpdate({autoAdvance:value}),(0,_googleforcreators_tracking__WEBPACK_IMPORTED_MODULE_2__.sx)("change_page_advancement",{status:value?"auto":"manual",duration})}),[onUpdate,duration]),updatePageDuration=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.YQ)((value=>{const newValue=(0,_googleforcreators_units__WEBPACK_IMPORTED_MODULE_10__.qE)(value,MIN_MAX_PAGE_DURATION);value!==newValue&&setDuration(newValue),pageDuration!==newValue&&(onUpdate({pageDuration:newValue}),(0,_googleforcreators_tracking__WEBPACK_IMPORTED_MODULE_2__.sx)("change_page_advancement",{status:autoAdvance?"auto":"manual",duration:newValue}))}),800),onDurationChange=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)(((_evt,newValue)=>{setDuration(newValue),updatePageDuration(newValue)}),[updatePageDuration]),onOverrideChange=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)((()=>onUpdate({override:!hasOverrideEnabled})),[hasOverrideEnabled,onUpdate]),customAdvancementDisabled=allowsOverride&&!hasOverrideEnabled,toggleId=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Kr)((()=>`toggle_${(0,uuid__WEBPACK_IMPORTED_MODULE_11__.A)()}`),[]);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_panel__WEBPACK_IMPORTED_MODULE_5__.RV,_extends({name:panelName,title:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Page Advancement","web-stories")},rest),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_form__WEBPACK_IMPORTED_MODULE_4__.fI,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(MutedText,null,children)),allowsOverride&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(JustifyEndRow,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(LabelText,{htmlFor:toggleId},(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Override Story Defaults","web-stories")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__.A,{id:toggleId,checked:hasOverrideEnabled,onChange:onOverrideChange})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(SwitchRow,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_form__WEBPACK_IMPORTED_MODULE_4__.dO,{groupLabel:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Page Advancement","web-stories"),name:"page-advancement-switch",value:autoAdvance,onLabel:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Auto","web-stories"),offLabel:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Manual","web-stories"),disabled:customAdvancementDisabled,onChange:onAdvanceChange})),autoAdvance&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_form__WEBPACK_IMPORTED_MODULE_4__.fI,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__.A,{unit:` ${(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("seconds","web-stories")}`,suffix:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Duration","web-stories"),value:duration,onChange:onDurationChange,"aria-label":(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__.__)("Default page duration in seconds","web-stories"),min:MIN_MAX_PAGE_DURATION.MIN,max:MIN_MAX_PAGE_DURATION.MAX,disabled:customAdvancementDisabled,containerStyleOverride:_styles__WEBPACK_IMPORTED_MODULE_6__.t})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(MutedText,null,(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_15__.A)((0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_12__._n)("Duration between %1$d and %2$d second.","Duration between %1$d and %2$d seconds.",MIN_MAX_PAGE_DURATION.MAX,"web-stories"),MIN_MAX_PAGE_DURATION.MIN,MIN_MAX_PAGE_DURATION.MAX))))}},"./packages/story-editor/src/components/panels/shared/media/backgroundAudioPanelContent.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>backgroundAudioPanelContent});var react=__webpack_require__("./node_modules/react/index.js"),styled_components_browser_esm=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js"),__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js")),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),outline=__webpack_require__("./packages/design-system/src/theme/helpers/outline.ts"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),translateToExclusiveList=__webpack_require__("./packages/i18n/src/translateToExclusiveList.ts"),react_src=__webpack_require__("./packages/react/src/index.ts"),src_mimeTypes=__webpack_require__("./packages/media/src/mimeTypes.ts"),preloadVideo=__webpack_require__("./packages/media/src/preloadVideo.ts"),getVideoLength=__webpack_require__("./packages/media/src/getVideoLength.ts"),v4=__webpack_require__("./packages/story-editor/node_modules/uuid/dist/esm-browser/v4.js"),src=__webpack_require__("./packages/tracking/src/index.ts"),config=__webpack_require__("./packages/story-editor/src/app/config/index.ts"),components_form=__webpack_require__("./packages/story-editor/src/components/form/index.js"),useCORSProxy=__webpack_require__("./packages/story-editor/src/utils/useCORSProxy.ts"),hotlinkModal=__webpack_require__("./packages/story-editor/src/components/hotlinkModal/index.js"),noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts"),captionsPanelContent=__webpack_require__("./packages/story-editor/src/components/panels/shared/media/captionsPanelContent.js"),loopPanelContent=__webpack_require__("./packages/story-editor/src/components/panels/shared/media/loopPanelContent.js"),play_filled=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./packages/design-system/src/icons/play_filled.svg")),stop_filled=__webpack_require__("./packages/design-system/src/icons/stop_filled.svg"),expandPresetStyles=__webpack_require__("./packages/design-system/src/theme/helpers/expandPresetStyles.ts"),zIndex=__webpack_require__("./packages/story-editor/src/constants/zIndex.ts"),tooltip=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js");const Play=(0,styled_components_browser_esm.Ay)(play_filled.A).withConfig({displayName:"audioPlayer__Play",componentId:"sc-gch3p5-0"})(["width:30px !important;height:30px !important;"]),Stop=(0,styled_components_browser_esm.Ay)(stop_filled.A).withConfig({displayName:"audioPlayer__Stop",componentId:"sc-gch3p5-1"})(["width:30px !important;height:30px !important;"]),StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"audioPlayer__StyledButton",componentId:"sc-gch3p5-2"})(["",";"],(({theme})=>outline.Q(theme.colors.border.focus,theme.colors.bg.secondary))),Wrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"audioPlayer__Wrapper",componentId:"sc-gch3p5-3"})((({theme})=>(0,styled_components_browser_esm.AH)(["color:",";",";"],theme.colors.fg.primary,expandPresetStyles.s({preset:{...theme.typography.presets.paragraph[types.$.Small]},theme})))),Audio=styled_components_browser_esm.Ay.audio.withConfig({displayName:"audioPlayer__Audio",componentId:"sc-gch3p5-4"})(["display:none;"]);const audioPlayer=function AudioPlayer({src,mimeType,tracks=[],audioId,loop,playerRef}){const[isPlaying,setIsPlaying]=(0,react_src.J0)(!1),{getProxiedUrl}=(0,useCORSProxy.A)(),handlePlayPause=(0,react_src.hb)((()=>{const player=playerRef.current;player&&(isPlaying?player.pause():player.play().catch(noop.l))}),[isPlaying,playerRef]);(0,react_src.vJ)((()=>{const player=playerRef.current;if(!player)return;const onAudioPlay=()=>setIsPlaying(!0),onAudioPause=()=>setIsPlaying(!1),onAudioEnd=()=>{player.currentTime=0,setIsPlaying(!1)};return player.addEventListener("play",onAudioPlay),player.addEventListener("pause",onAudioPause),player.addEventListener("ended",onAudioEnd),()=>{player.removeEventListener("play",onAudioPlay),player.removeEventListener("pause",onAudioPause),player.removeEventListener("ended",onAudioEnd)}}),[playerRef]);const buttonTitle=isPlaying?(0,i18n.__)("Pause","web-stories"):(0,i18n.__)("Play","web-stories"),tracksFormatted=tracks.map((track=>{const trackSrc=getProxiedUrl(track,track?.track);return{...track,track:trackSrc}}));return react.createElement(Wrapper,null,react.createElement(Audio,{crossOrigin:"anonymous",loop,ref:playerRef,id:audioId},react.createElement("source",{src,type:mimeType}),tracksFormatted&&tracksFormatted.map((({srclang,label,track:trackSrc,id:key},i)=>react.createElement("track",{srcLang:srclang,label,kind:"metadata",src:trackSrc,key,default:0===i})))),react.createElement(tooltip.A,{hasTail:!0,title:buttonTitle,popupZIndexOverride:zIndex.Xl},react.createElement(StyledButton,{type:constants.VQ.Tertiary,size:constants.Mp.Small,variant:constants.Ak.Square,"aria-label":buttonTitle,onClick:handlePlayPause},isPlaying?react.createElement(Stop,null):react.createElement(Play,null))))};var fileRow=__webpack_require__("./packages/story-editor/src/components/panels/shared/media/fileRow.js");const backgroundAudioPanelContent_StyledButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"backgroundAudioPanelContent__StyledButton",componentId:"sc-t2iem8-0"})(["",";"],(({theme})=>outline.Q(theme.colors.border.focus,theme.colors.bg.secondary))),UploadButton=(0,styled_components_browser_esm.Ay)(backgroundAudioPanelContent_StyledButton).withConfig({displayName:"backgroundAudioPanelContent__UploadButton",componentId:"sc-t2iem8-1"})(["padding:12px 8px;"]),ButtonRow=(0,styled_components_browser_esm.Ay)(components_form.fI).withConfig({displayName:"backgroundAudioPanelContent__ButtonRow",componentId:"sc-t2iem8-2"})(["gap:12px;"]),SectionHeading=(0,styled_components_browser_esm.Ay)(typography_text.E.Paragraph).attrs({size:types.$.Small}).withConfig({displayName:"backgroundAudioPanelContent__SectionHeading",componentId:"sc-t2iem8-3"})(["font-weight:bold;margin-bottom:12px;"]);const backgroundAudioPanelContent=function BackgroundAudioPanelContent({backgroundAudio,updateBackgroundAudio,showCaptions=!1,showLoopControl=!1,audioId}){const{allowedMimeTypes:{audio:allowedAudioMimeTypes},capabilities:{hasUploadMediaAction},MediaUpload}=(0,config.UK)(),[isOpen,setIsOpen]=(0,react_src.J0)(!1),{getProxiedUrl}=(0,useCORSProxy.A)(),allowedAudioFileTypes=(0,react_src.Kr)((()=>allowedAudioMimeTypes.flatMap((type=>(0,src_mimeTypes.n)(type)))),[allowedAudioMimeTypes]),{resource={},tracks=[],loop=!0}=backgroundAudio||{},playerRef=(0,react_src.li)(),audioSrcProxied=getProxiedUrl(resource,resource?.src),onSelectErrorMessage=(0,sprintf.A)((0,i18n.__)("Please choose only %s to insert into page.","web-stories"),(0,translateToExclusiveList.A)(allowedAudioFileTypes)),onSelect=(0,react_src.hb)((({src,id,mimeType,needsProxy,length,lengthFormatted})=>{const updatedBackgroundAudio={resource:{src,id,mimeType,length,lengthFormatted,needsProxy}};showCaptions&&(updatedBackgroundAudio.tracks=[]),showLoopControl&&(updatedBackgroundAudio.loop=!0),updateBackgroundAudio(updatedBackgroundAudio)}),[showCaptions,showLoopControl,updateBackgroundAudio]),onSelectHotlink=(0,react_src.hb)((async({link,hotlinkInfo,needsProxy})=>{const{mimeType}=hotlinkInfo,audioProxied=getProxiedUrl({needsProxy},link),videoEl=await(0,preloadVideo.A)(audioProxied),{length,lengthFormatted}=(0,getVideoLength.A)(videoEl);onSelect({src:link,mimeType,length,lengthFormatted,needsProxy}),setIsOpen(!1),(0,src.sx)("hotlink_audio",{event_label:link,file_size:hotlinkInfo.fileSize,file_type:hotlinkInfo.mimeType,needs_proxy:needsProxy}),setIsOpen(!1)}),[getProxiedUrl,onSelect]),onError=(0,react_src.hb)((err=>(0,src.Oz)("hotlink_audio",err?.message)),[]),updateTracks=(0,react_src.hb)((newTracks=>{updateBackgroundAudio({...backgroundAudio,tracks:newTracks})}),[backgroundAudio,updateBackgroundAudio]),onChangeLoop=(0,react_src.hb)((evt=>{updateBackgroundAudio({...backgroundAudio,loop:evt.target.checked})}),[backgroundAudio,updateBackgroundAudio]),handleRemoveTrack=(0,react_src.hb)((idToDelete=>{let newTracks=[];if(idToDelete){const trackIndex=tracks.findIndex((({id})=>id===idToDelete));newTracks=[...tracks.slice(0,trackIndex),...tracks.slice(trackIndex+1)]}updateTracks(newTracks)}),[tracks,updateTracks]),handleChangeTrack=(0,react_src.hb)((({src="",id,needsProxy=!1})=>{const newTrack={track:src,trackId:id,id:(0,v4.A)(),kind:"captions",srclang:"",label:"",needsProxy};updateTracks([newTrack])}),[updateTracks]),renderUploadButton=(0,react_src.hb)((open=>react.createElement(UploadButton,{onClick:open,type:constants.VQ.Secondary,size:constants.Mp.Small,variant:constants.Ak.Rectangle},(0,i18n.__)("Upload an audio file","web-stories"))),[]),renderUploadCaptionButton=(0,react_src.hb)((open=>react.createElement(UploadButton,{onClick:open,type:constants.VQ.Secondary,size:constants.Mp.Small,variant:constants.Ak.Rectangle},(0,i18n.__)("Upload audio captions","web-stories"))),[]),handleRemove=(0,react_src.hb)((()=>{playerRef.current&&playerRef.current.pause(),updateBackgroundAudio(null)}),[updateBackgroundAudio,playerRef]),options=[hasUploadMediaAction&&{label:(0,i18n.__)("Upload a file","web-stories"),value:"upload",onClick:noop.l,mediaPickerProps:{onSelect,onSelectErrorMessage:(0,i18n.__)("Please choose a VTT file to use as caption.","web-stories"),type:allowedAudioMimeTypes,title:(0,i18n.__)("Upload an audio file","web-stories"),buttonInsertText:(0,i18n.__)("Select audio file","web-stories")}},{label:(0,i18n.__)("Link to a file","web-stories"),value:"hotlink",onClick:()=>{setIsOpen(!0)}}].filter(Boolean);return react.createElement(react.Fragment,null,!resource?.src&&react.createElement(ButtonRow,{spaceBetween:!1},hasUploadMediaAction&&react.createElement(MediaUpload,{onSelect,onSelectErrorMessage,type:allowedAudioMimeTypes,title:(0,i18n.__)("Upload an audio file","web-stories"),buttonInsertText:(0,i18n.__)("Select audio file","web-stories"),render:renderUploadButton}),react.createElement(UploadButton,{variant:constants.Ak.Rectangle,type:constants.VQ.Secondary,size:constants.Mp.Small,onClick:()=>setIsOpen(!0)},(0,i18n.__)("Link to audio file","web-stories"))),resource?.src&&react.createElement(react.Fragment,null,react.createElement(fileRow.A,{id:resource.id,src:resource.src,title:resource.src.split("/").pop(),isExternal:!resource.id,options,onRemove:handleRemove,removeItemLabel:(0,i18n.__)("Remove file","web-stories")},react.createElement(audioPlayer,{title:resource.src.substring(resource?.src.lastIndexOf("/")+1),src:audioSrcProxied,mimeType:resource.mimeType,tracks,audioId,playerRef,loop})),showCaptions&&react.createElement(react.Fragment,null,react.createElement(SectionHeading,null,(0,i18n.__)("Caption and Subtitles","web-stories")),react.createElement(captionsPanelContent.A,{captionText:(0,i18n.__)("Upload a file","web-stories"),tracks:tracks||[],handleChangeTrack,handleRemoveTrack,renderUploadButton:renderUploadCaptionButton})),showLoopControl&&resource?.length>0&&react.createElement(react.Fragment,null,react.createElement(SectionHeading,null,(0,i18n.__)("Options","web-stories")),react.createElement(components_form.fI,{spaceBetween:!1},react.createElement(loopPanelContent.A,{loop,onChange:onChangeLoop})))),react.createElement(hotlinkModal.A,{title:(0,i18n.__)("Insert external background audio","web-stories"),isOpen,onError,onSelect:onSelectHotlink,onClose:()=>setIsOpen(!1),allowedFileTypes:allowedAudioFileTypes,insertText:(0,i18n.__)("Use audio file","web-stories"),insertingText:(0,i18n.__)("Selecting audio file","web-stories"),canUseProxy:!showCaptions&&!showLoopControl}))}},"./packages/story-editor/src/components/panels/shared/media/captionsPanelContent.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_12__=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js")),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./packages/design-system/src/theme/types.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./packages/i18n/src/i18n.ts"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_media__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./packages/media/src/mimeTypes.ts"),_googleforcreators_tracking__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/tracking/src/index.ts"),_form__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/story-editor/src/components/form/index.js"),_app_config__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/story-editor/src/app/config/index.ts"),_constants__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/story-editor/src/constants/index.ts"),_hotlinkModal__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/story-editor/src/components/hotlinkModal/index.js"),_utils_noop__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./packages/story-editor/src/utils/noop.ts"),_fileRow__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/story-editor/src/components/panels/shared/media/fileRow.js");const ButtonRow=(0,styled_components__WEBPACK_IMPORTED_MODULE_12__.Ay)(_form__WEBPACK_IMPORTED_MODULE_7__.fI).withConfig({displayName:"captionsPanelContent__ButtonRow",componentId:"sc-nb4jvi-0"})(["gap:12px;"]),FileName=(0,styled_components__WEBPACK_IMPORTED_MODULE_12__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__.E.Paragraph).attrs({size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__.$.Small}).withConfig({displayName:"captionsPanelContent__FileName",componentId:"sc-nb4jvi-1"})(["color:",";"],(({theme})=>theme.colors.fg.primary)),HotlinkButton=(0,styled_components__WEBPACK_IMPORTED_MODULE_12__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__.$).withConfig({displayName:"captionsPanelContent__HotlinkButton",componentId:"sc-nb4jvi-2"})(["padding:12px 8px;"]);const __WEBPACK_DEFAULT_EXPORT__=function CaptionsPanelContent({isIndeterminate=!1,tracks=[],captionText=(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Upload a file","web-stories"),handleChangeTrack,handleRemoveTrack,renderUploadButton,removeItemLabel=(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Remove file","web-stories")}){const{allowedMimeTypes:{caption:allowedCaptionMimeTypes=[]},capabilities:{hasUploadMediaAction},MediaUpload}=(0,_app_config__WEBPACK_IMPORTED_MODULE_8__.UK)(),[isOpen,setIsOpen]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_5__.J0)(!1),allowedFileTypes=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_5__.Kr)((()=>allowedCaptionMimeTypes.flatMap((type=>(0,_googleforcreators_media__WEBPACK_IMPORTED_MODULE_17__.n)(type)))),[allowedCaptionMimeTypes]),onSelect=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_5__.hb)((({link,hotlinkInfo,needsProxy})=>{handleChangeTrack({src:link,needsProxy}),(0,_googleforcreators_tracking__WEBPACK_IMPORTED_MODULE_6__.sx)("hotlink_caption",{event_label:link,file_size:hotlinkInfo.fileSize,file_type:hotlinkInfo.mimeType,needs_proxy:needsProxy}),setIsOpen(!1)}),[handleChangeTrack]),onError=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_5__.hb)((err=>(0,_googleforcreators_tracking__WEBPACK_IMPORTED_MODULE_6__.Oz)("hotlink_caption",err?.message)),[]);if(!allowedCaptionMimeTypes?.length)return null;const options=[hasUploadMediaAction&&{label:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Upload a file","web-stories"),value:"upload",onClick:_utils_noop__WEBPACK_IMPORTED_MODULE_18__.l,mediaPickerProps:{onSelect:handleChangeTrack,onSelectErrorMessage:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Please choose a VTT file to use as caption.","web-stories"),type:allowedCaptionMimeTypes,title:captionText,buttonInsertText:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Select caption","web-stories")}},{label:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Link to a file","web-stories"),value:"hotlink",onClick:()=>{setIsOpen(!0)}}].filter(Boolean);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,isIndeterminate&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_form__WEBPACK_IMPORTED_MODULE_7__.fI,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(FileName,null,_constants__WEBPACK_IMPORTED_MODULE_9__.Q6)),tracks.map((track=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_fileRow__WEBPACK_IMPORTED_MODULE_11__.A,{key:track.id,id:track.id,src:track.track,title:track.track.split("/").pop(),isExternal:!track.trackId,options,onRemove:handleRemoveTrack,removeItemLabel}))),!tracks.length&&!isIndeterminate&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(ButtonRow,{spaceBetween:!1},hasUploadMediaAction&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(MediaUpload,{onSelect:handleChangeTrack,onSelectErrorMessage:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Please choose a VTT file to use as caption.","web-stories"),type:allowedCaptionMimeTypes,title:captionText,buttonInsertText:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Select caption","web-stories"),render:renderUploadButton}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(HotlinkButton,{variant:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_19__.Ak.Rectangle,type:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_19__.VQ.Secondary,size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_19__.Mp.Small,onClick:()=>setIsOpen(!0)},(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Link to caption file","web-stories"))),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_hotlinkModal__WEBPACK_IMPORTED_MODULE_10__.A,{title:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Insert external captions","web-stories"),isOpen,onSelect,onError,onClose:()=>setIsOpen(!1),allowedFileTypes,insertText:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Use caption","web-stories"),insertingText:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Selecting caption","web-stories"),canUseProxy:!1}))}},"./packages/story-editor/src/components/panels/shared/media/dropDownMenu.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/i18n/src/i18n.ts"),uuid__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/story-editor/node_modules/uuid/dist/esm-browser/v4.js"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/design-system/src/icons/checkmark_small.svg"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/design-system/src/components/menu/list/components.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/design-system/src/theme/types.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/design-system/src/utils/noop.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./packages/design-system/src/components/popup/popup.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./packages/design-system/src/components/popup/constants.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./packages/design-system/src/components/menu/menu.tsx"),_app__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/story-editor/src/app/index.js"),_utils_dropDownKeyEvents__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/story-editor/src/components/panels/utils/dropDownKeyEvents.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const MenuButton=(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_5__.$).withConfig({displayName:"dropDownMenu__MenuButton",componentId:"sc-160pl0l-0"})(["top:4px;right:4px;"]),DropDownContainer=styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay.div.withConfig({displayName:"dropDownMenu__DropDownContainer",componentId:"sc-160pl0l-1"})(["margin-top:10px;"]),MenuContainer=styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay.div.withConfig({displayName:"dropDownMenu__MenuContainer",componentId:"sc-160pl0l-2"})(["z-index:1;"]),menuStylesOverride=(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.AH)(["min-width:160px;margin-top:0;"]),ActiveIcon=(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_6__.A).withConfig({displayName:"dropDownMenu__ActiveIcon",componentId:"sc-160pl0l-3"})(["position:absolute;left:4px;top:50%;transform:translateY(-50%);"]),CustomItemRenderer=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Rf)((function CustomItemRenderer({option,isSelected,...rest},ref){const{MediaUpload}=(0,_app__WEBPACK_IMPORTED_MODULE_2__.UK)();return option.mediaPickerProps?react__WEBPACK_IMPORTED_MODULE_0__.createElement(MediaUpload,_extends({},option.mediaPickerProps,{render:open=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__.ck,_extends({},rest,{ref,isSelected,disabled:option.disabled,"aria-disabled":option.disabled,onClick:evt=>{rest.onClick?.(evt),open(evt)}}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__.Jg,{size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.$.Small},option.label))})):react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__.ck,_extends({},rest,{ref,isSelected,disabled:option.disabled,"aria-disabled":option.disabled}),isSelected&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActiveIcon,{"data-testid":"dropdownMenuItem_active_icon","aria-label":(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("Selected","web-stories"),width:32,height:32}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_7__.Jg,{size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.$.Small},option.label))}));const __WEBPACK_DEFAULT_EXPORT__=function DropDownMenu({display,isMenuOpen,onMenuOpen,onMenuClose,onMenuSelected,setParentActive=_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_10__.l,groups,children,ariaLabel=(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_9__.__)("More","web-stories"),className,...rest}){const MenuButtonRef=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.li)(),onClose=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.hb)((()=>{onMenuClose(),MenuButtonRef.current?.focus(),setParentActive()}),[onMenuClose,setParentActive]),listId=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Kr)((()=>`list-${(0,uuid__WEBPACK_IMPORTED_MODULE_11__.A)()}`),[]),buttonId=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_1__.Kr)((()=>`button-${(0,uuid__WEBPACK_IMPORTED_MODULE_11__.A)()}`),[]);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(MenuContainer,{className},MenuButtonRef.current&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_utils_dropDownKeyEvents__WEBPACK_IMPORTED_MODULE_3__.A,{target:MenuButtonRef.current}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(MenuButton,{type:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_12__.VQ.Tertiary,size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_12__.Mp.Small,variant:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_12__.Ak.Square,ref:MenuButtonRef,onClick:onMenuOpen,"aria-label":ariaLabel,"aria-pressed":isMenuOpen,"aria-haspopup":!0,"aria-expanded":isMenuOpen,"aria-owns":isMenuOpen?listId:null,id:buttonId,$display:display,tabIndex:display||isMenuOpen?0:-1},children),(display||isMenuOpen)&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__.A,{anchor:MenuButtonRef,placement:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__.W.BottomStart,isOpen:isMenuOpen},react__WEBPACK_IMPORTED_MODULE_0__.createElement(DropDownContainer,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__.A,_extends({parentId:buttonId,listId,handleMenuItemSelect:(evt,value)=>{onMenuSelected(value)},groups,onDismissMenu:onClose,hasMenuRole:!0,menuStylesOverride,renderItem:CustomItemRenderer},rest)))))}},"./packages/story-editor/src/components/panels/shared/media/fileRow.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js")),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/design-system/src/icons/rotate.svg"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./packages/design-system/src/icons/link.svg"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./packages/design-system/src/icons/arrow_outline.svg"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./packages/design-system/src/theme/helpers/outline.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./packages/design-system/src/theme/types.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./packages/design-system/src/utils/useLiveRegion.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./packages/design-system/src/icons/trash.svg"),_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/react/src/index.ts"),_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./packages/i18n/src/i18n.ts"),_form__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/story-editor/src/components/form/index.js"),_tooltip__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js"),_dropDownMenu__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/story-editor/src/components/panels/shared/media/dropDownMenu.js");const InputRow=styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay.div.withConfig({displayName:"fileRow__InputRow",componentId:"sc-w8gml-0"})(["flex-grow:1;margin:0 8px;min-width:0;"]),ReplaceIcon=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_8__.A).withConfig({displayName:"fileRow__ReplaceIcon",componentId:"sc-w8gml-1"})(["vertical-align:bottom;"]),LinkIcon=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_9__.A).withConfig({displayName:"fileRow__LinkIcon",componentId:"sc-w8gml-2"})(["width:24px;height:24px;vertical-align:bottom;"]),UploadIcon=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_10__.A).withConfig({displayName:"fileRow__UploadIcon",componentId:"sc-w8gml-3"})(["width:24px;height:24px;vertical-align:bottom;"]),Link=styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay.a.withConfig({displayName:"fileRow__Link",componentId:"sc-w8gml-4"})(["",";"],(({theme})=>(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.AH)(["color:",";text-decoration:none;cursor:pointer;:hover,:active,:focus{text-decoration:underline;color:"," !important;}",""],theme.colors.fg.primary,theme.colors.fg.primary,_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_11__.Q(theme.colors.border.focus)))),StyledButton=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_12__.$).withConfig({displayName:"fileRow__StyledButton",componentId:"sc-w8gml-5"})(["",";"],(({theme})=>_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_11__.Q(theme.colors.border.focus,theme.colors.bg.secondary))),FileName=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.Ay)(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_13__.E.Paragraph).attrs({size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_14__.$.Small}).withConfig({displayName:"fileRow__FileName",componentId:"sc-w8gml-6"})(["color:",";text-overflow:ellipsis;overflow:hidden;"],(({theme})=>theme.colors.fg.primary));const __WEBPACK_DEFAULT_EXPORT__=function FileRow({id,isExternal,src,title,options,removeItemLabel,onRemove,children}){const groups=[{options}],[isMenuOpen,setIsMenuOpen]=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.J0)(!1),speak=(0,_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_15__.A)(),onMenuSelected=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.hb)((value=>{setIsMenuOpen(!1),options.find((item=>item.value===value))?.onClick()}),[options]),onItemRemove=(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_3__.hb)((()=>{onRemove(id),speak((0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("File removed","web-stories"))}),[id,onRemove,speak]),label=isExternal?(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("External file","web-stories"):(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Local file","web-stories");return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_form__WEBPACK_IMPORTED_MODULE_4__.fI,{key:`row-filename-${id}`},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_tooltip__WEBPACK_IMPORTED_MODULE_5__.A,{title:label},isExternal?react__WEBPACK_IMPORTED_MODULE_0__.createElement(LinkIcon,{title:label}):react__WEBPACK_IMPORTED_MODULE_0__.createElement(UploadIcon,{title:label})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(InputRow,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(FileName,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(Link,{href:src,rel:"noreferrer",target:"_blank"},title))),children,options.length>0&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_dropDownMenu__WEBPACK_IMPORTED_MODULE_6__.A,{onMenuOpen:()=>setIsMenuOpen(!0),isMenuOpen,onMenuSelected,display:!0,onMenuClose:()=>setIsMenuOpen(!1),groups,ariaLabel:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Replace file","web-stories")},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_tooltip__WEBPACK_IMPORTED_MODULE_5__.A,{title:(0,_googleforcreators_i18n__WEBPACK_IMPORTED_MODULE_16__.__)("Replace","web-stories")},react__WEBPACK_IMPORTED_MODULE_0__.createElement(ReplaceIcon,null))),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_tooltip__WEBPACK_IMPORTED_MODULE_5__.A,{hasTail:!0,title:removeItemLabel},react__WEBPACK_IMPORTED_MODULE_0__.createElement(StyledButton,{"aria-label":removeItemLabel,type:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_17__.VQ.Tertiary,size:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_17__.Mp.Small,variant:_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_17__.Ak.Square,onClick:onItemRemove},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_18__.A,null))))}},"./packages/story-editor/src/components/panels/utils/dropDownKeyEvents.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>DropDownKeyEvents});var prop_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__),_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx"),_canvas_useFocusCanvas__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/story-editor/src/components/canvas/useFocusCanvas.ts"),_utils_useRovingTabIndex__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/story-editor/src/utils/useRovingTabIndex/index.js");const BUTTON_NESTING_DEPTH=3;function DropDownKeyEvents({target}){(0,_utils_useRovingTabIndex__WEBPACK_IMPORTED_MODULE_1__.A)({ref:target},[],BUTTON_NESTING_DEPTH);const focusCanvas=(0,_canvas_useFocusCanvas__WEBPACK_IMPORTED_MODULE_0__.A)();return(0,_googleforcreators_design_system__WEBPACK_IMPORTED_MODULE_2__._h)(target,"tab",focusCanvas,[focusCanvas]),null}DropDownKeyEvents.propTypes={target:prop_types__WEBPACK_IMPORTED_MODULE_3___default().shape({current:prop_types__WEBPACK_IMPORTED_MODULE_3___default().instanceOf(Element)})}},"./packages/story-editor/src/components/publishModal/publishModal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>publishModal});var react=__webpack_require__("./node_modules/react/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),theme=__webpack_require__("./packages/design-system/src/theme/theme.ts"),modal=__webpack_require__("./packages/design-system/src/components/modal/modal.tsx"),src=__webpack_require__("./packages/tracking/src/index.ts"),react_src=__webpack_require__("./packages/react/src/index.ts"),checklist=__webpack_require__("./packages/story-editor/src/components/checklist/index.js"),directionAware=__webpack_require__("./packages/story-editor/src/components/directionAware/index.js"),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts"),cross=__webpack_require__("./packages/design-system/src/icons/cross.svg"),headline=__webpack_require__("./packages/design-system/src/components/typography/headline/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts");const INPUT_KEYS_EXCERPT="excerpt",INPUT_KEYS_TITLE="title";var buttonWithChecklistWarning=__webpack_require__("./packages/story-editor/src/components/header/buttons/buttonWithChecklistWarning.js");const _Header=styled_components_browser_esm.Ay.header.withConfig({displayName:"header___Header",componentId:"sc-yxsju1-0"})(["width:100%;height:",";display:flex;align-items:center;margin-bottom:",";background-color:",";border-top-left-radius:",";border-top-right-radius:",";"],"44px","1px",(({theme})=>theme.colors.bg.secondary),(({theme})=>theme.borders.radius.medium),(({theme})=>theme.borders.radius.medium)),CloseButton=(0,styled_components_browser_esm.Ay)(button_button.$).withConfig({displayName:"header__CloseButton",componentId:"sc-yxsju1-1"})(["margin:6px auto 5px 6px;"]),PublishButtonWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"header__PublishButtonWrapper",componentId:"sc-yxsju1-2"})(["margin:6px 6px 5px auto;"]),header=({onClose,onPublish,publishButtonDisabled,hasFutureDate})=>react.createElement(_Header,null,react.createElement(CloseButton,{variant:constants.Ak.Square,size:constants.Mp.Small,type:constants.VQ.Tertiary,onClick:onClose,"aria-label":(0,i18n.__)("Close","web-stories")},react.createElement(cross.A,null)),react.createElement(headline.$,{as:"h2",size:types.$.XXXSmall},(0,i18n.__)("Story Details","web-stories")),react.createElement(PublishButtonWrapper,null,react.createElement(buttonWithChecklistWarning.A,{onClick:onPublish,disabled:publishButtonDisabled,hasFutureDate})));var scrollbar=__webpack_require__("./packages/design-system/src/theme/helpers/scrollbar.ts"),useSidebar=__webpack_require__("./packages/story-editor/src/components/sidebar/useSidebar.js"),textArea=__webpack_require__("./packages/design-system/src/components/textArea/textArea.tsx"),app=__webpack_require__("./packages/story-editor/src/app/index.js"),storyUpdates=__webpack_require__("./packages/story-editor/src/utils/storyUpdates.ts"),excerpt=__webpack_require__("./packages/story-editor/src/components/panels/document/excerpt/index.js");const FormSection=styled_components_browser_esm.Ay.div.withConfig({displayName:"mainStoryInfo__FormSection",componentId:"sc-1f06m84-0"})(["padding:0 4px;&:first-of-type{margin:20px 0px 0px;}"]),_TextArea=(0,styled_components_browser_esm.Ay)(textArea.A).withConfig({displayName:"mainStoryInfo___TextArea",componentId:"sc-1f06m84-1"})(["margin:8px 0 0;& > p{margin-bottom:-4px;}"]),mainStoryInfo=()=>{const updateStory=(0,app.P3)((({actions})=>actions.updateStory)),_inputValues=(0,app.P3)((({state:{story}})=>({[INPUT_KEYS_EXCERPT]:story.excerpt,[INPUT_KEYS_TITLE]:story.title||""}))),slug=(0,app.P3)((({state:{story:{slug}}})=>slug)),IsolatedStatusPanel=(0,useSidebar.A)((({data})=>data?.modalSidebarTab?.IsolatedStatusPanel)),[inputValues,setInputValues]=(0,react_src.J0)(_inputValues),handleUpdateSlug=(0,react_src.hb)((newTitle=>{(0,storyUpdates.H)({currentSlug:slug,currentTitle:newTitle,updateStory})}),[slug,updateStory]),handleUpdateStoryInfo=(0,react_src.hb)((({target})=>{const{value,name}=target;updateStory({properties:{[name]:value}}),name===INPUT_KEYS_TITLE&&handleUpdateSlug(value)}),[handleUpdateSlug,updateStory]),onInputChange=({currentTarget})=>{setInputValues((prev=>({...prev,[currentTarget.name]:currentTarget.value})))};return react.createElement(react.Fragment,null,react.createElement(FormSection,null,react.createElement(headline.$,{as:"label",size:types.$.XXSmall,htmlFor:"story-title"},(0,i18n.__)("Story Title","web-stories")),react.createElement(_TextArea,{name:INPUT_KEYS_TITLE,id:"story-title",showCount:!0,value:inputValues[INPUT_KEYS_TITLE],onChange:onInputChange,onBlur:handleUpdateStoryInfo,"aria-label":(0,i18n.__)("Story Title","web-stories"),placeholder:(0,i18n.__)("Add title","web-stories")})),react.createElement(FormSection,null,react.createElement(headline.$,{as:"label",size:types.$.XXSmall,htmlFor:"story-excerpt"},(0,i18n.__)("Story Description","web-stories")),react.createElement(_TextArea,{name:INPUT_KEYS_EXCERPT,id:"story-excerpt",showCount:!0,maxLength:excerpt.q,value:inputValues[INPUT_KEYS_EXCERPT],"aria-label":(0,i18n.__)("Story Description","web-stories"),placeholder:(0,i18n.__)("Write a description of the story","web-stories"),hint:(0,i18n.__)("Stories with a description tend to do better on search and have a wider reach","web-stories"),onChange:onInputChange,onBlur:handleUpdateStoryInfo})),IsolatedStatusPanel&&react.createElement(IsolatedStatusPanel,null))};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js");var prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),mediaInput_types=__webpack_require__("./packages/design-system/src/components/mediaInput/types.ts"),src_constants=__webpack_require__("./packages/units/src/constants.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),translateToExclusiveList=__webpack_require__("./packages/i18n/src/translateToExclusiveList.ts"),src_mimeTypes=__webpack_require__("./packages/media/src/mimeTypes.ts"),story_editor_src_constants=__webpack_require__("./packages/story-editor/src/constants/index.ts"),components_form=__webpack_require__("./packages/story-editor/src/components/form/index.js");const PreviewWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__PreviewWrapper",componentId:"sc-zk17py-0"})(["width:","px;height:","px;position:relative;margin-top:8px;"],(({width})=>width),(({height})=>height));PreviewWrapper.propTypes={width:prop_types_default().number.isRequired,height:prop_types_default().number.isRequired};const PreviewContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__PreviewContainer",componentId:"sc-zk17py-1"})(["width:","px;height:","px;position:absolute;"],(({width})=>width),(({height})=>height));PreviewContainer.propTypes={width:prop_types_default().number.isRequired,height:prop_types_default().number.isRequired};const Image=styled_components_browser_esm.Ay.img.withConfig({displayName:"storyPreview__Image",componentId:"sc-zk17py-2"})(["height:100%;width:100%;display:block;aspect-ratio:",";object-fit:cover;border-radius:",";background:",";"],src_constants.iZ,(({theme})=>theme.borders.radius.medium),(({theme})=>theme.colors.interactiveBg.primaryNormal)),EmptyPlaceholder=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__EmptyPlaceholder",componentId:"sc-zk17py-3"})(["height:100%;border-radius:",";background:",";"],(({theme})=>theme.borders.radius.medium),(({theme})=>theme.colors.interactiveBg.primaryNormal)),Gradient=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__Gradient",componentId:"sc-zk17py-4"})(["position:absolute;bottom:0;height:67%;width:100%;border-radius:",";background:",";"],(({theme})=>theme.borders.radius.medium),(({theme})=>theme.colors.gradient.posterOverlay)),ScrimWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__ScrimWrapper",componentId:"sc-zk17py-5"})(["position:absolute;top:0;box-sizing:border-box;width:100%;height:100%;border-radius:",";background:",";padding:8px;"],(({theme})=>theme.borders.radius.medium),(({theme})=>theme.colors.opacity.black3)),ScrimContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__ScrimContainer",componentId:"sc-zk17py-6"})(["display:flex;height:100%;width:100%;flex-wrap:wrap;justify-content:space-between;"]),ScrimTop=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__ScrimTop",componentId:"sc-zk17py-7"})(["display:grid;grid-template-columns:50% 50%;grid-template-rows:auto;grid-template-areas:'publisherLogo editButton';justify-content:inherit;width:100%;"]),PublisherLogo=styled_components_browser_esm.Ay.img.withConfig({displayName:"storyPreview__PublisherLogo",componentId:"sc-zk17py-8"})(["grid-area:publisherLogo;height:24px;width:24px;border-radius:2px;box-shadow:0 0 8px rgba(0,0,0,0.08);"]),StyledMedia=(0,styled_components_browser_esm.Ay)(components_form.$U).withConfig({displayName:"storyPreview__StyledMedia",componentId:"sc-zk17py-9"})(["grid-area:editButton;display:flex;flex-direction:row-reverse;"]),ScrimBottom=styled_components_browser_esm.Ay.div.withConfig({displayName:"storyPreview__ScrimBottom",componentId:"sc-zk17py-10"})(["width:100%;margin:auto 0 0;align-self:flex-end;"]),Title=(0,styled_components_browser_esm.Ay)(headline.$).attrs({as:"h3",size:types.$.XSmall}).withConfig({displayName:"storyPreview__Title",componentId:"sc-zk17py-11"})(["max-height:calc(1.2em * 3);display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;padding:0;margin:0 0 4px;overflow:hidden;text-overflow:ellipsis;color:",";"],(({theme})=>theme.colors.fg.primary)),Publisher=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).attrs({size:types.$.Medium}).withConfig({displayName:"storyPreview__Publisher",componentId:"sc-zk17py-12"})(["display:block;margin:0;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:",";"],(({theme})=>theme.colors.fg.secondary)),storyPreview=()=>{const{title,featuredMedia,publisherLogo,updateStory}=(0,app.P3)((({state:{story},actions})=>({title:story?.title,featuredMedia:story?.featuredMedia||{},publisherLogo:story?.publisherLogo||{},updateStory:actions.updateStory}))),{allowedImageMimeTypes,hasUploadMediaAction,publisher}=(0,app.UK)((({allowedMimeTypes,capabilities,metadata})=>({allowedImageMimeTypes:allowedMimeTypes?.image||story_editor_src_constants.qW,hasUploadMediaAction:capabilities?.hasUploadMediaAction,publisher:metadata?.publisher}))),allowedImageFileTypes=(0,react_src.Kr)((()=>allowedImageMimeTypes.flatMap((type=>(0,src_mimeTypes.n)(type)))),[allowedImageMimeTypes]),mediaHeight=Math.round(232/src_constants.iZ),handleChangePoster=(0,react_src.hb)((newPoster=>updateStory({properties:{featuredMedia:{id:newPoster.id,url:newPoster.src,height:newPoster.height,width:newPoster.width,isExternal:newPoster.isExternal,needsProxy:newPoster.needsProxy}}})),[updateStory]);let posterErrorMessage=(0,i18n.__)("No file types are currently supported.","web-stories");allowedImageFileTypes.length&&(posterErrorMessage=(0,sprintf.A)((0,i18n.__)("Please choose only %s as a poster.","web-stories"),(0,translateToExclusiveList.A)(allowedImageFileTypes)));const menuOptions=[hasUploadMediaAction&&"upload","hotlink"].filter(Boolean);return react.createElement(react.Fragment,null,react.createElement(headline.$,{as:"label",size:types.$.XXSmall},(0,i18n.__)("Cover Preview","web-stories")),react.createElement(PreviewWrapper,{width:232,height:mediaHeight},react.createElement(PreviewContainer,{width:232,height:mediaHeight},featuredMedia?.url?react.createElement(Image,{crossOrigin:"anonymous",decoding:"async",src:featuredMedia.url,width:featuredMedia.width,height:featuredMedia.height,alt:(0,i18n.__)("Preview image","web-stories"),"data-testid":"story_preview_featured_media"}):react.createElement(EmptyPlaceholder,null),react.createElement(Gradient,null),react.createElement(ScrimWrapper,null,react.createElement(ScrimContainer,null,react.createElement(ScrimTop,null,publisherLogo?.url?.length>0&&react.createElement(PublisherLogo,{crossOrigin:"anonymous",decoding:"async",width:publisherLogo.width,height:publisherLogo.height,src:publisherLogo.url,alt:(0,i18n.__)("Publisher Logo","web-stories")}),react.createElement(StyledMedia,{onChange:handleChangePoster,title:(0,i18n.__)("Select as poster image","web-stories"),hotlinkTitle:(0,i18n.__)("Use external image as poster image","web-stories"),hotlinkInsertText:(0,i18n.__)("Use image as poster image","web-stories"),hotlinkInsertingText:(0,i18n.__)("Using image as poster image","web-stories"),buttonInsertText:(0,i18n.__)("Select as poster image","web-stories"),type:allowedImageMimeTypes,ariaLabel:(0,i18n.__)("Poster image","web-stories"),onChangeErrorText:posterErrorMessage,imgProps:featuredMedia,variant:mediaInput_types.Q.None,menuOptions,cropParams:{width:640,height:853}})),react.createElement(ScrimBottom,null,title&&react.createElement(Title,null,title),publisher&&react.createElement(Publisher,{"data-testid":"story_preview_publisher"},publisher)))))))};var icons_checkbox=__webpack_require__("./packages/design-system/src/icons/checkbox.svg"),zIndex=__webpack_require__("./packages/story-editor/src/constants/zIndex.ts"),checklist_constants=__webpack_require__("./packages/story-editor/src/components/checklist/constants.js"),countContext=__webpack_require__("./packages/story-editor/src/components/checklist/countContext/index.js"),toggleButton=__webpack_require__("./packages/story-editor/src/components/toggleButton/index.js");const checklistButton=({handleReviewChecklist})=>{const priorityCount=(0,countContext.L_)(checklist_constants.co.PRIORITY);return react.createElement(toggleButton.f,{MainIcon:icons_checkbox.A,label:(0,i18n.__)("Checklist","web-stories"),"aria-label":(0,i18n.__)("Checklist","web-stories"),popupZIndexOverride:zIndex.Xl,onClick:handleReviewChecklist,notificationCount:priorityCount})},Main=styled_components_browser_esm.Ay.div.withConfig({displayName:"content__Main",componentId:"sc-1d1lm9j-0"})(["display:grid;min-width:917px;width:100%;height:calc(100% - "," - ",");grid-template-columns:30.5% 34% 35.5%;grid-template-rows:auto;grid-template-areas:'preview mainPanel sidePanel' 'footer mainPanel sidePanel';"],"1px","44px"),_StoryPreview=styled_components_browser_esm.Ay.div.withConfig({displayName:"content___StoryPreview",componentId:"sc-1d1lm9j-1"})(["grid-area:preview;margin:20px 18px 0 32px;"]),_MainStoryInfo=styled_components_browser_esm.Ay.div.withConfig({displayName:"content___MainStoryInfo",componentId:"sc-1d1lm9j-2"})(["grid-area:mainPanel;display:flex;flex-direction:column;padding:0 16px;overflow-y:scroll;gap:34px;& > section{border:none;& > h2{padding-top:0;padding-bottom:2px;& > button{height:1em;}}}"]),PanelContainer=styled_components_browser_esm.Ay.div.attrs({role:"tabpanel"}).withConfig({displayName:"content__PanelContainer",componentId:"sc-1d1lm9j-3"})(["grid-area:sidePanel;height:100%;margin-left:18px;background-color:",";border-bottom-right-radius:",";overflow-y:scroll;",";"],(({theme})=>theme.colors.bg.secondary),(({theme})=>theme.borders.radius.medium),scrollbar.W),Footer=styled_components_browser_esm.Ay.div.withConfig({displayName:"content__Footer",componentId:"sc-1d1lm9j-4"})(["grid-area:footer;display:flex;align-items:flex-end;margin:0 18px 20px 32px;"]),content=({handleReviewChecklist})=>{const{DocumentPane,id:paneId}=(0,useSidebar.A)((({data})=>data?.modalSidebarTab||{})),hasChecklist=(0,checklist.WY)();return react.createElement(Main,null,react.createElement(_StoryPreview,null,react.createElement(storyPreview,null)),react.createElement(_MainStoryInfo,null,react.createElement(mainStoryInfo,null)),DocumentPane&&react.createElement(PanelContainer,{"aria-label":(0,i18n.__)("Story Settings","web-stories"),id:paneId},react.createElement(DocumentPane,null)),hasChecklist&&react.createElement(Footer,null,react.createElement(checklistButton,{handleReviewChecklist})))},Container=styled_components_browser_esm.Ay.div.withConfig({displayName:"publishModal__Container",componentId:"sc-16gvo2-0"})(["height:100%;color:",";background-color:",";border:",";border-radius:",";"],theme.w.colors.fg.primary,theme.w.colors.bg.primary,`1px solid ${theme.w.colors.divider.primary}`,theme.w.borders.radius.medium);const publishModal=function PublishModal({isOpen,onPublish,onClose,publishButtonDisabled,hasFutureDate}){const openChecklist=(0,checklist.Em)((({actions})=>actions.handleReviewChecklist));(0,react_src.vJ)((()=>{isOpen&&(0,src.sx)("publish_modal")}),[isOpen]);const handleReviewChecklist=(0,react_src.hb)((()=>{(0,src.sx)("review_prepublish_checklist"),onClose({focusPublishButton:!1}),openChecklist()}),[onClose,openChecklist]);return react.createElement(modal.A,{isOpen,onClose,contentLabel:(0,i18n.__)("Story details","web-stories"),contentStyles:{display:"block",width:"71vw",minWidth:"917px",height:"66vh",minHeight:"580px",overflow:"hidden"},overlayStyles:{backgroundColor:theme.w.colors.inverted.interactiveBg.modalScrim}},isOpen&&react.createElement(directionAware.A,null,react.createElement(Container,null,react.createElement(header,{hasFutureDate,publishButtonDisabled,onClose,onPublish}),react.createElement(content,{handleReviewChecklist}))))}},"./packages/story-editor/src/utils/storyUpdates.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>updateSlug});var _cleanForSlug__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/story-editor/src/utils/cleanForSlug.ts");const updateSlug=({currentSlug,currentTitle,updateStory})=>{if(!currentSlug){updateStory({properties:{slug:encodeURIComponent((0,_cleanForSlug__WEBPACK_IMPORTED_MODULE_0__.A)(currentTitle))}})}}},"./packages/story-editor/src/utils/useIsUploadingToStory.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");var _googleforcreators_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/react/src/index.ts"),_app__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/story-editor/src/app/index.js");const __WEBPACK_DEFAULT_EXPORT__=function useIsUploadingToStory(){const resourceIds=(0,_app__WEBPACK_IMPORTED_MODULE_5__.P3)((({state:{pages=[]}})=>pages.reduce(((acc,curr)=>(acc.push(...curr.elements.filter((({type,isExternal})=>["image","video","gif"].includes(type)&&!isExternal)).map((({resource})=>resource.id))),acc)),[]))),{isCurrentResourceUploading,isCurrentResourceProcessing}=(0,_app__WEBPACK_IMPORTED_MODULE_5__.HZ)((({state:{isCurrentResourceUploading,isCurrentResourceProcessing}})=>({isCurrentResourceUploading,isCurrentResourceProcessing})));return(0,_googleforcreators_react__WEBPACK_IMPORTED_MODULE_4__.Kr)((()=>Boolean(resourceIds?.some((resourceId=>isCurrentResourceUploading(resourceId)||isCurrentResourceProcessing(resourceId))))),[resourceIds,isCurrentResourceUploading,isCurrentResourceProcessing])}}}]);