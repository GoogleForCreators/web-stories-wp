"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[7748],{"./packages/story-editor/src/components/library/panes/media/common/mediaGallery.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>mediaGallery});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),react_src=__webpack_require__("./packages/react/src/index.ts"),react_photo_album_dist=__webpack_require__("./packages/story-editor/node_modules/react-photo-album/dist/index.mjs"),constants=__webpack_require__("./packages/story-editor/src/constants/index.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),polished_esm=__webpack_require__("./node_modules/polished/dist/polished.esm.js"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),loadingBar=__webpack_require__("./packages/design-system/src/components/loadingBar/loadingBar.tsx"),esm=__webpack_require__("./packages/story-editor/node_modules/react-blurhash/dist/esm/index.js"),v4=__webpack_require__("./packages/story-editor/node_modules/uuid/dist/esm-browser/v4.js"),noop=__webpack_require__("./packages/design-system/src/utils/noop.ts"),dots_fill_small=__webpack_require__("./packages/design-system/src/icons/dots_fill_small.svg"),popup=__webpack_require__("./packages/design-system/src/components/popup/popup.tsx"),popup_constants=__webpack_require__("./packages/design-system/src/components/popup/constants.ts"),menu=__webpack_require__("./packages/design-system/src/components/menu/menu.tsx"),app=__webpack_require__("./packages/story-editor/src/app/index.js"),shared=__webpack_require__("./packages/story-editor/src/components/library/panes/shared/index.js"),dropDownKeyEvents=__webpack_require__("./packages/story-editor/src/components/panels/utils/dropDownKeyEvents.js"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),useSnackbar=__webpack_require__("./packages/design-system/src/contexts/snackbar/useSnackbar.ts"),typography_text=__webpack_require__("./packages/design-system/src/components/typography/text/index.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),api=__webpack_require__("./packages/story-editor/src/app/api/index.ts"),app_media=__webpack_require__("./packages/story-editor/src/app/media/index.js"),story=__webpack_require__("./packages/story-editor/src/app/story/index.ts"),dialog=__webpack_require__("./packages/story-editor/src/components/dialog/index.js");function DeleteDialog(t0){const $=(0,dist.c)(22),{mediaId,type,onClose}=t0,{actions:t1}=(0,api.M1)(),{deleteMedia}=t1,{showSnackbar}=(0,useSnackbar.d)(),{deleteMediaElement:deleteMediaElement_0}=(0,app_media.HZ)(_temp),{deleteElementsByResourceId}=(0,story.P3)(_temp2);let t2,t3;$[0]!==deleteElementsByResourceId||$[1]!==deleteMedia||$[2]!==deleteMediaElement_0||$[3]!==mediaId||$[4]!==onClose||$[5]!==showSnackbar?(t2=async()=>{onClose();try{await deleteMedia(mediaId),deleteMediaElement_0({id:mediaId}),deleteElementsByResourceId({id:mediaId})}catch(t4){const err=t4;(0,tracking_src.Oz)("local_media_deletion",err.message),showSnackbar({message:(0,i18n.__)("Failed to delete media item.","web-stories"),dismissible:!0})}},t3=[deleteMedia,deleteMediaElement_0,deleteElementsByResourceId,mediaId,onClose,showSnackbar],$[0]=deleteElementsByResourceId,$[1]=deleteMedia,$[2]=deleteMediaElement_0,$[3]=mediaId,$[4]=onClose,$[5]=showSnackbar,$[6]=t2,$[7]=t3):(t2=$[6],t3=$[7]);const onDelete=(0,react_src.hb)(t2,t3);let t4;$[8]===Symbol.for("react.memo_cache_sentinel")?(t4=(0,i18n.__)("Delete Image?","web-stories"),$[8]=t4):t4=$[8];const imageDialogTitle=t4;let t5;$[9]===Symbol.for("react.memo_cache_sentinel")?(t5=(0,i18n.__)("Delete Video?","web-stories"),$[9]=t5):t5=$[9];const videoDialogTitle=t5;let t6;$[10]===Symbol.for("react.memo_cache_sentinel")?(t6=(0,i18n.__)("You are about to permanently delete this image from your site. The image will appear broken in any content that uses it.","web-stories"),$[10]=t6):t6=$[10];const imageDialogDescription=t6;let t7;$[11]===Symbol.for("react.memo_cache_sentinel")?(t7=(0,i18n.__)("You are about to permanently delete this video from your site. The video will appear broken in any content that uses it.","web-stories"),$[11]=t7):t7=$[11];const videoDialogDescription=t7,t8="image"===type?imageDialogTitle:videoDialogTitle;let t9,t10;$[12]===Symbol.for("react.memo_cache_sentinel")?(t9=(0,i18n.__)("Cancel","web-stories"),$[12]=t9):t9=$[12],$[13]===Symbol.for("react.memo_cache_sentinel")?(t10=(0,i18n.__)("Delete","web-stories"),$[13]=t10):t10=$[13];const t11="image"===type?imageDialogDescription:videoDialogDescription;let t12,t13,t14;return $[14]!==t11?(t12=react.createElement(typography_text.E.Paragraph,{size:types.$.Small},t11),$[14]=t11,$[15]=t12):t12=$[15],$[16]===Symbol.for("react.memo_cache_sentinel")?(t13=react.createElement(typography_text.E.Paragraph,{size:types.$.Small,isBold:!0},(0,i18n.__)("This action can not be undone.","web-stories")),$[16]=t13):t13=$[16],$[17]!==onClose||$[18]!==onDelete||$[19]!==t12||$[20]!==t8?(t14=react.createElement(dialog.A,{isOpen:!0,onClose,title:t8,secondaryText:t9,onPrimary:onDelete,primaryText:t10,maxWidth:512},t12,t13),$[17]=onClose,$[18]=onDelete,$[19]=t12,$[20]=t8,$[21]=t14):t14=$[21],t14}function _temp2(state){return{deleteElementsByResourceId:state.actions.deleteElementsByResourceId}}function _temp(t0){const{actions:t1}=t0,{deleteMediaElement}=t1;return{deleteMediaElement}}DeleteDialog.propTypes={mediaId:prop_types_default().number.isRequired,type:prop_types_default().string.isRequired,onClose:prop_types_default().func.isRequired};const deleteDialog=DeleteDialog;DeleteDialog.__docgenInfo={description:"Display a confirmation dialog for when a user wants to delete a media element.\n\n@param {Object} props Component props.\n@param {number} props.mediaId Selected media element's ID.\n@param {string} props.type Selected media element's type.\n@param {Function} props.onClose Callback to toggle dialog display on close.\n@return {null|*} The dialog element.",methods:[],displayName:"DeleteDialog",props:{mediaId:{description:"",type:{name:"number"},required:!0},type:{description:"",type:{name:"string"},required:!0},onClose:{description:"",type:{name:"func"},required:!0}}};var date_src=__webpack_require__("./packages/date/src/index.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),getSmallestUrlForWidth=__webpack_require__("./packages/media/src/getSmallestUrlForWidth.ts"),propTypes=__webpack_require__("./packages/media/src/types/propTypes.ts"),textArea=__webpack_require__("./packages/design-system/src/components/textArea/textArea.tsx");const styledMediaThumbnail=(0,styled_components_browser_esm.AH)(["display:flex;width:","px;margin-right:28px;"],152),Image=styled_components_browser_esm.Ay.img.withConfig({displayName:"mediaEditDialog__Image",componentId:"sc-ctku7j-0"})(["",""],styledMediaThumbnail),Video=styled_components_browser_esm.Ay.video.withConfig({displayName:"mediaEditDialog__Video",componentId:"sc-ctku7j-1"})(["",""],styledMediaThumbnail),DialogBody=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaEditDialog__DialogBody",componentId:"sc-ctku7j-2"})(["display:flex;justify-content:left;align-items:flex-start;"]),MetadataTextContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaEditDialog__MetadataTextContainer",componentId:"sc-ctku7j-3"})(["display:flex;flex-direction:column;margin:0 4px;"]),DateText=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).withConfig({displayName:"mediaEditDialog__DateText",componentId:"sc-ctku7j-4"})(["margin-bottom:8px;"]),AssistiveTextArea=(0,styled_components_browser_esm.Ay)(textArea.A).withConfig({displayName:"mediaEditDialog__AssistiveTextArea",componentId:"sc-ctku7j-5"})(["margin:20px 0 4px;"]),imageDialogTitle=(0,i18n.__)("Edit Image","web-stories"),videoDialogTitle=(0,i18n.__)("Edit Video","web-stories"),imageInputTitle=(0,i18n.__)("Assistive text","web-stories"),videoInputTitle=(0,i18n.__)("Video description","web-stories"),imageDialogDescription=(0,i18n.__)("Describe the appearance and function of the image. Leave empty if the image is purely decorative.","web-stories"),videoDialogDescription=(0,i18n.__)("For indexability and accessibility. Include any burned-in text inside the video.","web-stories");function MediaEditDialog(t0){const $=(0,dist.c)(50),{resource,onClose}=t0,{id,src,creationDate,width,height,type,alt,poster,mimeType}=resource,{actions:t1}=(0,api.M1)(),{updateMedia}=t1,{updateMediaElement:updateMediaElement_0}=(0,app_media.HZ)(mediaEditDialog_temp),{showSnackbar}=(0,useSnackbar.d)(),[altText,setAltText]=(0,react_src.J0)(alt),parsedDate=(0,date_src.ay)(creationDate);let t2,t3;$[0]!==setAltText?(t2=evt=>{setAltText(evt.target.value)},$[0]=setAltText,$[1]=t2):t2=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t3=[],$[2]=t3):t3=$[2];const handleAltTextChange=(0,react_src.hb)(t2,t3);let t4,t5;$[3]!==altText||$[4]!==id||$[5]!==onClose||$[6]!==showSnackbar||$[7]!==updateMedia||$[8]!==updateMediaElement_0?(t4=async()=>{try{await updateMedia(id,{altText}),updateMediaElement_0({id,data:{alt:altText}}),onClose()}catch(t6){const err=t6;(0,tracking_src.Oz)("local_media_edit",err.message),showSnackbar({message:(0,i18n.__)("Failed to update, please try again.","web-stories"),dismissible:!0})}},t5=[altText,id,onClose,showSnackbar,updateMedia,updateMediaElement_0],$[3]=altText,$[4]=id,$[5]=onClose,$[6]=showSnackbar,$[7]=updateMedia,$[8]=updateMediaElement_0,$[9]=t4,$[10]=t5):(t4=$[9],t5=$[10]);const updateMediaItem=(0,react_src.hb)(t4,t5),isImage="image"===type,T0=dialog.A,t7=isImage?imageDialogTitle:videoDialogTitle;let t8,t9;$[11]===Symbol.for("react.memo_cache_sentinel")?(t8=(0,i18n.__)("Cancel","web-stories"),$[11]=t8):t8=$[11],$[12]===Symbol.for("react.memo_cache_sentinel")?(t9=(0,i18n.__)("Save","web-stories"),$[12]=t9):t9=$[12];const T1=DialogBody;let t10;$[13]!==alt||$[14]!==mimeType||$[15]!==poster||$[16]!==resource||$[17]!==src||$[18]!==type?(t10="image"===type?react.createElement(Image,{src:(0,getSmallestUrlForWidth.A)(152,resource),alt,loading:"lazy",crossOrigin:"anonymous",decoding:"async"}):react.createElement(Video,{key:src,crossOrigin:"anonymous",poster,preload:"metadata",muted:!0},react.createElement("source",{src,type:mimeType})),$[13]=alt,$[14]=mimeType,$[15]=poster,$[16]=resource,$[17]=src,$[18]=type,$[19]=t10):t10=$[19];const T2=MetadataTextContainer,t11=(0,date_src.fn)(parsedDate)&&react.createElement(DateText,{size:types.$.XSmall},(0,sprintf.A)((0,i18n.__)("Uploaded: %s","web-stories"),(0,date_src.Yq)(creationDate)));let t12,t13;$[20]!==height||$[21]!==width?(t12=(0,sprintf.A)((0,i18n.__)("%1$d x %2$d pixels","web-stories"),width,height),$[20]=height,$[21]=width,$[22]=t12):t12=$[22],$[23]!==t12?(t13=react.createElement(typography_text.E.Span,{size:types.$.Small},t12),$[23]=t12,$[24]=t13):t13=$[24];const t14=isImage?imageInputTitle:videoInputTitle,t15=isImage?imageInputTitle:videoInputTitle;let t16;$[25]!==altText||$[26]!==handleAltTextChange||$[27]!==t14||$[28]!==t15?(t16=react.createElement(AssistiveTextArea,{value:altText,"aria-label":t14,type:"text",placeholder:t15,onChange:handleAltTextChange}),$[25]=altText,$[26]=handleAltTextChange,$[27]=t14,$[28]=t15,$[29]=t16):t16=$[29];const t17=isImage?imageDialogDescription:videoDialogDescription;let t18,t19,t20,t21;return $[30]!==t17?(t18=react.createElement(typography_text.E.Paragraph,{size:types.$.Small},t17),$[30]=t17,$[31]=t18):t18=$[31],$[32]!==T2||$[33]!==t11||$[34]!==t13||$[35]!==t16||$[36]!==t18?(t19=react.createElement(T2,null,t11,t13,t16,t18),$[32]=T2,$[33]=t11,$[34]=t13,$[35]=t16,$[36]=t18,$[37]=t19):t19=$[37],$[38]!==T1||$[39]!==t10||$[40]!==t19?(t20=react.createElement(T1,null,t10,t19),$[38]=T1,$[39]=t10,$[40]=t19,$[41]=t20):t20=$[41],$[42]!==T0||$[43]!==onClose||$[44]!==t20||$[45]!==t7||$[46]!==t8||$[47]!==t9||$[48]!==updateMediaItem?(t21=react.createElement(T0,{isOpen:true,onClose,title:t7,secondaryText:t8,onPrimary:updateMediaItem,primaryText:t9},t20),$[42]=T0,$[43]=onClose,$[44]=t20,$[45]=t7,$[46]=t8,$[47]=t9,$[48]=updateMediaItem,$[49]=t21):t21=$[49],t21}function mediaEditDialog_temp(t0){const{actions:t1}=t0,{updateMediaElement}=t1;return{updateMediaElement}}MediaEditDialog.propTypes={resource:propTypes.TL.resource.isRequired,onClose:prop_types_default().func.isRequired};const mediaEditDialog=MediaEditDialog;MediaEditDialog.__docgenInfo={description:"Displays a dialog where the user can edit the selected media element.\n\n@param {Object} props Component props.\n@param {Object} props.resource Selected media element's resource object.\n@param {Object} props.onClose Callback to toggle dialog display.\n@return {null|*} The dialog element.",methods:[],displayName:"MediaEditDialog",props:{resource:{description:"",type:{name:"custom",raw:"ResourcePropTypes.resource.isRequired"},required:!1},onClose:{description:"",type:{name:"func"},required:!0}}};const MoreButton=(0,styled_components_browser_esm.Ay)(shared.rA).withConfig({displayName:"dropDownMenu__MoreButton",componentId:"sc-1eq0xdj-0"})(["top:4px;right:4px;"]),DropDownContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"dropDownMenu__DropDownContainer",componentId:"sc-1eq0xdj-1"})(["margin-top:10px;"]),MenuContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"dropDownMenu__MenuContainer",componentId:"sc-1eq0xdj-2"})(["z-index:1;"]),menuStylesOverride=(0,styled_components_browser_esm.AH)(["min-width:160px;margin-top:0;li{display:block;}"]),MENU_OPTIONS_EDIT="edit",MENU_OPTIONS_DELETE="delete";function DropDownMenu(t0){const $=(0,dist.c)(37),{resource,display,isMenuOpen,onMenuOpen,onMenuCancelled,onMenuSelected,setParentActive:t1}=t0,setParentActive=void 0===t1?noop.l:t1;let t2;$[0]===Symbol.for("react.memo_cache_sentinel")?(t2=[{options:[{label:(0,i18n.__)("Edit meta data","web-stories"),value:MENU_OPTIONS_EDIT},{label:(0,i18n.__)("Delete from library","web-stories"),value:MENU_OPTIONS_DELETE}]}],$[0]=t2):t2=$[0];const groups=t2,[showDeleteDialog,setShowDeleteDialog]=(0,react_src.J0)(!1),[showEditDialog,setShowEditDialog]=(0,react_src.J0)(!1),moreButtonRef=(0,react_src.li)();let t3,t4;$[1]!==moreButtonRef.current||$[2]!==onMenuCancelled||$[3]!==setParentActive?(t3=()=>{onMenuCancelled(),moreButtonRef.current?.focus(),setParentActive()},$[1]=moreButtonRef.current,$[2]=onMenuCancelled,$[3]=setParentActive,$[4]=t3):t3=$[4],$[5]!==onMenuCancelled||$[6]!==setParentActive?(t4=[onMenuCancelled,setParentActive],$[5]=onMenuCancelled,$[6]=setParentActive,$[7]=t4):t4=$[7];const onClose=(0,react_src.hb)(t3,t4),{canTranscodeResource:canTranscodeResource_0}=(0,app.HZ)(dropDownMenu_temp);let t5;$[8]!==onMenuSelected||$[9]!==setShowDeleteDialog||$[10]!==setShowEditDialog?(t5=(evt,value)=>{onMenuSelected();bb16:switch(value){case MENU_OPTIONS_EDIT:setShowEditDialog(!0);break bb16;case MENU_OPTIONS_DELETE:setShowDeleteDialog(!0)}},$[8]=onMenuSelected,$[9]=setShowDeleteDialog,$[10]=setShowEditDialog,$[11]=t5):t5=$[11];const handleCurrentValue=t5;let t6,t7;$[12]!==onClose||$[13]!==setShowDeleteDialog?(t6=()=>{setShowDeleteDialog(!1),onClose()},t7=[setShowDeleteDialog,onClose],$[12]=onClose,$[13]=setShowDeleteDialog,$[14]=t6,$[15]=t7):(t6=$[14],t7=$[15]);const onDeleteDialogClose=(0,react_src.hb)(t6,t7);let t8,t9;$[16]!==onClose||$[17]!==setShowEditDialog?(t8=()=>{setShowEditDialog(!1),onClose()},t9=[setShowEditDialog,onClose],$[16]=onClose,$[17]=setShowEditDialog,$[18]=t8,$[19]=t9):(t8=$[18],t9=$[19]);const onEditDialogClose=(0,react_src.hb)(t8,t9);let t10;$[20]===Symbol.for("react.memo_cache_sentinel")?(t10=[],$[20]=t10):t10=$[20];const listId=(0,react_src.Kr)(dropDownMenu_temp2,t10);let t11;$[21]===Symbol.for("react.memo_cache_sentinel")?(t11=[],$[21]=t11):t11=$[21];const buttonId=(0,react_src.Kr)(_temp3,t11);let t12;return $[22]!==buttonId||$[23]!==canTranscodeResource_0||$[24]!==display||$[25]!==handleCurrentValue||$[26]!==isMenuOpen||$[27]!==listId||$[28]!==moreButtonRef||$[29]!==onClose||$[30]!==onDeleteDialogClose||$[31]!==onEditDialogClose||$[32]!==onMenuOpen||$[33]!==resource||$[34]!==showDeleteDialog||$[35]!==showEditDialog?(t12=canTranscodeResource_0(resource)&&react.createElement(MenuContainer,null,moreButtonRef.current&&react.createElement(dropDownKeyEvents.A,{target:moreButtonRef.current}),react.createElement(MoreButton,{ref:moreButtonRef,onClick:onMenuOpen,"aria-label":(0,i18n.__)("More","web-stories"),"aria-pressed":isMenuOpen,"aria-haspopup":!0,"aria-expanded":isMenuOpen,"aria-owns":isMenuOpen?listId:null,id:buttonId,$display:display,tabIndex:display||isMenuOpen?0:-1},react.createElement(dots_fill_small.A,null)),(display||isMenuOpen)&&react.createElement(popup.A,{anchor:moreButtonRef,placement:popup_constants.W.BottomStart,isOpen:isMenuOpen},react.createElement(DropDownContainer,null,react.createElement(menu.A,{parentId:buttonId,listId,handleMenuItemSelect:handleCurrentValue,groups,onDismissMenu:onClose,hasMenuRole:!0,menuStylesOverride}))),showDeleteDialog&&react.createElement(deleteDialog,{mediaId:resource.id,type:resource.type,onClose:onDeleteDialogClose}),showEditDialog&&react.createElement(mediaEditDialog,{resource,onClose:onEditDialogClose})),$[22]=buttonId,$[23]=canTranscodeResource_0,$[24]=display,$[25]=handleCurrentValue,$[26]=isMenuOpen,$[27]=listId,$[28]=moreButtonRef,$[29]=onClose,$[30]=onDeleteDialogClose,$[31]=onEditDialogClose,$[32]=onMenuOpen,$[33]=resource,$[34]=showDeleteDialog,$[35]=showEditDialog,$[36]=t12):t12=$[36],t12}function _temp3(){return`button-${(0,v4.A)()}`}function dropDownMenu_temp2(){return`list-${(0,v4.A)()}`}function dropDownMenu_temp(t0){const{state:t1}=t0,{canTranscodeResource}=t1;return{canTranscodeResource}}DropDownMenu.propTypes={resource:prop_types_default().object.isRequired,display:prop_types_default().bool.isRequired,isMenuOpen:prop_types_default().bool.isRequired,onMenuOpen:prop_types_default().func.isRequired,onMenuCancelled:prop_types_default().func.isRequired,onMenuSelected:prop_types_default().func.isRequired,setParentActive:prop_types_default().func};const dropDownMenu=DropDownMenu;DropDownMenu.__docgenInfo={description:"Get a More icon that displays a dropdown menu on click.\n\n@param {Object} props Component props.\n@param {Object} props.resource Selected media element's resource object.\n@param {boolean} props.display Whether the more icon should be displayed.\n@param {boolean} props.isMenuOpen If the dropdown menu is open.\n@param {Function} props.onMenuOpen Callback for when menu is opened.\n@param {Function} props.onMenuCancelled Callback for when menu is closed without any selections.\n@param {Function} props.onMenuSelected Callback for when menu is closed and an option selected.\n@param {Function} props.setParentActive Sets the parent element active.\n@return {null|*} Element or null if should not display the More icon.",methods:[],displayName:"DropDownMenu",props:{setParentActive:{defaultValue:{value:"noop",computed:!0},description:"",type:{name:"func"},required:!1},resource:{description:"",type:{name:"object"},required:!0},display:{description:"",type:{name:"bool"},required:!0},isMenuOpen:{description:"",type:{name:"bool"},required:!0},onMenuOpen:{description:"",type:{name:"func"},required:!0},onMenuCancelled:{description:"",type:{name:"func"},required:!0},onMenuSelected:{description:"",type:{name:"func"},required:!0}}};var tooltip=__webpack_require__("./packages/story-editor/src/components/tooltip/index.js"),utils_noop=__webpack_require__("./packages/story-editor/src/utils/noop.ts"),hideOnError=__webpack_require__("./packages/story-editor/src/components/hideOnError.tsx");const StyledText=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).withConfig({displayName:"attribution__StyledText",componentId:"sc-dg18hp-0"})(["color:",";"],(({theme,active})=>(0,polished_esm.B3)(theme.colors.standard.white,active?1:.6))),Link=styled_components_browser_esm.Ay.a.withConfig({displayName:"attribution__Link",componentId:"sc-dg18hp-1"})(["display:block;position:absolute;left:0;bottom:0;width:100%;padding:8px;background-color:",";text-overflow:ellipsis;overflow:hidden;white-space:nowrap;text-decoration:none;"],(({theme,active})=>(0,polished_esm.B3)(theme.colors.bg.primary,active?.8:.6))),Attribution=t0=>{const $=(0,dist.c)(13),{author,url}=t0,[active,setActive]=(0,react_src.J0)(!1);let t1;$[0]!==setActive?(t1=()=>setActive(!0),$[0]=setActive,$[1]=t1):t1=$[1];const makeActive=t1;let t2;$[2]!==setActive?(t2=()=>setActive(!1),$[2]=setActive,$[3]=t2):t2=$[3];const makeInactive=t2;let t3,t4;return $[4]!==author?(t3=react.createElement(StyledText,{size:types.$.XSmall},author),$[4]=author,$[5]=t3):t3=$[5],$[6]!==active||$[7]!==author||$[8]!==makeActive||$[9]!==makeInactive||$[10]!==t3||$[11]!==url?(t4=react.createElement(Link,{title:author,active,onPointerEnter:makeActive,onFocus:makeActive,onPointerLeave:makeInactive,onBlur:makeInactive,href:url,target:"_blank",rel:"noreferrer"},t3),$[6]=active,$[7]=author,$[8]=makeActive,$[9]=makeInactive,$[10]=t3,$[11]=url,$[12]=t4):t4=$[12],t4},common_attribution=Attribution;Attribution.__docgenInfo={description:"",methods:[],displayName:"Attribution",props:{author:{description:"",type:{name:"string"},required:!0},url:{description:"",type:{name:"string"},required:!0}}};var resourceList=__webpack_require__("./packages/media/src/resourceList.ts"),muted=__webpack_require__("./packages/design-system/src/icons/muted.svg"),libraryMoveable=__webpack_require__("./packages/story-editor/src/components/library/panes/shared/libraryMoveable.js"),dropTargets=__webpack_require__("./packages/story-editor/src/components/dropTargets/index.js"),insertionOverlay=__webpack_require__("./packages/story-editor/src/components/library/panes/shared/insertionOverlay.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const styledTiles=(0,styled_components_browser_esm.AH)(["width:100%;cursor:pointer;transition:0.2s transform,0.15s opacity;border-radius:4px;opacity:0;object-fit:cover;"]),innerElement_Image=styled_components_browser_esm.Ay.img.withConfig({displayName:"innerElement__Image",componentId:"sc-qkk7ov-0"})(["",""],styledTiles),innerElement_Video=styled_components_browser_esm.Ay.video.withConfig({displayName:"innerElement__Video",componentId:"sc-qkk7ov-1"})([""," ",""],styledTiles,(({showWithoutDelay})=>showWithoutDelay?"opacity: 1;":"")),DurationWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"innerElement__DurationWrapper",componentId:"sc-qkk7ov-2"})(["position:absolute;bottom:8px;left:8px;background:",";border-radius:100px;height:18px;padding:0 6px;"],(({theme})=>theme.colors.opacity.black64)),MuteWrapper=styled_components_browser_esm.Ay.div.withConfig({displayName:"innerElement__MuteWrapper",componentId:"sc-qkk7ov-3"})(["position:absolute;bottom:8px;right:8px;height:24px;width:24px;background:",";color:",";border-radius:100px;"],(({theme})=>theme.colors.opacity.black64),(({theme})=>theme.colors.fg.primary)),Duration=(0,styled_components_browser_esm.Ay)(typography_text.E.Span).attrs({size:types.$.XSmall}).withConfig({displayName:"innerElement__Duration",componentId:"sc-qkk7ov-4"})(["color:",";display:block;"],(({theme})=>theme.colors.fg.primary)),CloneImg=styled_components_browser_esm.Ay.img.withConfig({displayName:"innerElement__CloneImg",componentId:"sc-qkk7ov-5"})(["opacity:0;width:",";height:",";position:absolute;"],(({width})=>`${width}px`),(({height})=>`${height}px`));function InnerElement({type,src,resource,alt,width,height,onClick,onLoad=noop.l,showVideoDetail,mediaElementRef,active,isMuted}){const newVideoPosterRef=(0,react_src.li)(null),hasSetResourceRef=(0,react_src.li)(null),{handleDrag,handleDrop}=(0,dropTargets.h)((({state,actions})=>({handleDrag:actions.handleDrag,handleDrop:actions.handleDrop,dropTargets:state.dropTargets,activeDropTargetId:state.activeDropTargetId})),((prev,curr)=>{if(hasSetResourceRef.current)return!1;if(null===hasSetResourceRef.current)return hasSetResourceRef.current=!1,!1;if(prev?.dropTargets&&curr?.dropTargets){const prevIds=Object.keys(prev.dropTargets),currentIds=Object.keys(curr.dropTargets);if(prevIds.join()!==currentIds.join())return!1}return prev?.activeDropTargetId===curr?.activeDropTargetId})),{setDraggingResource:setDraggingResource_0}=(0,dropTargets.h)((({actions:{setDraggingResource}})=>({setDraggingResource})));(0,react_src.vJ)((()=>{resource.poster&&(newVideoPosterRef.current=resource.poster)}),[resource.poster]);let media;const{lengthFormatted,poster,mimeType}=resource,displayPoster=poster??newVideoPosterRef.current,thumbnailURL=displayPoster||(0,getSmallestUrlForWidth.A)(width,resource),commonProps={width,height,alt,crossOrigin:"anonymous"},commonImageProps={...commonProps,onLoad:()=>{mediaElementRef.current&&(mediaElementRef.current.style.opacity=1),onLoad()},loading:"lazy",decoding:"async",draggable:!1},cloneProps={...commonImageProps,onLoad:void 0},imageProps={...commonImageProps,src:thumbnailURL},videoProps={...commonProps,title:alt,alt:null,loop:type===app_media.cM.Gif,muted:!0,preload:"metadata",poster:displayPoster,showWithoutDelay:active};if(type===app_media.cM.Image||type===app_media.cM.Sticker?(media=react.createElement(innerElement_Image,_extends({key:src},imageProps,{ref:mediaElementRef})),cloneProps.src=thumbnailURL):[app_media.cM.Video,app_media.cM.Gif].includes(type)&&(media=react.createElement(react.Fragment,null,poster&&!active?react.createElement(innerElement_Image,_extends({key:src},imageProps,{ref:mediaElementRef})):react.createElement(innerElement_Video,_extends({key:src},videoProps,{ref:mediaElementRef}),type===app_media.cM.Gif?resource.output.src&&react.createElement("source",{src:resource.output.src,type:resource.output.mimeType}):react.createElement("source",{src:(0,getSmallestUrlForWidth.A)(width,resource),type:mimeType})),type===app_media.cM.Video&&showVideoDetail&&lengthFormatted&&react.createElement(DurationWrapper,null,react.createElement(Duration,null,lengthFormatted)),type===app_media.cM.Video&&showVideoDetail&&isMuted&&react.createElement(MuteWrapper,null,react.createElement(muted.A,null))),cloneProps.src=poster),!media)throw new Error("Invalid media element type.");const imageURL=type===app_media.cM.Image?thumbnailURL:poster;return react.createElement(react.Fragment,null,media,active&&react.createElement(insertionOverlay.A,{showIcon:!1}),react.createElement(libraryMoveable.A,{active,handleDrag:event=>{hasSetResourceRef.current||(resourceList.A.set(resource.id,{url:thumbnailURL,type:"cached"}),setDraggingResource_0(resource),hasSetResourceRef.current=!0),handleDrag(resource,event.clientX,event.clientY)},handleDragEnd:()=>{handleDrop(resource),hasSetResourceRef.current=!1},type:resource.type,elementProps:{resource},onClick:onClick(imageURL),cloneElement:CloneImg,cloneProps}))}const innerElement=(0,react_src.ph)(InnerElement);InnerElement.__docgenInfo={description:"",methods:[],displayName:"InnerElement",props:{onLoad:{defaultValue:{value:"noop",computed:!0},description:"",type:{name:"func"},required:!1},type:{description:"",type:{name:"string"},required:!0},src:{description:"",type:{name:"string"},required:!0},resource:{description:"",type:{name:"custom",raw:"ResourcePropTypes.imageResource"},required:!1},alt:{description:"",type:{name:"string"},required:!1},width:{description:"",type:{name:"number"},required:!1},height:{description:"",type:{name:"number"},required:!1},isMuted:{description:"",type:{name:"bool"},required:!1},onClick:{description:"",type:{name:"func"},required:!0},showVideoDetail:{description:"",type:{name:"bool"},required:!1},mediaElementRef:{description:"",type:{name:"object"},required:!1},active:{description:"",type:{name:"bool"},required:!0}}};var keyboard=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx"),plus_filled_small=__webpack_require__("./packages/design-system/src/icons/plus_filled_small.svg"),getElementProperties=__webpack_require__("./packages/story-editor/src/components/canvas/utils/getElementProperties.ts"),useStory=__webpack_require__("./packages/story-editor/src/app/story/useStory.ts"),useRovingTabIndex=__webpack_require__("./packages/story-editor/src/utils/useRovingTabIndex/index.js"),useFocusCanvas=__webpack_require__("./packages/story-editor/src/components/canvas/useFocusCanvas.ts");const insertionMenu_DropDownContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"insertionMenu__DropDownContainer",componentId:"sc-xjd4tf-0"})(["margin-top:10px;min-width:160px;"]),insertionMenu_MenuContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"insertionMenu__MenuContainer",componentId:"sc-xjd4tf-1"})(["z-index:1;"]),insertionMenu_menuStylesOverride=(0,styled_components_browser_esm.AH)(["min-width:160px;margin-top:0;li{display:block;}"]),insertionMenu_MENU_OPTIONS_INSERT="insert",insertionMenu_MENU_OPTIONS_ADD_BACKGROUND="addBackground";function InsertionMenu(t0){const $=(0,dist.c)(53),{resource,display,onInsert,width,index,isLocal:t1,setParentActive:t2,setParentInactive:t3}=t0,isLocal=void 0!==t1&&t1,setParentActive=void 0===t2?noop.l:t2,setParentInactive=void 0===t3?noop.l:t3,insertButtonRef=(0,react_src.li)(),[isMenuOpen,setIsMenuOpen]=(0,react_src.J0)(!1);let t4,t5;$[0]!==setIsMenuOpen?(t4=e=>{e.stopPropagation(),setIsMenuOpen(!0)},$[0]=setIsMenuOpen,$[1]=t4):t4=$[1],$[2]===Symbol.for("react.memo_cache_sentinel")?(t5=[],$[2]=t5):t5=$[2];const onMenuOpen=(0,react_src.hb)(t4,t5);let t6,t7;$[3]!==insertButtonRef.current||$[4]!==setIsMenuOpen||$[5]!==setParentActive?(t6=()=>{setIsMenuOpen(!1),insertButtonRef.current?.focus(),setParentActive()},$[3]=insertButtonRef.current,$[4]=setIsMenuOpen,$[5]=setParentActive,$[6]=t6):t6=$[6],$[7]!==setParentActive?(t7=[setParentActive],$[7]=setParentActive,$[8]=t7):t7=$[8];const onMenuCancelled=(0,react_src.hb)(t6,t7),{currentBackgroundId,combineElements}=(0,useStory.A)(insertionMenu_temp),{type,poster}=resource;let t8;$[9]!==type?(t8=["image","gif"].includes(type)?(0,i18n.__)("Insert image","web-stories"):(0,i18n.__)("Insert video","web-stories"),$[9]=type,$[10]=t8):t8=$[10];const insertLabel=t8;let t9,t10,t11;$[11]!==insertLabel?(t9={label:insertLabel,value:insertionMenu_MENU_OPTIONS_INSERT},$[11]=insertLabel,$[12]=t9):t9=$[12],$[13]===Symbol.for("react.memo_cache_sentinel")?(t10={label:(0,i18n.__)("Add as background","web-stories"),value:insertionMenu_MENU_OPTIONS_ADD_BACKGROUND},$[13]=t10):t10=$[13],$[14]!==t9?(t11=[{options:[t9,t10]}],$[14]=t9,$[15]=t11):t11=$[15];const groups=t11;let t12;$[16]!==combineElements||$[17]!==currentBackgroundId||$[18]!==onInsert||$[19]!==poster||$[20]!==resource||$[21]!==setIsMenuOpen||$[22]!==setParentInactive||$[23]!==width?(t12=(evt,value)=>{const thumbnailUrl=poster||(0,getSmallestUrlForWidth.A)(width,resource),newElement=(0,getElementProperties.A)(resource.type,{resource});setIsMenuOpen(!1);bb43:switch(value){case insertionMenu_MENU_OPTIONS_INSERT:onInsert(resource,thumbnailUrl);break bb43;case insertionMenu_MENU_OPTIONS_ADD_BACKGROUND:combineElements({firstElement:newElement,secondId:currentBackgroundId})}setParentInactive()},$[16]=combineElements,$[17]=currentBackgroundId,$[18]=onInsert,$[19]=poster,$[20]=resource,$[21]=setIsMenuOpen,$[22]=setParentInactive,$[23]=width,$[24]=t12):t12=$[24];const handleCurrentValue=t12;let t13,t14;$[25]!==insertButtonRef?(t13={ref:insertButtonRef},$[25]=insertButtonRef,$[26]=t13):t13=$[26],$[27]===Symbol.for("react.memo_cache_sentinel")?(t14=[],$[27]=t14):t14=$[27],(0,useRovingTabIndex.A)(t13,t14,3);const focusCanvas=(0,useFocusCanvas.A)();let t15,t16;$[28]!==focusCanvas?(t15=[focusCanvas],$[28]=focusCanvas,$[29]=t15):t15=$[29],(0,keyboard._h)(isLocal?null:insertButtonRef,"tab",focusCanvas,t15),$[30]===Symbol.for("react.memo_cache_sentinel")?(t16=[],$[30]=t16):t16=$[30];const listId=(0,react_src.Kr)(insertionMenu_temp2,t16);let t17;$[31]===Symbol.for("react.memo_cache_sentinel")?(t17=[],$[31]=t17):t17=$[31];const buttonId=(0,react_src.Kr)(insertionMenu_temp3,t17);let t18;$[32]===Symbol.for("react.memo_cache_sentinel")?(t18=(0,i18n.__)("Open insertion menu","web-stories"),$[32]=t18):t18=$[32];const t19=isMenuOpen?listId:null,t20=0===index?0:-1;let t21,t22,t23,t24;return $[33]===Symbol.for("react.memo_cache_sentinel")?(t21=react.createElement(plus_filled_small.A,null),$[33]=t21):t21=$[33],$[34]!==buttonId||$[35]!==display||$[36]!==insertButtonRef||$[37]!==isMenuOpen||$[38]!==onMenuOpen||$[39]!==t19||$[40]!==t20?(t22=react.createElement(shared.rA,{ref:insertButtonRef,onClick:onMenuOpen,"aria-label":t18,"aria-pressed":isMenuOpen,"aria-haspopup":!0,"aria-expanded":isMenuOpen,"aria-owns":t19,id:buttonId,$display:display,tabIndex:t20},t21),$[34]=buttonId,$[35]=display,$[36]=insertButtonRef,$[37]=isMenuOpen,$[38]=onMenuOpen,$[39]=t19,$[40]=t20,$[41]=t22):t22=$[41],$[42]!==buttonId||$[43]!==groups||$[44]!==handleCurrentValue||$[45]!==insertButtonRef||$[46]!==isMenuOpen||$[47]!==listId||$[48]!==onMenuCancelled?(t23=isMenuOpen&&react.createElement(popup.A,{anchor:insertButtonRef,placement:popup_constants.W.BottomStart,isOpen:isMenuOpen},react.createElement(insertionMenu_DropDownContainer,null,react.createElement(menu.A,{parentId:buttonId,listId,handleMenuItemSelect:handleCurrentValue,groups,onDismissMenu:onMenuCancelled,hasMenuRole:!0,menuStylesOverride:insertionMenu_menuStylesOverride}))),$[42]=buttonId,$[43]=groups,$[44]=handleCurrentValue,$[45]=insertButtonRef,$[46]=isMenuOpen,$[47]=listId,$[48]=onMenuCancelled,$[49]=t23):t23=$[49],$[50]!==t22||$[51]!==t23?(t24=react.createElement(insertionMenu_MenuContainer,null,t22,t23),$[50]=t22,$[51]=t23,$[52]=t24):t24=$[52],t24}function insertionMenu_temp3(){return`button-${(0,v4.A)()}`}function insertionMenu_temp2(){return`list-${(0,v4.A)()}`}function insertionMenu_temp(state){return{currentBackgroundId:state.state.currentPage?.elements?.[0]?.id,combineElements:state.actions.combineElements}}InsertionMenu.propTypes={resource:propTypes.TL.resource.isRequired,display:prop_types_default().bool.isRequired,onInsert:prop_types_default().func.isRequired,width:prop_types_default().number.isRequired,index:prop_types_default().number.isRequired,isLocal:prop_types_default().bool,setParentActive:prop_types_default().func,setParentInactive:prop_types_default().func};const insertionMenu=InsertionMenu;function mediaElement_extends(){return mediaElement_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},mediaElement_extends.apply(null,arguments)}InsertionMenu.__docgenInfo={description:"Get a More icon that displays a dropdown menu on click.\n\n@param {Object} props Component props.\n@param {Object} props.resource Selected media element's resource object.\n@param {boolean} props.display Whether the more icon should be displayed.\n@param {Function} props.onInsert Callback for inserting media.\n@param {number} props.width Media width.\n@param {number} props.index Element index in the gallery.\n@param {boolean} props.isLocal If the menu is for local or 3p media.\n@param {Function} props.setParentActive Sets the parent element active.\n@param {Function} props.setParentInactive Sets the parent element inactive.\n@return {null|*} Element or null if should not display the More icon.",methods:[],displayName:"InsertionMenu",props:{isLocal:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},setParentActive:{defaultValue:{value:"noop",computed:!0},description:"",type:{name:"func"},required:!1},setParentInactive:{defaultValue:{value:"noop",computed:!0},description:"",type:{name:"func"},required:!1},resource:{description:"",type:{name:"custom",raw:"ResourcePropTypes.resource.isRequired"},required:!1},display:{description:"",type:{name:"bool"},required:!0},onInsert:{description:"",type:{name:"func"},required:!0},width:{description:"",type:{name:"number"},required:!0},index:{description:"",type:{name:"number"},required:!0}}};const Container=styled_components_browser_esm.Ay.div.attrs((props=>({style:{width:props.width+"px",height:props.height+"px",margin:props.margin,backgroundColor:"transparent",color:"inherit",border:"none",padding:0}}))).withConfig({displayName:"mediaElement__Container",componentId:"sc-n7038j-0"})([""]),InnerContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"mediaElement__InnerContainer",componentId:"sc-n7038j-1"})(["position:relative;display:flex;margin-bottom:10px;background-color:",";"],(({theme,$baseColor})=>$baseColor||(0,polished_esm.B3)(theme.colors.standard.black,.3))),BlurhashContainer=(0,styled_components_browser_esm.Ay)(esm.Q).withConfig({displayName:"mediaElement__BlurhashContainer",componentId:"sc-n7038j-2"})(["position:absolute !important;top:0;left:0;"]);function Element({index,resource,width:requestedWidth,height:requestedHeight,margin,onInsert,providerType,canEditMedia}){const{id:resourceId,src,type,width:originalWidth,height:originalHeight,alt,isMuted,baseColor,blurHash}=resource,{isCurrentResourceProcessing,isCurrentResourceUploading}=(0,app_media.HZ)((({state})=>({isCurrentResourceProcessing:state.isCurrentResourceProcessing,isCurrentResourceUploading:state.isCurrentResourceUploading}))),oRatio=originalWidth&&originalHeight?originalWidth/originalHeight:1,width=requestedWidth||requestedHeight/oRatio,height=requestedHeight||width/oRatio,mediaElementRef=(0,react_src.li)(),[showVideoDetail,setShowVideoDetail]=(0,react_src.J0)(!0),[active,setActive]=(0,react_src.J0)(!1),[isMenuOpen,setIsMenuOpen]=(0,react_src.J0)(!1),[isLoaded,setLoaded]=(0,react_src.J0)(!1),makeActive=(0,react_src.hb)((()=>setActive(!0)),[]),makeInactive=(0,react_src.hb)((()=>setActive(!1)),[]),onMenuOpen=(0,react_src.hb)((()=>setIsMenuOpen(!0)),[]),onMenuCancelled=(0,react_src.hb)((()=>setIsMenuOpen(!1)),[]),onMenuSelected=(0,react_src.hb)((()=>{setIsMenuOpen(!1),setActive(!1)}),[]),[hoverTimer,setHoverTimer]=(0,react_src.J0)(null),activeRef=(0,react_src.li)(active);activeRef.current=active,(0,react_src.vJ)((()=>{if(![app_media.cM.Video,app_media.cM.Gif].includes(type))return;const resetHoverTime=()=>{null!==hoverTimer&&(clearTimeout(hoverTimer),setHoverTimer(null))};if(!isMenuOpen)if(active){if(setShowVideoDetail(!1),mediaElementRef.current&&null===hoverTimer){const timer=setTimeout((()=>{activeRef.current&&src&&mediaElementRef.current.play().catch(utils_noop.l)}),600);setHoverTimer(timer)}}else setShowVideoDetail(!0),resetHoverTime(),mediaElementRef.current&&mediaElementRef.current?.pause&&src&&(mediaElementRef.current.pause(),mediaElementRef.current.currentTime=0);return resetHoverTime}),[isMenuOpen,active,type,src,hoverTimer,setHoverTimer,activeRef]);const onClick=(0,react_src.hb)((thumbnailUrl=>()=>{onInsert(resource,thumbnailUrl)}),[onInsert,resource]),attribution=active&&resource.attribution?.author?.displayName&&resource.attribution?.author?.url&&react.createElement(common_attribution,{author:resource.attribution.author.displayName,url:resource.attribution.author.url}),ref=(0,react_src.li)(),onLoad=(0,react_src.hb)((()=>setLoaded(!0)),[]),isPlaceholder=!isLoaded&&!active;return react.createElement(Container,{ref,"data-testid":`mediaElement-${type}`,"data-id":resourceId,className:"mediaElement",width,height,margin,onPointerEnter:makeActive,onFocus:makeActive,onPointerLeave:makeInactive,onBlur:makeInactive,tabIndex:"-1"},react.createElement(InnerContainer,{$baseColor:isPlaceholder&&baseColor},react.createElement(innerElement,{type,src,mediaElementRef,resource,alt,isMuted,width,height,onClick,onLoad,showVideoDetail,active}),attribution,isPlaceholder&&blurHash&&react.createElement(hideOnError.w,null,react.createElement(BlurhashContainer,{hash:blurHash,width,height,punch:1})),(!src||isCurrentResourceProcessing(resourceId)||isCurrentResourceUploading(resourceId))&&react.createElement(loadingBar.G,{loadingMessage:(0,i18n.__)("Uploading media…","web-stories")}),react.createElement(insertionMenu,{resource,display:active,onInsert,width,index,isLocal:"local"===providerType,setParentActive:makeActive,setParentInactive:makeInactive}),"local"===providerType&&canEditMedia&&react.createElement(dropDownMenu,{resource,display:active,isMenuOpen,onMenuOpen,onMenuCancelled,onMenuSelected,setParentActive:makeActive})))}function MediaElement(t0){const $=(0,dist.c)(13);let props,t1,t2;$[0]!==t0?(({providerType:t1,canEditMedia:t2,...props}=t0),$[0]=t0,$[1]=props,$[2]=t1,$[3]=t2):(props=$[1],t1=$[2],t2=$[3]);const providerType=void 0===t1?"local":t1,canEditMedia=void 0!==t2&&t2,{isCurrentResourceProcessing,isCurrentResourceUploading}=(0,app_media.HZ)(mediaElement_temp),{id:resourceId}=props.resource;if(isCurrentResourceProcessing(resourceId)||isCurrentResourceUploading(resourceId)){let t3,t4;return $[4]===Symbol.for("react.memo_cache_sentinel")?(t3=(0,i18n.__)("Uploading media…","web-stories"),$[4]=t3):t3=$[4],$[5]!==canEditMedia||$[6]!==props||$[7]!==providerType?(t4=react.createElement(tooltip.A,{title:t3},react.createElement(Element,mediaElement_extends({},props,{providerType,canEditMedia}))),$[5]=canEditMedia,$[6]=props,$[7]=providerType,$[8]=t4):t4=$[8],t4}let t3;return $[9]!==canEditMedia||$[10]!==props||$[11]!==providerType?(t3=react.createElement(Element,mediaElement_extends({},props,{providerType,canEditMedia})),$[9]=canEditMedia,$[10]=props,$[11]=providerType,$[12]=t3):t3=$[12],t3}function mediaElement_temp(t0){const{state}=t0;return{isCurrentResourceProcessing:state.isCurrentResourceProcessing,isCurrentResourceUploading:state.isCurrentResourceUploading}}MediaElement.propTypes={index:prop_types_default().number.isRequired,resource:prop_types_default().object,width:prop_types_default().number,height:prop_types_default().number,margin:prop_types_default().string,onInsert:prop_types_default().func,providerType:prop_types_default().string,canEditMedia:prop_types_default().bool};const mediaElement=(0,react_src.ph)(MediaElement);MediaElement.__docgenInfo={description:"Get a formatted element for different media types.\n\n@param {Object} props Component props.\n@param {number} props.index Index of the media element in the gallery.\n@param {Object} props.resource Resource object\n@param {number} props.width Width that element is inserted into editor.\n@param {number} props.height Height that element is inserted into editor.\n@param {string?} props.margin The margin in around the element\n@param {Function} props.onInsert Insertion callback.\n@param {string} props.providerType Which provider the element is from.\n@param {boolean} props.canEditMedia Current user can upload media.\n@return {null|*} Element or null if does not map to video/image.",methods:[],displayName:"MediaElement",props:{providerType:{defaultValue:{value:"'local'",computed:!1},description:"",type:{name:"string"},required:!1},canEditMedia:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},index:{description:"",type:{name:"number"},required:!0},resource:{description:"",type:{name:"object"},required:!1},width:{description:"",type:{name:"number"},required:!1},height:{description:"",type:{name:"number"},required:!1},margin:{description:"",type:{name:"string"},required:!1},onInsert:{description:"",type:{name:"func"},required:!1}}};var styles=__webpack_require__("./packages/story-editor/src/components/library/panes/media/common/styles.js");const ROW_CONSTRAINTS={maxPhotos:2},ContainerRenderer=t0=>{const $=(0,dist.c)(3),{children,containerRef}=t0;let t1;return $[0]!==children||$[1]!==containerRef?(t1=react.createElement(styles.WW,{ref:containerRef},children),$[0]=children,$[1]=containerRef,$[2]=t1):t1=$[2],t1},RowRenderer=({children})=>children;function MediaGallery(t0){const $=(0,dist.c)(13),{resources,uploadingResources:t1,onInsert,providerType,canEditMedia:t2}=t0;let t3;$[0]!==t1?(t3=void 0===t1?[]:t1,$[0]=t1,$[1]=t3):t3=$[1];const uploadingResources=t3,canEditMedia=void 0!==t2&&t2;let t4;$[2]!==resources||$[3]!==uploadingResources?(t4=[...uploadingResources.map(mediaGallery_temp),...resources.map(mediaGallery_temp2)].map(mediaGallery_temp3),$[2]=resources,$[3]=uploadingResources,$[4]=t4):t4=$[4];const photos=t4;let t5,t6;$[5]!==canEditMedia||$[6]!==onInsert||$[7]!==providerType?(t5=t7=>{const{photo:photo_0,layout}=t7;return react.createElement(mediaElement,{key:photo_0.key,index:photo_0.index,margin:"0px 0px 8px 0px",resource:photo_0.resource,width:layout.width,height:layout.height,onInsert,providerType,canEditMedia})},t6=[providerType,onInsert,canEditMedia],$[5]=canEditMedia,$[6]=onInsert,$[7]=providerType,$[8]=t5,$[9]=t6):(t5=$[8],t6=$[9]);const imageRenderer=(0,react_src.hb)(t5,t6);let t7;return $[10]!==imageRenderer||$[11]!==photos?(t7=react.createElement("div",null,react.createElement(react_photo_album_dist.A,{layout:"rows",photos,renderPhoto:imageRenderer,renderRowContainer:RowRenderer,renderContainer:ContainerRenderer,targetRowHeight:110,rowConstraints:ROW_CONSTRAINTS,spacing:8,defaultContainerWidth:constants.gH})),$[10]=imageRenderer,$[11]=photos,$[12]=t7):t7=$[12],t7}function mediaGallery_temp3(photo,index){return{...photo,index}}function mediaGallery_temp2(resource_0){return{key:resource_0.id,src:resource_0.src,width:resource_0.width,height:resource_0.height,resource:resource_0}}function mediaGallery_temp(resource){return{key:`uploading-${resource.id}`,src:resource.src,width:resource.width,height:resource.height,resource}}const mediaGallery=MediaGallery;MediaGallery.__docgenInfo={description:"Displays a gallery of media elements arranged in a row-based format.\n\n@param {Object} props Component props.\n@param {Array.<Object>} props.resources List of resources to display.\n@param {Array.<Object>} props.uploadingResources List of uploading resources to display.\n@param {InsertionCallback} props.onInsert Called when element is selected.\n@param {string} props.providerType Provider of gallery's elements.\n@param {boolean} props.canEditMedia Current user can upload media.\n@return {*} The gallery element.",methods:[],displayName:"MediaGallery",props:{uploadingResources:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},canEditMedia:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},resources:{description:"",type:{name:"arrayOf",value:{name:"object"}},required:!0},onInsert:{description:"",type:{name:"func"},required:!0},providerType:{description:"",type:{name:"string"},required:!0}}}}}]);