"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[3473],{"./packages/dashboard/src/components/cardGallery/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>cardGallery});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),src=__webpack_require__("./packages/react/src/index.ts"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),useGridViewKeys=__webpack_require__("./packages/design-system/src/components/keyboard/gridview/useGridViewKeys.ts"),constants=__webpack_require__("./packages/dashboard/src/constants/index.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),button_button=__webpack_require__("./packages/design-system/src/components/button/button.tsx"),button_constants=__webpack_require__("./packages/design-system/src/components/button/constants.ts");const pictureCss=(0,styled_components_browser_esm.AH)(["picture{display:block;& > img{display:block;height:100%;width:100%;object-fit:fill;border-radius:",";border:",";}}"],(({theme})=>theme.borders.radius.medium),(({theme})=>`1px solid ${theme.colors.border.defaultNormal}`)),GalleryContainer=styled_components_browser_esm.Ay.div.withConfig({displayName:"cardGallery__GalleryContainer",componentId:"sc-8jnrkn-0"})(["flex:1;display:flex;justify-content:space-between;align-items:start;"]),DisplayPage=styled_components_browser_esm.Ay.div.withConfig({displayName:"cardGallery__DisplayPage",componentId:"sc-8jnrkn-1"})(["overflow:hidden;width:38.6%;margin-left:2.1%;"," @media screen and (min-width:1600px){width:45.2%;margin-left:2.4%;}"],pictureCss);DisplayPage.propTypes={$isThreeRows:prop_types_default().bool};const Thumbnails=styled_components_browser_esm.Ay.div.withConfig({displayName:"cardGallery__Thumbnails",componentId:"sc-8jnrkn-2"})(["position:relative;display:grid;width:52.3%;grid-template-columns:repeat(3,1fr);column-gap:8px;row-gap:16px;margin-right:16px;@media screen and (min-width:1600px){width:59.3%;grid-template-columns:repeat(4,1fr);}"]),ThumbnailButton=(0,styled_components_browser_esm.Ay)(button_button.$).attrs({type:button_constants.VQ.Plain}).withConfig({displayName:"cardGallery__ThumbnailButton",componentId:"sc-8jnrkn-3"})(["display:block;height:100%;padding:0;border:none;background-color:transparent;position:relative;&:active{background-color:transparent;}"," ",";"],(({$isSelected,theme})=>$isSelected&&(0,styled_components_browser_esm.AH)(["&:after{content:'';position:absolute;box-sizing:border-box;width:100%;height:100%;display:block;top:0;right:0;border-radius:",";border:4px solid ",";}"],theme.borders.radius.medium,theme.colors.interactiveBg.active)),pictureCss);function getPosterAltCopy(pageNumber){return(0,sprintf.A)((0,i18n.__)("Poster of template page %s","web-stories"),pageNumber)}function CardGallery(t0){const $=(0,dist.c)(47),{galleryPosters,isRTL,galleryLabel}=t0,[selectedGridItemIndex,setSelectedGridItemIndex]=(0,src.J0)(0),[focusedGridItemIndex,setFocusedGridItemIndex]=(0,src.J0)(),containerRef=(0,src.li)(),gridRef=(0,src.li)();let t1;$[0]===Symbol.for("react.memo_cache_sentinel")?(t1={},$[0]=t1):t1=$[0];const postersRef=(0,src.li)(t1);let t2,t3;$[1]!==setFocusedGridItemIndex||$[2]!==setSelectedGridItemIndex?(t2=index=>{setSelectedGridItemIndex(index),setFocusedGridItemIndex(index)},$[1]=setFocusedGridItemIndex,$[2]=setSelectedGridItemIndex,$[3]=t2):t2=$[3],$[4]===Symbol.for("react.memo_cache_sentinel")?(t3=[],$[4]=t3):t3=$[4];const handleMiniCardClick=(0,src.hb)(t2,t3);let t4,t5;$[5]!==setFocusedGridItemIndex?(t4=index_0=>{setFocusedGridItemIndex(index_0)},$[5]=setFocusedGridItemIndex,$[6]=t4):t4=$[6],$[7]===Symbol.for("react.memo_cache_sentinel")?(t5=[],$[7]=t5):t5=$[7];const handleGalleryItemFocus=(0,src.hb)(t4,t5);let t6,t7,t8,t9,t10;$[8]!==galleryPosters||$[9]!==setFocusedGridItemIndex||$[10]!==setSelectedGridItemIndex?(t6=()=>{galleryPosters&&(setSelectedGridItemIndex(0),setFocusedGridItemIndex())},$[8]=galleryPosters,$[9]=setFocusedGridItemIndex,$[10]=setSelectedGridItemIndex,$[11]=t6):t6=$[11],$[12]!==galleryPosters?(t7=[galleryPosters],$[12]=galleryPosters,$[13]=t7):t7=$[13],(0,src.vJ)(t6,t7),$[14]!==containerRef||$[15]!==focusedGridItemIndex||$[16]!==galleryPosters||$[17]!==gridRef||$[18]!==isRTL||$[19]!==postersRef?(t8={containerRef,gridRef,itemRefs:postersRef,isRTL,currentItemId:focusedGridItemIndex,items:galleryPosters},$[14]=containerRef,$[15]=focusedGridItemIndex,$[16]=galleryPosters,$[17]=gridRef,$[18]=isRTL,$[19]=postersRef,$[20]=t8):t8=$[20],(0,useGridViewKeys.A)(t8),$[21]!==focusedGridItemIndex||$[22]!==galleryPosters||$[23]!==handleGalleryItemFocus||$[24]!==handleMiniCardClick||$[25]!==postersRef||$[26]!==selectedGridItemIndex?(t9=()=>galleryPosters.map(((poster,index_1)=>{const key=`gallery_item_${index_1}`,pageNumber=index_1+1,isFocusIndex=focusedGridItemIndex?focusedGridItemIndex===index_1:selectedGridItemIndex===index_1;return react.createElement("div",{key,ref:el=>{postersRef.current[index_1]=el},onFocus:()=>handleGalleryItemFocus(index_1)},react.createElement(ThumbnailButton,{$isSelected:selectedGridItemIndex===index_1,tabIndex:isFocusIndex?0:-1,onClick:()=>handleMiniCardClick(index_1),"aria-label":selectedGridItemIndex===index_1?(0,sprintf.A)((0,i18n.__)("Page %s (current page)","web-stories"),pageNumber):(0,sprintf.A)((0,i18n.__)("Page %s","web-stories"),pageNumber)},react.createElement("picture",null,react.createElement("source",{srcSet:poster.webp,type:"image/webp"}),react.createElement("source",{srcSet:poster.png,type:"image/png"}),react.createElement("img",{src:poster.png,decoding:"async",alt:getPosterAltCopy(pageNumber),width:constants.qs,height:constants.PO}))))})),$[21]=focusedGridItemIndex,$[22]=galleryPosters,$[23]=handleGalleryItemFocus,$[24]=handleMiniCardClick,$[25]=postersRef,$[26]=selectedGridItemIndex,$[27]=t9):t9=$[27],$[28]!==focusedGridItemIndex||$[29]!==galleryPosters||$[30]!==handleGalleryItemFocus||$[31]!==handleMiniCardClick||$[32]!==selectedGridItemIndex?(t10=[galleryPosters,selectedGridItemIndex,focusedGridItemIndex,handleGalleryItemFocus,handleMiniCardClick],$[28]=focusedGridItemIndex,$[29]=galleryPosters,$[30]=handleGalleryItemFocus,$[31]=handleMiniCardClick,$[32]=selectedGridItemIndex,$[33]=t10):t10=$[33];const GalleryItems=(0,src.Kr)(t9,t10);let t11,t12,t13,t14;return $[34]!==GalleryItems||$[35]!==galleryLabel||$[36]!==gridRef?(t11=react.createElement(Thumbnails,{ref:gridRef,role:"group","aria-label":galleryLabel,"data-testid":"mini-cards-container"},GalleryItems),$[34]=GalleryItems,$[35]=galleryLabel,$[36]=gridRef,$[37]=t11):t11=$[37],$[38]!==galleryPosters||$[39]!==selectedGridItemIndex?(t12=galleryPosters[selectedGridItemIndex]&&react.createElement("picture",null,react.createElement("source",{srcSet:galleryPosters[selectedGridItemIndex].webp,type:"image/webp"}),react.createElement("source",{srcSet:galleryPosters[selectedGridItemIndex].png,type:"image/png"}),react.createElement("img",{src:galleryPosters[selectedGridItemIndex].png,decoding:"async",alt:(0,sprintf.A)((0,i18n.__)("Active Page Preview - Page %s","web-stories"),selectedGridItemIndex+1),width:constants.qs,height:constants.PO})),$[38]=galleryPosters,$[39]=selectedGridItemIndex,$[40]=t12):t12=$[40],$[41]!==t12?(t13=react.createElement(DisplayPage,null,t12),$[41]=t12,$[42]=t13):t13=$[42],$[43]!==containerRef||$[44]!==t11||$[45]!==t13?(t14=react.createElement(GalleryContainer,{ref:containerRef},t11,t13),$[43]=containerRef,$[44]=t11,$[45]=t13,$[46]=t14):t14=$[46],t14}ThumbnailButton.propTypes={$isSelected:prop_types_default().bool};const cardGallery=CardGallery;CardGallery.__docgenInfo={description:"",methods:[],displayName:"CardGallery",props:{galleryPosters:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{png:{name:"string",required:!1},webp:{name:"string",required:!1},id:{name:"number",required:!1}}}},required:!0},isRTL:{description:"",type:{name:"bool"},required:!1},galleryLabel:{description:"",type:{name:"string"},required:!0}}}},"./packages/design-system/src/components/keyboard/gridview/useGridViewKeys.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>gridview_useGridViewKeys});var dist=__webpack_require__("./node_modules/react-compiler-runtime/dist/index.js"),src=__webpack_require__("./packages/react/src/index.ts"),keyboard=__webpack_require__("./packages/design-system/src/components/keyboard/keyboard.tsx");function focusOnPage(page){const button=page?.querySelector("button, a");button&&button.focus()}function getArrowDir(key,pos,neg,isRTL){const rtlDir=isRTL?-1:1;return key===pos?rtlDir:key===neg?-1*rtlDir:0}function getGridColumnAndRowCount(grid,pageCount){let prevX,columns=0;for(const el of grid.children){const{x}=el.getBoundingClientRect();if(void 0!==prevX&&x<prevX)break;prevX=x,columns++}return{rows:Math.ceil(pageCount/columns),columns}}function getRow(index,numColumns){return Math.ceil((index+1)/numColumns)}function getColumn(index,numColumns){return index%numColumns+1}function getIndex({row,column,numRows,numColumns,numItems}){if(row>numRows||row<=0||column>numColumns||column<=0)return-1;const index=numColumns*(row-1)+(column-1);return index>=numItems?numItems-1:index}function _temp(t0){const{id}=t0;return id}const gridview_useGridViewKeys=function useGridViewKeys(t0){const $=(0,dist.c)(38),{currentItemId,items,containerRef,gridRef,itemRefs,isRTL,arrangeItem}=t0,[focusedItemId,setFocusedItemId]=(0,src.J0)(null);let t1,t2;$[0]!==items?(t1=()=>items.map(_temp),t2=[items],$[0]=items,$[1]=t1,$[2]=t2):(t1=$[1],t2=$[2]);const itemIds=(0,src.Kr)(t1,t2);let t3,t4,t5,t6,t7,t8,t9,t10;$[3]!==currentItemId||$[4]!==setFocusedItemId?(t3=()=>{setFocusedItemId(currentItemId)},$[3]=currentItemId,$[4]=setFocusedItemId,$[5]=t3):t3=$[5],$[6]!==currentItemId?(t4=[currentItemId],$[6]=currentItemId,$[7]=t4):t4=$[7],(0,src.vJ)(t3,t4),$[8]===Symbol.for("react.memo_cache_sentinel")?(t5={key:["up","down","left","right"]},$[8]=t5):t5=$[8],$[9]!==focusedItemId||$[10]!==gridRef||$[11]!==isRTL||$[12]!==itemIds||$[13]!==itemRefs?.current||$[14]!==setFocusedItemId?(t6=t7=>{const{key}=t7;bb7:switch(key){case"ArrowLeft":case"ArrowRight":{const dir_0=getArrowDir(key,"ArrowRight","ArrowLeft",isRTL);if(0===dir_0)return;const nextIndex_0=(null!==focusedItemId?itemIds.indexOf(focusedItemId):-1)+dir_0;if(nextIndex_0<0||nextIndex_0===itemIds.length)return;const itemId_0=itemIds[nextIndex_0];setFocusedItemId(itemId_0);const item_0=itemRefs?.current?.[itemId_0];focusOnPage(item_0);break bb7}case"ArrowUp":case"ArrowDown":{if(!gridRef.current)return;const{rows:numRows,columns:numColumns}=getGridColumnAndRowCount(gridRef.current,itemIds.length),currentIndex=null!==focusedItemId?itemIds.indexOf(focusedItemId):-1,dir="ArrowDown"===key?1:-1,nextIndex=getIndex({row:getRow(currentIndex,numColumns)+dir,column:getColumn(currentIndex,numColumns),numRows,numColumns,numItems:itemIds.length});if(nextIndex<0)return;const itemId=itemIds[nextIndex];setFocusedItemId(itemId);const item=itemRefs?.current?.[itemId];focusOnPage(item);break bb7}}},$[9]=focusedItemId,$[10]=gridRef,$[11]=isRTL,$[12]=itemIds,$[13]=itemRefs?.current,$[14]=setFocusedItemId,$[15]=t6):t6=$[15],$[16]!==currentItemId||$[17]!==focusedItemId||$[18]!==gridRef||$[19]!==isRTL||$[20]!==itemIds||$[21]!==itemRefs?(t7=[focusedItemId,isRTL,itemIds,itemRefs,gridRef,currentItemId],$[16]=currentItemId,$[17]=focusedItemId,$[18]=gridRef,$[19]=isRTL,$[20]=itemIds,$[21]=itemRefs,$[22]=t7):t7=$[22],(0,keyboard._h)(containerRef,t5,t6,t7),$[23]===Symbol.for("react.memo_cache_sentinel")?(t8={key:["mod+up","mod+down","mod+left","mod+right"],shift:!0},$[23]=t8):t8=$[23],$[24]!==arrangeItem||$[25]!==focusedItemId||$[26]!==gridRef||$[27]!==isRTL||$[28]!==itemIds?(t9=e=>{const{key:key_0,shiftKey}=e;let nextIndex_1,canArrange=!1;e.preventDefault();bb59:switch(key_0){case"ArrowLeft":case"ArrowRight":{const dir_2=getArrowDir(key_0,"ArrowRight","ArrowLeft",isRTL);if(0===dir_2)return;const currentIndex_1=null!==focusedItemId?itemIds.indexOf(focusedItemId):-1;nextIndex_1=currentIndex_1,shiftKey?nextIndex_1=dir_2<0?0:itemIds.length-1:nextIndex_1+=dir_2,canArrange=nextIndex_1!==currentIndex_1&&nextIndex_1>=0&&nextIndex_1<=itemIds.length-1;break bb59}case"ArrowUp":case"ArrowDown":{if(!gridRef.current)return;const{rows:numRows_0,columns:numColumns_0}=getGridColumnAndRowCount(gridRef.current,itemIds.length),currentIndex_0=null!==focusedItemId?itemIds.indexOf(focusedItemId):-1,dir_1="ArrowDown"===key_0?1:-1;if(nextIndex_1=getIndex({row:getRow(currentIndex_0,numColumns_0)+dir_1,column:getColumn(currentIndex_0,numColumns_0),numRows:numRows_0,numColumns:numColumns_0,numItems:itemIds.length}),nextIndex_1<0)return;break bb59}}canArrange&&void 0!==nextIndex_1&&arrangeItem&&focusedItemId&&arrangeItem(focusedItemId,nextIndex_1)},$[24]=arrangeItem,$[25]=focusedItemId,$[26]=gridRef,$[27]=isRTL,$[28]=itemIds,$[29]=t9):t9=$[29],$[30]!==arrangeItem||$[31]!==currentItemId||$[32]!==focusedItemId||$[33]!==gridRef||$[34]!==isRTL||$[35]!==itemIds||$[36]!==itemRefs?(t10=[currentItemId,itemIds,isRTL,gridRef,itemRefs,focusedItemId,arrangeItem],$[30]=arrangeItem,$[31]=currentItemId,$[32]=focusedItemId,$[33]=gridRef,$[34]=isRTL,$[35]=itemIds,$[36]=itemRefs,$[37]=t10):t10=$[37],(0,keyboard._h)(containerRef,t8,t9,t10)}}}]);